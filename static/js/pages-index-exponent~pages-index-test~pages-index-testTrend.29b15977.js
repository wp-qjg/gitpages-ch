(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-exponent~pages-index-test~pages-index-testTrend"],{1148:function(t,e,a){"use strict";var i=a("5926"),r=a("577e"),n=a("1d80"),s=RangeError;t.exports=function(t){var e=r(n(this)),a="",o=i(t);if(o<0||o==1/0)throw s("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(a+=e);return a}},"1c59":function(t,e,a){"use strict";var i=a("6d61"),r=a("6566");i("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},"1e2c":function(t,e,a){"use strict";function i(){}a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSCommonUniApp=void 0,a("ac1f"),a("841c"),a("e25e"),a("00b4"),i.GetCanvasFont=function(t){return t.font},i.MeasureText=function(t,e){var a=i.GetCanvasFont(e),r=12,n=a.search("px");if(n>0){var s=a.substring(0,n);r=parseInt(s)}t=String(t);t=t.split("");for(var o=0,h=0;h<t.length;h++){var l=t[h];/[a-zA-Z]/.test(l)?o+=7:/[0-9]/.test(l)?o+=5.5:/\./.test(l)?o+=2.7:/-/.test(l)?o+=3.25:/[\u4e00-\u9fa5]/.test(l)?o+=10:/\(|\)/.test(l)?o+=3.73:/\s/.test(l)?o+=3.25:/%/.test(l)?o+=8:/:/.test(l)?o+=3.25:o+=10}return o*r/10};var r={JSUniAppCanvasHelper:i};e.JSCommonUniApp=r},"40a3":function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSCommonHQStyle=void 0;var i={BLACK_ID:1,WHITE_ID:2};var r={GetStyleConfig:function(t){switch(t){case i.BLACK_ID:return function(){return{BGColor:"rgb(0,0,0)",TooltipBGColor:"rgb(255, 255, 255)",TooltipAlpha:.92,SelectRectBGColor:"rgba(1,130,212,0.06)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(199,199,199)",Minute:{VolBarColor:null,PriceColor:"rgb(25,180,231)",AvPriceColor:"rgb(255,236,0)"},DefaultTextColor:"rgb(101,104,112)",DefaultTextFont:"14px 微软雅黑",IndexTitleBGColor:"rgb(211,211,211)",IndexTitleColor:"rgb(101,104,112)",OverlayIndexTitleBGColor:"rgba(0,0,0,0.7)",DynamicTitleFont:"12px 微软雅黑",UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(101,104,112)",CloseLineColor:"rgb(178,34,34)",Title:{TradeIndexColor:"rgb(105,105,105)",ColorIndexColor:"rgb(112,128,144)",VolColor:"rgb(101,104,112)",AmountColor:"rgb(101,104,112)",DateTimeColor:"rgb(101,104,112)",SettingColor:"rgb(101,104,112)",NameColor:"rgb(101,104,112)",TurnoverRateColor:"rgb(101,104,112)",PositionColor:"rgb(101,104,112)"},FrameBorderPen:"rgba(236,236,236,0.13)",FrameSplitPen:"rgba(236,236,236,0.13)",FrameSplitTextColor:"rgb(101,104,112)",FrameSplitTextFont:"12px 微软雅黑",FrameTitleBGColor:"rgb(246,251,253)",Frame:{XBottomOffset:0},FrameLatestPrice:{TextColor:"rgb(255,255,255)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(190,190,190)",BGAlpha:.6},CorssCursorBGColor:"rgb(43,54,69)",CorssCursorTextColor:"rgb(255,255,255)",CorssCursorTextFont:"12px 微软雅黑",CorssCursorHPenColor:"rgb(130,130,130)",CorssCursorVPenColor:"rgb(130,130,130)",KLine:{MaxMin:{Font:"12px 微软雅黑",Color:"rgb(111,111,111)",RightArrow:"→",LeftArrow:"←",HighYOffset:0,LowYOffset:0},Info:{Color:"rgb(205,149,12)",TextColor:"#afc0da",TextBGColor:"#1a283e",Investor:{ApiUrl:"/API/NewsInteract"},Announcement:{ApiUrl:"/API/ReportList"},Pforecast:{ApiUrl:"/API/StockHistoryDay"},Research:{ApiUrl:"/API/InvestorRelationsList"},BlockTrading:{ApiUrl:"/API/StockHistoryDay"},TradeDetail:{ApiUrl:"/API/StockHistoryDay"},Policy:{ApiUrl:"/API/StockHistoryDay"}}},Index:{LineColor:["rgb(255,189,09)","rgb(22,198,255)","rgb(174,35,161)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],NotSupport:{Font:"14px 微软雅黑",TextColor:"rgb(52,52,52)"}},ColorArray:["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],DrawPicture:{LineColor:"rgb(30,144,255)",PointColor:"rgb(105,105,105)"},TooltipPaint:{BGColor:"rgba(20,20,20,0.8)",BorderColor:"rgb(210,210,210)",TitleColor:"rgb(210,210,210)",TitleFont:"13px 微软雅黑"},DepthChart:{BidColor:{Line:"rgb(82,176,123)",Area:"rgba(82,176,123,0.5)"},AskColor:{Line:"rgb(207,76,89)",Area:"rgba(207,76,89, 0.5)"},LineWidth:4},DepthCorss:{BidColor:{Line:"rgb(82,176,123)"},AskColor:{Line:"rgb(207,76,89)"},LineWidth:2,LineDash:[3,3],Tooltip:{BGColor:"rgba(54,54,54, 0.8)",TextColor:"rgb(203,215,224)",Border:{Top:5,Left:20,Bottom:5,Center:5},Font:"14px 微软雅黑",LineHeight:16}},Report:{BorderColor:"rgb(38,38,41)",SelectedColor:"rgb(49,48,56)",Header:{Color:"rgb(245,245,245)",SortColor:"rgb(255,0,0)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:15,Name:"微软雅黑"}},Item:{Mergin:{Top:2,Bottom:0,Left:5,Right:5},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2},NameFont:{Size:14,Name:"微软雅黑"},SymbolFont:{Size:12,Name:"微软雅黑"}},FixedItem:{Font:{Size:15,Name:"微软雅黑"}},LimitBorder:{Color:"rgb(64,64,64)",Mergin:{Top:1,Bottom:1,Left:0,Right:0}},FieldColor:{Index:"rgb(245,245,245)",Symbol:"rgb(255,255,255)",Name:"rgb(255,255,255)",Amount:"rgb(2,226,244)",Vol:"rgb(192,192,0)",BarTitle:"rgb(245,245,245)",Text:"rgb(245,245,245)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(228,228,228)",PageInfo:{Font:{Size:15,Name:"微软雅黑"},TextColor:"rgb(255,255,255)",BGColor:"rgba(49,48,56,0.8)",Mergin:{Left:5,Right:5,Top:4,Bottom:2}}}}}();case i.WHITE_ID:return function(){return{BGColor:"rgb(255,255,255)",TooltipBGColor:"rgb(255, 255, 255)",TooltipAlpha:.92,SelectRectBGColor:"rgba(1,130,212,0.06)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(0,0,0)",Minute:{VolBarColor:"rgb(238,127,9)",PriceColor:"rgb(50,171,205)",AvPriceColor:"rgb(238,127,9)"},DefaultTextColor:"rgb(43,54,69)",DefaultTextFont:"14px 微软雅黑",DynamicTitleFont:"12px 微软雅黑",UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(0,0,0)",CloseLineColor:"rgb(178,34,34)",FrameBorderPen:"rgb(225,236,242)",FrameSplitPen:"rgb(225,236,242)",FrameSplitTextColor:"rgb(51,51,51)",FrameSplitTextFont:"12px 微软雅黑",FrameTitleBGColor:"rgb(246,251,253)",CorssCursorBGColor:"rgb(43,54,69)",CorssCursorTextColor:"rgb(255,255,255)",CorssCursorTextFont:"12px 微软雅黑",CorssCursorPenColor:"rgb(130,130,130)",KLine:{MaxMin:{Font:"12px 微软雅黑",Color:"rgb(111,111,111)"},Info:{Color:"rgb(205,149,12)",TextColor:"#197de9",TextBGColor:"#e1e4ef",Investor:{ApiUrl:"/API/NewsInteract"},Announcement:{ApiUrl:"/API/ReportList"},Pforecast:{ApiUrl:"/API/StockHistoryDay"},Research:{ApiUrl:"/API/InvestorRelationsList"},BlockTrading:{ApiUrl:"/API/StockHistoryDay"},TradeDetail:{ApiUrl:"/API/StockHistoryDay"},Policy:{ApiUrl:"/API/StockHistoryDay"}}},Index:{LineColor:["rgb(255,189,09)","rgb(22,198,255)","rgb(174,35,161)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],NotSupport:{Font:"14px 微软雅黑",TextColor:"rgb(52,52,52)"}},ColorArray:["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],DrawPicture:{LineColor:"rgb(30,144,255)",PointColor:"rgb(105,105,105)"}}}();default:return null}},STYLE_TYPE_ID:i};e.JSCommonHQStyle=r},"4ec9":function(t,e,a){a("6f48")},"4fad":function(t,e,a){var i=a("d039"),r=a("861d"),n=a("c6b6"),s=a("d86b"),o=Object.isExtensible,h=i((function(){o(1)}));t.exports=h||s?function(t){return!!r(t)&&((!s||"ArrayBuffer"!=n(t))&&(!o||o(t)))}:o},"514b":function(t,e,a){"use strict";function i(){}a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSNetwork=i,i.IsDingTalk=!1,i.IsUniApp=!1,i.HttpRequest=function(t){i.IsDingTalk?i.DD_httpRequest(t):i.WX_Reqeust(t)},i.WX_Reqeust=function(t){wx.request({url:t.url,data:t.data,method:t.method,dataType:t.dataType,success:t.success,error:t.error})},i.DD_httpRequest=function(t){dd.httpRequest({url:t.url,method:t.method,data:t.data,dataType:t.dataType,success:t.success})}},"52e0":function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSKLineInfoMap=o,e.JSMinuteInfoMap=f,e.KLINE_INFO_TYPE=void 0,a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("14d9"),a("6062");var i=a("ee32"),r=a("deed"),n={INVESTOR:1,ANNOUNCEMENT:2,PFORECAST:3,ANNOUNCEMENT_QUARTER_1:4,ANNOUNCEMENT_QUARTER_2:5,ANNOUNCEMENT_QUARTER_3:6,ANNOUNCEMENT_QUARTER_4:7,RESEARCH:8,BLOCKTRADING:9,TRADEDETAIL:10,POLICY:11};function s(){this.ID,this.Date,this.Title,this.InfoType,this.ExtendData}function o(){}function h(){this.MaxRequestDataCount=1e3,this.StartDate=20160101,this.Data,this.ClassName="IKLineInfo",this.Explain="IKLineInfo",this.GetToday=function(){var t=new Date,e=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate();return e},this.GetRequestData=function(t){var e={Symbol:t.Symbol,MaxRequestDataCount:t.MaxRequestDataCount,MaxRequestMinuteDayCount:t.MaxRequestMinuteDayCount,Period:t.Period};return e},this.NetworkFilter=function(t,e){if(!t.NetworkFilter)return!1;var a=this,i={HQChart:t},r={Name:"".concat(this.ClassName,"::RequestData"),Explain:this.Explain,Request:this.GetRequestData(t),Self:this,HQChart:t,CallInfo:e,PreventDefault:!1};return e&&(1==e.Update&&(r.Update={Start:{Date:e.StartDate}},i.Update={Start:{Date:e.StartDate}}),r.CallFunctionName=e.FunctionName),t.NetworkFilter(r,(function(t){a.RecvData(t,i)})),1==r.PreventDefault}}function l(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.g_JSChartResource.Domain+i.g_JSChartResource.KLine.Info.Investor.ApiUrl,data:{filed:["question","answerdate","symbol","id"],symbol:[a.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxRequestDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.list&&!(a.list.length<=0)){for(var i in a.list){var r=a.list[i],o=new s;o.Date=r.answerdate,o.Title=r.question,o.InfoType=n.INVESTOR,this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function u(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="AnnouncementInfo",this.Explain="公告",this.RequestData=function(t,e){var a=this,r={HQChart:t};if(e&&!0===e.Update||(this.Data=[]),!this.NetworkFilter(t,e))return wx.request({url:i.g_JSChartResource.Domain+i.g_JSChartResource.KLine.Info.Announcement.ApiUrl,data:{filed:["title","releasedate","symbol","id"],symbol:[r.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxRequestDataCount},method:"post",dataType:"json",success:function(t){a.RecvData(t,r)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.report&&!(a.report.length<=0)){for(var i in a.report){var r=a.report[i],o=new s;for(var h in o.Date=r.releasedate,o.Title=r.title,o.InfoType=n.ANNOUNCEMENT,r.type){var l=r.type[h];switch(l){case"一季度报告":o.InfoType=n.ANNOUNCEMENT_QUARTER_1;break;case"半年度报告":o.InfoType=n.ANNOUNCEMENT_QUARTER_2;break;case"三季度报告":o.InfoType=n.ANNOUNCEMENT_QUARTER_3;break;case"年度报告":o.InfoType=n.ANNOUNCEMENT_QUARTER_4;break}}this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function C(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="PforecastInfo",this.Explain="业绩预告",this.RequestData=function(t){var e=this;this.Data=[];var a={HQChart:t};return wx.request({url:i.g_JSChartResource.Domain+i.g_JSChartResource.KLine.Info.Pforecast.ApiUrl,data:{field:["pforecast.type","pforecast.reportdate","fweek"],condition:[{item:["pforecast.reportdate","int32","gte",this.StartDate]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a.stock&&1==a.stock.length&&a.stock[0].stockday&&!(a.stock[0].stockday.length<=0)){for(var i in a.stock[0].stockday){var r=a.stock[0].stockday[i];if(r.pforecast.length>0){var o=r.pforecast[0],h=new s;h.Date=r.date,h.Title=o.type,h.InfoType=n.PFORECAST,h.ExtendData={Type:o.type,ReportDate:o.reportdate},r.fweek&&(h.ExtendData.FWeek={},null!=r.fweek.week1&&(h.ExtendData.FWeek.Week1=r.fweek.week1),null!=r.fweek.week4&&(h.ExtendData.FWeek.Week4=r.fweek.week4)),this.Data.push(h)}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function D(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="ResearchInfo",this.Explain="投资者关系",this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.g_JSChartResource.Domain+i.g_JSChartResource.KLine.Info.Research.ApiUrl,data:{filed:["releasedate","researchdate","level","symbol","id"],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},symbol:[a.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.list&&!(a.list.length<=0)){for(var i in a.list){var r=a.list[i],o=new s;o.ID=r.id,o.Date=r.researchdate,o.InfoType=n.RESEARCH,o.ExtendData={Level:r.level},this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function m(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="BlockTrading",this.Explain="大宗交易",this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.g_JSChartResource.Domain+i.g_JSChartResource.KLine.Info.BlockTrading.ApiUrl,data:{field:["blocktrading.price","blocktrading.vol","blocktrading.premium","fweek","price"],condition:[{item:["date","int32","gte",this.StartDate]},{item:["blocktrading.vol","int32","gte","0"]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.stock&&1==a.stock.length&&a.stock[0].stockday&&!(a.stock[0].stockday.length<=0)){for(var i in a.stock[0].stockday){var r=a.stock[0].stockday[i],o=new s;o.Date=r.date,o.InfoType=n.BLOCKTRADING,o.ExtendData={Price:r.blocktrading.price,Premium:r.blocktrading.premium,Vol:r.blocktrading.vol,ClosePrice:r.price},r.fweek&&(o.ExtendData.FWeek={},null!=r.fweek.week1&&(o.ExtendData.FWeek.Week1=r.fweek.week1),null!=r.fweek.week4&&(o.ExtendData.FWeek.Week4=r.fweek.week4)),this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function c(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="TradeDetail",this.Explain="龙虎榜",this.RequestData=function(t){var e=this,a={HQChart:t};return this.Data=[],wx.request({url:i.g_JSChartResource.Domain+i.g_JSChartResource.KLine.Info.TradeDetail.ApiUrl,data:{field:["tradedetail.typeexplain","tradedetail.type","fweek"],condition:[{item:["date","int32","gte",this.StartDate]},{item:["tradedetail.type","int32","gte","0"]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a&&a.stock&&1==a.stock.length&&a.stock[0].stockday&&!(a.stock[0].stockday.length<=0)){for(var i in a.stock[0].stockday){var r=a.stock[0].stockday[i],o=new s;for(var h in o.Date=r.date,o.InfoType=n.TRADEDETAIL,o.ExtendData={Detail:new Array},r.tradedetail){var l=r.tradedetail[h];o.ExtendData.Detail.push({Type:l.type,TypeExplain:l.typeexplain})}r.fweek&&(o.ExtendData.FWeek={},null!=r.fweek.week1&&(o.ExtendData.FWeek.Week1=r.fweek.week1),null!=r.fweek.week4&&(o.ExtendData.FWeek.Week4=r.fweek.week4)),this.Data.push(o)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function S(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="PolicyInfo",this.Explain="策略信息",this.PolicyList=[],this.SetPolicyList=function(t){for(var e in t)this.PolicyList.push({Name:t[e]})},this.RequestData=function(t){var e=this;this.Data=[];var a={HQChart:t};return wx.request({url:i.g_JSChartResource.Domain+i.g_JSChartResource.KLine.Info.Policy.ApiUrl,data:{symbol:[a.HQChart.Symbol],field:["policy"],condition:[{item:["date","int32","gte",this.StartDate,"lte",this.GetToday()]}],start:0,end:this.MaxRequestDataCount},method:"post",dataType:"json",success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){var a=t.data;if(a.stock&&1==a.stock.length&&a.stock[0].stockday&&!(a.stock[0].stockday.length<=0)){var i=new Set;for(var r in this.PolicyList)i.add(this.PolicyList[r].Name);for(var r in a.stock[0].stockday){var o=a.stock[0].stockday[r],h=new s;for(var l in h.Date=o.date,h.InfoType=n.POLICY,h.ExtendData=[],o.policy){var u=o.policy[l].name;i.has(u)&&h.ExtendData.push({Name:u})}h.ExtendData.length>0&&this.Data.push(h)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw(),e.HQChart.UpdateUICallback&&e.HQChart.UpdateUICallback("RecvPolicyInfoData",this)}}}function f(){}function I(){this.Data,this.ClassName="IMinuteInfo"}function d(){this.newMethod=I,this.newMethod(),delete this.newMethod,this.ClassName="MarketEventInfo",this.RequestData=function(t){var e=this;this.Data=[];var a={HQChart:t},r=i.g_JSChartResource.CacheDomain+"/cache/analyze/shszevent/marketevent/concept/"+t.TradeDate+".json";if(t.NetworkFilter){var n={Name:"MarketEventInfo::RequestData",Explain:"大盘异动",Request:{Url:r,Type:"Get",Data:{Date:t.TradeDate,Symbol:t.Symbol}},Self:this,PreventDefault:!1};if(t.NetworkFilter(n,(function(t){e.RecvData(t,a),a.HQChart.UpdataChartInfo(),a.HQChart.Draw()})),1==n.PreventDefault)return}return wx.request({url:r,method:"get",dataType:"json",success:function(t){e.RecvData(t,a)},error:function(t,e){console.warn("[MarketEventInfo::RequestData] error, http ",e,t)}}),!0},this.RecvData=function(t,e){var a=t.data;for(var i in a.event){var n=a.event[i];for(var s in n.data){var o=n.data[s];if(Array.isArray(o)){if(o.length<2)continue;var h={Date:n.date,Time:o[0],Title:o[1],Type:0};this.Data.push(h)}else{if(!r.IFrameSplitOperator.IsNumber(o.Date)||!r.IFrameSplitOperator.IsNumber(o.Time)||!o.Title)continue;h={Date:o.Date,Time:o.Time,Title:o.Title,Type:0};o.Color&&(h.Color=o.Color),o.BGColor&&(h.BGColor=o.BGColor),r.IFrameSplitOperator.IsNumber(o.Price)&&(h.Price=o.Price),o.Content&&(h.Content=o.Content),o.Link&&(h.Link=o.Link),this.Data.push(h)}}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}e.KLINE_INFO_TYPE=n,o.Get=function(t){var e=new Map([["互动易",{Create:function(){return new l}}],["公告",{Create:function(){return new u}}],["业绩预告",{Create:function(){return new C}}],["调研",{Create:function(){return new D}}],["大宗交易",{Create:function(){return new m}}],["龙虎榜",{Create:function(){return new c}}],["策略选股",{Create:function(){return new S}}]]);return e.get(t)},f.InfoMap=new Map([["大盘异动",{Create:function(){return new d}}]]),f.Get=function(t){return f.InfoMap.get(t)}},6062:function(t,e,a){a("1c59")},"630d":function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSCanvasElement=function(){this.Height,this.Width,this.ID,this.WebGLCanvas,this.IsUniApp=!1,this.IsDingTalk=!1,this.IsDouYin=!1,this.CanvasNode=null,this.ComponentObject=null,this.PixelRatio=null,this.GetContext=function(){var t;if(this.IsDingTalk)return t=dd.createCanvasContext(this.ID),null==this.PixelRatio&&(this.PixelRatio=dd.getSystemInfoSync().pixelRatio),t.restore(),t.save(),t.scale(this.PixelRatio,this.PixelRatio),i.JSConsole.Chart.Log("[JSCanvasElement::GetContext] measureText() => JSUniAppCanvasHelper.MeasureText()"),r.JSCommonUniApp.JSUniAppCanvasHelper.GetCanvasFont=function(t){return t.state.font},t.measureText=function(e){var a=r.JSCommonUniApp.JSUniAppCanvasHelper.MeasureText(e,t);return{width:a}},t;if(this.CanvasNode&&this.CanvasNode.node){var e=this.CanvasNode.width,a=this.CanvasNode.height,n=this.CanvasNode.node;n._height=a,n._width=e,i.JSConsole.Chart.Log("[JSCanvasElement::GetContext] create by getContext('2d')"),t=n.getContext("2d");var s=wx.getSystemInfoSync().pixelRatio;n.width=e*s,n.height=a*s,t.restore(),t.save(),t.scale(s,s),t.draw=function(t,e){e&&e()},t.DomNode=n}else t=this.ComponentObject?wx.createCanvasContext(this.ID,this.ComponentObject):wx.createCanvasContext(this.ID);return this.IsUniApp&&(i.JSConsole.Chart.Log("[JSCanvasElement::GetContext] measureText() => JSUniAppCanvasHelper.MeasureText()"),t.measureText=function(e){var a=r.JSCommonUniApp.JSUniAppCanvasHelper.MeasureText(e,t);return{width:a}},t.fillText_backup=t.fillText,t.fillText=function(e,a,i,r){t.fillText_backup(e,a,i)}),t},this.GetWebGLCanvas=function(t){var e=this,a=wx.createSelectorQuery();a.select(t).node().exec((function(t){i.JSConsole.Chart.Log("[JSCanvasElement::GetWebGLCanvas] res ",t),e.WebGLCanvas=t[0].node}))}},a("ac1f");var i=a("c534"),r=a("1e2c")},6566:function(t,e,a){"use strict";var i=a("9bf2").f,r=a("7c73"),n=a("6964"),s=a("0366"),o=a("19aa"),h=a("7234"),l=a("2266"),u=a("c6d2"),C=a("4754"),D=a("2626"),m=a("83ab"),c=a("f183").fastKey,S=a("69f3"),f=S.set,I=S.getterFor;t.exports={getConstructor:function(t,e,a,u){var C=t((function(t,i){o(t,D),f(t,{type:e,index:r(null),first:void 0,last:void 0,size:0}),m||(t.size=0),h(i)||l(i,t[u],{that:t,AS_ENTRIES:a})})),D=C.prototype,S=I(e),d=function(t,e,a){var i,r,n=S(t),s=T(t,e);return s?s.value=a:(n.last=s={index:r=c(e,!0),key:e,value:a,previous:i=n.last,next:void 0,removed:!1},n.first||(n.first=s),i&&(i.next=s),m?n.size++:t.size++,"F"!==r&&(n.index[r]=s)),t},T=function(t,e){var a,i=S(t),r=c(e);if("F"!==r)return i.index[r];for(a=i.first;a;a=a.next)if(a.key==e)return a};return n(D,{clear:function(){var t=S(this),e=t.index,a=t.first;while(a)a.removed=!0,a.previous&&(a.previous=a.previous.next=void 0),delete e[a.index],a=a.next;t.first=t.last=void 0,m?t.size=0:this.size=0},delete:function(t){var e=S(this),a=T(this,t);if(a){var i=a.next,r=a.previous;delete e.index[a.index],a.removed=!0,r&&(r.next=i),i&&(i.previous=r),e.first==a&&(e.first=i),e.last==a&&(e.last=r),m?e.size--:this.size--}return!!a},forEach:function(t){var e,a=S(this),i=s(t,arguments.length>1?arguments[1]:void 0);while(e=e?e.next:a.first){i(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!T(this,t)}}),n(D,a?{get:function(t){var e=T(this,t);return e&&e.value},set:function(t,e){return d(this,0===t?0:t,e)}}:{add:function(t){return d(this,t=0===t?0:t,t)}}),m&&i(D,"size",{get:function(){return S(this).size}}),C},setStrong:function(t,e,a){var i=e+" Iterator",r=I(e),n=I(i);u(t,e,(function(t,e){f(this,{type:i,target:t,state:r(t),kind:e,last:void 0})}),(function(){var t=n(this),e=t.kind,a=t.last;while(a&&a.removed)a=a.previous;return t.target&&(t.last=a=a?a.next:t.state.first)?C("keys"==e?a.key:"values"==e?a.value:[a.key,a.value],!1):(t.target=void 0,C(void 0,!0))}),a?"entries":"values",!a,!0),D(e)}}},"698c":function(t,e,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorHandler=p,e.JSCommonComplier=void 0,e.JSComplier=y,e.JSParser=E,e.g_JSComplierResource=e.Syntax=e.JS_EXECUTE_JOB_ID=void 0;var r=i(a("ade3")),n=i(a("53ca")),s=i(a("b85c"));a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("c975"),a("ac1f"),a("00b4"),a("14d9"),a("d9e2"),a("d401"),a("1d1c"),a("fb6a"),a("acd8"),a("6062"),a("5319"),a("3c65"),a("e25e"),a("25f0"),a("4e82"),a("99af"),a("466d"),a("6b93");var o,h=a("c534"),l=a("8709"),u=a("514b"),C=a("ee32"),D=a("deed"),m=a("9594"),c=a("966c"),S={Domain:"https://opensource.zealink.com",CacheDomain:"https://opensourcecache.zealink.com",CustomFunction:{Data:new Map},CustomVariant:{Data:new Map},IsCustomFunction:function(t){return!!S.CustomFunction.Data.has(t)},IsCustomVariant:function(t){return!!S.CustomVariant.Data.has(t)},GetDrawTextIcon:function(t){var e=new Map([[1,{Symbol:"↑",Color:"rgb(238,44,44)"}],[2,{Symbol:"↓",Color:"rgb(0,139,69)"}],[3,{Symbol:"😧"}],[4,{Symbol:"😨"}],[5,{Symbol:"😁"}],[6,{Symbol:"😱"}],[7,{Symbol:"B",Color:"rgb(238,44,44)"}],[8,{Symbol:"S",Color:"rgb(0,139,69)"}],[9,{Symbol:"💰"}],[10,{Symbol:"📪"}],[11,{Symbol:"👆"}],[12,{Symbol:"👇"}],[13,{Symbol:"B",Color:"rgb(178,34,34)"}],[14,{Symbol:"S",Color:"rgb(0,139,69)"}],[36,{Symbol:"Χ",Color:"rgb(238,44,44)"}],[37,{Symbol:"X",Color:"rgb(0,139,69)"}],[38,{Symbol:"▲",Color:"rgb(238,44,44)"}],[39,{Symbol:"▼",Color:"rgb(0,139,69)"}],[40,{Symbol:"◉",Color:"rgb(238,44,44)"}],[41,{Symbol:"◈",Color:"rgb(238,44,44)"}],[42,{Symbol:"📌"}],[43,{Symbol:"💎"}],[44,{Symbol:"🥇"}],[45,{Symbol:"🥈"}],[46,{Symbol:"🥉"}],[47,{Symbol:"🏅"}]]),a=e.get(t);return a}};e.g_JSComplierResource=S;var f={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"},I={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},d={FromCodePoint:function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10))+String.fromCharCode(56320+(t-65536&1023))},IsWhiteSpace:function(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0},IsLineTerminator:function(t){return 10===t||13===t||8232===t||8233===t},IsIdentifierStart:function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||12304===t||12305===t||9650===t||9660===t||t>=128&&I.NonAsciiIdentifierStart.test(d.FromCodePoint(t))},IsIdentifierPart:function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||35===t||12304===t||12305===t||9650===t||9660===t||t>=128&&I.NonAsciiIdentifierPart.test(d.FromCodePoint(t))},IsDecimalDigit:function(t){return t>=48&&t<=57},IsHexDigit:function(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102},isOctalDigit:function(t){return t>=48&&t<=55}},T={};function p(){this.Error=[],this.RecordError=function(t){this.Error.push(t)},this.ConstructError=function(t,e){var a=new Error(t);try{throw a}catch(i){Object.create&&Object.defineProperties&&(a=Object.create(i),a.Column=e)}return a},this.CreateError=function(t,e,a,i){var r="Line "+e+": "+i,n=this.ConstructError(r,a);return n.Index=t,n.LineNumber=e,n.Description=i,n},this.ThrowError=function(t,e,a,i){var r=this.CreateError(t,e,a,i);throw r}}function v(t,e){this.Source=t,this.ErrorHandler=e,this.Length=t.length,this.Index=0,this.LineNumber=t.length>0?1:0,this.LineStart=0,this.CurlyStack=[],this.SaveState=function(){return{Index:this.Index,LineNumber:this.LineNumber,LineStart:this.LineStart}},this.RestoreState=function(t){this.Index=t.Index,this.LineNumber=t.LineNumber,this.LineStart=t.LineStart},this.IsEOF=function(){return this.Index>=this.Length},this.IsKeyword=function(t){return!1},this.CodePointAt=function(t){var e=this.Source.charCodeAt(t);if(e>=55296&&e<=56319){var a=this.Source.charCodeAt(t+1);if(a>=56320&&a<=57343){var i=e;e=1024*(i-55296)+a-56320+65536}}return e},this.Lex=function(){if(this.IsEOF())return{Type:2,Value:"",LineNumber:this.LineNumber,LineStart:this.LineStart,Start:this.Index,End:this.Index};var t=this.Source.charCodeAt(this.Index);return d.IsIdentifierStart(t)?this.ScanIdentifier():40===t||41===t||59===t?this.ScanPunctuator():39===t||34===t?this.ScanStringLiteral():46==t?d.IsDecimalDigit(this.Source.charCodeAt(this.Index+1))?this.ScanNumericLiteral():this.ScanPunctuator():d.IsDecimalDigit(t)?this.ScanNumericLiteral():t>=55296&&t<57343&&d.IsIdentifierStart(this.CodePointAt(this.Index))?this.ScanIdentifier():this.ScanPunctuator()},this.ScanIdentifier=function(){var t,e=this.Index,a=92===this.Source.charCodeAt(e)?this.GetComplexIdentifier():this.GetIdentifier();if(t=a.length?3:this.IsKeyword(a)?4:null==a?5:"true"==a||"false"==a?1:3,3!=t&&e+a.length!=this.Index){this.Index;throw this.Index=e,f.InvalidEscapedReservedWord}return"AND"!=a&&"OR"!=a||(t=7),{Type:t,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:e,End:this.Index}},this.GetIdentifier=function(){var t=this.Index++;while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(92==e)return this.Index=t,this.GetComplexIdentifier();if(e>=55296&&e<57343)return this.Index=t,this.GetComplexIdentifier();if(!d.IsIdentifierPart(e))break;++this.Index}return this.Source.slice(t,this.Index)},this.ScanPunctuator=function(){var t=this.Index,e=this.Source[this.Index];switch(e){case"(":++this.Index;break;case")":case";":case",":++this.Index;break;case".":++this.Index;break;default:e=this.Source.substr(this.Index,3),"AND"==e?this.Index+=3:(e=this.Source.substr(this.Index,2),"&&"===e||"||"===e||"=="===e||"!="===e||"<>"===e||"<="===e||">="===e||"=>"===e||":="==e||"OR"==e?this.Index+=2:(e=this.Source[this.Index],"<>=!+-*%&|^/:".indexOf(e)>=0&&++this.Index))}return this.Index==t&&this.ThrowUnecpectedToken(),{Type:7,Value:e,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanStringLiteral=function(){var t=this.Index,e=this.Source[this.Index];++this.Index;var a="";while(!this.IsEOF()){var i=this.Source[this.Index++];if(i==e){e="";break}if("\\"==i)throw"not complete";if(d.IsLineTerminator(i.charCodeAt(0)))break;a+=i}return""!=e&&(this.Index=t,this.ThrowUnecpectedToken()),{Type:8,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanNumericLiteral=function(){var t=this.Index,e=this.Source[this.Index],a="";if("."!=e){if(a=this.Source[this.Index++],e=this.Source[this.Index],"0"==a&&("x"==e||"X"==e))return++this.Index,this.ScanHexLiteral(t);while(d.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];e=this.Source[this.Index]}if("."==e){a+=this.Source[this.Index++];while(d.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];e=this.Source[this.Index]}if("e"==e||"E"==e)if(a+=this.Source[this.Index++],e=this.Source[this.Index],"+"!=e&&"-"!=e||(a+=this.Source[this.Index]),d.IsDecimalDigit(this.Source.charCodeAt(this.Index)))while(d.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];else this.ThrowUnecpectedToken();return d.IsIdentifierStart(this.Source.charCodeAt(this.Index))&&this.ThrowUnecpectedToken(),{Type:6,Value:parseFloat(a),LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanComments=function(){this.Index;while(!this.IsEOF()){var t=this.Source.charCodeAt(this.Index);if(d.IsWhiteSpace(t))++this.Index;else if(d.IsLineTerminator(t))++this.Index,13==t&&10==this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,!0;else if(47==t){if(t=this.Source.charCodeAt(this.Index+1),47!=t)break;this.Index+=2;this.SkipSingleLineComment(2);!0}else{if(123!=t)break;this.Index+=1;this.SkipMultiLineComment()}}},this.SkipMultiLineComment=function(){var t=[];while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(d.IsLineTerminator(e))++this.LineNumber,++this.Index,this.LineStart=this.Index;else{if(125==e)return this.Index+=1,t;++this.Index}}return t},this.SkipSingleLineComment=function(t){var e=[];while(!this.IsEOF()){var a=this.Source.charCodeAt(this.Index);if(++this.Index,d.IsLineTerminator(a))return 13===a&&10===this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,e}return e},this.ThrowUnecpectedToken=function(t){return t||(t=f.UnexpectedTokenIllegal),this.ErrorHandler.ThrowError(this.Index,this.LineNumber,this.Index-this.LineStart+1,t)}}function F(t){this.ErrorHandler=new p,this.Scanner=new v(t,this.ErrorHandler),this.Buffer=[],this.GetNextToken=function(){if(0==this.Buffer.length){this.Scanner.ScanComments();if(!this.Scanner.IsEOF()){var t=this.Scanner.Lex(),e={Type:T[t.Type],Value:this.Scanner.Source.slice(t.Start,t.End)};this.Buffer.push(e)}}return this.Buffer.shift()}}T[1]="Boolean",T[2]="<end>",T[3]="Identifier",T[4]="Keyword",T[5]="Null",T[6]="Numeric",T[7]="Punctuator",T[8]="String",T[9]="RegularExpression",T[10]="Template";var g={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"};function A(){this.IsNeedIndexData=!1,this.IsNeedLatestData=!1,this.IsNeedSymbolData=!1,this.IsNeedMarginData=new Set,this.IsNeedNewsAnalysisData=new Set,this.IsNeedBlockIncreaseData=new Set,this.IsNeedSymbolExData=new Set,this.FunctionData=[],this.Dynainfo=[],this.IsAPIData=[],this.ExecuteIndex=[],this.OtherSymbolData=[],this.PeriodSymbolData=[],this.ErrorHandler=p,this.GetDataJobList=function(){var t=[];this.IsNeedSymbolData&&t.push({ID:O.JOB_DOWNLOAD_SYMBOL_DATA}),this.IsNeedIndexData&&t.push({ID:O.JOB_DOWNLOAD_INDEX_DATA});for(var e=0;e<this.Dynainfo.length;++e){var a=this.Dynainfo[e];t.push(a)}var i,r=(0,s.default)(this.IsNeedBlockIncreaseData);try{for(r.s();!(i=r.n()).done;){var n=i.value;t.push({ID:O.JOB_DOWNLOAD_INDEX_INCREASE_DATA,Symbol:n})}}catch(c){r.e(c)}finally{r.f()}var o,h=(0,s.default)(this.IsNeedMarginData);try{for(h.s();!(o=h.n()).done;){var l=o.value;t.push({ID:l})}}catch(c){h.e(c)}finally{h.f()}var u,C=(0,s.default)(this.IsNeedNewsAnalysisData);try{for(C.s();!(u=C.n()).done;){l=u.value;t.push({ID:l})}}catch(c){C.e(c)}finally{C.f()}for(var e in this.IsAPIData){a=this.IsAPIData[e];t.push(a)}for(var e in this.ExecuteIndex){a=this.ExecuteIndex[e];t.push(a)}var D,m=(0,s.default)(this.IsNeedSymbolExData);try{for(m.s();!(D=m.n()).done;){l=D.value;t.push({ID:l})}}catch(c){m.e(c)}finally{m.f()}for(var e in this.FunctionData){a=this.FunctionData[e];t.push(a)}for(var e in this.OtherSymbolData){a=this.OtherSymbolData[e];t.push(a)}return t},this.VerifySymbolVariable=function(t,e){var a=new Set(["INDEXA","INDEXC","INDEXH","INDEXL","INDEXO","INDEXV","INDEXDEC","INDEXADV"]);if(a.has(t))this.IsNeedIndexData=!0;else{var i=new Set(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT"]);if(i.has(t))this.IsNeedSymbolData=!0;else if("VOLR"!==t){var r=new Set(["CAPITAL","TOTALCAPITAL","EXCHANGE","HYBLOCK","DYBLOCK","GNBLOCK","FGBLOCK","ZSBLOCK","ZHBLOCK","ZDBLOCK","HYZSCODE","GNBLOCKNUM","FGBLOCKNUM","ZSBLOCKNUM","ZHBLOCKNUM","ZDBLOCKNUM","HYSYL","HYSJL"]);if(r.has(t)){var n={ID:O.JOB_DOWNLOAD_VARIANT,VariantName:t};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.FunctionData.push(n)}if(S.IsCustomVariant(t)){n={VariantName:t,ID:O.JOB_CUSTOM_VARIANT_DATA};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.FunctionData.push(n)}}else this.IsNeedSymbolExData.has(O.JOB_DOWNLOAD_VOLR_DATA)||this.IsNeedSymbolExData.add(O.JOB_DOWNLOAD_VOLR_DATA)}},this.VerifySymbolFunction=function(t,e,a){if(S.IsCustomFunction(t.Name)){var i={FunctionName:t.Name,ID:O.JOB_CUSTOM_FUNCTION_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("DYNAINFO"!=t.Name){if("FINANCE"==t.Name){i={ID:O.JOB_DOWNLOAD_FINANCE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("FINVALUE"==t.Name){i={ID:O.JOB_DOWNLOAD_FINVALUE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("FINONE"==t.Name){i={ID:O.JOB_DOWNLOAD_FINONE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("GPJYVALUE"==t.Name){i={ID:O.JOB_DOWNLOAD_GPJYVALUE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("MARGIN"!==t.Name)if("NEWS"!==t.Name){if("COST"==t.Name||"WINNER"==t.Name||"PWINNER"==t.Name){i={ID:O.JOB_DOWNLOAD_FINANCE,Args:[7],FunctionName:"FINANCE",FunctionName2:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("INBLOCK"==t.Name){i={ID:O.JOB_DOWNLOAD_VARIANT,VariantName:"INBLOCK"};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("BETA"!==t.Name)if("UPCOUNT"!=t.Name&&"DOWNCOUNT"!=t.Name){if("STKINDI"==t.Name||"CALCSTOCKINDEX"==t.Name){i={ID:O.JOB_EXECUTE_INDEX,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.ExecuteIndex.push(i)}if("LOADAPIDATA"==t.Name){i={Name:t.Name,ID:O.JOB_DOWNLOAD_CUSTOM_API_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.IsAPIData.push(i)}var r=new Set(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT","AMO","VOLINSTK"]);if(r.has(t.Name)){i={Name:t.Name,ID:O.JOB_DOWNLOAD_OTHER_SYMBOL_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.OtherSymbolData.push(i)}}else{var n=e[0].Value;this.IsNeedBlockIncreaseData.has(n)||this.IsNeedBlockIncreaseData.add(n)}else this.IsNeedIndexData=!0}else{var s=O.GetNewsAnalysisID(e[0].Value);s&&!this.IsNeedNewsAnalysisData.has(s)&&this.IsNeedNewsAnalysisData.add(s)}else{var o=O.GetMarginJobID(e[0].Value);o&&!this.IsNeedMarginData.has(o)&&this.IsNeedMarginData.add(o)}}else{var i={ID:O.JOB_DOWNLOAD_SYMBOL_LATEST_DATA,Args:e,FunctionName:t.Name};this.Dynainfo.push(i)}},this.VerifySymbolLiteral=function(t,e){if(D.IFrameSplitOperator.IsString(t)&&t.indexOf("$")>0){var a=t.split("$");if(2!=a.length)return;var i={Literal:t,ID:O.JOB_DOWNLOAD_OTHER_SYMBOL_DATA};e&&(i.Token={Index:e.Start,Line:e.LineNumber}),this.OtherSymbolData.push(i)}},this.ExpressionStatement=function(t){return{Type:g.ExpressionStatement,Expression:t}},this.Script=function(t){return{Type:g.Program,Body:t,SourceType:"通达信脚本"}},this.SequenceExpression=function(t){return{Type:g.SequenceExpression,Expression:t}},this.BinaryExpression=function(t,e,a){var i="||"===t||"&&"===t||"AND"==t||"OR"==t,r=i?g.LogicalExpression:g.BinaryExpression;return{Type:r,Operator:t,Left:e,Right:a}},this.Literal=function(t,e,a){return this.VerifySymbolLiteral(t,a),{Type:g.Literal,Value:t,Raw:e}},this.Identifier=function(t,e){return this.VerifySymbolVariable(t,e),{Type:g.Identifier,Name:t}},this.AssignmentExpression=function(t,e,a){return{Type:g.AssignmentExpression,Operator:t,Left:e,Right:a}},this.MemberIdentifier=function(t,e){return{Type:g.Identifier,Name:t}},this.UnaryExpression=function(t,e){return{Type:g.UnaryExpression,Operator:t,Argument:e,Prefix:!0}},this.EmptyStatement=function(){return{Type:g.EmptyStatement}},this.CallExpression=function(t,e,a){return this.VerifySymbolFunction(t,e,a),{Type:g.CallExpression,Callee:t,Arguments:e}},this.StaticMemberExpression=function(t,e,a){return this.VerifyMemberVariable(t,e,a),{Type:g.MemberExpression,Computed:!1,Object:t,Property:e}},this.VerifyMemberVariable=function(t,e,a){var i={ID:O.JOB_EXECUTE_INDEX,Member:{Object:t,Property:e}};a&&(i.Token={Index:a.Start,Line:a.LineNumber}),this.ExecuteIndex.push(i)}}function E(t){this.ErrorHandler=new p,this.Scanner=new v(t,this.ErrorHandler),this.Node=new A,this.LookAhead={Type:2,Value:"",LineNumber:this.Scanner.LineNumber,LineStart:0,Start:0,End:0},this.HasLineTerminator=!1,this.Context={IsModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,FirstCoverInitializedNameError:null,IsAssignmentTarget:!1,IsBindingElement:!1,InFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},Strict:!1},this.PeratorPrecedence={")":0,";":0,",":0,"]":0,"||":1,OR:1,"&&":2,AND:2,"|":3,"^":4,"&":5,"=":6,"==":6,"!=":6,"<>":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.StartMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.LastMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.Initialize=function(){this.NextToken(),this.LastMarker={Index:this.Scanner.Index,Line:this.Scanner.LineNumber,Column:this.Scanner.Index-this.Scanner.LineStart}},this.CreateNode=function(){return{Index:this.StartMarker.Index,Line:this.StartMarker.Line,Column:this.StartMarker.Column}},this.StartNode=function(t,e){void 0==e&&(e=0);var a=t.Start-t.LineStart,i=t.LineNumber;return a<0&&(a+=e,i--),{Index:t.Start,Line:i,Column:a}},this.Match=function(t){return 7==this.LookAhead.Type&&this.LookAhead.Value==t},this.Expect=function(t){var e=this.NextToken();7==e.Type&&e.Value==t||this.ThrowUnexpectedToken(e)},this.MatchAssign=function(){if(7!=this.LookAhead.Type)return!1;var t=this.LookAhead.Value;return":"==t||":="==t},this.GetTokenRaw=function(t){return this.Scanner.Source.slice(t.Start,t.End)},this.NextToken=function(){var t=this.LookAhead;this.LastMarker.Index=this.Scanner.Index,this.LastMarker.Line=this.Scanner.LineNumber,this.LastMarker.Column=this.Scanner.Index-this.Scanner.LineStart,this.CollectComments(),this.Scanner.Index!==this.StartMarker.Index&&(this.StartMarker.Index=this.Scanner.Index,this.StartMarker.Line=this.Scanner.LineNumber,this.StartMarker.Column=this.Scanner.Index-this.Scanner.LineStart);var e=this.Scanner.Lex();return this.HasLineTerminator=t.LineNumber!=e.LineNumber,e&&this.Context.Strict&&e.Type,this.LookAhead=e,t},this.CollectComments=function(){this.Scanner.ScanComments()},this.ParseScript=function(){var t=this.CreateNode(),e=this.ParseDirectivePrologues();while(2!=this.LookAhead.Type)e.push(this.ParseStatementListItem());return this.Finalize(t,this.Node.Script(e))},this.ParseDirective=function(){this.LookAhead,this.CreateNode(),this.ParseExpression()},this.ParseDirectivePrologues=function(){var t=[];while(1){var e=this.LookAhead;if(8!=e.Type)break;var a=this.ParseDirective();t.push(a)}return t},this.ParseStatementListItem=function(){var t;return this.Context.IsAssignmentTarget=!0,this.Context.IsBindingElement=!0,4==this.LookAhead.Type||(t=this.ParseStatement()),t},this.ParseStatement=function(){var t;switch(this.LookAhead.Type){case 1:case 5:case 6:case 8:case 10:case 9:t=this.ParseExpressionStatement();break;case 7:var e=this.LookAhead.Value;t="("===e?this.ParseExpressionStatement():";"===e?this.ParseEmptyStatement():this.ParseExpressionStatement();break;case 3:t=this.ParseLabelledStatement();break;case 4:break;default:t="error"}return t},this.ParseEmptyStatement=function(){var t=this.CreateNode();return this.Expect(";"),this.Finalize(t,this.Node.EmptyStatement())},this.ParseLabelledStatement=function(){var t=this.CreateNode(),e=this.ParseExpression();this.ConsumeSemicolon();var a=new this.Node.ExpressionStatement(e);return this.Finalize(t,a)},this.ParseExpression=function(){var t=this.LookAhead,e=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(this.Match(",")){var a=[];a.push(e);while(2!=this.LookAhead.Type){if(!this.Match(","))break;this.NextToken(),a.push(this.IsolateCoverGrammar(this.ParseAssignmentExpression))}e=this.Finalize(this.StartNode(t),this.Node.SequenceExpression(a))}return e},this.ParseAssignmentExpression=function(){var t,e=this.LookAhead,a=e;if(t=this.ParseConditionalExpression(),this.MatchAssign()){if(!this.Context.IsAssignmentTarget){var i=t.Marker;this.ThrowUnexpectedError(i.Index,i.Line,i.Column,f.InvalidLHSInAssignment)}this.Match("=")||this.Match(":")?this.ReinterpretExpressionAsPattern(t):(this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1),a=this.NextToken();var r=a.Value,n=this.IsolateCoverGrammar(this.ParseAssignmentExpression);t=this.Finalize(this.StartNode(e),this.Node.AssignmentExpression(r,t,n)),this.Context.FirstCoverInitializedNameError=null}return t},this.ParseConditionalExpression=function(){this.LookAhead;var t=this.InheritCoverGrammar(this.ParseBinaryExpression);return t},this.ParseBinaryExpression=function(){var t=this.LookAhead,e=this.InheritCoverGrammar(this.ParseExponentiationExpression),a=this.LookAhead,i=this.BinaryPrecedence(a);if(i>0){this.NextToken(),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1;var r=[t,this.LookAhead],n=e,s=this.IsolateCoverGrammar(this.ParseExponentiationExpression),o=[n,a.Value,s],h=[i];while(1){if(i=this.BinaryPrecedence(this.LookAhead),i<=0)break;while(o.length>2&&i<=h[h.length-1]){s=o.pop();var l=o.pop();h.pop(),n=o.pop(),r.pop();var u=this.StartNode(r[r.length-1]);o.push(this.Finalize(u,this.Node.BinaryExpression(l,n,s)))}o.push(this.NextToken().Value),h.push(i),r.push(this.LookAhead),o.push(this.IsolateCoverGrammar(this.ParseExponentiationExpression))}var C=o.length-1;e=o[C];var D=r.pop();while(C>1){var m=r.pop(),c=D&&D.LineStart,S=this.StartNode(m,c),f=o[C-1];e=this.Finalize(S,this.Node.BinaryExpression(f,o[C-2],e)),C-=2,D=m}}return e},this.ParseExponentiationExpression=function(){this.LookAhead;var t=this.InheritCoverGrammar(this.ParseUnaryExpression);return t},this.ParseUnaryExpression=function(){var t;if(this.Match("+")||this.Match("-")){var e=this.StartNode(this.LookAhead),a=this.NextToken();t=this.InheritCoverGrammar(this.ParseUnaryExpression),t=this.Finalize(e,this.Node.UnaryExpression(a.Value,t)),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1}else t=this.ParseUpdateExpression();return t},this.ParseUpdateExpression=function(){var t;this.LookAhead;return t=this.InheritCoverGrammar(this.ParseLeftHandSideExpressionAllowCall),t},this.ParseLeftHandSideExpressionAllowCall=function(){var t,e=this.LookAhead;t=this.InheritCoverGrammar(this.ParsePrimaryExpression);while(1)if(this.Match(".")){this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!0,this.Expect(".");var a=this.ParseMemberIdentifierName();t=this.Finalize(this.StartNode(e),this.Node.StaticMemberExpression(t,a,e))}else{if(!this.Match("("))break;this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!1;var i=this.ParseArguments();t=this.Finalize(this.StartNode(e),this.Node.CallExpression(t,i,e))}return t},this.IsIdentifierName=function(t){return 3===t.Type||4===t.Type||1===t.Type||5===t.Type},this.ParseIdentifierName=function(){var t=this.CreateNode(),e=this.NextToken();return this.IsIdentifierName(e)||this.ThrowUnexpectedToken(e),this.Finalize(t,this.Node.Identifier(e.Value,e))},this.ParseMemberIdentifierName=function(){var t=this.CreateNode(),e=this.NextToken();return this.IsIdentifierName(e)||this.ThrowUnexpectedToken(e),this.Finalize(t,this.Node.MemberIdentifier(e.Value,e))},this.ParseArguments=function(){this.Expect("(");var t=[];if(!this.Match(")"))while(1){var e=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(t.push(e),this.Match(")"))break;if(this.ExpectCommaSeparator(),this.Match(")"))break}return this.Expect(")"),t},this.ExpectCommaSeparator=function(){this.Expect(",")},this.ParsePrimaryExpression=function(){var t,e,a,i=this.CreateNode();switch(this.LookAhead.Type){case 3:e=this.NextToken(),t=this.Finalize(i,this.Node.Identifier(e.Value,e));break;case 6:case 8:this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1,e=this.NextToken(),a=this.GetTokenRaw(e),t=this.Finalize(i,this.Node.Literal(e.Value,a,e));break;case 7:switch(this.LookAhead.Value){case"(":this.Context.IsBindingElement=!1,t=this.InheritCoverGrammar(this.ParseGroupExpression);break;default:t=this.ThrowUnexpectedToken(this.NextToken())}break;default:t=this.ThrowUnexpectedToken(this.NextToken())}return t},this.ParseGroupExpression=function(){var t;if(this.Expect("("),this.Match(")"))this.NextToken();else{this.LookAhead;if(this.Context.IsBindingElement=!0,t=this.InheritCoverGrammar(this.ParseAssignmentExpression),this.Match(",")){this.Context.IsAssignmentTarget=!1,[].push(t);while(2!=this.LookAhead.Type){if(!this.Match(","))break;this.NextToken(),this.Match(")")}}this.Expect(")"),this.Context.IsBindingElement=!1}return t},this.ParseExpressionStatement=function(){var t=this.CreateNode(),e=this.ParseExpression();return this.ConsumeSemicolon(),this.Finalize(t,this.Node.ExpressionStatement(e))},this.ConsumeSemicolon=function(){this.Match(";")?this.NextToken():this.HasLineTerminator||(this.LastMarker.Index=this.StartMarker.Index,this.LastMarker.Line=this.StartMarker.Line,this.LastMarker.Column=this.StartMarker.Column)},this.ReinterpretExpressionAsPattern=function(t){switch(t.Type){case g.Identifier:case g.MemberExpression:case g.AssignmentExpression:break;default:break}},this.Finalize=function(t,e){return e.Marker={Line:t.Line,Column:t.Column,Index:t.Index},e},this.BinaryPrecedence=function(t){var e,a=t.Value;return e=7===t.Type&&this.PeratorPrecedence[a]||0,e},this.IsolateCoverGrammar=function(t){var e=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,i=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;var r=t.call(this);return this.Context.FirstCoverInitializedNameError,this.Context.IsBindingElement=e,this.Context.IsAssignmentTarget=a,this.Context.FirstCoverInitializedNameError=i,r},this.InheritCoverGrammar=function(t){var e=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,i=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;var r=t.call(this);return this.Context.IsBindingElement=this.Context.IsBindingElement&&e,this.Context.IsAssignmentTarget=this.Context.IsAssignmentTarget&&a,this.Context.FirstCoverInitializedNameError=i||this.Context.FirstCoverInitializedNameError,r},this.ThrowUnexpectedToken=function(t,e){throw this.UnexpectedTokenError(t,e)},this.ThrowUnexpectedError=function(t,e,a,i){var r=i||"执行异常";return this.ErrorHandler.ThrowError(t,e,a,r)},this.UnexpectedTokenError=function(t,e){var a=e||f.UnexpectedToken,i="ILLEGAL";if(t&&(i=t.Value),a=a.replace("%0",i),t&&"number"==typeof t.LineNumber){var r=t.Start,n=t.LineNumber,s=this.LastMarker.Index-this.LastMarker.Column,o=t.Start-s+1;return this.ErrorHandler.CreateError(r,n,o,a)}var h=this.LastMarker.Index,l=this.LastMarker.Line,u=this.LastMarker.Column+1;return this.ErrorHandler.CreateError(h,l,u,a)}}function N(t,e){this.ErrorHandler=t,this.SymbolData=e,this.Add=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t+e;var r,n,s=[];if(!a&&!i){for(var o=Math.max(t.length,e.length),h=0;h<o;++h)s[h]=null,h<t.length&&h<e.length&&this.IsNumber(t[h])&&this.IsNumber(e[h])&&(s[h]=t[h]+e[h]);return s}for(var l in a?(r=t,n=e):(r=e,n=t),n)s[l]=null,this.IsNumber(n[l])&&this.IsNumber(r)&&(s[l]=r+n[l]);return s},this.Subtract=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t-e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsNumber(e[s])&&(r[s]=t[s]-e[s]);return r}if(a)for(var o in e)r[o]=null,this.IsNumber(t)&&this.IsNumber(e[o])&&(r[o]=t-e[o]);else for(var h in t)r[h]=null,this.IsNumber(t[h])&&this.IsNumber(e)&&(r[h]=t[h]-e);return r},this.Multiply=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t*e;var r,n,s=[];if(!a&&!i){for(var o=Math.max(t.length,e.length),h=0;h<o;++h)s[h]=null,h<t.length&&h<e.length&&this.IsNumber(t[h])&&this.IsNumber(e[h])&&(s[h]=t[h]*e[h]);return s}for(var l in a?(r=t,n=e):(r=e,n=t),n)s[l]=null,this.IsNumber(n[l])&&this.IsNumber(r)&&(s[l]=r*n[l]);return s},this.Divide=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return 0==e?null:t/e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsDivideNumber(e[s])&&(r[s]=t[s]/e[s]);return r}if(a)for(var o in e)r[o]=null,this.IsNumber(t)&&this.IsDivideNumber(e[o])&&(r[o]=t/e[o]);else for(var h in t)r[h]=null,this.IsNumber(t[h])&&this.IsDivideNumber(e)&&(r[h]=t[h]/e);return r},this.GT=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]>e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t>e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]>e?1:0);return r},this.GTE=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]>=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t>=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]>=e?1:0);return r},this.LT=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t<e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]<e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t<e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]<e?1:0);return r},this.LTE=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]<=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t<=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]<=e?1:0);return r},this.EQ=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t==e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]==e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t==e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]==e?1:0);return r},this.NEQ=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t!=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]!=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t!=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]!=e?1:0);return r},this.And=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t&&e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]&&e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t&&e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]&&e?1:0);return r},this.Or=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t||e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]||e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t||e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]||e?1:0);return r},this.IF=function(t,e,a){var i=this.IsNumber(t),r=this.IsNumber(e),n=this.IsNumber(a),s=Array.isArray(e),o=Array.isArray(a);if(i)return t?e:a;var h=[];for(var l in t)t[l]?h[l]=r?e:s?e[l]:null:h[l]=n?a:o?a[l]:null;return h},this.IFN=function(t,e,a){return this.IF(t,a,e)},this.REF=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null)}else for(var r=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){var n=e[r];a[r]=n>0&&n<=r?t[r-n]:r?a[r-1]:t[r]}return a},this.REFV=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null)}else for(var r=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){var n=e[r];n>=0&&n<=r&&(a[r]=t[r-n])}return a},this.REFX=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(e,t.length);for(var i=t[t.length-1],r=0;r<e;++r)a.push(i)}else for(var n=t.length,s=0;s<t.length;++s)if(a[s]=null,!(s>=e.length)){var o=e[s];a[s]=o>=0&&o+s<n?t[s+o]:s?a[s-1]:t[s]}return a},this.REFXV=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(e,t.length);for(var i=0;i<e;++i)a.push(null)}else for(var r=t.length,n=0;n<t.length;++n)if(a[n]=null,!(n>=e.length)){var s=e[n];s>=0&&s+n<r&&(a[n]=t[n+s])}return a},this.MAX=function(t,e){if(0==t.length&&this.ThrowUnexpectedNode(e,"MAX() Error: 参数个数不能为0"),1==t.length)return t[0];var a=[],i=[];for(var r in t){var n=t[r];D.IFrameSplitOperator.IsNumber(n)?i.push(n):Array.isArray(n)&&a.push(n)}var s=null;if(i.length>0){s=i[0];for(r=1;r<i.length;++r)s=Math.max(s,i[r])}var o=null;if(a.length>0){o=a[0].slice(0);for(r=1;r<a.length;++r){var h=a[r];for(var l in h){var u=o[l];n=h[l];D.IFrameSplitOperator.IsNumber(u)&&(D.IFrameSplitOperator.IsNumber(n)?o[l]=Math.max(u,n):o[l]=null)}}}if(null==o&&null!=s)return s;if(o&&null==s)return o;for(var r in o)D.IFrameSplitOperator.IsNumber(o[r])&&(o[r]=Math.max(o[r],s));return o},this.MIN=function(t,e){if(0==t.length&&this.ThrowUnexpectedNode(e,"MIN() Error: 参数个数不能为0"),1==t.length)return t[0];var a=[],i=[];for(var r in t){var n=t[r];D.IFrameSplitOperator.IsNumber(n)?i.push(n):Array.isArray(n)&&a.push(n)}var s=null;if(i.length>0){s=i[0];for(r=1;r<i.length;++r)s=Math.min(s,i[r])}var o=null;if(a.length>0){o=a[0].slice(0);for(r=1;r<a.length;++r){var h=a[r];for(var l in h){var u=o[l];n=h[l];D.IFrameSplitOperator.IsNumber(u)&&(D.IFrameSplitOperator.IsNumber(n)?o[l]=Math.min(u,n):o[l]=null)}}}if(null==o&&null!=s)return s;if(o&&null==s)return o;for(var r in o)D.IFrameSplitOperator.IsNumber(o[r])&&(o[r]=Math.min(o[r],s));return o},this.ABS=function(t){var e=[];for(var a in t)e[a]=null,isNaN(t[a])||(e[a]=Math.abs(t[a]));return e},this.MA=function(t,e){var a=[];if(e<=0)return a;if(Array.isArray(e)){for(h=0;h<t.length;++h)if(a[h]=null,!(h>=e.length)){var i=e[h];if(this.IsNumber(i)&&!(i<=0)){for(var r=0,n=0,s=h,o=0;s>=0&&o<i;--s,++o)r+=t[s],++n;n>0&&(a[h]=r/n)}}}else{if(e<=0&&(e=1),!t||!t.length)return a;for(var h=0;h<t.length;++h)if(a[h]=null,this.IsNumber(t[h]))break;t=t.slice(0);for(var l=0;h<t.length;++h,++l)if(l<e-1)a[h]=null;else{for(var u=t[h-(e-1)],C=0,D=e-1;D>=0;--D){var m=t[h-D];this.IsNumber(m)?u=m:(m=u,t[h-D]=m),C+=m}a[h]=C/e}}return a},this.EMA=function(t,e){var a=[];if(t.length<=0)return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){var r=e[i];if(this.IsNumber(r)&&(r=parseInt(r),!(r<=0))){r>i+1&&(r=i+1);for(var n=[2/(r+1),(r-1)/(r+1)],s=null,o=null,h=0;h<r;++h){var l=i-(r-h-1),u=t[l];this.IsNumber(u)||coninue,null==o?(s=u,o=s):(s=n[0]*u+n[1]*o,o=s)}a[i]=s}}else{if(e<=0)return a;for(var C=0;C<t.length;++C)if(null!=t[C]&&!isNaN(t[C]))break;var D=C,m=C+1;a[D]=t[D];for(i=C+1;i<t.length;++i,++D,++m)a[m]=(2*t[m]+(e-1)*a[D])/(e+1)}return a},this.XMA=function(t,e){for(var a=[],i=0;i<t.length;++i)if(this.IsNumber(t[i]))break;for(var r=parseInt((e-2)/2),n=0,s=0,o=0,h=0,l=i,u=0;l<t.length;++l){for(o=l-r-1,h=l+(e-r)-1,u=o;u<h;++u)u>=0&&u<t.length&&this.IsNumber(t[u])&&(n+=t[u],++s);a[l]=0!=s?n/s:null,n=0,s=0}return a},this.SMA=function(t,e,a){var i=[];if(Array.isArray(e))for(var r=0;r<e.length;++r){var n=e[r];if(this.IsNumber(n)&&(n=parseInt(n),!(n<=0))){n>r+1&&(n=r+1);for(var s=null,o=null,h=0;h<n;++h){var l=r-(n-h-1),u=t[l];this.IsNumber(u)&&(null==s?(s=u,o=u):(o=(a*u+(n-a)*s)/n,s=o))}i[r]=o}}else{r=0;for(var C=null;r<t.length;++r)if(null!=t[r]&&!isNaN(t[r])){C=t[r],i[r]=C;break}for(++r;r<t.length;++r)i[r]=(a*t[r]+(e-a)*C)/e,C=i[r]}return i},this.DMA=function(t,e){var a=[];if(t.length<0||t.length!=e.length)return a;for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&!isNaN(e[i])){a[i]=t[i];break}for(i+=1;i<t.length;++i)null==t[i]||null==e[i]?a[i]=null:t[i]<1?a[i]=e[i]*t[i]+(1-e[i])*a[i-1]:a[i]=t[i];return a},this.WMA=function(t,e){var a=[];if(!t||!t.length)return a;e<1&&(e=1);var i=0;for(i=0;i<t.length&&!this.IsNumber(t[i]);++i)a[i]=null;t=t.slice(0);for(var r=0;i<t.length;++i,++r)if(r<e-1)a[i]=null;else{for(var n=t[i-(e-1)],s=0,o=0,h=e-1;h>=0;--h){var l=t[i-h];this.IsNumber(l)?n=l:(l=n,t[i-h]=l),o+=e-h,s+=l*(e-h)}a[i]=s/o}return a},this.MEMA=function(t,e){var a=[];if(!t||!t.length)return a;var i=0,r=0;for(r=0;r<t.length&&!this.IsNumber(t[r]);++r)a[r]=null;if(i=r,e<1||i+e>=t.length)return a;var n=0;for(t=t.slice(0);i<r+e;++i)a[i]=null,!this.IsNumber(t[i])&&i-1>=0&&(t[i]=t[i-1]),n+=t[i];for(a[i-1]=n/e;i<t.length;++i)this.IsNumber(a[i-1])&&this.IsNumber(t[i])?a[i]=(t[i]+a[i-1]*(e-1))/e:i-1>-1&&this.IsNumber(a[i-1])?a[i]=a[i-1]:a[i]=null;return a},this.EXPMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=e;i<t.length;++i)if(null!=t[i]){a[i]=t[i];break}for(i+=1;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},this.EXPMEMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=0;i<t.length;++i)if(t[i]&&!isNaN(t[i]))break;for(var r=0,n=0;i<t.length&&n<e;++n,++i)t[i]&&!isNaN(t[i])?r+=t[i]:r+=t[i-1];for(a[i-1]=r/e;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},this.SUMBARS=function(t,e){var a=[];if(!t||!t.length||!e||!e.length)return a;for(var i=0,r=0,n=0;i<t.length&&!this.IsNumber(t[i]);++i)a[i]=null;var s=0;for(r=t.length-1;r>=i;--r){for(n=r,s=0;n>=i&&s<e[r];--n)s+=t[n];a[r]=n<i?null:r-n}for(r=i+1;r<t.length;++r)null==a[r]&&(a[r]=a[r-1]);return a},this.REVERSE=function(t){if(this.IsNumber(t))return 0-t;for(var e=[],a=0;a<t.length&&!this.IsNumber(t[a]);++a)e[a]=null;for(;a<t.length;++a)this.IsNumber(t[a])?e[a]=0-t[a]:e[a]=null;return e},this.COUNT=function(t,e){if(Array.isArray(e)){for(var a=null,i=t.length,r=0;r<i;++r)if(this.IsNumber(t[r])){a=r;break}if(null==a)return[];var n=[],s=0;for(r=0;r<e.length;++r){var o=e[r];if(this.IsNumber(o)){o<1&&(o=r+1),s=0;for(var h=r,l=0;h>=0&&l<o;--h,++l)t[h]&&++s;n[r]=s}}return n}for(o=e,i=t.length,o=o<1?i:o,r=0,h=0;r<i;++r)if(this.IsNumber(t[r]))break;n=[];for(var u=0;r<i&&h<o;++r,++h)u=t[r]?u+1:u,n[r]=u;for(;r<i;++r)t[r-o]&&u&&u--,u=t[r]?u+1:u,n[r]=u;return n},this.HHV=function(t,e){var a=[];if(Array.isArray(e)){for(var i=null,r=0,n=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){i=null;var s=e[r];if(s>0&&s<=r)for(n=r-s;n<=r;++n)(null==i||i<t[n])&&(i=t[n]);else for(s=r,n=0;n<=r;++n)(null==i||i<t[n])&&(i=t[n]);a[r]=i}}else{if(!D.IFrameSplitOperator.IsNonEmptyArray(t))return a;(e<=0||e>t.length)&&(e=t.length);var o=this.GetFirstVaildIndex(t);if(o>=t.length)return a;var h=o;h<t.length&&(a[h]=t[h]);for(r=h+1,n=2;r<t.length&&n<e;++r,++n)t[r]>=t[h]&&(h=r),a[r]=t[h];for(;r<t.length;++r){if(r-h<e)h=t[r]<t[h]?h:r;else for(n=h=r-e+1;n<=r;++n)h=t[n]<t[h]?h:n;a[r]=t[h]}}return a},this.HV=function(t,e){var a=this.HHV(t,e);return this.REF(a,1)},this.LLV=function(t,e){var a=[];if(Array.isArray(e)){for(var i=0;i<t.length;++i)if(a[i]=null,!(i>=e.length)){var r=null,n=e[i];if(n>0&&n<=i)for(var s=i-n;s<=i;++s)(null==r||r>t[s])&&(r=t[s]);else{n=i;for(s=0;s<=i;++s)(null==r||r>t[s])&&(r=t[s])}a[i]=r}}else{if(!D.IFrameSplitOperator.IsNonEmptyArray(t))return a;(e<=0||e>t.length)&&(e=t.length);var o=this.GetFirstVaildIndex(t);if(o>=t.length)return a;var h=o;h<t.length&&(a[h]=t[h]);for(i=h+1,s=2;i<t.length&&s<e;++i,++s)t[i]<=t[h]&&(h=i),a[i]=t[h];for(;i<t.length;++i){if(i-h<e)h=t[i]>t[h]?h:i;else for(s=h=i-e+1;s<=i;++s)h=t[s]>t[h]?h:s;a[i]=t[h]}}return a},this.LV=function(t,e){var a=this.LLV(t,e);return this.REF(a,1)},this.STD=function(t,e){var a=[],i=this.GetFirstVaildIndex(t);if(!D.IFrameSplitOperator.IsNumber(e))return a;if(i+e>t.length||e<1)return a;var r=i,n=0,s=!0,o=0,h=0;for(r+=e-1;r<t.length;++r){if(o=0,s){for(s=!1,n=r-e+1;n<=r;++n)h+=t[n];h/=e}else h+=(t[r]-t[r-e])/e;for(n=r-e+1;n<=r;++n)o+=(t[n]-h)*(t[n]-h);a[r]=Math.sqrt(o/(e-1))}return a},this.AVEDEV=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.abs(t[n-s]-r[n]);a[n]=i/e}return a},this.CROSS=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e)){if(t.length!=e.length)return[];for(var i=0;i<t.length;++i)if(this.IsNumber(t[i])&&this.IsNumber(e[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e[i]&&t[i-1]<e[i-1]?1:0}else if(Array.isArray(t)&&"number"==typeof e){for(i=0;i<t.length;++i)if(this.IsNumber(t[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e&&t[i-1]<e?1:0}else if("number"==typeof t&&Array.isArray(e)){for(i=0;i<e.length;++i)if(this.IsNumber(e[i]))break;for(++i;i<e.length;++i)a[i]=e[i]<t&&e[i-1]>t?1:0}return a},this.CROSSDOWN=function(t,e){return this.CROSS(e,t)},this.MULAR=function(t,e){var a=[];if(t.length<e)return a;for(var i=e;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])){a[i]=t[i];break}for(++i;i<t.length;++i)a[i]=a[i-1]*t[i];return a},this.SUM=function(t,e){var a=[];if(Array.isArray(e))for(r=0;r<t.length;++r){a[r]=null;var i=e[r];if(i>0)for(n=r,s=0;n>=0&&s<i;--n,++s)0==s?a[r]=t[n]:a[r]+=t[n]}else if(0==e){a[0]=t[0];for(var r=1;r<t.length;++r)a[r]=a[r-1]+t[r]}else for(var r=e-1,n=0;r<t.length;++r,++n)for(var s=0;s<e;++s)0==s?a[r]=t[s+n]:a[r]+=t[s+n];return a},this.BARSCOUNT=function(t){var e=[],a=null;for(var i in t)e[i]=0,null==a&&(this.IsNumber(t[i])||contnue,a=0),e[i]=a,++a;return e},this.DEVSQ=function(t,e){if(this.IsNumber(t)&&this.IsNumber(e))return 0;var a=[];if(Array.isArray(t)){var i=null;if(Array.isArray(e)){for(var r=e.length-1;r>=0;--r)if(this.IsNumber(e[r])){i=parseInt(e[r]);break}}else i=parseInt(e);if(!this.IsNumber(i))return a;var n=t.length,s=(r=0,0),o=0,h=0,l=0;for(r=0;r<n&&!this.IsNumber(t[r]);++r)a[r]=null;if(i<1||r+i>n)return a;for(h=0;r<n&&s<i;++r,++s)h+=t[r]/i;if(s==i){for(l=0,r--;o<i;o++)l+=(t[r-o]-h)*(t[r-o]-h);a[r]=l,r++}for(;r<n;++r){for(h+=(t[r]-t[r-i])/i,l=0,o=0;o<i;++o)l+=(t[r-o]-h)*(t[r-o]-h);a[r]=l}}return a},this.NOT=function(t){var e="number"==typeof t;if(e)return t?0:1;var a=[];for(var i in t)a[i]=null,this.IsNumber(t[i])&&(a[i]=t[i]?0:1);return a},this.FORCAST=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n,s,o,h,l,u=0,C=0,D=0,m=0;for(h=0;h<r&&!this.IsNumber(t[h]);++h)a[h]=null;for(o=h+i-1;o<r;++o){for(u=C=D=m=0,h=0,l=i;h<i&&h<=o;++h,--l)u+=l,C+=t[o-h];for(u/=i,C/=i,h=0,l=i;h<i&&h<=o;++h,--l)D+=(l-u)*(t[o-h]-C),m+=(l-u)*(l-u);s=D/m,n=C-u*s,a[o]=s*i+n}return a},this.SLOPE=function(t,e){var a=[];if("number"!=typeof e&&(e=parseInt(e)),e<1||!t.length)return a;if(e>=t.length)return a;for(var i,r,n,s,o=0,h=0;h<t.length;++h,++o)if(a[h]=null,this.IsNumber(t[h]))break;for(var l=o+e-1;l<t.length;++l){a[l]=null,i=r=n=s=0;for(var u=0;u<e&&u<=l;++u)i+=l-u,r+=t[l-u];for(i/=e,r/=e,u=0;u<e&&u<=l;++u)n+=(l-u-i)*(t[l-u]-r),s+=(l-u-i)*(l-u-i);s?a[l]=n/s:l&&(a[l]=a[l-1])}return a},this.STDP=function(t,e){var a=[],i=this.GetFirstVaildIndex(t);if(!D.IFrameSplitOperator.IsNumber(e))return a;if(i+e>t.length||e<1)return a;var r=i,n=0,s=!0,o=0,h=0;for(r+=e-1;r<t.length;++r){if(o=0,s){for(s=!1,n=r-e+1;n<=r;++n)h+=t[n];h/=e}else h+=(t[r]-t[r-e])/e;for(n=r-e+1;n<=r;++n)o+=(t[n]-h)*(t[n]-h);a[r]=Math.sqrt(o/e)}return a},this.VAR=function(t,e){if(this.IsNumber(t)&&this.IsNumber(e))return 0;var a=[];if(Array.isArray(t)&&this.IsNumber(e)){var i,r=parseInt(e),n=t.length;if(r<=0||r>=n)return a;for(o=0;o<n&&!this.IsNumber(t[o]);++o)a[o]=null;for(l=0,o=o+r-1;o<n;++o){for(h=i=0,l=0;l<r&&l<=o;++l)h+=t[o-l]*t[o-l],i+=t[o-l];a[o]=(r*h-i*i)/r*(r-1)}}else if(Array.isArray(t)&&Array.isArray(e))for(var s=this.GetFirstVaildIndex(t),o=s;o<t.length;++o){var h=i=0;if(this.IsNumber(e[o])){r=parseInt(e[o]);if(!(r<=0||o-(r-1)<0)){for(var l=0;l<r;++l)h+=t[o-l]*t[o-l],i+=t[o-l];a[o]=(r*h-i*i)/r*(r-1)}}}return a},this.VARP=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n=0,s=0;for(n=0;n<r&&!this.IsNumber(t[n]);++n)a[n]=null;for(var o=0,h=0;n<r&&s<i;++n,++s)o+=t[n]*t[n],h+=t[n];for(s==i&&(a[n-1]=(i*o-h*h)/(i*i));n<r;++n)o+=t[n]*t[n]-t[n-i]*t[n-i],h+=t[n]-t[n-i],a[n]=(i*o-h*h)/(i*i);return a},this.RANGE=function(t,e,a){var i="number"==typeof t,r="number"==typeof e,n="number"==typeof a;if(i&&r&&n)return t>Math.min(e,a)&&t<Math.max(e,a)?1:0;for(var s,o,h=[],l=0;l<t.length;++l)if(h[l]=null,s=t[l],this.IsNumber(s)){if(r)o=e;else{if(l>=e.length)continue;o=e[l]}if(this.IsNumber(o)){if(n)rangeValue2=a;else{if(l>=a.length)continue;rangeValue2=a[l]}this.IsNumber(rangeValue2)&&(h[l]=s>Math.min(o,rangeValue2)&&s<Math.max(o,rangeValue2)?1:0)}}return h},this.EXIST=function(t,e){if(e=parseInt(e),"number"==typeof t)return 0;for(var a,i=[],r=0;r<t.length;++r)i[r]=null,a=t[r],this.IsNumber(a),i[r]=r-void 0<e?1:0;return i},this.BETWEEN=function(t,e,a){var i=[],r="number"==typeof t,n="number"==typeof e,s="number"==typeof a;if(r&&n&&s)return t>=e&&t<=a?1:0;for(var o in t){i[o]=0;var h=t[o],l=null,u=null;n?l=e:o<e.length-1&&(l=e[o]),s?u=a:o<a.length-1&&(u=a[o]),null!=l&&null!=u&&(l>u?h>=u&&h<=l&&(i[o]=1):h<=u&&h>=l&&(i[o]=1))}return i},this.TFILTER=function(t,e,a){if(!this.IsNumber(a))return[];if(1==a)return this.And(t,this.EQ(this.COUNT(t,this.BARSLAST(e)),1));if(2==a)return this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1));if(0==a){for(var i=this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1)),r=this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1)),n=0;n<i.length;++n){var s=r[n];s>0&&(i[n]=2)}return i}return[]},this.FILTER=function(t,e){for(var a=[],i=0,r=0;i<t.length;++i)if(t[i]){for(a[i]=1,r=0;r<e&&r+i+1<t.length;++r)a[r+i+1]=0;i+=e}else a[i]=0;return a},this.BARSLAST=function(t){var e=[];if(!t)return e;for(var a=null,i=0;i<t.length;++i)e[i]=null,t[i]>0?a=0:null!=a&&++a,null!=a&&(e[i]=a);return e},this.BARSSINCEN=function(t,e){var a=[];if(this.IsNumber(e)&&Array.isArray(t)){var i=e;i<1&&(i=t.length);var r=this.GetFirstVaildIndex(t);if(r>=t.length)return a;var n=0;for(n=r<=i-1?i-1:r,a[n]=n-r;n<t.length;++n)if(this.IsNumber(a[n-1])){if(a[n-1]+1<i)a[n]=a[n-1]+1;else for(var s=n-i+1;s<=n;++s)if(!(Math.abs(t[s])<1e-6)){a[n]=n-s;break}}else Math.abs(t[n])<1e-6||(a[n]=0)}return a},this.BARSSINCE=function(t){for(var e=[],a=null,i=0;i<t.length;++i)e[i]=null,null==a?t[i]&&(a=0):++a,a&&(e[i]=a);return e},this.Trigonometric=function(t,e){if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=e(r):a[i]=null}return a}return this.IsNumber(t)?e(t):null},this.ASIN=function(t){if(Array.isArray(t)){var e=[];for(var a in t){var i=t[a];if(e[a]=null,this.IsNumber(i))if(i>=-1&&i<=1)e[a]=Math.asin(i);else if(a-1>=0){var r=e[a-1];this.IsNumber(r)&&(e[a]=r)}}return e}return this.IsNumber(t)?Math.acos(t):null},this.ACOS=function(t){if(Array.isArray(t)){var e=[];for(var a in t){var i=t[a];if(e[a]=null,this.IsNumber(i))if(i>=-1&&i<=1)e[a]=Math.acos(i);else if(a-1>=0){var r=e[a-1];this.IsNumber(r)&&(e[a]=r)}}return e}return this.IsNumber(t)?Math.acos(t):null},this.LAST=function(t,e,a){var i=[];if(a<=0&&(a=t.length-1),a>e)return i;for(var r=0,n=0,s=0;n<t.length;++n){i[n]=0,r=0;var o=n-e,h=n-a;if(!(o<0||h<0)){for(s=o;s<t.length&&s<=h;++s,++r)if(!t[s])break;r==h-o+1&&(i[n]=1)}}return i},this.ZIG=function(t,e){var a=this.SymbolData.Data;if("number"==typeof t)switch(t){case 0:t=a.GetOpen();break;case 1:t=a.GetHigh();break;case 2:t=a.GetLow();break;case 3:t=a.GetClose();break;default:return[]}return this.ZIG_Calculate(t,e)},this.ZIG_Calculate=function(t,e){var a=[],i=t.length,r=this.GetFirstVaildIndex(t),n=0,s=0,o=0,h=0,l=0;for(n=r+1,s=o=r;n<i-1&&o==r;++n)o=100*Math.abs(t[n]-t[r])>=e*t[r]?t[n]>t[r]?n:-n:r;for(;n<i-1;++n)if(t[n]>=t[n-1]&&t[n]>=t[n+1])if(o<0){if(100*(t[n]-t[-o])<e*t[-o])continue;for(l=(t[s]-t[h=-o])/(-o-s),a[h--]=t[-o];h>=s;h--)a[h]=t[-o]+(-o-h)*l;s=-o,o=n}else t[n]>t[o]&&(o=n);else if(t[n]<=t[n-1]&&t[n]<=t[n+1])if(o>0){if(100*(t[o]-t[n])<e*t[o])continue;for(l=(t[o]-t[h=s])/(o-s),a[h++]=t[s];h<=o;++h)a[h]=t[s]+(h-s)*l;s=o,o=-n}else t[n]<t[-o]&&(o=-n);if(Math.abs(o)>=i-2&&(o>0&&t[i-1]>=t[o]&&(o=i-1),o<0&&t[i-1]<=t[-o]&&(o=1-i)),o>0)for(l=(t[o]-t[h=s])/(o-s),a[h++]=t[s];h<=o;++h)a[h]=t[s]+(h-s)*l;else for(l=(t[s]-t[h=-o])/(-o-s),a[h--]=t[-o];h>=s;h--)a[h]=t[-o]+(-o-h)*l;if((o=Math.abs(o))<i-1)if(t[i-1]>=t[o])for(l=(t[i-1]-t[h=o])/(i-o),a[h++]=t[o];h<i;++h)a[h]=t[o]+(h-o)*l;else for(l=(t[o]-t[h=i-1])/(i-o),a[h--]=t[i-1];h>=o;h--)a[h]=t[i-1]+(i-h)*l;return a},this.GetFirstVaildIndex=function(t){for(var e=0;e<t.length;++e)if(this.IsNumber(t[e]))return e;return t.length},this.JSDraw=null,this.CalculateZIGLine=function(t,e,a,i,r){null==this.JSDraw&&(this.JSDraw=new M(this.ErrorHandler));var n=e.Up,s=t;if(n)for(var o=t.ID+1;o<a.ID;++o){var h=i[o];this.IsNumber(h)&&(s.Value<h&&(s={ID:o,Value:h}))}else for(o=t.ID+1;o<a.ID;++o){h=i[o];this.IsNumber(h)&&(s.Value>h&&(s={ID:o,Value:h}))}e.Value=s.Value,e.ID=s.ID;var l={Start:{ID:t.ID,Value:t.Value},End:{ID:e.ID,Value:e.Value}},u=this.JSDraw.CalculateDrawLine(l);for(var o in u){var C=u[o];r[C.ID]=C.Value}if(a.ID==i.length-1)for(var o in l={Start:{ID:e.ID,Value:e.Value},End:{ID:a.ID,Value:a.Value}},u=this.JSDraw.CalculateDrawLine(l),u){C=u[o];r[C.ID]=C.Value}else t.ID=e.ID,t.Value=e.Value,e.ID=a.ID,e.Value=a.Value,e.Up=t.Value<e.Value},this.TROUGHBARS=function(t,e,a){var i=this.ZIG(t,e),r=[],n=a;if(n<1)return r;for(var s=i.length,o=[],h=0;h<n;++h)o[h]=0;var l=0;h=this.GetFirstVaildIndex(i)+1;for(n--;h<s&&i[h]>i[h-1];++h);for(;h<s&&i[h]<i[h-1];++h);for(o[0]=--h;h<s-1;++h){if(i[h]<i[h+1]){if(l){if(n)for(var u=o.slice(0),C=0;C<n;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[n]&&(r[h]=h-o[n])}return o[n]&&(r[h]=h-o[n]),r},this.TROUGH=function(t,e,a){var i=this.ZIG(t,e),r=[],n=a;if(n<1)return r;for(var s=i.length,o=[],h=0;h<n;++h)o[h]=0;h=1;var l=0;h=this.GetFirstVaildIndex(i)+1;for(n--;h<s&&i[h]>i[h-1];++h);for(;h<s&&i[h]<i[h-1];++h);for(o[0]=--h;h<s-1;++h){if(i[h]<i[h+1]){if(l){if(n)for(var u=o.slice(0),C=0;C<n;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[n]&&(r[h]=i[o[n]])}return o[n]&&(r[h]=i[o[n]]),r},this.PEAKBARS=function(t,e,a){var i=this.ZIG(t,e),r=[],n=i.length,s=a;if(s<1)return r;for(var o=[],h=0;h<s;++h)o[h]=0;var l=0;h=this.GetFirstVaildIndex(i)+1;for(s--;h<n&&i[h]<i[h-1];++h);for(;h<n&&i[h]>i[h-1];++h);for(o[0]=--h;h<n-1;++h){if(i[h]>i[h+1]){if(l){if(s)for(var u=o.slice(0),C=0;C<s;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[s]&&(r[h]=h-o[s])}return o[s]&&(r[h]=h-o[s]),r},this.PEAK=function(t,e,a){var i=this.ZIG(t,e),r=[],n=i.length,s=a;if(s<1)return r;for(var o=0,h=[],l=0;l<s;++l)h[l]=0;l=this.GetFirstVaildIndex(i)+1;for(s--;l<n&&i[l]<i[l-1];++l);for(;l<n&&i[l]>i[l-1];++l);for(h[0]=--l;l<n-1;++l){if(i[l]>i[l+1]){if(o){if(s)for(var u=h.slice(0),C=0;C<s;++C)h[C+1]=u[C];h[o=0]=l}}else o=1;h[s]&&(r[l]=i[h[s]])}return h[s]&&(r[l]=i[h[s]]),r},this.EVERY=function(t,e){var a=[];if(e<1)return a;if(D.IFrameSplitOperator.IsNumber(e)){e=parseInt(e);for(var i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i]))break;for(var r=0;i<t.length;++i)t[i]?r+=1:r=0,r==e?(a[i]=1,--r):a[i]=0}else if(Array.isArray(e))for(i=0;i<e.length;++i){var n=e[i];if(a[i]=null,D.IFrameSplitOperator.IsPlusNumber(n)){n=parseInt(n);r=0;for(var s=i,o=0;s>=0&&o<n;--s,++o)t[s]&&++r;a[i]=r==n?1:0}}return a},this.COST=function(t,e){var a=[],i=t/100;if(i<1e-6||i>1)return a;var r=this.SymbolData.Data.Data;if(!r||r.length<=0)return a;for(var n=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),s=r[0].High,o=r[0].Low,h=0;h<r.length;++h){var l=r[h];o=Math.min(o,l.Low),s=Math.max(s,l.High)}(o>5e3||o<0||s>5e3||o<0)&&this.ThrowUnexpectedNode(e,"COST() 历史K线最大最小值错误, 超出(0,5000)范围");var u=parseInt(100*s+1),C=parseInt(100*o-1),D=0,m=0,c=0;s=u/100,o=C/100;var S=u-C+1;if(S<1)return a;var f=[],I=[];for(h=0;h<S;++h)f[h]=0,I[h]=0;var d=0,T=0,p=0,v=0;for(h=0;h<r.length;++h)if(!(h>=n.length)){if(n[h]>1){var F=r[h];d=F.Vol/n[h];for(var g=0;g<S;g++)f[g]*=1-d;D=parseInt(Math.min(u,Math.max(C,100*F.Low)))-C,m=parseInt(Math.min(u,Math.max(C,100*F.High)))-C,c=parseInt(Math.min(u,Math.max(C,100*F.Close)))-C;for(g=0;g<S;++g)I[g]=0;var A=parseInt((D+m+2*c)/4);if(A==m||A==D)I[A]+=F.Vol;else{for(var E=F.Vol/(A-D),N=D;N<A;++N)I[N]+=E/(A-D)*(N-D);for(N;N<=m;++N)I[N]+=E/(A-m)*(N-m)}for(T=0,g=D;g<=m;g++)f[g]+=I[g];for(g=0;g<S;g++)T+=f[g];for(g=0,v=p=0;g<S;++g)if(p+=f[g],p>=T*i){v=(s-o)*g/S+o;break}}a[h]=v}return a},this.WINNER=function(t,e){var a=[],i=this.SymbolData.Data.Data;if(!i||i.length<=0)return a;for(var r=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),n=i[0].High,s=i[0].Low,o=0;o<i.length;++o){var h=i[o];s=Math.min(s,h.Low),n=Math.max(n,h.High)}(s>5e3||s<0||n>5e3||s<0)&&this.ThrowUnexpectedNode(e,"WINNER() 历史K线最大最小值错误, 超出(0,5000)范围");var l=parseInt(100*n+1),u=parseInt(100*s-1),C=0,D=0,m=0;n=l/100,s=u/100;var c=l-u+1;if(c<1)return a;var S=[],f=[];for(o=0;o<c;++o)S[o]=0,f[o]=0;var I=0,d=0,T=0;for(o=0;o<i.length;++o)if(!(o>=r.length)&&r[o]>1){var p=i[o];I=p.Vol/r[o];for(var v=0;v<c;v++)S[v]*=1-I;C=parseInt(Math.min(l,Math.max(u,100*p.Low)))-u,D=parseInt(Math.min(l,Math.max(u,100*p.High)))-u,m=parseInt(Math.min(l,Math.max(u,100*p.Close)))-u;for(v=0;v<c;++v)f[v]=0;var F=parseInt((C+D+2*m)/4);if(F==D||F==C)f[F]+=p.Vol;else{for(var g=p.Vol/(F-C),A=C;A<F;++A)f[A]+=g/(F-C)*(A-C);for(A;A<=D;++A)f[A]+=g/(F-D)*(A-D)}for(d=0,v=C;v<=D;v++)S[v]+=f[v];for(v=0;v<c;v++)d+=S[v];D=Array.isArray(t)?parseInt(Math.min(100*t[o]-u,c-1)):parseInt(Math.min(100*t-u,c-1));for(v=0,T=0;v<=D;v++)T+=S[v];d>0?a[o]=T/d:o-1>=0&&(a[o]=a[o-1])}return a},this.CalculateChip=function(t,e,a,i){for(var r={Min:null,Max:null,Data:[]},n=1,s=null,o=null,h=t;h>=0;--h){var l={},u=a[h];l.Vol=h==t?u.Vol*e[h]:u.Vol*n,l.Date=u.Date,l.High=u.High,l.Low=u.Low,(null==s||s<l.High)&&(s=l.High),(null==o||o<l.Low)&&(o=l.Low),r.Data[h]=l,n*=1-e[h]/100*i}return r.Max=s,r.Min=o,r},this.UPNDAY=function(t,e){var a=[];if(e<1)return a;if(null==t||e>t.length)return a;for(var i=0,r=0;r<t.length;++r)a[r]=0,r-1<0||(this.IsNumber(t[r])&&this.IsNumber(t[r-1])?(t[r]>t[r-1]?++i:i=0,i==e&&(a[r]=1,--i)):i=0);return a},this.DOWNNDAY=function(t,e){var a=[];if(e<1)return a;if(null==t||e>t.length)return a;for(var i=0,r=0;r<t.length;++r)a[r]=0,r-1<0||(this.IsNumber(t[r])&&this.IsNumber(t[r-1])?(t[r]<t[r-1]?++i:i=0,i==e&&(a[r]=1,--i)):i=0);return a},this.NDAY=function(t,e,a){var i=[];if(a<1)return i;if(!Array.isArray(t)&&!Array.isArray(e))return i;if(null==t||null==e)return i;if(Array.isArray(t)&&Array.isArray(e)){if(a>=t.length||a>=e.length)return i;for(var r=Math.max(t.length,e.length),n=0,s=0;s<r;++s)i[s]=0,s>=t.length||s>=e.length||(this.IsNumber(t[s])&&this.IsNumber(e[s])?(t[s]>e[s]?++n:n=0,n==a&&(i[s]=1,--n)):n=0)}else if(Array.isArray(t)&&!Array.isArray(e)){if(a>=t.length||!this.IsNumber(e))return;n=0;for(var o in t)i[o]=0,this.IsNumber(t[o])?(t[o]>e?++n:n=0,n==a&&(i[o]=1,--n)):n=0}else if(!Array.isArray(t)&&Array.isArray(e)){if(a>=e.length||!this.IsNumber(t))return;n=0;for(var h in e)i[h]=0,this.IsNumber(e[h])?(t>e[h]?++n:n=0,n==a&&(i[h]=1,--n)):n=0}return i},this.LONGCROSS=function(t,e,a){for(var i=[],r=Math.max(t.length,e.length),n=0;n<r;++n)i[n]=0,n-1<0||n>=t.length||n>=e.length||this.IsNumber(t[n])&&this.IsNumber(e[n])&&this.IsNumber(t[n-1])&&this.IsNumber(e[n-1])&&t[n]>e[n]&&t[n-1]<e[n-1]&&(i[n]=1);for(var s=0,o=0;s<r;++s)if(i[s])for(o=1;o<=a&&s-o>=0;++o)if(t[s-o]>=e[s-o]){i[s]=0;break}return i},this.ISVALID=function(t){if(Array.isArray(t)){for(var e=[],a=0;a<t.length;++a){var i=t[a];e[a]=i?1:0}return e}return t?1:0},this.EXISTR=function(t,e,a){var i=[];if(!Array.isArray(t))return i;if(e=parseInt(e),a=parseInt(a),e<=0&&(e=t.length),a<=0&&(a=1),a>e)return i;i=[];for(var r=0,n=0;r<t.length;++r)if(i[r]=null,!(r-e<0||r-a<0))for(i[r]=0,n=e;n>=a;--n){var s=t[r-n];if(this.IsNumber(s)&&s){i[r]=1;break}}return i},this.RELATE=function(t,e,a){var i=[];if(a<1&&(a=1),!Array.isArray(t)||!Array.isArray(e))return i;for(var r=this.CalculateAverage(t,a),n=this.CalculateAverage(e,a),s=Math.max(t.length,e.length),o=0,h=0;o<s;++o)if(i[o]=null,!(o>=t.length||o>=e.length||o>=r.length||o>=n.length)){var l=r[o],u=n[o],C=0,D=0,m=0;for(h=o-a+1;h<=o;++h)C+=(t[h]-l)*(e[h]-u),D+=Math.pow(t[h]-l,2),m+=Math.pow(e[h]-u,2);i[o]=C/a/(Math.sqrt(D/a)*Math.sqrt(m/a))}return i},this.CalculateAverage=function(t,e){var a=[];if(e<1)return a;for(var i=0,r=0;r<t.length;++r)if(this.IsNumber(t[r]))break;for(;r<t.length&&r<e;++r){a[r]=null;var n=t[r];this.IsNumber(n)&&(i+=n)}for(a[r-1]=i/e;r<t.length;++r){n=t[r];var s=t[r-e];this.IsNumber(n)||(n=0),this.IsNumber(s)||(s=0),i=i-s+n,a[r]=i/e}return a},this.COVAR=function(t,e,a){if(this.IsNumber(t)||this.IsNumber(e))return 0;var i=[];if(a<1&&(a=1),!Array.isArray(t)||!Array.isArray(e))return i;for(var r=this.CalculateAverage(t,a),n=this.CalculateAverage(e,a),s=Math.max(t.length,e.length),o=(s=Math.max(t.length,e.length),0),h=0;o<s;++o)if(i[o]=null,!(o>=t.length||o>=e.length||o>=r.length||o>=n.length)){var l=r[o],u=n[o],C=0;for(h=o-a+1;h<=o;++h)C+=(t[h]-l)*(e[h]-u);i[o]=C/a}return i},this.HHVBARS=function(t,e){var a=[];if(!Array.isArray(t))return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){a[i]=null;var r=e[i];if(this.IsNumber(r)){var n=i-r;n<0&&(n=0);for(var s=null,o=n;o<t.length;++o)if(this.IsNumber(t[o])){s=o;break}for(var h=0;o<t.length&&h<r;++h,++o)t[o]>=t[s]&&(s=o);null!=s&&(a[i]=i-s)}}else{e<1&&(e=t.length);for(s=null,i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i])){s=i;break}o=0;for(i=s+1;i<t.length&&o<e;++i,++o)t[i]>=t[s]&&(s=i),e==t.length&&(a[i]=i-s);for(;i<t.length;++i){if(i-s<e)t[i]>=t[s]&&(s=i);else for(s=i-e+1,o=s;o<=i;++o)t[o]>=t[s]&&(s=o);a[i]=i-s}}return a},this.LLVBARS=function(t,e){var a=[];if(!Array.isArray(t))return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){a[i]=null;var r=e[i];if(this.IsNumber(r)){var n=i-r;n<0&&(n=0);for(var s=null,o=n;o<t.length;++o)if(this.IsNumber(t[o])){s=o;break}for(var h=0;o<t.length&&h<r;++h,++o)t[o]<=t[s]&&(s=o);null!=s&&(a[i]=i-s)}}else{e<1&&(e=t.length);for(s=null,i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i])){s=i;break}o=0;for(i=s+1;i<t.length&&o<e;++i,++o)t[i]<=t[s]&&(s=i),e==t.length&&(a[i]=i-s);for(;i<t.length;++i){if(i-s<e)t[i]<=t[s]&&(s=i);else for(s=i-e+1,o=s;o<=i;++o)t[o]<=t[s]&&(s=o);a[i]=i-s}}return a},this.BETA=function(t){var e=[],a=this.SymbolData.Data,i=this.SymbolData.IndexData;t<=0&&(t=1);for(var r=[],n=[],s=0;s<a.Data.length;++s){r[s]=0,n[s]=0;var o=a.Data[s],h=i.Data[s];o.Close>0&&o.YClose>0&&(r[s]=(o.Close-o.YClose)/o.YClose),h.Close>0&&h.YClose>0&&(n[s]=(h.Close-h.YClose)/h.YClose)}for(var l=this.CalculateAverage(r,t),u=this.CalculateAverage(n,t),C=0,D=0;C<a.Data.length;++C)if(e[C]=null,!(C>=r.length||C>=n.length||C>=l.length||C>=u.length)){var m=l[C],c=u[C],S=0,f=0;for(D=C-t+1;D<=C;++D){var I=n[D]-c,d=r[D]-m;S+=I*d,f+=I*I}this.IsDivideNumber(f)&&this.IsNumber(S)&&(e[C]=S/f)}return e},this.BETA2=function(t,e,a){var i=[];a<=0&&(a=1);for(var r=[null],n=[null],s=Math.max(t.length,e.length),o={X:t[0],Y:e[0]},h=1;h<s;++h){r[h]=0,n[h]=0;var l=t[h],u=e[h];o.X>0&&(r[h]=(l-o.X)/o.X),o.Y>0&&(n[h]=(u-o.Y)/o.Y),o={X:l,Y:u}}for(var C=this.CalculateAverage(r,a),D=this.CalculateAverage(n,a),m=(h=0,0);h<s;++h)if(i[h]=null,!(h>=r.length||h>=n.length||h>=C.length||h>=D.length)){var c=C[h],S=D[h],f=0,I=0;for(m=h-a+1;m<=h;++m){var d=r[m]-c,T=n[m]-S;f+=d*T,I+=d*d}this.IsDivideNumber(I)&&this.IsNumber(f)&&(i[h]=f/I)}return i},this.SAR=function(t,e,a){var i=[],r=this.SymbolData.Data;if(t>=r.Data.length)return i;for(var n=null,s=null,o=0;o<t;++o){var h=r.Data[o];null==n?n=h.High:n<h.High&&(n=h=n),(null==s||s>h.Low)&&(s=h.Low)}var l=0;i[t-1]=s;var u=s,C=r.Data[0].High,D=a/100;for(o=t;o<r.Data.length;++o){var m=C,c=(h=r.Data[o],r.Data[o-1]);0==l?h.Low<i[o-1]?(l=1,C=h.Low,D=e/100,u=Math.max(h.High,c.High),u=Math.max(u,m+D*(C-m))):(l=0,h.High>m&&(C=h.High,D=Math.min(D+e/100,a/100)),u=Math.min(h.Low,c.Low),u=Math.min(u,i[o-1]+D*(C-i[o-1]))):1==l&&(h.High>i[o-1]?(l=0,C=h.High,D=e/100,u=Math.min(h.Low,c.Low),u=Math.min(u,i[o-1]+D*(C-m))):(l=1,h.Low<m&&(C=h.Low,D=Math.min(D+e/100,a/100)),u=Math.max(h.High,c.High),u=Math.max(u,i[o-1]+D*(C-i[o-1])))),i[o]=u}return i},this.SARTURN=function(t,e,a){var i=[],r=this.SAR(t,e,a),n=this.SymbolData.Data,s=0;for(s=0;s<r.length;++s)if(this.IsNumber(r[s]))break;var o=0;s<n.Data.length&&(o=n.Data[s].Close>r[s]);for(var h=s+1;h<n.Data.length;++h){var l=n.Data[h];l.Close<r[h]&&o?i[h]=-1:i[h]=l.Close>r[h]&&!o?1:0,o=l.Close>r[h]}return i},this.BACKSET=function(t,e){var a=[];if(!t)return a;var i=t.length;if(!this.IsNumber(i)||i<=0)return a;if(Array.isArray(e)){for(var r=0;r<i;++r)a[r]=0;for(r=0;r<i;++r){var n=t[r],s=e[r];if(this.IsNumber(n)&&n&&this.IsNumber(s))for(var o=r,h=0;o>=0&&h<s;--o,++h)a[o]=1}}else{for(r=0;r<i;++r)a[r]=0;for(var l=0;l<i;++l)if(this.IsNumber(t[l]))break;if(l==i)return a;var u=Math.min(i-l,Math.max(e,1));for(r=i-1,o=0;r>=0;--r){n=t[r];if(this.IsNumber(n)&&n)for(o=r;o>r-u;--o)a[o]=1}if(t[r])for(o=r;o>=l;--o)a[o]=1}return a},this.STRCAT=function(t,e){var a=[];return this.IsString(t)&&this.IsString(e)&&(a=t+e),a},this.VARCAT=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e))for(var i=Math.max(t.length,e.length),r="",n=0;n<i;++n){if(a[n]=null,r="",n<t.length){var s=t[n];this.IsString(s)&&(r+=s)}if(n<e.length){s=e[n];this.IsString(s)&&(r+=s)}""!=r&&(a[n]=r)}else if(this.IsString(t)&&Array.isArray(e))for(n=0;n<e.length;++n){a[n]=null;s=e[n];this.IsString(s)&&(a[n]=t+s)}else if(Array.isArray(t)&&this.IsString(e))for(n=0;n<t.length;++n){a[n]=null;s=t[n];this.IsString(s)&&(a[n]=s+e)}else this.IsString(t)&&this.IsString(e)&&(a=t+e);return a},this.FINDSTR=function(t,e){var a,i,r=[];if(a=D.IFrameSplitOperator.IsNumber(t)?t.toString():t,i=D.IFrameSplitOperator.IsNumber(e)?e.toString():e,D.IFrameSplitOperator.IsString(a)&&D.IFrameSplitOperator.IsString(i))return a.indexOf(i)>=0?1:0;if(Array.isArray(t)&&D.IFrameSplitOperator.IsString(i))for(var n=0;n<t.length;++n){var s=t[n];D.IFrameSplitOperator.IsString(s)?r[n]=s.indexOf(i)>=0?1:0:D.IFrameSplitOperator.IsNumber(s)?(a=s.toString(),r[n]=a.indexOf(i)>=0?1:0):r[n]=0}return r},this.STRLEN=function(t){if(D.IFrameSplitOperator.IsString(t))return t.length;if(Array.isArray(t)){for(var e=[],a=0;a<t.length;++a){var i=t[a];D.IFrameSplitOperator.IsString(i)?e[a]=i.length:e[a]=null}return e}return null},this.STRCMP=function(t,e){return D.IFrameSplitOperator.IsString(t)&&D.IFrameSplitOperator.IsString(e)?t==e?1:0:null},this.STRSPACE=function(t){var e=[];if(Array.isArray(t))for(var a=0;a<t.length;++a){e[a]=null;var i=t[a];TouchList.IsString(i)&&(e[a]=i+" ")}else this.IsString(t)&&(e=t+" ");return e},this.CON2STR=function(t,e){var a=[];if(Array.isArray(t))for(var i=t.length-1;i>=0;--i){var r=t[i];if(this.IsNumber(r))return a=r.toFixed(e),a}else this.IsNumber(t)&&(a=t.toFixed(e));return a},this.VAR2STR=function(t,e){var a=[];if(Array.isArray(t))for(var i=0;i<t.length;++i){a[i]=null;var r=t[i];this.IsNumber(r)&&(a[i]=r.toFixed(e))}else this.IsNumber(t)&&(a=t.toFixed(e));return a},this.ZTPRICE=function(t,e){if(!this.IsNumber(e))return null;if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=(1+e)*r:a[i]=null}return a}if(this.IsNumber(t)){a=(1+e)*t;return a}},this.DTPRICE=function(t,e){if(!this.IsNumber(e))return null;if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=(1-e)*r:a[i]=null}return a}if(this.IsNumber(t)){a=(1-e)*t;return a}},this.FRACPART=function(t){if(Array.isArray(t)){var e=[],a=0;for(var i in t){var r=t[i];this.IsNumber(r)?(a=parseInt(r),e[i]=r-a):e[i]=null}return e}if(this.IsNumber(t)){a=parseInt(t);e=t-a;return e}},this.SIGN=function(t){if(Array.isArray(t)){for(var e=[],a=0;a<t.length;++a){var i=t[a];e[a]=null,D.IFrameSplitOperator.IsNumber(i)&&(e[a]=i>0?1:0==i?0:-1)}return e}return t>0?1:0==t?0:-1},this.BARSLASTCOUNT=function(t){var e=null;if(Array.isArray(t)){if(e=[],t.length>0)for(var a=0,i=t.length-1;i>=0;--i){a=0;for(var r=i;r>=0;--r){if(!t[r])break;++a}e[i]=a}}else e=t?1:0;return e},this.INTPART=function(t){var e=null;if(Array.isArray(t))for(var a in e=[],t){var i=t[a];this.IsNumber(i)?e[a]=parseInt(i):e[a]=null}else this.IsNumber(t)&&(e=parseInt(t));return e},this.CONST=function(t){if(Array.isArray(t)){var e=t.length;return e>0?t[e-1]:null}return t},this.TOPRANGE=function(t){if(this.IsNumber(t))return 0;var e=[];if(Array.isArray(t))for(var a=t.length,i=a-1;i>=0;--i){e[i]=0;var r=t[i];if(this.IsNumber(r)){for(var n=0,s=i-1;s>=0;--s){if(t[s]>r)break;++n}e[i]=n}}return e},this.LOWRANGE=function(t){if(this.IsNumber(t))return 0;var e=[];if(Array.isArray(t))for(var a=t.length,i=a-1;i>=0;--i){e[i]=0;var r=t[i];if(this.IsNumber(r)){for(var n=0,s=i-1;s>=0;--s){if(t[s]<r)break;++n}e[i]=n}}return e},this.FINDLOW=function(t,e,a,i){if(this.IsNumber(t))return t;var r=[];if(Array.isArray(t))for(var n=t.length,s=n-1;s>=0;--s){r[s]=null;for(var o=[],h=e;h<a;++h){var l=s-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&o.push(u)}if(o.length>0){o.sort((function(t,e){return t-e}));l=i-1;l<0?l=0:l>=o.length&&(l=o.length-1),r[s]=o[l]}}return r},this.FINDHIGH=function(t,e,a,i){if(this.IsNumber(t))return t;var r=[];if(Array.isArray(t))for(var n=t.length,s=n-1;s>=0;--s){r[s]=null;for(var o=[],h=e;h<a;++h){var l=s-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&o.push(u)}if(o.length>0){o.sort((function(t,e){return e-t}));l=i-1;l<0?l=0:l>=o.length&&(l=o.length-1),r[s]=o[l]}}return r},this.FINDHIGHBARS=function(t,e,a,i){if(this.IsNumber(t))return a-e-i;var r=[];if(Array.isArray(t))for(var n=t.length,s=n-1;s>=0;--s){r[s]=null;for(var o=[],h=e;h<a;++h){var l=s-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&o.push({Value:u,Period:h})}if(o.length>0){o.sort((function(t,e){return e.Value-t.Value}));l=i-1;l<0?l=0:l>=o.length&&(l=o.length-1),r[s]=o[l].Period}}return r},this.FINDLOWBARS=function(t,e,a,i){if(this.IsNumber(t))return a-e-i;var r=[];if(Array.isArray(t))for(var n=t.length,s=n-1;s>=0;--s){r[s]=null;for(var o=[],h=e;h<a;++h){var l=s-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&o.push({Value:u,Period:h})}if(o.length>0){o.sort((function(t,e){return t.Value-e.Value}));l=i-1;l<0?l=0:l>=o.length&&(l=o.length-1),r[s]=o[l].Period}}return r},this.HOD=function(t,e){var a=[];if(D.IFrameSplitOperator.IsNumber(t))return 1;if(Array.isArray(t))for(var i=t.length,r=i-1;r>=0;--r){var n=t[r];if(D.IFrameSplitOperator.IsNumber(n)){if(Array.isArray(e))var s=parseInt(e[r]);else s=parseInt(e);e<=0&&(s=r);for(var o=1,h=r-1,l=1;h>=0&&l<s;--h,++l){var u=t[h];D.IFrameSplitOperator.IsNumber(u)&&u>n&&++o}a[r]=o}}return a},this.LOD=function(t,e){var a=[];if(D.IFrameSplitOperator.IsNumber(t))return 1;if(Array.isArray(t))for(var i=t.length,r=i-1;r>=0;--r){var n=t[r];if(D.IFrameSplitOperator.IsNumber(n)){if(Array.isArray(e))var s=parseInt(e[r]);else s=parseInt(e);e<=0&&(s=r);for(var o=1,h=r-1,l=1;h>=0&&l<s;--h,++l){var u=t[h];D.IFrameSplitOperator.IsNumber(u)&&u<n&&++o}a[r]=o}}return a},this.BARSNEXT=function(t){if(!Array.isArray(t))return 0;for(var e=[],a=0;a<t.length;++a){e[a]=0;for(var i=a,r=0;i<t.length;++i,++r){var n=t[i];if(n>0){e[a]=r;break}}}return e},this.RAND=function(t){if(Array.isArray(t)){var e=[];for(var a in t){e[a]=null;var i=t[a],r=parseInt(i);r<=0||(e[a]=Math.ceil(Math.random()*r))}return e}r=parseInt(t);if(r<=0)return null;var n=this.SymbolData.Data,s=n.Data.length;for(e=[],a=0;a<s;++a)e[a]=Math.ceil(Math.random()*r);return e},this.AMA=function(t,e){var a,i=[];if(Array.isArray(e)){for(var r=t.length-1;r>=0;--r)if(this.IsNumber(e[r])){a=e[r];break}}else a=e;if(this.IsNumber(a)){if(a>1)return i;var n=0,s=0;for(n;n<t.length;++n)if(i[n]=null,this.IsNumber(t[n])){s=t[n],i[n]=s;break}for(r=n+1;r<t.length;++r){var o=t[r];i[r]=i[r-1]+a*(o-i[r-1])}}return i},this.TMA=function(t,e,a){var i=[];if(this.IsNumber(e)&&e<=1&&this.IsNumber(a)&&a<1){var r=!1;for(var n in t)if(i[n]=null,0==r){var s=t[n];this.IsNumber(s)&&(i[n]=s,i[n],r=!0)}else{s=t[n];if(!this.IsNumber(s))continue;i[n]=e*i[n-1]+a*s,i[n]}}return i},this.ROUND=function(t){if(this.IsNumber(t))return Math.round(t);var e=[];if(Array.isArray(t))for(var a in t){var i=t[a];this.IsNumber(i)?e[a]=Math.round(i):e[a]=null}return e},this.ROUND2=function(t,e){var a=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12],i=0;if(this.IsNumber(e)&&(i=parseInt(e)),e<0?i=0:e>=a.length&&(i=a.length-1),this.IsNumber(t))return Math.round(t*a[i])/a[i];var r=[];if(Array.isArray(t))for(var n in t){var s=t[n];this.IsNumber(s)?r[n]=Math.round(s*a[i])/a[i]:r[n]=null}return r},this.TRMA=function(t,e){if(!this.IsNumber(e)||e<=0)return[];e=parseInt(e);var a=0,i=0;e%2==0?(a=parseInt(e/2),i=a+1):(a=parseInt((e+1)/2),i=a);var r=this.MA(t,a),n=this.MA(r,i);return n},this.VALUEWHEN=function(t,e){if(Array.isArray(t)){var a=[];if(Array.isArray(e)){var i=null;for(var r in t)if(r>=e.length)a[r]=i;else{var n=e[r];t[r]?(a[r]=n,i=n):a[r]=i}}else{i=null;for(var r in t)t[r]?(a[r]=e,i=e):a[r]=i}return a}return t?1:0},this.HARMEAN=function(t,e){var a=[];if(Array.isArray(t))if(Array.isArray(e))for(var i=0;i<t.length;++i)if(i>=e.length)a[i]=null;else{var r=parseInt(e[i]);if(r<=0||r>i)a[i]=null;else{for(var n=0,s=0;s<r;++s){var o=t[i-s];if(!this.IsNumber(o)||0==o){n=null;break}n+=1/o}a[i]=null==n?null:1/(n/r)}}else if(this.IsNumber(e)){if(e=parseInt(e),e<=0)return a;for(i=0;i<t.length;++i)if(e>i)a[i]=null;else{for(n=0,s=0;s<e;++s){o=t[i-s];if(!this.IsNumber(o)||0==o){n=null;break}n+=1/o}a[i]=null==n?null:1/(n/e)}}return a},this.DATETODAY=function(t){var e=[],a=new Date("1990-12-19");if(Array.isArray(t))for(var i in t){e[i]=null;var r=t[i];if(this.IsNumber(r)){var n=r+19e6;if(!(n<19901219)){var s=parseInt(n/1e4),o=parseInt(n%1e4/100),h=parseInt(n%100),l=new Date("".concat(s,"-").concat(o,"-").concat(h));e[i]=Math.round((l-a)/864e5)}}}else if(this.IsNumber(t)){n=t+19e6;if(n>=19901219){s=parseInt(n/1e4),o=parseInt(n%1e4/100),h=parseInt(n%100),l=new Date("".concat(s,"-").concat(o,"-").concat(h));return Math.round((l-l)/864e5)}}return e},this.DAYTODATE=function(t){var e=new Date("1990-12-19"),a=[];if(Array.isArray(t))for(var i in t){a[i]=null;var r=t[i];if(this.IsNumber(r)){e.setDate(e.getDate()+r);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();n-=19e6,a[i]=n,e.setDate(e.getDate()-r)}}else if(this.IsNumber(t)){e.setDate(e.getDate()+t);n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();return n-=19e6,n}return a},this.TIMETOSEC=function(t){var e=parseInt(t/1e4),a=parseInt(t%1e4/100),i=t%100,r=60*e*60+60*a+i;return r},this.SECTOTIME=function(t){Math.floor(t/86400);var e=Math.floor(t%86400/3600),a=Math.floor(t%3600/60),i=t%60,r=1e4*e+100*a+i;return r},this.MOD=function(t,e){var a=[],i="number"==typeof t,r="number"==typeof e;if(i&&r)return N.MOD(t,e);if(!i&&!r){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)a[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsNumber(e[s])&&(a[s]=N.MOD(t[s],e[s]));return a}if(i&&!r){for(var o in e)a[o]=null,this.IsNumber(t)&&this.IsNumber(e[o])&&(a[o]=N.MOD(t,e[o]));return a}if(!i&&r){for(var o in t)a[o]=null,this.IsNumber(t[o])&&this.IsNumber(e)&&(a[o]=N.MOD(t[o],e));return a}return a},this.POW=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e))for(var i=0;i<t.length;++i){var r=t[i],n=e[i];this.IsNumber(r)&&this.IsNumber(n)?a[i]=Math.pow(r,n):a[i]=null}else if(this.IsNumber(t)&&Array.isArray(e))for(i=0;i<e.length;++i){var s=e[i];this.IsNumber(s)?a[i]=Math.pow(t,s):a[i]=null}else{if(this.IsNumber(t)&&this.IsNumber(e))return Math.pow(t,e);if(Array.isArray(t)&&this.IsNumber(e))for(i=0;i<t.length;++i){s=t[i];this.IsNumber(s)?a[i]=Math.pow(s,e):a[i]=null}}return a},this.CEILING=function(t){var e="number"==typeof t;if(e)return parseInt(t);var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=parseInt(r):a[i]=null}return a},this.FLOOR=function(t){var e="number"==typeof t;if(e)return parseInt(t-1);var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=parseInt(r-1):a[i]=null}return a},this.PWINNER=function(t,e,a){return[]},this.ANY=function(t,e){e<=0&&(e=1);var a=[];if(Array.isArray(t)){if(e>=t.length)return 0;for(var i=e,r=0;i<t.length;++i){var n=0;for(r=0;r<e;++r){var s=t[i-r];if(s>0){n=1;break}}a[i]=n}return a}if(D.IFrameSplitOperator.IsNumber(t)){if(t<=0)return 0;if(e>=this.SymbolData.Data.Data.length)return 0;for(i=e;i<this.SymbolData.Data.Data.length;++i)a[i]=1;return a}return 0},this.ALL=function(t,e){e<=0&&(e=1);var a=[];if(Array.isArray(t)){if(e>=t.length)return 0;for(var i=e,r=0;i<t.length;++i){var n=1;for(r=0;r<e;++r){var s=t[i-r];if(!(s>0)){n=0;break}}a[i]=n}return a}if(D.IFrameSplitOperator.IsNumber(t)){if(t<=0)return 0;if(e>=this.SymbolData.Data.Data.length)return 0;for(i=e;i<this.SymbolData.Data.Data.length;++i)a[i]=1;return a}return 0},this.TESTSKIP=function(t,e){if(Array.isArray(t)){if(t.length<=0)return!1;var a=t[t.length-1];return!!a}return D.IFrameSplitOperator.IsNumber(t)?!(t<=0):!!t},this.IFC=function(t){if(Array.isArray(t)){var e=t[t.length-1];return!!D.IFrameSplitOperator.IsNumber(e)&&e>0}return!!D.IFrameSplitOperator.IsNumber(t)&&t>0},this.ALIGNRIGHT=function(t){if(Array.isArray(t)){for(var e=[],a=t.length-1,i=t.length-1;i>=0;--i){var r=t[i];(D.IFrameSplitOperator.IsNumber(r)||D.IFrameSplitOperator.IsString(r))&&(e[a]=r,--a)}for(i=a;i>=0;--i)e[i]=null;return e}return t},this.STRFORMAT=function(t,e,a){var i=t.match(/{\d+}/g);if(!D.IFrameSplitOperator.IsNonEmptyArray(i))return null;for(var r=new Map,n=-1,o=0;o<i.length;++o){var h=i[o];if(!(h.length<3)){var l=h.slice(1,h.length-1),u=parseInt(l),C={Src:h,Index:u,Text:null};n<u&&(n=u),r.set(u,C)}}var m=!1,c=0;for(o=1;o<e.length;++o){h=e[o];Array.isArray(h)&&(m=!0,c<h.length&&(c=h.length))}if(m){var S=[];for(o=0;o<c;++o){var f,I=t,d=(0,s.default)(r);try{for(d.s();!(f=d.n()).done;){h=f.value;var T=h[1],p=(C=e[T.Index+1],"null");if(C)if(Array.isArray(C)){l=C[o];l&&(p="".concat(l))}else p="".concat(C);I=I.replace(T.Src,p)}}catch(g){d.e(g)}finally{d.f()}S[o]=I}return S}S=t;var v,F=(0,s.default)(r);try{for(F.s();!(v=F.n()).done;){h=v.value,T=h[1],C=e[T.Index+1],p="null";C&&(p="".concat(C)),S=S.replace(T.Src,p)}}catch(g){F.e(g)}finally{F.f()}return S},this.CallFunction=function(t,e,a){switch(t){case"MAX":case"MAX6":return this.MAX(e,a);case"MIN":case"MIN6":return this.MIN(e,a);case"REF":return this.REF(e[0],e[1]);case"REFV":return this.REFV(e[0],e[1]);case"REFX":return this.REFX(e[0],e[1]);case"REFXV":return this.REFXV(e[0],e[1]);case"REFX1":return this.REFX(e[0],e[1]);case"ABS":return this.ABS(e[0]);case"MA":return this.MA(e[0],e[1]);case"EMA":return this.EMA(e[0],e[1]);case"SMA":return this.SMA(e[0],e[1],e[2]);case"DMA":return this.DMA(e[0],e[1]);case"XMA":return this.XMA(e[0],e[1]);case"EXPMA":return this.EXPMA(e[0],e[1]);case"EXPMEMA":return this.EXPMEMA(e[0],e[1]);case"COUNT":return this.COUNT(e[0],e[1]);case"LLV":return this.LLV(e[0],e[1]);case"LV":return this.LV(e[0],e[1]);case"LLVBARS":return this.LLVBARS(e[0],e[1]);case"HHV":return this.HHV(e[0],e[1]);case"HV":return this.HV(e[0],e[1]);case"HHVBARS":return this.HHVBARS(e[0],e[1]);case"MULAR":return this.MULAR(e[0],e[1]);case"CROSS":return this.CROSS(e[0],e[1]);case"CROSSDOWN":return this.CROSSDOWN(e[0],e[1]);case"LONGCROSS":return this.LONGCROSS(e[0],e[1],e[2]);case"AVEDEV":return this.AVEDEV(e[0],e[1]);case"STD":return this.STD(e[0],e[1]);case"IF":case"IFF":case"IFELSE":return this.IF(e[0],e[1],e[2]);case"IFN":return this.IFN(e[0],e[1],e[2]);case"NOT":return this.NOT(e[0]);case"SUM":return this.SUM(e[0],e[1]);case"RANGE":return this.RANGE(e[0],e[1],e[2]);case"EXIST":return this.EXIST(e[0],e[1]);case"EXISTR":return this.EXISTR(e[0],e[1],e[2]);case"ISVALID":return this.ISVALID(e[0]);case"FILTER":return this.FILTER(e[0],e[1]);case"TFILTER":return this.TFILTER(e[0],e[1],e[2]);case"SLOPE":return this.SLOPE(e[0],e[1]);case"BARSLAST":return this.BARSLAST(e[0]);case"BARSCOUNT":return this.BARSCOUNT(e[0]);case"BARSSINCEN":return this.BARSSINCEN(e[0],e[1]);case"BARSSINCE":return this.BARSSINCE(e[0]);case"LAST":return this.LAST(e[0],e[1],e[2]);case"EVERY":return this.EVERY(e[0],e[1]);case"ZIG":return this.ZIG(e[0],e[1]);case"TROUGHBARS":return this.TROUGHBARS(e[0],e[1],e[2]);case"TROUGH":return this.TROUGH(e[0],e[1],e[2]);case"PEAKBARS":return this.PEAKBARS(e[0],e[1],e[2]);case"PEAK":return this.PEAK(e[0],e[1],e[2]);case"COST":return this.COST(e[0],a);case"WINNER":return this.WINNER(e[0],a);case"PWINNER":return this.PWINNER(e[0],e[1],a);case"UPNDAY":return this.UPNDAY(e[0],e[1]);case"DOWNNDAY":return this.DOWNNDAY(e[0],e[1]);case"NDAY":return this.NDAY(e[0],e[1],e[2]);case"DEVSQ":return this.DEVSQ(e[0],e[1]);case"FORCAST":return this.FORCAST(e[0],e[1]);case"STDP":return this.STDP(e[0],e[1]);case"VAR":return this.VAR(e[0],e[1]);case"VARP":return this.VARP(e[0],e[1]);case"RELATE":return this.RELATE(e[0],e[1],e[2]);case"COVAR":return this.COVAR(e[0],e[1],e[2]);case"BETA":return this.BETA(e[0]);case"BETA2":return this.BETA2(e[0],e[1],e[2]);case"WMA":return this.WMA(e[0],e[1]);case"MEMA":return this.MEMA(e[0],e[1]);case"SUMBARS":return this.SUMBARS(e[0],e[1]);case"REVERSE":return this.REVERSE(e[0]);case"SAR":return this.SAR(e[0],e[1],e[2]);case"SARTURN":return this.SARTURN(e[0],e[1],e[2]);case"BACKSET":return this.BACKSET(e[0],e[1]);case"STRCAT":return this.STRCAT(e[0],e[1]);case"VARCAT":return this.VARCAT(e[0],e[1]);case"VAR2STR":return this.VAR2STR(e[0],e[1]);case"CON2STR":return this.CON2STR(e[0],e[1]);case"STRSPACE":return this.STRSPACE(e[0]);case"FINDSTR":return this.FINDSTR(e[0],e[1]);case"STRCMP":return this.STRCMP(e[0],e[1]);case"STRLEN":return this.STRLEN(e[0]);case"STRFORMAT":return this.STRFORMAT(e[0],e,a);case"DTPRICE":return this.DTPRICE(e[0],e[1]);case"ZTPRICE":return this.ZTPRICE(e[0],e[1]);case"FRACPART":return this.FRACPART(e[0]);case"SIGN":return this.SIGN(e[0]);case"BARSLASTCOUNT":return this.BARSLASTCOUNT(e[0]);case"INTPART":return this.INTPART(e[0]);case"CONST":return this.CONST(e[0]);case"TOPRANGE":return this.TOPRANGE(e[0]);case"LOWRANGE":return this.LOWRANGE(e[0]);case"FINDLOW":return this.FINDLOW(e[0],e[1],e[2],e[3]);case"FINDLOWBARS":return this.FINDLOWBARS(e[0],e[1],e[2],e[3]);case"FINDHIGH":return this.FINDHIGH(e[0],e[1],e[2],e[3]);case"FINDHIGHBARS":return this.FINDHIGHBARS(e[0],e[1],e[2],e[3]);case"BARSNEXT":return this.BARSNEXT(e[0]);case"HOD":return this.HOD(e[0],e[1]);case"LOD":return this.LOD(e[0],e[1]);case"AMA":return this.AMA(e[0],e[1]);case"TMA":return this.TMA(e[0],e[1],e[2]);case"ROUND":return this.ROUND(e[0]);case"ROUND2":return this.ROUND2(e[0],e[1]);case"TRMA":return this.TRMA(e[0],e[1]);case"VALUEWHEN":return this.VALUEWHEN(e[0],e[1]);case"HARMEAN":return this.HARMEAN(e[0],e[1]);case"DATETODAY":return this.DATETODAY(e[0]);case"DAYTODATE":return this.DAYTODATE(e[0]);case"TIMETOSEC":return this.TIMETOSEC(e[0]);case"SECTOTIME":return this.SECTOTIME(e[0]);case"MOD":return this.MOD(e[0],e[1]);case"POW":return this.POW(e[0],e[1]);case"CEILING":return this.CEILING(e[0]);case"FLOOR":return this.FLOOR(e[0]);case"BETWEEN":return this.BETWEEN(e[0],e[1],e[2]);case"ANY":return this.ANY(e[0],e[1]);case"ALL":return this.ALL(e[0],e[1]);case"ALIGNRIGHT":return this.ALIGNRIGHT(e[0]);case"ATAN":return this.Trigonometric(e[0],Math.atan);case"ACOS":return this.ACOS(e[0]);case"ASIN":return this.ASIN(e[0]);case"COS":return this.Trigonometric(e[0],Math.cos);case"SIN":return this.Trigonometric(e[0],Math.sin);case"TAN":return this.Trigonometric(e[0],Math.tan);case"LN":return this.Trigonometric(e[0],Math.log);case"LOG":return this.Trigonometric(e[0],Math.log10);case"EXP":return this.Trigonometric(e[0],Math.exp);case"SQRT":return this.Trigonometric(e[0],Math.sqrt);default:this.ThrowUnexpectedNode(a,"函数"+t+"不存在")}},this.CallCustomFunction=function(t,e,a,i){var r=S.CustomFunction.Data.get(t),n=a.GetStockCacheData({CustomName:t,Node:i});if(!r.Invoke)return{Out:n};h.JSConsole.Complier.Log("[JSAlgorithm::CallCustomFunction] call custom function functionInfo=",r);var s=this,o={Name:t,Args:e,Symbol:a.Symbol,Period:a.Period,Right:a.Right,KData:a.Data,DownloadData:n,ThrowError:function(t){s.ThrowUnexpectedNode(i,t)}};return r.Invoke(o)},this.ThrowUnexpectedNode=function(t,e){var a=t.Marker,i=e||"执行异常";return this.ErrorHandler.ThrowError(a.Index,a.Line,a.Column,i)}}function M(t,e){this.ErrorHandler=t,this.SymbolData=e,this.DRAWTEXT=function(t,e,a){var i=[],r={DrawData:i,DrawType:"DRAWTEXT",Text:a};if(Array.isArray(t)){var n=this.IsNumber(e),s=!1;"TOP"!==e&&"BOTTOM"!==e||(r.FixedPosition=e,s=!0);for(var o=0;o<t.length;++o)i[o]=null,!isNaN(t[o])&&t[o]&&(n||s?i[o]=e:this.IsNumber(e[o])&&(i[o]=e[o]))}else if(this.IsNumber(t)&&t){n=this.IsNumber(e),s=!1;"TOP"!==e&&"BOTTOM"!==e||(r.FixedPosition=e,s=!0);for(o=0;o<this.SymbolData.Data.Data.length;++o)n||s?i[o]=e:this.IsNumber(e[o])&&(i[o]=e[o])}return r},this.DRAWTEXT_FIX=function(t,e,a,i,r){var n={Position:null,DrawType:"DRAWTEXT_FIX",Text:r};if(t.length<=0)return n;for(var s in t)if(!isNaN(t[s])&&t[s])return n.Position={X:e,Y:a,Type:i},n;return n},this.SUPERDRAWTEXT=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"SUPERDRAWTEXT",Text:a,YOffset:r,Direction:i,TextAlign:"center"};if(t.length<=0)return s;var o="number"==typeof e;for(var h in t)n[h]=null,!isNaN(t[h])&&t[h]&&(o?n[h]=e:this.IsNumber(e[h])&&(n[h]=e[h]));return s},this.STICKLINE=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"STICKLINE",Width:i,Type:r},o="number"==typeof e,h="number"==typeof a;if(Array.isArray(t)){if(t.length<=0)return s;for(var l in t)if(n[l]=null,!isNaN(t[l])&&t[l])if(o&&h)n[l]={Value:e,Value2:a};else if(o&&!h){if(isNaN(a[l]))continue;n[l]={Value:e,Value2:a[l]}}else if(!o&&h){if(isNaN(e[l]))continue;n[l]={Value:e[l],Value2:a}}else{if(isNaN(e[l])||isNaN(a[l]))continue;n[l]={Value:e[l],Value2:a[l]}}}else{if(!t)return s;for(l=0;l<this.SymbolData.Data.Data.length;++l)if(n[l]=null,o&&h)n[l]={Value:e,Value2:a};else if(o&&!h){if(!this.IsNumber(a[l]))continue;n[l]={Value:e,Value2:a[l]}}else if(!o&&h){if(!this.IsNumber(e[l]))continue;n[l]={Value:e[l],Value2:a}}else{if(!this.IsNumber(e[l])||!this.IsNumber(a[l]))continue;n[l]={Value:e[l],Value2:a[l]}}}return s},this.DRAWLINE=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"DRAWLINE",Expand:r};if(t.length<=0)return s;for(var o=Math.max(t.length,a.length),h=!1,l=!1,u={Start:{},End:{},List:new Array},C=0;C<o;++C)if(n[C]=null,C<t.length&&C<a.length){if(0==h&&0==l){if(null==t[C]||!t[C])continue;h=!0,u.Start={ID:C,Value:e[C]}}else if(1==h&&0==l){var D=null!=a[C]&&a[C];if(!D)continue;D&&(l=!0,u.End={ID:C,Value:i[C]})}if(1==h&&1==l){var m=this.CalculateDrawLine(u);for(var c in m){var S=m[c];n[S.ID]=S.Value}h=l=!1,u={Start:{},End:{}}}}if(1==r){for(var f=null,I=n.length-1;I>=0;--I)if(this.IsNumber(n[I])){f=I;break}if(null!=f&&f-1>=0){var d=f-1;for(I=f+1;I<n.length;++I){var T=n[d],p=n[f],v=(T-p)*(I-d)/(f-d);n[I]=T-v}}}return s},this.DRAWBAND=function(t,e,a,i){for(var r=[],n={DrawData:r,DrawType:"DRAWBAND",Color:[e.toLowerCase(),i.toLowerCase()]},s=Math.max(t.length,a.length),o=0;o<s;++o){var h={Value:null,Value2:null};o<t.length&&(h.Value=t[o]),o<a.length&&(h.Value2=a[o]),r.push(h)}return n},this.DRAWKLINE=function(t,e,a,i){for(var r=[],n={DrawData:r,DrawType:"DRAWKLINE"},s=Math.max(t.length,e.length,a.length,i.length),o=0;o<s;++o){var h={Open:null,High:null,Low:null,Close:null};o<t.length&&o<e.length&&o<a.length&&o<i.length&&(h.Open=e[o],h.High=t[o],h.Low=a[o],h.Close=i[o]),r[o]=h}return n},this.DRAWKLINE_IF=function(t,e,a,i,r){for(var n=[],s={DrawData:n,DrawType:"DRAWKLINE_IF"},o=Math.max(t.length,e.length,a.length,i.length,r.length),h=0;h<o;++h){var l={Open:null,High:null,Low:null,Close:null};h<e.length&&h<a.length&&h<i.length&&h<r.length&&h<t.length&&t[h]&&(l.Open=a[h],l.High=e[h],l.Low=i[h],l.Close=r[h]),n[h]=l}return s},this.DRAWCOLORKLINE=function(t,e,a){var i=[],r={DrawData:i,DrawType:"DRAWCOLORKLINE",IsEmptyBar:!(0==a),Color:e};if(Array.isArray(t))for(var n=0;n<t.length&&n<this.SymbolData.Data.Data.length;++n){i[n]=null;var s=t[n];if(s){var o=this.SymbolData.Data.Data[n];o&&(i[n]={Open:o.Open,High:o.High,Low:o.Low,Close:o.Close})}}else if(t)for(n=0;n<this.SymbolData.Data.Data.length;++n){i[n]=null;o=this.SymbolData.Data.Data[n];o&&(i[n]={Open:o.Open,High:o.High,Low:o.Low,Close:o.Close})}return r},this.POLYLINE=function(t,e){var a=[],i={DrawData:a,DrawType:"POLYLINE"},r="number"==typeof e,n=!1;if(r)for(var s in t)if(a[s]=null,0==n){if(!t[s])continue;a[s]=e,n=!0}else a[s]=e;else{var o={Start:{},End:{},List:new Array};for(var h in t)if(a[h]=null,0==n){if(null==t[h]||!t[h])continue;if(h>=e.length||!this.IsNumber(e[h]))continue;n=!0,o.Start={ID:parseInt(h),Value:e[h]}}else if(1==n){if(null==t[h]||!t[h])continue;if(h>=e.length||!this.IsNumber(e[h]))continue;o.End={ID:parseInt(h),Value:e[h]};var l=this.CalculateDrawLine(o);for(var u in l){var C=l[u];a[C.ID]=C.Value}var D={ID:o.End.ID,Value:o.End.Value};o={Start:D,End:{}}}}return i},this.DRAWNUMBER=function(t,e,a,i){var r={Value:[],Text:[]},n={DrawData:r,DrawType:"DRAWNUMBER"},s=2;D.IFrameSplitOperator.IsNumber(i)&&(s=i);var o={DataType:0,SingleValue:null,ArrayValue:null};Array.isArray(e)?(o.ArrayValue=e,o.DataType=2):("TOP"!==e&&"BOTTOM"!==e||(n.FixedPosition=e),o.SingleValue=e,o.DataType=1);var h={DataType:0,SingleValue:null,ArrayValue:null};if(Array.isArray(a)?(h.ArrayValue=a,h.DataType=2):(h.SingleValue=a,h.DataType=1,D.IFrameSplitOperator.IsNumber(a)&&(D.IFrameSplitOperator.IsInteger(a)?h.SingleValue=a.toString():text=a.toFixed(s))),Array.isArray(t))for(var l=0;l<t.length;++l)r.Value[l]=null,t[l]&&(r.Value[l]=this.DRAWNUMBER_Temp_PriceItem(l,o),r.Text[l]=this.DRAWNUMBER_Temp_NumberItem(l,h,s));else if(this.IsNumber(t)&&t)for(l=0;l<this.SymbolData.Data.Data.length;++l)r.Value[l]=this.DRAWNUMBER_Temp_PriceItem(l,o),r.Text[l]=this.DRAWNUMBER_Temp_NumberItem(l,h,s);return n},this.DRAWNUMBER_Temp_PriceItem=function(t,e){return e?1==e.DataType?e.SingleValue:D.IFrameSplitOperator.IsNonEmptyArray(e.ArrayValue)?e.ArrayValue[t]:null:null},this.DRAWNUMBER_Temp_NumberItem=function(t,e,a){if(!e)return null;if(1==e.DataType)return e.SingleValue;if(!D.IFrameSplitOperator.IsNonEmptyArray(e.ArrayValue))return null;var i=e.ArrayValue[t];return this.IsNumber(i)?D.IFrameSplitOperator.IsInteger(i)?i.toString():i.toFixed(a):i.toString()},this.DRAWICON=function(t,e,a){if(D.IFrameSplitOperator.IsString(a)){var i=a.replace("ICO","");a=parseInt(i)}var r=S.GetDrawTextIcon(a);r||(r={Symbol:"●",Color:"rgb(0,139,69)"});var n=[],s={DrawData:n,DrawType:"DRAWICON",Icon:r,IconID:a};if(t.length<=0)return s;var o="number"==typeof e;if("number"==typeof t){if(!t)return s;for(var h=0;h<this.SymbolData.Data.Data.length;++h)o?n[h]=e:h<e.length&&this.IsNumber(e[h])?n[h]=e[h]:n[h]=null;return s}for(var h in t)n[h]=null,t[h]&&(o?n[h]=e:this.IsNumber(e[h])&&(n[h]=e[h]));return s},this.ICON=function(t,e){if(D.IFrameSplitOperator.IsString(e)){var a=e.replace("ICO","");e=parseInt(a)}var i=S.GetDrawTextIcon(e);i||(i={Symbol:"●",Color:"rgb(0,139,69)"});for(var r=[],n={DrawData:r,DrawType:"ICON",Icon:i},s=0;s<this.SymbolData.Data.Data.length;++s){var o=this.SymbolData.Data.Data[s];o&&(0==t?r[s]=o.Low:1==t&&(r[s]=o.High))}return n},this.DRAWRECTREL=function(t,e,a,i,r){var n={Rect:{Left:Math.min(t,a),Top:Math.min(e,i),Right:Math.max(t,a),Bottom:Math.max(e,i)},Color:r};0==r&&(n.Color=null);var s={DrawData:n,DrawType:"DRAWRECTREL"};return s},this.DRAWTEXTREL=function(t,e,a){var i={Point:{X:t,Y:e}};D.IFrameSplitOperator.IsString(a)?i.Text=a:D.IFrameSplitOperator.IsNonEmptyArray(a)&&(i.Text=a[0]);var r={DrawData:i,DrawType:"DRAWTEXTREL"};return r},this.DRAWTEXTABS=function(t,e,a){var i={Point:{X:t,Y:e}};D.IFrameSplitOperator.IsString(a)?i.Text=a:D.IFrameSplitOperator.IsNonEmptyArray(a)&&(i.Text=a[0]);var r={DrawData:i,DrawType:"DRAWTEXTABS"};return r},this.DRAWGBK=function(t,e,a,i){var r={Color:[],Angle:i};e&&r.Color.push(e),a&&r.Color.push(a);var n={DrawData:null,DrawType:"DRAWGBK"};if(Array.isArray(t))for(var s in t){var o=t[s];if(o){n.DrawData=r;break}}else t&&(n.DrawData=r);return n},this.DRAWGBK2=function(t,e,a,i){var r={Color:[],Angle:i};e&&r.Color.push(e),a&&r.Color.push(a);var n={DrawData:null,DrawType:"DRAWGBK2"};if(Array.isArray(t)){for(var s in r.Data=[],t){var o=t[s];r.Data[s]=o?1:0}n.DrawData=r}else t&&(n.DrawData=r,n.DrawType="DRAWGBK");return n},this.DRAWGBK_DIV=function(t,e,a,i,r){var n={AryColor:[e,a],ColorType:i,FillType:r,Data:[]},s={DrawData:n,DrawType:"DRAWGBK_DIV"};if(!this.SymbolData||!this.SymbolData.Data||!D.IFrameSplitOperator.IsNonEmptyArray(this.SymbolData.Data.Data))return s;var o=this.SymbolData.Data.Data;if(Array.isArray(t))for(var h=0;h<o.length;++h){var l=t[h],u=null;if(l){var C=o[h];u=1==r?{AryValue:[C.High,C.Low]}:2==r?{AryValue:[C.Open,C.Close]}:{AryValue:null}}n.Data[h]=u}else if(t)for(h=0;h<o.length;++h){C=o[h],u=null;u=1==r?{AryValue:[C.High,C.Low]}:2==r?{AryValue:[C.Open,C.Close]}:{AryValue:null},n.Data[h]=u}return s},this.RGB=function(t,e,a){var i="rgb(".concat(t,",").concat(e,",").concat(a,")");return i},this.RGBA=function(t,e,a,i){var r="rgba(".concat(t,",").concat(e,",").concat(a,",").concat(i,")");return r},this.UPCOLOR=function(t){return t},this.DOWNCOLOR=function(t){return t},this.XMOVE=function(t){return t},this.YMOVE=function(t){return t},this.BACKGROUND=function(t,e,a,i,r,n){var s={Margin:[0,1,1,1]};return t&&(s.Color=t),e&&(s.Border=e),D.IFrameSplitOperator.IsNumber(a)&&(s.Margin[2]=a),D.IFrameSplitOperator.IsNumber(i)&&(s.Margin[3]=i),D.IFrameSplitOperator.IsNumber(r)&&(s.Margin[0]=r),D.IFrameSplitOperator.IsNumber(n)&&(s.Margin[1]=n),s},this.CKLINE=function(t,e,a,i){var r={Color:t,LineWidth:1,LineType:0,LineDot:[3,3]};if(D.IFrameSplitOperator.IsPlusNumber(e)&&(r.LineWidth=e),D.IFrameSplitOperator.IsPlusNumber(a)&&(r.LineType=a),i){var n=i.split(","),s=[];for(var o in n){var h=n[o];if(h){var l=parseInt(n[o]);l<=0||s.push(l)}}s.length>0&&(r.LineDotted=s)}r.Data=[];for(o=0;o<this.SymbolData.Data.Data.length;++o){h=this.SymbolData.Data.Data[o];r.Data[o]={High:h.High,Low:h.Low}}return r}}e.Syntax=g,N.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},N.prototype.IsInteger=function(t){return"number"===typeof t&&t%1===0},N.prototype.IsDivideNumber=function(t){return null!=t&&(!isNaN(t)&&0!=t)},N.MOD=function(t,e){if(t<0&&e<0||t>=0&&e>=0){if(parseInt(t)==t&&parseInt(e)==e)return t%e;var a=parseFloat((t-Math.floor(t/e)*e).toFixed(1));return a}var i=Math.abs(t),r=Math.abs(e);a=Math.abs(Math.abs(e)*(Math.floor(i/r)+1)-Math.abs(t));return e<0&&(a=-a),a},N.prototype.IsString=function(t){return!(!t||"string"!=typeof t)},M.prototype.CalculateDrawLine=function(t){t.List=[];for(var e=t.Start.ID;e<=t.End.ID;++e)t.List.push(e);var a=Math.abs(t.Start.Value-t.End.Value),i=t.List.length-1,r=[];if(r.push({ID:t.Start.ID,Value:t.Start.Value}),t.Start.Value>t.End.Value)for(var n=1;n<t.List.length-1;++n){var s=a*(t.List.length-1-n)/i+t.End.Value;r.push({ID:t.List[n],Value:s})}else for(var o=1;o<t.List.length-1;++o){s=a*o/i+t.Start.Value;r.push({ID:t.List[o],Value:s})}return r.push({ID:t.End.ID,Value:t.End.Value}),r},M.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},M.prototype.IsInteger=function(t){return"number"===typeof t&&t%1===0},M.prototype.IsDrawFunction=function(t){var e=new Set(["STICKLINE","DRAWTEXT","SUPERDRAWTEXT","DRAWTEXT_FIX","DRAWLINE","DRAWBAND","DRAWKLINE1","DRAWCOLORKLINE","DRAWKLINE","DRAWKLINE_IF","PLOYLINE","POLYLINE","DRAWNUMBER","DRAWICON","ICON","DRAWRECTREL","DRAWTEXTABS","DRAWTEXTREL","DRAWGBK","DRAWGBK2","DRAWGBK_DIV"]);return!!e.has(t)};var L={YCLOSE:3,OPEN:4,HIGH:5,LOW:6,CLOSE:7,VOL:8,AMOUNT:10,AMPLITUDE:13,INCREASE:14,EXCHANGERATE:37};function x(t,e,a){this.AST=t,this.Execute=a,this.Symbol="600000.sh",this.Name,this.Data=null,this.SourceData=null,this.MarketValue=null,this.Period=0,this.Right=0,this.DataType=0,this.KLineApiUrl=S.Domain+"/API/KLine2",this.MinuteKLineApiUrl=S.Domain+"/API/KLine3",this.RealtimeApiUrl=S.Domain+"/API/stock",this.StockHistoryDayApiUrl=S.Domain+"/API/StockHistoryDay",this.StockHistoryDay3ApiUrl=S.Domain+"/API/StockHistoryDay3",this.StockNewsAnalysisApiUrl=S.CacheDomain+"/cache/newsanalyze",this.MaxRequestDataCount=1e3,this.MaxRequestMinuteDayCount=5,this.LatestData=new Map,this.IndexData,this.MarginData=new Map,this.NewsAnalysisData=new Map,this.ExtendData=new Map,this.ScriptIndexOutData=new Map,this.OtherSymbolData=new Map,this.StockData=new Map,this.NetworkFilter,e&&(e.HQDataType&&(this.DataType=e.HQDataType),e.Data&&(this.Data=e.Data,2!=this.DataType&&(this.Period=e.Data.Period,this.Right=e.Data.Right)),e.SourceData&&(this.SourceData=e.SourceData),e.Symbol&&(this.Symbol=e.Symbol),e.Symbol&&(this.Symbol=e.Symbol),e.MaxRequestDataCount>0&&(this.MaxRequestDataCount=e.MaxRequestDataCount),e.MaxRequestMinuteDayCount>0&&(this.MaxRequestMinuteDayCount=e.MaxRequestMinuteDayCount),e.KLineApiUrl&&(this.KLineApiUrl=e.KLineApiUrl),e.NetworkFilter&&(this.NetworkFilter=e.NetworkFilter),e.DayCount>0&&(this.DayCount=e.DayCount),e.IsApiPeriod&&(this.IsApiPeriod=e.IsApiPeriod)),this.GetLatestDataKey=function(t){t="DYNAINFO-".concat(t);return t},this.GetLatestData=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetLatestDataKey(a);if(this.LatestData.has(i))return this.Execute.RunNextJob();var r=this;u.JSNetwork.HttpRequest({url:r.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","exchangerate","amplitude"],symbol:[this.Symbol]},method:"POST",dataType:"json",success:function(t){r.RecvLatestData(t),r.Execute.RunNextJob()},error:function(t){r.RecvError(t)}})},this.RecvLatestData=function(t){var e=t.data;if(2!=e.ver){if(e.stock&&1==e.stock.length){var a=e.stock[0];a&&(D.IFrameSplitOperator.IsNumber(a.yclose)&&this.LatestData.set(L.YCLOSE,a.yclose),D.IFrameSplitOperator.IsNumber(a.open)&&this.LatestData.set(L.OPEN,a.open),D.IFrameSplitOperator.IsNumber(a.high)&&this.LatestData.set(L.HIGH,a.high),D.IFrameSplitOperator.IsNumber(a.low)&&this.LatestData.set(L.LOW,a.low),D.IFrameSplitOperator.IsNumber(a.price)&&this.LatestData.set(L.CLOSE,a.price),D.IFrameSplitOperator.IsNumber(a.vol)&&this.LatestData.set(L.VOL,a.vol),D.IFrameSplitOperator.IsNumber(a.amount)&&this.LatestData.set(L.AMOUNT,a.amount),D.IFrameSplitOperator.IsNumber(a.increase)&&this.LatestData.set(L.INCREASE,a.increase),D.IFrameSplitOperator.IsNumber(a.exchangerate)&&this.LatestData.set(L.EXCHANGERATE,a.exchangerate),D.IFrameSplitOperator.IsNumber(a.amplitude)&&this.LatestData.set(L.AMPLITUDE,a.amplitude),h.JSConsole.Complier.Log("[JSSymbolData::RecvLatestData] symbol, LatestData",a.symbol,this.LatestData))}}else this.RecvLatestDataVer2(e)},this.RecvLatestDataVer2=function(t){var e=t.data;if(D.IFrameSplitOperator.IsNonEmptyArray(e.data)){for(var a=e.symbol,i=0;i<e.data.length;++i){var r=e.data[i];r&&(D.IFrameSplitOperator.IsNumber(r.id)&&(D.IFrameSplitOperator.IsNumber(r.value)||D.IFrameSplitOperator.IsString(r.value))&&(h.JSConsole.Complier.Log("[JSSymbolData::RecvLatestDataVer2] symbol=".concat(a," DYNAINFO(").concat(r.id,")=").concat(r.value,".")),this.LatestData.set(r.id,r.value)))}h.JSConsole.Complier.Log("[JSSymbolData::RecvLatestDataVer2]",this.LatestData)}},this.GetLatestCacheData=function(t){return this.LatestData&&this.LatestData.has(t)?this.LatestData.get(t):null},this.GetVolRateData=function(t,e){var a=t.ID.toString()+"-VolRate-"+this.Symbol;if(this.ExtendData.has(a))return this.Execute.RunNextJob();var i=this,r=30;if(this.NetworkFilter){var n=this.Data.GetDateRange();r=1;this.DataType==l.HQ_DATA_TYPE.MULTIDAY_MINUTE_ID&&(r=this.DayCount);var s={Name:"JSSymbolData::GetVolRateData",Explain:"分时量比数据(成交量)",Request:{Url:i.KLineApiUrl,Type:"POST",Data:{symbol:i.Symbol,dayCount:r,field:["name","symbol","vol"],period:0,right:0,dateRange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(t){i.RecvVolRateData(t,a),i.Execute.RunNextJob()})),1==s.PreventDefault)return}u.JSNetwork.HttpRequest({url:i.KLineApiUrl,data:{field:["name","symbol","vol"],symbol:i.Symbol,start:-1,count:r},type:"post",dataType:"json",async:!0,success:function(t){i.RecvVolRateData(t,a),i.Execute.RunNextJob()},error:function(t){i.RecvError(t)}})},this.RecvVolRateData=function(t,e){var a=t.data,i=0,r=0,n=new Map;if(2==a.Ver){if(!D.IFrameSplitOperator.IsNonEmptyArray(a.data))return;for(var s=0;s<a.data.length;++s){var o=a.data[s];D.IFrameSplitOperator.IsNonEmptyArray(o)&&(o.length<2||D.IFrameSplitOperator.IsNumber(o[0])&&D.IFrameSplitOperator.IsPlusNumber(o[1])&&n.set(o[0],{AvgVol5:o[1]}))}}else{if(!D.IFrameSplitOperator.IsNonEmptyArray(a.data))return;var l=241;D.IFrameSplitOperator.IsNumber(a.minutecount)&&(l=a.minutecount);s=0;for(var u=0,C=0;s<a.data.length;++s){for(i=0,u=s,C=0;u>=0&&C<5;--u,++C){o=a.data[u];D.IFrameSplitOperator.IsNumber(o[6])&&(i+=o[6])}if(C>0){r=i/C/l;o=a.data[s];n.set(o[0],{AvgVol5:r})}}}n.size>0&&this.ExtendData.set(e,n),h.JSConsole.Complier.Log("[JSSymbolData::RecvVolRateData]",n)},this.GetVolRateCacheData=function(t){var e=O.JOB_DOWNLOAD_VOLR_DATA.toString()+"-VolRate-"+this.Symbol;e&&this.ExtendData.has(e)||this.Execute.ThrowUnexpectedNode(t,"不支持VOLR");for(var a=[],i=this.ExtendData.get(e),r=0,n=0,s=null,o=0,h=0;o<this.Data.Data.length;++o){a[o]=null;var l=this.Data.Data[o];if(n!=l.Date){if(s=null,h=0,r=0,i.has(l.Date)){var u=i.get(l.Date);s=u.AvgVol5}n=l.Date}null!=s&&(r+=l.Vol,a[o]=r/(h+1)/s*100,++h)}return a},this.GetOtherSymbolParam=function(t){var e=t.split("$"),a=new Set(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT","AMO","VOLINSTK"]);if(!a.has(e[1]))return null;var i=e[0];if(6==i.length)"6"==i[0]||"5"==i[0]||"8"==i[0]||"9"==i[0]?i+=".SH":"0"!=i[0]&&"1"!=i[0]&&"2"!=i[0]&&"3"!=i[0]||(i+=".SZ");else if(0==i.indexOf("SZ"))i=i.substr(2)+".SZ";else if(0==i.indexOf("SH"))i=i.substr(2)+".SH";else{if(!(i.indexOf("_")>0))return null;var r=i.split("_");i="".concat(r[1],".").concat(r[0])}return{Symbol:i.toLowerCase(),DataName:e[1]}},this.GetOtherSymbolData=function(t){var e=this.Symbol;if(t.Literal){var a=this.GetOtherSymbolParam(t.Literal.toUpperCase());if(!a){var i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.Literal," Error."))}e=a.Symbol}else{a=t.Args;if(a.length>0){var r=a[0];if(r.Type==g.Literal)e=r.Value;else if(r.Type==g.Identifier){var n=!1;for(var s in this.Arguments){var o=this.Arguments[s];if(o.Name==r.Name){e=o.Value,n=!0;break}}if(!n){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.FunctionName,"() Error: can't read ").concat(r.Name))}}}}if(t.Symbol=e.toLowerCase(),t.Symbol==this.Symbol)return this.Execute.RunNextJob();if(this.OtherSymbolData.has(t.Symbol))return this.Execute.RunNextJob();var h=this;if(this.DataType==l.HQ_DATA_TYPE.KLINE_ID&&l.ChartData.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var C=this.Data.GetDateRange(),D={Name:"JSSymbolData::GetOtherSymbolData",Explain:"指定个股数据",Request:{Data:{symbol:t.Symbol,right:h.Right,period:h.Period,dateRange:C}},Self:this,PreventDefault:!1};if(this.NetworkFilter(D,(function(e){h.RecvOtherSymbolKData(e,t),h.Execute.RunNextJob()})),1==D.PreventDefault)return}u.JSNetwork.HttpRequest({url:h.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:h.MaxRequestDataCount+500},method:"POST",dataType:"json",async:!0,success:function(e){h.RecvOtherSymbolKDayData(e,t),h.Execute.RunNextJob()},error:function(t){h.RecvError(t)}})}else if(l.ChartData.IsMinutePeriod(this.Period,!0)||this.DataType==l.HQ_DATA_TYPE.MINUTE_ID||this.DataType==l.HQ_DATA_TYPE.MULTIDAY_MINUTE_ID){if(this.NetworkFilter){C=this.Data.GetDateRange(),D={Name:"JSSymbolData::GetOtherSymbolData",Explain:"指定个股数据",Request:{Data:{symbol:t.Symbol,right:h.Right,period:h.Period,dateRange:C}},Self:this,PreventDefault:!1};if(this.NetworkFilter(D,(function(e){h.RecvOtherSymbolKData(e,t),h.Execute.RunNextJob()})),1==D.PreventDefault)return}u.JSNetwork.HttpRequest({url:h.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:h.MaxRequestMinuteDayCount+5},method:"POST",dataType:"json",async:!0,success:function(e){h.RecvOtherSymbolKMinuteData(e,t),h.Execute.RunNextJob()},error:function(t){h.RecvError(t)}})}},this.RecvOtherSymbolKData=function(t,e){var a=t.data;h.JSConsole.Complier.Log("[JSSymbolData::RecvOtherSymbolKData] recv data",a);var i=new l.ChartData,r=null,n=this.Period;this.DataType==l.HQ_DATA_TYPE.KLINE_ID&&l.ChartData.IsDayPeriod(this.Period,!0)?(r=this.JsonDataToHistoryData(a),i.DataType=0):(r=this.JsonDataToMinuteHistoryData(a),i.DataType=1,this.DataType!=l.HQ_DATA_TYPE.MINUTE_ID&&this.DataType!=l.HQ_DATA_TYPE.MULTIDAY_MINUTE_ID||(n=4)),i.Period=this.Period,i.Right=this.Right,i.Data=this.Data.FixKData(r,n),this.OtherSymbolData.set(e.Symbol,i)},this.RecvOtherSymbolKDayData=function(t,e){var a=t.data;h.JSConsole.Complier.Log("[JSSymbolData::RecvOtherSymbolKDayData] recv data",a);var i=this.JsonDataToHistoryData(a),r=new l.ChartData;r.DataType=0,r.Data=i;var n=this.SourceData.GetOverlayData(r.Data);if(r.Data=n,l.ChartData.IsDayPeriod(this.Period,!1)){var s=r.GetPeriodData(this.Period);r.Data=s}this.OtherSymbolData.set(e.Symbol,r)},this.RecvOtherSymbolKMinuteData=function(t,e){var a=t.data;h.JSConsole.Complier.Log("[JSSymbolData::RecvOtherSymbolKMinuteData] recv data",a);var i=this.JsonDataToMinuteHistoryData(a),r=new l.ChartData;if(r.DataType=1,r.Data=i,l.ChartData.IsMinutePeriod(this.Period,!1)){var n=r.GetPeriodData(this.Period);r.Data=n}this.OtherSymbolData.set(e.Symbol,r)},this.GetOtherSymolCacheData=function(t){var e,a;if(t.FunctionName){a=t.FunctionName;var i=t.Args;if(i.length<=0)return this.GetSymbolCacheData(a);e=i[0].toString().toLowerCase()}else if(t.Literal){i=this.GetOtherSymbolParam(t.Literal.toUpperCase());if(!i)return[];e=i.Symbol,a=i.DataName}if(e==this.Symbol)return this.GetSymbolCacheData(a);if(!this.OtherSymbolData.has(e))return[];var r=this.OtherSymbolData.get(e),n=e.toUpperCase();switch(a){case"CLOSE":case"C":return r.GetClose();case"VOL":case"V":return c.MARKET_SUFFIX_NAME.IsSHSZ(n)?r.GetVol(100):r.GetVol();case"OPEN":case"O":return r.GetOpen();case"HIGH":case"H":return r.GetHigh();case"LOW":case"L":return r.GetLow();case"AMOUNT":case"AMO":return r.GetAmount();case"VOLINSTK":return r.GetPosition()}},this.GetIndexData=function(){if(this.IndexData)return this.Execute.RunNextJob();var t=this;l.JSCommonData.ChartData.IsDayPeriod(this.Period,!0)?u.JSNetwork.HttpRequest({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","up","down","stop","unchanged"],symbol:"000001.sh",start:-1,count:t.MaxRequestDataCount+500},method:"POST",dataType:"json",success:function(e){t.RecvIndexHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}}):l.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0)&&u.JSNetwork.HttpRequest({url:t.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:"000001.sh",start:-1,count:t.MaxRequestMinuteDayCount+5},method:"POST",dataType:"json",success:function(e){t.RecvIndexMinuteHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})},this.RecvIndexHistroyData=function(t){var e=t.data;h.JSConsole.Complier.Log("[JSSymbolData::RecvIndexHistroyData] recv data",e);var a=this.JsonDataToHistoryData(e);this.IndexData=new l.JSCommonData.ChartData,this.IndexData.DataType=0,this.IndexData.Data=a;var i=this.SourceData.GetOverlayData(this.IndexData.Data);if(this.IndexData.Data=i,l.JSCommonData.ChartData.IsDayPeriod(this.Period,!1)){var r=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=r}},this.RecvIndexMinuteHistroyData=function(t){var e=t.data;h.JSConsole.Complier.Log("[JSSymbolData::RecvIndexMinuteHistroyData] recv data",e);var a=this.JsonDataToMinuteHistoryData(e);if(this.IndexData=new l.JSCommonData.ChartData,this.IndexData.DataType=1,this.IndexData.Data=a,l.JSCommonData.ChartData.IsMinutePeriod(this.Period,!1)){var i=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=i}},this.GetIndexCacheData=function(t){if(!this.IndexData)return new Array;switch(t){case"INDEXA":return this.IndexData.GetAmount();case"INDEXC":return this.IndexData.GetClose();case"INDEXH":return this.IndexData.GetHigh();case"INDEXL":return this.IndexData.GetLow();case"INDEXO":return this.IndexData.GetOpen();case"INDEXV":return this.IndexData.GetVol();case"INDEXADV":return this.IndexData.GetUp();case"INDEXDEC":return this.IndexData.GetDown()}},this.GetIndexIncreaseData=function(t){var e=t.ID.toString()+"-UpCount-"+t.Symbol,a=t.ID.toString()+"-DownCount-"+t.Symbol;if(this.ExtendData.has(e)&&this.ExtendData.has(a))return this.Execute.RunNextJob();var i=t.Symbol;i=i.replace(".CI",".ci");var r=this,n=S.CacheDomain+"/cache/analyze/increaseanalyze/"+i+".json";h.JSConsole.Complier.Log("[JSSymbolData::GetIndexIncreaseData] Get url=",n),u.JSNetwork.HttpRequest({url:n,method:"GET",dataType:"json",success:function(t){r.RecvMinuteIncreaseData(t,{UpKey:e,DownKey:a}),r.Execute.RunNextJob()},error:function(t){r.RecvError(t)}})},this.RecvMinuteIncreaseData=function(t,e){h.JSConsole.Complier.Log("[JSSymbolData::RecvMinuteIncreaseData] recv data",t);var a=t.data;if(a.minute){var i=a.minute;if(i.time&&i.up&&i.down){for(var r=[],n=[],s=0;s<i.time.length;++s)r[s]=i.up[s],n[s]=i.down[s];this.ExtendData.set(e.UpKey,r),this.ExtendData.set(e.DownKey,n)}}},this.GetIndexIncreaseCacheData=function(t,e,a){var i;return"UPCOUNT"==t?i=O.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+"-UpCount-"+e:"DOWNCOUNT"==t&&(i=O.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+"-DownCount-"+e),i&&this.ExtendData.has(i)||this.Execute.ThrowUnexpectedNode(a,"不支持函数"+t+"("+e+")"),this.ExtendData.get(i)},this.GetSymbolData=function(){if(this.Data)return this.Execute.RunNextJob();var t=this;2!==this.DataType?l.JSCommonData.ChartData.IsDayPeriod(this.Period,!0)?u.JSNetwork.HttpRequest({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestDataCount},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}}):l.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0)&&u.JSNetwork.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvMinuteHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}}):u.JSNetwork.HttpRequest({url:t.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","minute","time","minutecount"],symbol:[t.Symbol],start:-1},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvMinuteData(e),t.Execute.RunNextJob()}})},this.RecvHistroyData=function(t){var e=t.data;h.JSConsole.Complier.Log("[JSSymbolData::RecvHistroyData] recv data",e);var a=this.JsonDataToHistoryData(e);if(this.Data=new l.JSCommonData.ChartData,this.Data.DataType=0,this.Data.Data=a,this.SourceData=new l.JSCommonData.ChartData,this.SourceData.Data=a,this.Right>0){var i=this.Data.GetRightDate(this.Right);this.Data.Data=i}if(l.JSCommonData.ChartData.IsDayPeriod(this.Period,!1)){var r=this.Data.GetPeriodData(this.Period);this.Data.Data=r}this.Name=e.name},this.RecvMinuteHistroyData=function(t){var e=t.data;h.JSConsole.Complier.Log("[JSSymbolData::RecvMinuteHistroyData] recv data",e);var a=this.JsonDataToMinuteHistoryData(e);if(this.Data=new l.JSCommonData.ChartData,this.Data.DataType=1,this.Data.Data=a,this.SourceData=new l.JSCommonData.ChartData,this.SourceData.Data=a,l.JSCommonData.ChartData.IsMinutePeriod(this.Period,!1)){var i=this.Data.GetPeriodData(this.Period);this.Data.Data=i}this.Name=e.name},this.RecvMinuteData=function(t){var e=t.data;h.JSConsole.Complier.Log("[JSSymbolData::RecvMinuteData] recv data",e);var a=this.JsonDataToMinuteData(e);this.Data=new l.JSCommonData.ChartData,this.Data.DataType=2,this.Data.Data=a,this.Name=e.stock[0].name},this.GetSymbolCacheData=function(t){if(!this.Data)return new Array;switch(t){case"CLOSE":case"C":return this.Data.GetClose();case"VOL":case"V":return this.Data.GetVol();case"OPEN":case"O":return this.Data.GetOpen();case"HIGH":case"H":return this.Data.GetHigh();case"LOW":case"L":return this.Data.GetLow();case"AMOUNT":case"AMO":return this.Data.GetAmount();case"OPI":case"VOLINSTK":return this.Data.GetPosition();case"ZSTJJ":return this.Data.GetAvPrice();case"SETTLE":case"QHJSJ":return this.Data.GetSettlementPrice();case"ISEQUAL":return this.Data.GetIsEqual();case"ISUP":return this.Data.GetIsUp();case"ISDOWN":return this.Data.GetIsDown()}},this.GetCurrBarsCount=function(){if(!this.Data||!this.Data.Data||!this.Data.Data.length)return new Array;for(var t=this.Data.Data.length,e=[],a=t-1;a>=0;--a)e.push(a);return e},this.GetTotalBarsCount=function(){var t=this.Data.Data.length;return t},this.GetTotalTradeMinuteCount=function(){var t=c.g_MinuteCoordinateData.GetCoordinateData(this.Symbol);return t&&t.Count>0?t.Count-1:242},this.GetBarPos=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)t.push(a+1);return t},this.GetIsLastBar=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)a==e-1?t.push(1):t.push(0);return t},this.GetBarStatus=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)t[a]=0==a?1:a==e-1?2:0;return t},this.GetMarginCacheData=function(t,e){var a=O.GetMarginJobID(t);return a||this.Execute.ThrowUnexpectedNode(e,"不支持MARGIN("+t+")"),this.MarginData.has(a)?this.MarginData.get(a):[]},this.GetMarginData=function(t){if(this.MarginData.has(t))return this.Execute.RunNextJob();h.JSConsole.Complier.Log("[JSSymbolData::GetMarginData] jobID=",t);var e=this,a=["name","date","symbol"];switch(t){case O.JOB_DOWNLOAD_MARGIN_BALANCE:a.push("margin.balance");break;case O.JOB_DOWNLOAD_MARGIN_RATE:a.push("margin.rate");break;case O.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case O.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case O.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case O.JOB_DOWNLOAD_MARGIN_BUY_NET:a.push("margin.buy");break;case O.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case O.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case O.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case O.JOB_DOWNLOAD_MARGIN_SELL_NET:a.push("margin.sell");break}u.JSNetwork.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:a,symbol:[this.Symbol],orderfield:"date"},method:"POST",dataType:"json",async:!0,success:function(a){e.RecvMarginData(a,t),e.Execute.RunNextJob()}})},this.RecvMarginData=function(t,e){var a=t.data;if(a.stock&&1==a.stock.length){var i=a.stock[0],r=new Array,n=[],s=[],o=[];for(var h in i.stockday){var u=i.stockday[h],C=u.margin;if(C){var D=new l.JSCommonData.SingleData;switch(D.Date=u.date,e){case O.JOB_DOWNLOAD_MARGIN_BALANCE:if(!this.IsNumber(C.balance))continue;D.Value=C.balance,r.push(D);break;case O.JOB_DOWNLOAD_MARGIN_RATE:if(!this.IsNumber(C.rate))continue;D.Value=C.rate,r.push(D);break;case O.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case O.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case O.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case O.JOB_DOWNLOAD_MARGIN_BUY_NET:var m=C.buy;if(!m)continue;if(!this.IsNumber(m.balance)||!this.IsNumber(m.amount)||!this.IsNumber(m.repay)||!this.IsNumber(m.net))continue;D.Value=m.balance;var c=new l.JSCommonData.SingleData;c.Date=u.date,c.Value=m.amount;var S=new l.JSCommonData.SingleData;S.Date=u.date,S.Value=m.repay;var f=new l.JSCommonData.SingleData;f.Date=u.date,f.Value=m.net,r.push(D),n.push(c),s.push(S),o.push(f);break;case O.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case O.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case O.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case O.JOB_DOWNLOAD_MARGIN_SELL_NET:var I=C.sell;if(!I)continue;if(!this.IsNumber(I.balance)||!this.IsNumber(I.volume)||!this.IsNumber(I.repay)||!this.IsNumber(I.net))continue;D.Value=m.balance;c=new l.JSCommonData.SingleData;c.Date=u.date,c.Value=m.volume;S=new l.JSCommonData.SingleData;S.Date=u.date,S.Value=m.repay;f=new l.JSCommonData.SingleData;f.Date=u.date,f.Value=m.net,r.push(D),n.push(c),s.push(S),o.push(f);break;default:continue}}}var d=[];for(var T in e===O.JOB_DOWNLOAD_MARGIN_BALANCE||e===O.JOB_DOWNLOAD_MARGIN_RATE?d.push({JobID:e,Data:r}):e===O.JOB_DOWNLOAD_MARGIN_BUY_BALANCE||e===O.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT||e===O.JOB_DOWNLOAD_MARGIN_BUY_REPAY||e===O.JOB_DOWNLOAD_MARGIN_BUY_NET?(d.push({JobID:O.JOB_DOWNLOAD_MARGIN_BUY_BALANCE,Data:r}),d.push({JobID:O.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT,Data:n}),d.push({JobID:O.JOB_DOWNLOAD_MARGIN_BUY_REPAY,Data:s}),d.push({JobID:O.JOB_DOWNLOAD_MARGIN_BUY_NET,Data:o})):e!==O.JOB_DOWNLOAD_MARGIN_SELL_BALANCE&&e!==O.JOB_DOWNLOAD_MARGIN_SELL_VOLUME&&e!==O.JOB_DOWNLOAD_MARGIN_SELL_REPAY&&e!==O.JOB_DOWNLOAD_MARGIN_SELL_NET||(d.push({JobID:O.JOB_DOWNLOAD_MARGIN_SELL_BALANCE,Data:r}),d.push({JobID:O.JOB_DOWNLOAD_MARGIN_SELL_VOLUME,Data:n}),d.push({JobID:O.JOB_DOWNLOAD_MARGIN_SELL_REPAY,Data:s}),d.push({JobID:O.JOB_DOWNLOAD_MARGIN_SELL_NET,Data:o})),d){var p=this.Data.GetFittingData(d[T].Data),v=new l.JSCommonData.ChartData;if(v.Data=p,v.Period=this.Period,v.Period>0){var F=v.GetPeriodSingleData(v.Period);v.Data=F}var g=v.GetValue();this.MarginData.set(d[T].JobID,g)}}},this.GetNewsAnalysisCacheData=function(t,e){var a=O.GetNewsAnalysisID(t);return a||this.Execute.ThrowUnexpectedNode(e,"不支持NEWS("+t+")"),this.NewsAnalysisData.has(a)?this.NewsAnalysisData.get(a):[]},this.GetNewsAnalysisData=function(t){if(this.NewsAnalysisData.has(t))return this.Execute.RunNextJob();var e=this,a=new Map([[O.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE,"negative"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH,"research"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT,"interact"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,"holderchange"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,"holderchange"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER,"trustholder"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING,"Blocktrading"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS,"companynews"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS,"topmanagers"],[O.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE,"Pledge"]]);if(a.has(t)){var i=a.get(t),r=this.StockNewsAnalysisApiUrl+"/"+i+"/"+this.Symbol+".json";u.JSNetwork.HttpRequest({url:r,method:"GET",dataType:"json",async:!0,success:function(a){200==a.statusCode?e.RecvNewsAnalysisData(a,t):e.RecvNewsAnalysisDataError(a,t),e.Execute.RunNextJob()},fail:function(t,a){e.Execute.RunNextJob()}})}else this.Execute.RunNextJob()},this.RecvNewsAnalysisDataError=function(t,e){h.JSConsole.Complier.Log("[JSSymbolData::RecvNewsAnalysisDataError] request error.",t.statusCode);for(var a=[],i=0;i<this.Data.Data.length;++i){var r=new l.JSCommonData.SingleData;r.Date=this.Data.Data[i].Date,r.Value=0,a.push(r)}var n=new l.JSCommonData.ChartData;n.Data=a,this.NewsAnalysisData.set(e,n.GetValue())},this.RecvNewsAnalysisData=function(t,e){var a=t.data;if(a.data&&a.date&&!(a.data.length<=0||a.data.length!=a.date.length))if(h.JSConsole.Complier.Log("[JSSymbolData::RecvNewsAnalysisData] jobID",e,a.update),e==O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE||e==O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2){for(var i=[],r=[],n=0;n<a.data.length;++n){var s=new l.JSCommonData.SingleData;s.Date=a.date[n],s.Value=a.data[n],this.IsNumber(s.Value)&&i.push(s),n<a.data2.length&&(s=new l.JSCommonData.SingleData,s.Date=a.date[n],s.Value=a.data2[n],this.IsNumber(s.Value)&&r.push(s))}var o=this.Data.GetFittingData2(i,0),u=new l.JSCommonData.ChartData;u.Data=o,this.NewsAnalysisData.set(O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,u.GetValue()),o=this.Data.GetFittingData2(r,0),u=new l.JSCommonData.ChartData,u.Data=o,this.NewsAnalysisData.set(O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,u.GetValue())}else{for(i=[],n=0;n<a.data.length;++n){s=new l.JSCommonData.SingleData;s.Date=a.date[n],s.Value=a.data[n],i.push(s)}var C=this.Data.GetFittingData2(i,0);u=new l.JSCommonData.ChartData;u.Data=C,this.NewsAnalysisData.set(e,u.GetValue())}},this.GetStockDataKey=function(t,e){var a=t.FunctionName;if(e.length>0){a+="(";for(var i=0;i<e.length;++i)i>0&&(a+=","),a+=e[i].toString();a+=")"}return a},this.GetFinOne=function(t){var e=this.JobArgumentsToArray(t,3),a=this.GetStockDataKey(t,e);if(this.StockData.has(a))return this.Execute.RunNextJob();var i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetFinOne",Explain:"财务数据FINONE(ID,Y,MMDD)",JobID:t.ID,Request:{Url:i.StockHistoryDayApiUrl,Type:"POST",Data:{Args:e,symbol:this.Symbol,daterange:r}},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(e){i.RecvStockValue(e,t,a,1),i.Execute.RunNextJob()})),1==n.PreventDefault)return}var s=new B({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:a,Callback:function(t,e,a){i.RecvStockValue(t,e,a,1),i.Execute.RunNextJob()},ErrorCallback:function(t){i.AddStockValueError(a,t)}});s.Download()},this.GetFinValue=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetStockDataKey(t,e);if(this.StockData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetFinValue",Explain:"财务数据FINVALUE(ID)",JobID:t.ID,Request:{Url:r.StockHistoryDayApiUrl,Type:"POST",Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){r.RecvStockValue(e,t,i,0),r.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new b({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:i,Callback:function(t,e,a){r.RecvStockValue(t,e,a,0),r.Execute.RunNextJob()},ErrorCallback:function(t){r.AddStockValueError(i,t)}});o.Download()},this.GetFinance=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetStockDataKey(t,e);if(this.StockData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetFinance",Explain:"财务数据FINANCE(ID)",JobID:t.ID,Request:{Url:r.RealtimeApiUrl,Type:"POST",Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){r.RecvStockValue(e,t,i,0),r.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new w({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:e,DataKey:i,Callback:function(t,e,a){r.RecvStockValue(t,e,a,0),r.Execute.RunNextJob()},ErrorCallback:function(t){r.AddStockValueError(i,t)}});o.Download()},this.GetVariantData=function(t){var e=t.VariantName;if(this.StockData.has(e))return this.Execute.RunNextJob();var a=this;if(this.NetworkFilter){var i=this.Data.GetDateRange(),r={Name:"JSSymbolData::GetVariantData",Explain:"变量数据下载",JobID:t.ID,Request:{Url:"数据地址",Type:"POST",Data:{VariantName:t.VariantName,symbol:this.Symbol,daterange:i}},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(i){if(i.Error)a.AddStockValueError(e,i.Error);else{var r=0;D.IFrameSplitOperator.IsNumber(i.DataType)&&(r=i.DataType),a.RecvStockValue(i.Data,t,e,r)}a.Execute.RunNextJob()})),1==r.PreventDefault)return}var n,s=function(t){a.AddStockValueError(e,t)};if("CAPITAL"==t.VariantName||"TOTALCAPITAL"==t.VariantName||"EXCHANGE"==t.VariantName){var o=function(t,e,i){a.RecvStockValue(t,e,i,0),a.Execute.RunNextJob()};n=new w({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:[t.VariantName],DataKey:e,Callback:o,ErrorCallback:s})}else{if("HYBLOCK"!=t.VariantName&&"DYBLOCK"!=t.VariantName&&"GNBLOCK"!=t.VariantName){if("INBLOCK"==t.VariantName){var h="".concat(t.VariantName,", 请对接外部数据.");return this.AddStockValueError(e,h),void this.Execute.RunNextJob()}h="不支持变量".concat(t.VariantName,", 请对接外部数据.");return this.AddStockValueError(e,h),void this.Execute.RunNextJob()}o=function(t,e,i,r){a.RecvStockValue(t,e,i,r),a.Execute.RunNextJob()};n=new V({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:[t.VariantName],DataKey:e,Callback:o,ErrorCallback:s})}n.Download()},this.GetGPJYValue=function(t){var e=this.JobArgumentsToArray(t,3),a=this.GetStockDataKey(t,e);if(this.StockData.has(a))return this.Execute.RunNextJob();var i=this,r=1==e[2]?0:2;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetGPJYValue",Explain:"股票交易类数据GPJYVALUE(ID,N,TYPE)",JobID:t.ID,Request:{Url:i.StockHistoryDayApiUrl,Type:"POST",Data:{Args:e,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){i.RecvStockValue(e,t,a,r),i.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new P({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:a,Callback:function(t,e,a){i.RecvStockValue(t,e,a,r),i.Execute.RunNextJob()},ErrorCallback:function(t){i.AddStockValueError(a,t)}});o.Download()},this.GetCustomVariantData=function(t){var e=t.VariantName;if(this.StockData.has(e))return this.Execute.RunNextJob();var a=S.CustomVariant.Data.get(e),i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetCustomVariantData",Explain:"自定义变量数据下载",JobID:t.ID,Request:{Url:"数据地址",Type:"POST",Data:{VariantName:t.VariantName,symbol:this.Symbol,daterange:r}},Self:this,VariantInfo:a,PreventDefault:!1};this.NetworkFilter(n,(function(a){a.Error?i.AddStockValueError(e,a.Error):i.RecvStockValue(a.Data,t,e,a.DataType),i.Execute.RunNextJob()}))}else this.AddStockValueError(e,"自定义变量".concat(e,"下载失败")),this.Execute.RunNextJob()},this.GetCustomFunctionData=function(t){var e=t.FunctionName,a=S.CustomFunction.Data.get(e);if(!a.IsDownload)return this.Execute.RunNextJob();if(this.StockData.has(e))return this.Execute.RunNextJob();var i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetCustomFunctionData",Explain:"自定义函数数据下载",JobID:t.ID,Request:{Url:"数据地址",Type:"POST",Data:{FunctionName:t.FunctionName,symbol:this.Symbol,daterange:r,JobItem:t}},Self:this,FunctionInfo:a,PreventDefault:!1};this.NetworkFilter(n,(function(a){a.Error?i.AddStockValueError(e,a.Error):i.RecvStockValue(a.Data,t,e,a.DataType),i.Execute.RunNextJob()}))}else this.AddStockValueError(e,"自定义函数".concat(e,"下载失败")),this.Execute.RunNextJob()},this.RecvStockValue=function(t,e,a,i){if(t){if(0==i)if(Array.isArray(t)){var r=this.Data;if(this.DataType==l.HQ_DATA_TYPE.KLINE_ID)if(l.JSCommonData.ChartData.IsDayPeriod(this.Period,!0))C=r.GetFittingFinanceData(t);else{if(!l.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0))return;C=r.GetMinuteFittingFinanceData(t)}else C=r.GetMinuteFittingFinanceData(t);var n=new l.JSCommonData.ChartData;n.Data=C;var s=n.GetValue();if("EXCHANGE"==a)for(var o in s){var u=r.Data[o];s[o]>0&&(s[o]=u.Vol/s[o]*100)}this.StockData.set(a,{Data:s})}else this.StockData.set(a,{Data:t.Value});else if(1==i)this.StockData.set(a,{Data:t.Value});else if(2==i){var C;r=this.Data;if(this.DataType==l.HQ_DATA_TYPE.KLINE_ID)if(l.JSCommonData.ChartData.IsDayPeriod(this.Period,!0))C=r.GetFittingTradeData(t,0,!1);else{if(!l.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0))return;C=r.GetMinuteFittingTradeData(t,0,!1)}else C=r.GetMinuteFittingTradeData(t,0);n=new l.JSCommonData.ChartData;n.Data=C;s=n.GetValue();this.StockData.set(a,{Data:s})}}else h.JSConsole.Complier.Log("[JSSymbolData::RecvStockValue] key=".concat(a," data is null"))},this.AddStockValueError=function(t,e){this.StockData.set(t,{Error:e})},this.GetStockCacheData=function(t){var e;if(t.FunctionName)e=this.GetStockDataKey({FunctionName:t.FunctionName},t.Args);else if(t.VariantName)e=t.VariantName;else{if(!t.CustomName)return null;e=t.CustomName}if(!this.StockData.has(e))return null;var a=this.StockData.get(e);return a.Error&&this.Execute.ThrowUnexpectedNode(t.Node,a.Error),a.Data},this.IsInBlock=function(t,e){var a=this.GetStockCacheData({VariantName:"INBLOCK",Node:e});if(!a)return 0;for(var i=a.split("|"),r=0;r<i.length;++r){var n=i[r];if(n==t)return 1}return 0},this.JobArgumentsToArray=function(t,e){var a=t.Args;if(a.length!=e){var i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.FunctionName,"() Error: argument count error."))}for(var r=[],n=0;n<a.length;++n){var s=a[n];if(this.IsNumber(s))r.push(s);else if(s.Type==g.Literal)r.push(s.Value);else if(s.Type==g.Identifier){var o=!1;for(var h in this.Arguments){var l=this.Arguments[h];if(l.Name==s.Name){r.push(l.Value),o=!0;break}}if(!o){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.FunctionName,"() Error: can't read ").concat(s.Name))}}}return r},this.DownloadCustomAPIData=function(t){if(!this.NetworkFilter)return this.Execute.RunNextJob();var e=[];for(var a in t.Args){var i=t.Args[a];if(i.Type==g.Literal)e.push(i.Value);else{if(i.Type!=g.Identifier)return this.Execute.RunNextJob();var r=!1;for(var n in this.Arguments){var s=this.Arguments[n];if(s.Name==i.Name){e.push(s.Value),r=!0;break}}if(!r){var o=t.Token;this.Execute.ErrorHandler.ThrowError(o.Index,o.Line,0,"LoadAPIData() Error: can't read ".concat(i.Name))}}}var h=this,l={Name:"JSSymbolData::DownloadCustomAPIData",Explain:"下载自定义api数据",Period:this.Period,Right:this.Right,Symbol:this.Symbol,KData:this.Data,Cache:this.CustomAPIData,Args:e,Self:this,PreventDefault:!1};this.NetworkFilter(l,(function(t){h.RecvCustomAPIData(t,e),h.Execute.RunNextJob()})),1!=l.PreventDefault&&this.Execute.RunNextJob()},this.RecvCustomAPIData=function(t,e){if(t&&t.data){var a=t.data,i=this.GenerateCustomAPIKey(e);if(l.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0)){if(!a.date||!a.time)return;var r=a.date;a.time;for(var n in a)if("date"!=n&&"time"!=n)var s=a[n]}else if(l.JSCommonData.ChartData.IsDayPeriod(this.Period,!0)){if(!a.date)return;r=a.date;var o={__Type__:"Object"};for(var n in a)if("date"!=n){s=a[n];if(Array.isArray(s)){var h=this.FittingCustomAPIArray(s,r);o[n]=h}else this.IsNumber(s)&&(o[n]=s)}this.CustomAPIData.set(i,o)}}},this.FittingCustomAPIArray=function(t,e,a){var i,r=this.Data,n=[];for(var s in t){var o=t[s],h=new l.JSCommonData.SingleData;h.Date=e[s],a&&s<a.length&&(h.Time=a[s]),h.Value=o,n.push(h)}if(l.JSCommonData.ChartData.IsDayPeriod(this.Period,!0))i=r.GetFittingData(n);else{if(!l.JSCommonData.ChartData.IsMinutePeriod(this.Period,!0))return null;i=r.GetMinuteFittingData(n)}var u=new l.JSCommonData.ChartData;u.Data=i;var C=u.GetValue();return C},this.ReadIndexFunctionValue=function(t,e){var a={};if("object"===(0,n.default)(t)){if(!this.ReadArgumentValue(t,a))return e.Error=a.Error,!1}else a.Value=t;var i=a.Value.indexOf(".");if(-1!=i){e.Name=a.Value.slice(0,i);var r=a.Value.indexOf("#",i+1);-1!=r?(e.Out=a.Value.slice(i+1,r),e.Period=a.Value.slice(r+1)):e.Out=a.Value.slice(i+1)}else{r=a.Value.indexOf("#");-1!=r?(e.Name=a.Value.slice(0,r),e.Period=a.Value.slice(r+1)):e.Name=a.Value}var s=new Map([["DAY",0],["WEEK",1],["MONTH",2],["SEASON",9],["YEAR",3],["HALFYEAR",22],["WEEK2",21],["MIN1",4],["MIN5",5],["MIN15",6],["MIN30",7],["MIN60",8],["DAY2",40002],["MULTIDAY",40002],["DAY3",40003],["DAY4",40004],["DAY5",40005],["DAY6",40006],["DAY7",40007],["DAY8",40008],["DAY9",40009],["DAY10",40010],["DAY11",40011],["DAY12",40012],["DAY13",40013],["DAY14",40014],["DAY15",40015]]);if(e.Period){if(!s.has(e.Period))return e.Error="".concat(e.Period,", 周期错误"),!1;e.PeriodID=s.get(e.Period)}return!0},this.ReadSymbolArgumentValue=function(t,e){var a={};if("object"===(0,n.default)(t)){if(!this.ReadArgumentValue(t,a))return e.Error=a.Error,!1}else a.Value=t;""==a.Value&&(a.Value=this.Symbol);var i=a.Value;return i.indexOf(".SH")>0?e.Symbol=i.replace(".SH",".sh"):i.indexOf(".SZ")>0?e.Symbol=i.replace(".SZ",".sz"):0==i.indexOf("SH")?e.Symbol=i.slice(2)+".sh":0==i.indexOf("SZ")?e.Symbol=i.slice(2)+".sz":e.Symbol=i,!0},this.ReadIndexArgumentValue=function(t,e){for(var a in e.Args=[],e.SytemIndex.Args){var i=e.SytemIndex.Args[a];e.Args.push({Value:i.Value,Name:i.Name})}if(t.length>2&&e.SytemIndex.Args&&e.SytemIndex.Args.length>0){a=2;for(var r=0;a<t.length&&r<e.SytemIndex.Args.length;++a,++r){var s={};i=t[a];if("object"===(0,n.default)(i)){if(!this.ReadArgumentValue(i,s))return e.Error=s.Error,!1}else s.Value=i;e.Args[r].Value=s.Value}}return!0},this.ReadArgumentValue=function(t,e){if(e.Name=t.Name,t.Type==g.Literal)return e.Value=t.Value,!0;if(t.Type==g.Identifier){var a=!1;for(var i in this.Arguments){var r=this.Arguments[i];if(r.Name==t.Name)return e.Value=r.Value,a=!0,!0}if(!a)return e.Error="can't read ".concat(t.Name),!1}return e.Error="can't read ".concat(t.Name,", type error."),!1},this.ReadIndexFunctionOut=function(t,e){var a={};if("object"===(0,n.default)(t)){if(!this.ReadArgumentValue(t,a))return e.Error=a.Error,!1}else a.Value=t;return e.OutIndex=a.Value,e.Out=null,!0},this.CallMemberScriptIndex=function(t){var e=this;if(t.Member.Object.Type!=g.Identifier||t.Member.Property.Type!=g.Identifier){var a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: 参数错误")}var i=t.Member.Object.Name,r=t.Member.Property.Name;if(""==r||null==r){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: ".concat(i,".").concat(r," 指标输出变量错误"))}if(this.Execute.VarTable.has(i)){var n=this.Execute.VarTable.get(i);if(n.hasOwnProperty(r))return h.JSConsole.Complier.Log("[JSSymbolData::CallMemberScriptIndex] index data ".concat(i,".").concat(r," in cache.")),this.Execute.RunNextJob()}var s=i+"."+r,o={Job:t,PeriodID:this.Period,Symbol:this.Symbol};if(!this.ReadIndexFunctionValue(s,o)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: '".concat(s,"' ").concat(o.Error))}var l=new m.JSIndexScript,u=l.Get(o.Name);if(!u){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: '".concat(s,"' ").concat(o.Name," 指标不存在"))}if(Array.isArray(u.Args)&&u.Args.length>0)for(var C in o.Args=[],u.Args){var D=u.Args[C];o.Args.push({Value:D.Value,Name:D.Name})}h.JSConsole.Complier.Log("[JSSymbolData::CallMemberScriptIndex] call script index",o);var c=this.Data.GetDateRange(),S={HQDataType:this.DataType,Symbol:o.Symbol,Name:"",Right:this.Right,Period:o.PeriodID,Data:null,SourceData:null,Callback:function(t,a,i){e.RecvMemberScriptIndexData(t,a,i),e.Execute.RunNextJob()},CallbackParam:o,Async:!0,MaxRequestDataCount:this.MaxRequestDataCount+60,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount+2,Arguments:o.Args,IsBeforeData:this.IsBeforeData,NetworkFilter:this.NetworkFilter,KLineRange:c};y.Execute(u.Script,S,(function(t,a){e.ExecuteScriptIndexError(t,a)}))},this.CallScriptIndex=function(t){var e=this;if(t.Member)return this.CallMemberScriptIndex(t);if(!t.Args||!(t.Args.length>=2)){var a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() Error: ".concat(t.FunctionName," 参数错误"))}var i={Job:t,PeriodID:this.Period};if(!this.ReadSymbolArgumentValue(t.Args[0],i)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() Error: ".concat(i.Error))}if(!this.ReadIndexFunctionValue(t.Args[1],i)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() Error: ".concat(i.Error))}if("CALCSTOCKINDEX"==t.FunctionName&&!this.ReadIndexFunctionOut(t.Args[2],i)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() Error: ".concat(i.Error))}var r=new m.JSIndexScript,n=r.Get(i.Name);if(!n){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() ".concat(i.Name," 指标不存在"))}if(i.SytemIndex=n,!this.ReadIndexArgumentValue(t.Args,i)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() ".concat(i.Name," 指标参数错误 : ").concat(i.Error," "))}h.JSConsole.Complier.Log("[JSSymbolData::CallScriptIndex] call script index",i);var s=null;if(this.Data&&this.Data.Data.length>0){var o=this.Data.Data[0],l=this.Data.Data[this.Data.Data.length-1];s={Start:{Date:o.Date,Time:o.Time},End:{Date:l.Date,Time:l.Time}}}var u={HQDataType:this.DataType,Symbol:i.Symbol,Name:"",Right:this.Right,Period:i.PeriodID,Data:null,SourceData:null,Callback:function(t,a,i){e.RecvScriptIndexData(t,a,i),e.Execute.RunNextJob()},CallbackParam:i,Async:!0,MaxRequestDataCount:this.MaxRequestDataCount+60,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount+2,Arguments:i.Args,IsBeforeData:this.IsBeforeData,NetworkFilter:this.NetworkFilter,KLineRange:s};y.Execute(i.SytemIndex.Script,u,(function(t,a){e.ExecuteScriptIndexError(t,a)}))},this.RecvMemberScriptIndexData=function(t,e,a){h.JSConsole.Complier.Log("[JSSymbolData::RecvMemberScriptIndexData] ",t,e,a);var i=a.Data.Data,r=t,n=this.Data.FitKLineIndex(i,r,this.Period,e.PeriodID),s=e.Job.Member,o=s.Object.Name,l=(s.Property.Name,{});for(var u in this.Execute.VarTable.has(o)?l=this.Execute.VarTable.get(o):this.Execute.VarTable.set(o,l),n){var C=t[u].Name;e.Period&&(C+="#"+e.Period),l[C]=n[u].Data}},this.RecvScriptIndexData=function(t,e,a){var i=this.GenerateScriptIndexKey(e);h.JSConsole.Complier.Log("[JSSymbolData::RecvScriptIndexData] ",t,e,a,i);var r=a.Data.Data,n=t;if(e.Out){for(var s=0;s<t.length;++s){var o=t[s];if(o.Name==e.Out){n=[o];break}}var l=this.Data.FitKLineIndex(r,n,this.Period,e.PeriodID);this.ScriptIndexOutData.set(i,l[0].Data)}else if(D.IFrameSplitOperator.IsPlusNumber(e.OutIndex)){var u=e.OutIndex-1;n=[t[u]];l=this.Data.FitKLineIndex(r,n,this.Period,e.PeriodID);this.ScriptIndexOutData.set(i,l[0].Data)}else{l=this.Data.FitKLineIndex(r,n,this.Period,e.PeriodID);var C={__Type__:"Object"};for(var s in l){o=l[s];C[o.Name]=o.Data}this.ScriptIndexOutData.set(i,C)}},this.GenerateScriptIndexKey=function(t){var e="",a=t.Args;for(var i in a){e.length>0&&(e+=",");var r=a[i];e+=r.Value.toString()}var n="ALL";t.Out?n=t.Out:D.IFrameSplitOperator.IsPlusNumber(t.OutIndex)&&(n="Out[".concat(t.OutIndex-1,"]"));var s="(".concat(t.Symbol,",").concat(t.PeriodID,"), ").concat(t.Name,"(").concat(e,")=>").concat(n);return s},this.ExecuteScriptIndexError=function(t,e){var a=e.Job.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() ".concat(e.Name," 指标执行错误 : ").concat(t," "))},this.GetScriptIndexOutData=function(t,e,a){var i={PeriodID:this.Period};this.ReadSymbolArgumentValue(t[0],i)||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"() 股票代码错误: ").concat(i.Error)),this.ReadIndexFunctionValue(t[1],i)||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"() 指标错误: ").concat(i.Error)),"CALCSTOCKINDEX"==a&&(this.ReadIndexFunctionOut(t[2],i)||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"() Error: ").concat(i.Error)));var r=new m.JSIndexScript,n=r.Get(i.Name);n||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"() 指标错误: ").concat(i.Name," 指标不存在")),i.SytemIndex=n,this.ReadIndexArgumentValue(t,i)||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"()  指标参数错误: ").concat(i.Error));var s=this.GenerateScriptIndexKey(i);return this.ScriptIndexOutData.has(s)?this.ScriptIndexOutData.get(s):null},this.JsonDataToHistoryData=function(t){for(var e=t.data,a=new Array,i=0;i<e.length;++i){var r=new l.JSCommonData.HistoryData;r.Date=e[i][0],r.Open=e[i][2],r.YClose=e[i][1],r.Close=e[i][5],r.High=e[i][3],r.Low=e[i][4],r.Vol=e[i][6],r.Amount=e[i][7],isNaN(r.Open)||r.Open<=0||(e[i].length>8&&(r.Up=e[i][8]),e[i].length>9&&(r.Down=e[i][9]),e[i].length>10&&(r.Stop=e[i][10]),e[i].length>11&&(r.Unchanged=e[i][11]),a.push(r))}return a},this.JsonDataToMinuteHistoryData=function(t){for(var e=t.data,a=new Array,i=0;i<e.length;++i){var r=new l.JSCommonData.HistoryData;r.Date=e[i][0],r.Open=e[i][2],r.YClose=e[i][1],r.Close=e[i][5],r.High=e[i][3],r.Low=e[i][4],r.Vol=e[i][6],r.Amount=e[i][7],r.Time=e[i][8],a.push(r)}for(var n=0;n<a.length;++n){var s=a[n];if(null==s&&coninue,isNaN(s.Open)||s.Open<=0||isNaN(s.High)||s.High<=0||isNaN(s.Low)||s.Low<=0||isNaN(s.Close)||s.Close<=0||isNaN(s.YClose)||s.YClose<=0)if(0==n)s.YClose>0&&(s.Open=s.YClose,s.High=s.YClose,s.Low=s.YClose,s.Close=s.YClose);else for(var o=n-1;o>=0;--o){var h=a[o];if(null==h&&coninue,h.Open>0&&h.High>0&&h.Low>0&&h.Close>0){s.YClose<=0&&(s.YClose=h.Close),s.Open=h.Open,s.High=h.High,s.Low=h.Low,s.Close=h.Close;break}}}return a},this.JsonDataToMinuteData=function(t){var e=new Array;for(var a in t.stock[0].minute){var i=t.stock[0].minute[a],r=new l.JSCommonData.MinuteData;r.Close=i.price,r.Open=i.open,r.High=i.high,r.Low=i.low,r.Vol=i.vol,r.Amount=i.amount,r.DateTime=0==a?t.stock[0].date.toString()+" 0925":t.stock[0].date.toString()+" "+i.time.toString(),r.Date=t.stock[0].date,r.Time=i.time,r.Increate=i.increate,r.Risefall=i.risefall,r.AvPrice=i.avprice,e[a]=r}return e},this.CODELIKE=function(t){return 0==this.Symbol.indexOf(t)?1:0},this.NAMELIKE=function(t){return this.Name&&0==this.Name.indexOf(t)?1:0},this.SETCODE=function(){return this.Symbol.indexOf(".sh")?1:(this.Symbol.indexOf(".sz"),0)},this.GetSymbol=function(){return this.Symbol},this.GetName=function(){return this.Name},this.TIME=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Time)?t[e]=a.Time:t[e]=0}return t},this.DATE=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];t[e]=a.Date-19e6}return t},this.TIME2=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e];this.IsNumber(a.Time)?t[e]=100*a.Time:t[e]=0}return t},this.DateTime=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=l.ChartData.IsMinutePeriod(this.Period,!0),a=0;a<this.Data.Data.length;++a){var i=this.Data.Data[a];t[a]=e?1e4*i.Date+i.Time:i.Date}return t},this.YEAR=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date/1e4):t[e]=null}return t},this.MONTH=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date%1e4/100):t[e]=null}return t},this.WEEK=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;var e=new Date;for(var a in this.Data.Data){var i=this.Data.Data[a];if(t[a]=null,this.IsNumber(i.Date)){var r=parseInt(i.Date/1e4),n=parseInt(i.Date%1e4/100),s=i.Date%100;e.setFullYear(r,n-1,s),t[a]=e.getDay()}}return t},this.DAYSTOTODAY=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=new Date,a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=0;i<this.Data.Data.length;++i){var r=this.Data.Data[i];if(t[i]=null,this.IsNumber(r.Date)){var n=parseInt(r.Date/1e4),s=parseInt(r.Date%1e4/100),o=r.Date%100,h=new Date(n,s-1,o),l=Math.ceil((a-h)/864e5);t[i]=l}}return t},this.WEEKOFYEAR=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];if(t[e]=null,this.IsNumber(a.Date)){var i=parseInt(a.Date/1e4),r=parseInt(a.Date%1e4/100),n=a.Date%100,s=new Date(i,r-1,n),o=new Date(i,0,1),h=Math.ceil((s-o)/864e5);h+=o.getDay()+1-1;var l=Math.ceil(h/7),u=l;t[e]=u}}return t},this.GetYearWeek=function(t){var e=new Date(t.getFullYear(),0,1),a=t.getDay();0==a&&(a=7);var i=e.getDay();0==i&&(i=7);var r=t.getTime()-e.getTime(),n=Math.floor((r+864e5*(i-a))/864e5);return Math.ceil(n/7)+1},this.REFDATE=function(t,e){var a=null;if(Array.isArray(e)?e.length>0&&(a=e[e.length-1]):this.IsNumber(e)&&(a=e),null==a)return null;a<5e6&&(a+=19e6);var i=null;for(var r in this.Data.Data)if(this.Data.Data[r].Date==a){i=parseInt(r);break}return null==i||i>=t.length?null:t[i]},this.PERIOD=function(){var t=[5,6,7,11,0,1,2,3,4,5,9];return this.Period>=0&&this.Period<=t.length-1?t[this.Period]:this.Period},this.GetDrawNull=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data)t[e]=null;return t}}x.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},x.prototype.IsDivideNumber=function(t){return null!=t&&(!isNaN(t)&&0!=t)},x.prototype.JsonDataToFinance=function(t){for(var e,a=1;a<=4;++a){switch(a){case 1:var i=t.finance1,r=t.announcement1;break;case 2:i=t.finance2,r=t.announcement2;break;case 3:i=t.finance3,r=t.announcement3;break;case 4:i=t.finance4,r=t.announcement4;break;default:break}i&&r&&this.IsNumber(r.year)&&this.IsNumber(r.quarter)&&(e?e.Announcement.year<r.year&&(e={Date:t.date,Finance:i,Announcement:r}):e={Date:t.date,Finance:i,Announcement:r})}return e};var O=(o={JOB_DOWNLOAD_SYMBOL_DATA:1,JOB_DOWNLOAD_INDEX_DATA:2,JOB_DOWNLOAD_SYMBOL_LATEST_DATA:3,JOB_DOWNLOAD_INDEX_INCREASE_DATA:4,JOB_DOWNLOAD_VOLR_DATA:5,JOB_DOWNLOAD_OTHER_SYMBOL_DATA:9,JOB_DOWNLOAD_FINVALUE:301,JOB_DOWNLOAD_FINONE:302,JOB_DOWNLOAD_FINANCE:303,JOB_DOWNLOAD_GPJYVALUE:304,JOB_DOWNLOAD_VARIANT:305,JOB_CUSTOM_FUNCTION_DATA:6e3,JOB_CUSTOM_VARIANT_DATA:6001,JOB_DOWNLOAD_MARGIN_BALANCE:1e3,JOB_DOWNLOAD_MARGIN_RATE:1001,JOB_DOWNLOAD_MARGIN_BUY_BALANCE:1010,JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:1011,JOB_DOWNLOAD_MARGIN_BUY_REPAY:1012,JOB_DOWNLOAD_MARGIN_BUY_NET:1013,JOB_DOWNLOAD_MARGIN_SELL_BALANCE:1020,JOB_DOWNLOAD_MARGIN_SELL_VOLUME:1021,JOB_DOWNLOAD_MARGIN_SELL_REPAY:1022,JOB_DOWNLOAD_MARGIN_SELL_NET:1023,JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:2e3,JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:2001,JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:2002,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:2003,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:2004,JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:2005,JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:2006,JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:2007,JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:2008,JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:2009},(0,r.default)(o,"JOB_CUSTOM_FUNCTION_DATA",6e3),(0,r.default)(o,"JOB_CUSTOM_VARIANT_DATA",6001),(0,r.default)(o,"JOB_DOWNLOAD_CUSTOM_API_DATA",3e4),(0,r.default)(o,"JOB_EXECUTE_INDEX",30010),(0,r.default)(o,"JOB_RUN_SCRIPT",1e4),(0,r.default)(o,"GetMarginJobID",(function(t){var e=new Map([[1,O.JOB_DOWNLOAD_MARGIN_BALANCE],[2,O.JOB_DOWNLOAD_MARGIN_RATE],[3,O.JOB_DOWNLOAD_MARGIN_BUY_BALANCE],[4,O.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT],[5,O.JOB_DOWNLOAD_MARGIN_BUY_REPAY],[6,O.JOB_DOWNLOAD_MARGIN_BUY_NET],[7,O.JOB_DOWNLOAD_MARGIN_SELL_BALANCE],[8,O.JOB_DOWNLOAD_MARGIN_SELL_VOLUME],[9,O.JOB_DOWNLOAD_MARGIN_SELL_REPAY],[10,O.JOB_DOWNLOAD_MARGIN_SELL_NET]]);return e.has(t)?e.get(t):null})),(0,r.default)(o,"GetNewsAnalysisID",(function(t){var e=new Map([[1,O.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE],[2,O.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH],[3,O.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT],[4,O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE],[5,O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2],[6,O.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER],[7,O.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING],[8,O.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS],[9,O.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS],[10,O.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE]]);return e.has(t)?e.get(t):null})),o);function R(t,e){this.AST=t,this.ErrorHandler=new p,this.VarTable=new Map,this.VarDrawTable=new Map,this.OutVarTable=new Array,this.Arguments=[],this.ConstVarTable=new Map([["CLOSE",null],["VOL",null],["OPEN",null],["HIGH",null],["LOW",null],["AMOUNT",null],["AMO",null],["C",null],["V",null],["O",null],["H",null],["L",null],["VOLR",null],["VOLINSTK",null],["OPI",null],["QHJSJ",null],["SETTLE",null],["ZSTJJ",null],["ISEQUAL",null],["ISUP",null],["ISDOWN"],["DATE",null],["YEAR",null],["MONTH",null],["PERIOD",null],["WEEK",null],["TIME",null],["DATETIME",null],["TIME2",null],["WEEKOFYEAR",null],["DAYSTOTODAY",null],["INDEXA",null],["INDEXC",null],["INDEXH",null],["INDEXL",null],["INDEXO",null],["INDEXV",null],["INDEXADV",null],["INDEXDEC",null],["TOTALFZNUM",null],["CURRBARSCOUNT",null],["TOTALBARSCOUNT",null],["ISLASTBAR",null],["BARSTATUS",null],["BARPOS",null],["TOTALCAPITAL",null],["CAPITAL",null],["EXCHANGE",null],["SETCODE",null],["CODE",null],["STKNAME",null],["TQFLAG",null],["HYBLOCK",null],["DYBLOCK",null],["GNBLOCK",null],["FGBLOCK",null],["ZSBLOCK",null],["ZHBLOCK",null],["ZDBLOCK",null],["HYZSCODE",null],["GNBLOCKNUM",null],["FGBLOCKNUM",null],["ZSBLOCKNUM",null],["ZHBLOCKNUM",null],["ZDBLOCKNUM",null],["HYSYL",null],["HYSJL",null],["DRAWNULL",null],["NULL",null],["MACHINEDATE",null],["MACHINETIME",null],["MACHINEWEEK",null]]),this.SymbolData=new x(this.AST,e,this),this.Algorithm=new N(this.ErrorHandler,this.SymbolData),this.Draw=new M(this.ErrorHandler,this.SymbolData),this.JobList=[],this.UpdateUICallback=null,this.CallbackParam=null,this.Interrupt={Exit:!1},e&&(e.Callback&&(this.UpdateUICallback=e.Callback),e.CallbackParam&&(this.CallbackParam=e.CallbackParam),e.Arguments&&(this.Arguments=e.Arguments)),this.Execute=function(){h.JSConsole.Complier.Log("[JSExecute::Execute] JobList",this.JobList),this.RunNextJob()},this.RunNextJob=function(){if(!(this.JobList.length<=0)){var t=this.JobList.shift();switch(t.ID){case O.JOB_DOWNLOAD_SYMBOL_DATA:return this.SymbolData.GetSymbolData();case O.JOB_DOWNLOAD_INDEX_DATA:return this.SymbolData.GetIndexData();case O.JOB_DOWNLOAD_INDEX_INCREASE_DATA:return this.SymbolData.GetIndexIncreaseData(t);case O.JOB_DOWNLOAD_SYMBOL_LATEST_DATA:return this.SymbolData.GetLatestData(t);case O.JOB_DOWNLOAD_VOLR_DATA:return this.SymbolData.GetVolRateData(t);case O.JOB_DOWNLOAD_OTHER_SYMBOL_DATA:return this.SymbolData.GetOtherSymbolData(t);case O.JOB_DOWNLOAD_FINONE:return this.SymbolData.GetFinOne(t);case O.JOB_DOWNLOAD_FINVALUE:return this.SymbolData.GetFinValue(t);case O.JOB_DOWNLOAD_FINANCE:return this.SymbolData.GetFinance(t);case O.JOB_DOWNLOAD_GPJYVALUE:return this.SymbolData.GetGPJYValue(t);case O.JOB_DOWNLOAD_VARIANT:return this.SymbolData.GetVariantData(t);case O.JOB_CUSTOM_VARIANT_DATA:return this.SymbolData.GetCustomVariantData(t);case O.JOB_CUSTOM_FUNCTION_DATA:return this.SymbolData.GetCustomFunctionData(t);case O.JOB_DOWNLOAD_MARGIN_BALANCE:case O.JOB_DOWNLOAD_MARGIN_RATE:case O.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case O.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case O.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case O.JOB_DOWNLOAD_MARGIN_BUY_NET:case O.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case O.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case O.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case O.JOB_DOWNLOAD_MARGIN_SELL_NET:return this.SymbolData.GetMarginData(t.ID);case O.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:case O.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:return this.SymbolData.GetNewsAnalysisData(t.ID);case O.JOB_DOWNLOAD_CUSTOM_API_DATA:return this.SymbolData.DownloadCustomAPIData(t);case O.JOB_EXECUTE_INDEX:return this.SymbolData.CallScriptIndex(t);case O.JOB_RUN_SCRIPT:return this.Run()}}},this.ReadSymbolData=function(t,e){switch(t){case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"OPI":case"VOLINSTK":case"SETTLE":case"QHJSJ":case"ZSTJJ":case"ISEQUAL":case"ISUP":case"ISDOWN":return this.SymbolData.GetSymbolCacheData(t);case"VOLR":return this.SymbolData.GetVolRateCacheData(e);case"INDEXA":case"INDEXC":case"INDEXH":case"INDEXO":case"INDEXV":case"INDEXL":case"INDEXADV":case"INDEXDEC":return this.SymbolData.GetIndexCacheData(t);case"CURRBARSCOUNT":return this.SymbolData.GetCurrBarsCount();case"BARPOS":return this.SymbolData.GetBarPos();case"TOTALBARSCOUNT":return this.SymbolData.GetTotalBarsCount();case"TOTALFZNUM":return this.SymbolData.GetTotalTradeMinuteCount();case"ISLASTBAR":return this.SymbolData.GetIsLastBar();case"BARSTATUS":return this.SymbolData.GetBarStatus();case"TOTALCAPITAL":case"CAPITAL":case"EXCHANGE":case"HYBLOCK":case"DYBLOCK":case"GNBLOCK":case"FGBLOCK":case"ZSBLOCK":case"ZHBLOCK":case"ZDBLOCK":case"HYZSCODE":case"GNBLOCKNUM":case"FGBLOCKNUM":case"ZSBLOCKNUM":case"ZHBLOCKNUM":case"ZDBLOCKNUM":case"HYSYL":case"HYSJL":return this.SymbolData.GetStockCacheData({VariantName:t,Node:e});case"SETCODE":return this.SymbolData.SETCODE();case"CODE":return this.SymbolData.GetSymbol();case"STKNAME":return this.SymbolData.GetName();case"TIME":return this.SymbolData.TIME();case"TIME2":return this.SymbolData.TIME2();case"DATE":return this.SymbolData.DATE();case"DATETIME":return this.SymbolData.DateTime();case"YEAR":return this.SymbolData.YEAR();case"MONTH":return this.SymbolData.MONTH();case"WEEK":return this.SymbolData.WEEK();case"PERIOD":return this.SymbolData.PERIOD();case"DRAWNULL":case"NULL":return this.SymbolData.GetDrawNull();case"TQFLAG":return this.SymbolData.Right;case"MACHINEDATE":var a=new Date;return 1e4*a.getFullYear()+1*a.getMonth()*100+a.getDate()-19e6;case"MACHINETIME":a=new Date;return 1e4*a.getHours()+1*a.getMinutes()*100+a.getSeconds();case"MACHINEWEEK":a=new Date;return a.getDay();case"WEEKOFYEAR":return this.SymbolData.WEEKOFYEAR();case"DAYSTOTODAY":return this.SymbolData.DAYSTOTODAY()}},this.ReadCustomVariant=function(t,e){return this.SymbolData.GetStockCacheData({VariantName:t,Node:e})},this.ReadVariable=function(t,e){if(this.ConstVarTable.has(t)){var a=this.ConstVarTable.get(t);return null==a&&(a=this.ReadSymbolData(t,e),this.ConstVarTable.set(t,a)),a}if(S.IsCustomVariant(t))return this.ReadCustomVariant(t,e);if(this.VarTable.has(t))return this.VarTable.get(t);if(0==t.indexOf("COLOR")){var i=y.ColorVarToRGB(t);if(i)return i}return this.ThrowUnexpectedNode(e,"变量"+t+"不存在"),null},this.ReadMemberVariable=function(t){var e,a=t.Object,i=t.Property;if(e=a.Type==g.BinaryExpression||a.Type==g.LogicalExpression?this.VisitBinaryExpression(a):a.Type==g.CallExpression?this.VisitCallExpression(a):this.GetNodeValue(a),!e)return null;var r=e[i.Name];return r||null},this.SingleDataToArrayData=function(t){for(var e=this.SymbolData.Data.Data.length,a=[],i=0;i<e;++i)a[i]=t;return a},this.RunAST=function(){for(var t in this.Arguments){var e=this.Arguments[t];this.VarTable.set(e.Name,e.Value)}for(var a in this.AST||this.ThrowError(),this.AST.Body||this.ThrowError(),this.AST.Body){var i=this.AST.Body[a];if(this.VisitNode(i),i.Type==g.ExpressionStatement&&i.Expression)if(i.Expression.Type==g.AssignmentExpression&&":"==i.Expression.Operator&&i.Expression.Left){var r=i.Expression,n=r.Left.Name,s=this.VarTable.get(n);if(this.VarDrawTable.has(n)){var o=this.VarDrawTable.get(n);this.OutVarTable.push({Name:o.Name,Draw:o,Type:1})}else{var l=0;if(!Array.isArray(s))if("string"==typeof s){var u=parseFloat(s);D.IFrameSplitOperator.IsNumber(u)?s=this.SingleDataToArrayData(u):(s=this.SingleDataToArrayData(s),l=1001)}else s=this.SingleDataToArrayData(s);this.OutVarTable.push({Name:n,Data:s,Type:l})}}else if(i.Expression.Type==g.CallExpression){var m=i.Expression;if(this.Draw.IsDrawFunction(m.Callee.Name)){var c=m.Draw;c.Name=m.Callee.Name,this.OutVarTable.push({Name:c.Name,Draw:c,Type:1})}else if("IFC"===m.Callee.Name&&m.Draw){var S=m.Draw;S.Name=S.DrawType,this.OutVarTable.push({Name:S.Name,Draw:S,Type:1})}else{var f=m.Out;p="__temp_c_".concat(m.Callee.Name,"_").concat(a,"__");l=0;Array.isArray(f)||(f=this.SingleDataToArrayData(f)),this.OutVarTable.push({Name:p,Data:f,Type:l,NoneName:!0})}}else if(i.Expression.Type==g.Identifier){var I=i.Expression.Name,d=this.ReadVariable(I,i.Expression);l=0;Array.isArray(d)||(d="string"==typeof d?this.SingleDataToArrayData(parseFloat(d)):this.SingleDataToArrayData(d)),I="__temp_i_"+a+"__",this.OutVarTable.push({Name:I,Data:d,Type:l,NoneName:!0})}else if(i.Expression.Type==g.Literal){var T=i.Expression.Value;D.IFrameSplitOperator.IsString(T)&&T.indexOf("$")>0&&(T=this.SymbolData.GetOtherSymolCacheData({Literal:T})),p="__temp_li_"+a+"__";l=0;this.OutVarTable.push({Name:p,Data:T,Type:l,NoneName:!0})}else if(i.Expression.Type==g.BinaryExpression){var p="__temp_b_"+a+"__",v=i.Expression.Out;l=0;Array.isArray(v)||(v=this.SingleDataToArrayData(v)),this.OutVarTable.push({Name:p,Data:v,Type:l,NoneName:!0})}else if(i.Expression.Type==g.LogicalExpression){p="__temp_l_"+a+"__";var F=i.Expression.Out;l=0;Array.isArray(F)||(F=this.SingleDataToArrayData(F)),this.OutVarTable.push({Name:p,Data:F,Type:l,NoneName:!0})}else if(i.Expression.Type==g.SequenceExpression){for(var A=void 0,E=void 0,N=void 0,M=void 0,L=void 0,x=void 0,O=!1,R=!1,y=!1,w=!1,b=!1,B=!1,P=!1,V=!1,G=!1,H=!0,_=!1,k=!1,U=!1,Y=!1,W=!0,X=!1,J=-1,K=-1,z=-1,Z=null,Q=null,q=null,j=null,$=0;$<i.Expression.Expression.length;++$){var tt=i.Expression.Expression[$];if(tt.Type==g.AssignmentExpression&&":"==tt.Operator&&tt.Left){if(0==$){A=tt.Left.Name;var et=this.VarTable.get(A);this.VarDrawTable.has(A)?E=this.VarDrawTable.get(A):Array.isArray(et)||(et=this.SingleDataToArrayData(et),this.VarTable.set(A,et))}}else if(tt.Type==g.Identifier){var at=tt.Name;if("COLORSTICK"===at)O=!0;else if("POINTDOT"===at)R=!0;else if("UPDOWNDOT"==at)y=!0;else if("CIRCLEDOT"===at)w=!0;else if("DOTLINE"==at)k=!0;else if("LINESTICK"===at)b=!0;else if("STICK"===at)B=!0;else if("VOLSTICK"===at)P=!0;else if("LINEAREA"==at)V=!0;else if("STEPLINE"==at)G=!0;else if("DRAWABOVE"===at)X=!0;else if(0==at.indexOf("COLOR"))N=at;else if(0==at.indexOf("RGBX")&&10==at.length)N=at;else if(0==at.indexOf("LINETHICK"))x=at;else if("ALIGN0"==at)J=0;else if("ALIGN1"==at)J=1;else if("ALIGN2"==at)J=2;else if("VALIGN0"==at)K=0;else if("VALIGN1"==at)K=1;else if("VALIGN2"==at)K=2;else if(0==at.indexOf("NODRAW"))H=!1;else if(0==at.indexOf("EXDATA"))_=!0;else if(0==at.indexOf("LINEOVERLAY"))U=!0;else if(0==at.indexOf("NOTEXT")||0==at.indexOf("NOTITLE"))W=!1;else if(0==at.indexOf("FONTSIZE")){var it=at.replace("FONTSIZE","");z=parseInt(it)}else if(0==$){A=tt.Name;var rt=this.ReadVariable(A,tt);Array.isArray(rt)||(rt=this.SingleDataToArrayData(rt)),A="__temp_si_"+a+"__",Y=!0,this.VarTable.set(A,rt)}}else if(tt.Type==g.Literal){if(0==$){var nt=this.SingleDataToArrayData(tt.Value);A=tt.Value.toString(),this.VarTable.set(A,nt)}}else if(tt.Type==g.CallExpression)if(0==$)if(this.Draw.IsDrawFunction(tt.Callee.Name))E=tt.Draw,E.Name=tt.Callee.Name;else{var st=tt.Out;A="__temp_sc_".concat(tt.Callee.Name,"_").concat(a,"__"),Y=!0,this.VarTable.set(A,st)}else if("RGB"==tt.Callee.Name||"RGBA"==tt.Callee.Name)N=tt.Out;else if("UPCOLOR"==tt.Callee.Name)M=tt.Out;else if("DOWNCOLOR"==tt.Callee.Name)L=tt.Out;else if("XMOVE"==tt.Callee.Name)q=tt.Out;else if("YMOVE"==tt.Callee.Name)j=tt.Out;else if("SOUND"==tt.Callee.Name){this.GetSoundEvent();A=null}else if("ICON"==tt.Callee.Name){var ot=this.VarTable.get(A);ot&&(E=this.GetOutIconData(ot,tt.Draw),E&&(E.Name=tt.Callee.Name)),A=null}else"BACKGROUND"==tt.Callee.Name?(Z=tt.Draw,A=null):"CKLINE"==tt.Callee.Name&&(Q=tt.Draw,A=null);else if(tt.Type==g.BinaryExpression&&0==$){A="__temp_sb_"+a+"__";var ht=tt.Out;Y=!0,this.VarTable.set(A,ht)}}if(R&&A){var lt=this.VarTable.get(A),ut={Name:A,Data:lt,Radius:C.g_JSChartResource.POINTDOT.Radius,Type:3};N&&(ut.Color=N),x&&(ut.LineWidth=x),this.OutVarTable.push(ut)}else if(w&&A){var Ct=this.VarTable.get(A),Dt={Name:A,Data:Ct,Radius:C.g_JSChartResource.CIRCLEDOT.Radius,Type:3};N&&(Dt.Color=N),x&&(Dt.LineWidth=x),this.OutVarTable.push(Dt)}else if(y&&A){var mt=this.VarTable.get(A);Array.isArray(mt)||(mt=this.SingleDataToArrayData(mt));var ct={Name:A,Data:mt,Radius:C.g_JSChartResource.CIRCLEDOT.Radius,Type:3,UpDownDot:!0};N&&(ct.Color=N),x&&(ct.LineWidth=x),this.OutVarTable.push(ct)}else if(b&&A){var St=this.VarTable.get(A),ft={Name:A,Data:St,Type:4};N&&(ft.Color=N),x&&(ft.LineWidth=x),this.OutVarTable.push(ft)}else if(B&&A){var It=this.VarTable.get(A),dt={Name:A,Data:It,Type:5};N&&(dt.Color=N),x&&(dt.LineWidth=x),this.OutVarTable.push(dt)}else if(P&&A){var Tt=this.VarTable.get(A),pt={Name:A,Data:Tt,Type:6};N&&(pt.Color=N),M&&(pt.UpColor=M),L&&(pt.DownColor=L),this.OutVarTable.push(pt)}else if(V&&A){var vt=this.VarTable.get(A),Ft={Name:A,Data:vt,Type:9};N&&(Ft.Color=N),M&&(Ft.UpColor=M),L&&(Ft.DownColor=L),x&&(Ft.LineWidth=x),this.OutVarTable.push(Ft)}else if(O&&A){var gt=this.VarTable.get(A),At={Name:A,Data:gt,Color:N,Type:2};x&&(At.LineWidth=x),N&&(At.Color=N),M&&(At.UpColor=M),L&&(At.DownColor=L),this.OutVarTable.push(At)}else if(A&&N&&!E){var Et=this.VarTable.get(A),Nt={Name:A,Data:Et,Color:N,Type:0};x&&(Nt.LineWidth=x),0==H&&(Nt.IsShow=!1),1==_&&(Nt.IsExData=!0),1==k&&(Nt.IsDotLine=!0),1==U&&(Nt.IsOverlayLine=!0),1==Y&&(Nt.NoneName=!0),0==W&&(Nt.IsShowTitle=!1),1==G&&(Nt.Type=7),this.OutVarTable.push(Nt)}else if(E){var Mt={Name:E.Name,Draw:E,Type:1};N&&(Mt.Color=N),x&&(Mt.LineWidth=x),X&&(Mt.IsDrawAbove=!0),J>=0&&(Mt.DrawAlign=J),K>=0&&(Mt.DrawVAlign=K),z>0&&(Mt.DrawFontSize=z),Z&&(Mt.Background=Z),Q&&(Mt.VerticalLine=Q),D.IFrameSplitOperator.IsNumber(q)&&(Mt.XOffset=q),D.IFrameSplitOperator.IsNumber(j)&&(Mt.YOffset=j),this.OutVarTable.push(Mt)}else if(A){var Lt=this.VarTable.get(A),xt={Name:A,Data:Lt,Type:0};N&&(xt.Color=N),x&&(xt.LineWidth=x),0==H&&(xt.IsShow=!1),1==_&&(xt.IsExData=!0),1==k&&(xt.IsDotLine=!0),1==U&&(xt.IsOverlayLine=!0),0==W&&(xt.IsShowTitle=!1),1==G&&(xt.Type=7),this.OutVarTable.push(xt)}}if(this.Interrupt&&this.Interrupt.Exit){h.JSConsole.Complier.Log("[JSExecute::RunAST] Interrupt",this.Interrupt);break}}return h.JSConsole.Complier.Log("[JSExecute::RunAST]",this.VarTable),this.OutVarTable},this.GetOutIconData=function(t,e){if(Array.isArray(t)){for(var a=0;a<t.length&&a<e.DrawData.length;++a){var i=t[a];i<=0&&(e.DrawData[a]=null)}return e}return t?e:null},this.GetSoundEvent=function(){return this.GetEventCallback?this.GetEventCallback(JSCHART_EVENT_ID.ON_PLAY_SOUND):null},this.Run=function(){var t=this.RunAST();h.JSConsole.Complier.Log("[JSComplier.Run] execute finish",t),this.UpdateUICallback&&(h.JSConsole.Complier.Log("[JSComplier.Run] invoke UpdateUICallback."),this.CallbackParam&&this.CallbackParam.Job&&this.CallbackParam.Job.ID==O.JOB_EXECUTE_INDEX?this.UpdateUICallback(t,this.CallbackParam,this.SymbolData):(this.CallbackParam&&this.CallbackParam.Self&&"ScriptIndexConsole"===this.CallbackParam.Self.ClassName&&(this.CallbackParam.JSExecute=this),this.UpdateUICallback(t,this.CallbackParam)))},this.VisitNode=function(t){switch(t.Type){case g.SequenceExpression:this.VisitSequenceExpression(t);break;case g.ExpressionStatement:this.VisitNode(t.Expression);break;case g.AssignmentExpression:this.VisitAssignmentExpression(t);break;case g.BinaryExpression:case g.LogicalExpression:this.VisitBinaryExpression(t);break;case g.CallExpression:this.VisitCallExpression(t);break}},this.VisitSequenceExpression=function(t){for(var e in t.Expression){var a=t.Expression[e];this.VisitNode(a)}},this.VisitCallExpression=function(t){for(var e=t.Callee.Name,a=[],i=0;i<t.Arguments.length;++i){var r=t.Arguments[i],n=void 0;if("IFC"===e&&i>=1)break;n=r.Type==g.BinaryExpression||r.Type==g.LogicalExpression?this.VisitBinaryExpression(r):r.Type==g.CallExpression?this.VisitCallExpression(r):this.GetNodeValue(r),a.push(n)}if("IFC"===e){var s,o=this.Algorithm.IFC(a[0]),h=o?t.Arguments[1]:t.Arguments[2];return s=h.Type==g.BinaryExpression||h.Type==g.LogicalExpression?this.VisitBinaryExpression(h):h.Type==g.CallExpression?this.VisitCallExpression(h):this.GetNodeValue(h),t.Out=s,h.Draw&&(t.Draw=h.Draw),t.Out}if(S.IsCustomFunction(e)){var l=this.Algorithm.CallCustomFunction(e,a,this.SymbolData,t);return t.Out=[],t.Draw=null,l&&(l.Out&&(t.Out=l.Out),l.Draw&&(t.Draw=l.Draw)),t.Out}switch(e){case"DYNAINFO":t.Out=this.SymbolData.GetLatestCacheData(a[0]);break;case"STICKLINE":t.Draw=this.Draw.STICKLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXT":t.Draw=this.Draw.DRAWTEXT(a[0],a[1],a[2]),t.Out=[];break;case"SUPERDRAWTEXT":t.Draw=this.Draw.SUPERDRAWTEXT(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXT_FIX":t.Draw=this.Draw.DRAWTEXT_FIX(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWICON":t.Draw=this.Draw.DRAWICON(a[0],a[1],a[2]),t.Out=[];break;case"ICON":t.Draw=this.Draw.ICON(a[0],a[1]),t.Out=[];break;case"BACKGROUND":t.Draw=this.Draw.BACKGROUND(a[0],a[1],a[2],a[3],a[4],a[5]),t.Out=[];break;case"CKLINE":t.Draw=this.Draw.CKLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWLINE":t.Draw=this.Draw.DRAWLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=t.Draw.DrawData;break;case"DRAWBAND":t.Draw=this.Draw.DRAWBAND(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWKLINE":case"DRAWKLINE1":t.Draw=this.Draw.DRAWKLINE(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWKLINE_IF":t.Draw=this.Draw.DRAWKLINE_IF(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWCOLORKLINE":t.Draw=this.Draw.DRAWCOLORKLINE(a[0],a[1],a[2]),t.Out=[];break;case"PLOYLINE":case"POLYLINE":t.Draw=this.Draw.POLYLINE(a[0],a[1]),t.Out=t.Draw.DrawData;break;case"DRAWNUMBER":t.Draw=this.Draw.DRAWNUMBER(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Value;break;case"RGB":t.Out=this.Draw.RGB(a[0],a[1],a[2]);break;case"RGBA":t.Out=this.Draw.RGBA(a[0],a[1],a[2],a[3]);break;case"UPCOLOR":t.Out=this.Draw.UPCOLOR(a[0]);break;case"DOWNCOLOR":t.Out=this.Draw.DOWNCOLOR(a[0]);break;case"XMOVE":t.Out=this.Draw.XMOVE(a[0]);break;case"YMOVE":t.Out=this.Draw.YMOVE(a[0]);break;case"DRAWRECTREL":t.Draw=this.Draw.DRAWRECTREL(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXTREL":t.Draw=this.Draw.DRAWTEXTREL(a[0],a[1],a[2]),t.Out=[];break;case"DRAWTEXTABS":t.Draw=this.Draw.DRAWTEXTABS(a[0],a[1],a[2]),t.Out=[];break;case"DRAWGBK":t.Draw=this.Draw.DRAWGBK(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWGBK2":t.Draw=this.Draw.DRAWGBK2(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWGBK_DIV":t.Draw=this.Draw.DRAWGBK_DIV(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"CODELIKE":t.Out=this.SymbolData.CODELIKE(a[0]);break;case"NAMELIKE":case"NAMEINCLUDE":t.Out=this.SymbolData.NAMELIKE(a[1]);break;case"REFDATE":t.Out=this.SymbolData.REFDATE(a[0],a[1]);break;case"FINANCE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:1,Node:t});break;case"FINVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:1,Node:t});break;case"FINONE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"GPJYVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"MARGIN":t.Out=this.SymbolData.GetMarginCacheData(a[0],t);break;case"NEWS":t.Out=this.SymbolData.GetNewsAnalysisCacheData(a[0],t);break;case"UPCOUNT":case"DOWNCOUNT":t.Out=this.SymbolData.GetIndexIncreaseCacheData(e,a[0],t);break;case"LOADAPIDATA":t.Out=this.SymbolData.GetCustomApiData(a);break;case"STKINDI":case"CALCSTOCKINDEX":t.Out=this.SymbolData.GetScriptIndexOutData(a,t,e);break;case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"AMO":t.Out=this.SymbolData.GetOtherSymolCacheData({FunctionName:e,Args:a});break;case"INBLOCK":t.Out=this.SymbolData.IsInBlock(a[0],t);break;case"TESTSKIP":var u=this.Algorithm.TESTSKIP(a[0],t);if(t.Out=null,u&&(this.Interrupt.Exit=!0,t&&t.Marker)){var C=t.Marker;this.Interrupt.Line=C.Line,this.Interrupt.Index=C.Index,this.Interrupt.Column=C.Column}break;default:t.Out=this.Algorithm.CallFunction(e,a,t);break}return t.Out},this.VisitAssignmentExpression=function(t){var e=t.Left;e.Type!=g.Identifier&&this.ThrowUnexpectedNode(t);var a=e.Name,i=t.Right,r=null,n=null;i.Type==g.BinaryExpression||i.Type==g.LogicalExpression?r=this.VisitBinaryExpression(i):i.Type==g.CallExpression?(r=this.VisitCallExpression(i),i.Draw&&(n=i.Draw)):i.Type==g.Literal?(r=i.Value,D.IFrameSplitOperator.IsString(r)&&i.Value.indexOf("$")>0&&(r=this.SymbolData.GetOtherSymolCacheData({Literal:r}))):i.Type==g.Identifier?r=this.ReadVariable(i.Name,i):i.Type==g.MemberExpression&&(r=this.ReadMemberVariable(i)),n&&this.VarDrawTable.set(a,n),this.VarTable.set(a,r)},this.VisitBinaryExpression=function(t){var e=[];e.push(t);var a=null;while(0!=e.length)if(a=e[e.length-1],a.Left&&t!=a.Left&&t!=a.Right)e.push(a.Left);else if(a.Right&&t!=a.Right)e.push(a.Right);else{var i=e.pop();if(i.Type==g.BinaryExpression){var r=this.GetNodeValue(i.Left),n=this.GetNodeValue(i.Right);switch(i.Out=null,i.Operator){case"-":i.Out=this.Algorithm.Subtract(r,n);break;case"*":i.Out=this.Algorithm.Multiply(r,n);break;case"/":i.Out=this.Algorithm.Divide(r,n);break;case"+":i.Out=this.Algorithm.Add(r,n);break;case">":i.Out=this.Algorithm.GT(r,n);break;case">=":i.Out=this.Algorithm.GTE(r,n);break;case"<":i.Out=this.Algorithm.LT(r,n);break;case"<=":i.Out=this.Algorithm.LTE(r,n);break;case"==":case"=":i.Out=this.Algorithm.EQ(r,n);break;case"!=":case"<>":i.Out=this.Algorithm.NEQ(r,n);break}0}else if(i.Type==g.LogicalExpression){var s=this.GetNodeValue(i.Left),o=this.GetNodeValue(i.Right);switch(i.Out=null,i.Operator){case"&&":case"AND":i.Out=this.Algorithm.And(s,o);break;case"||":case"OR":i.Out=this.Algorithm.Or(s,o);break}0}t=a}return t.Out},this.GetNodeValue=function(t){switch(t.Type){case g.Literal:return t.Value;case g.UnaryExpression:if("-"==t.Operator){var e=this.GetNodeValue(t.Argument);return this.Algorithm.Subtract(0,e)}return t.Argument.Value;case g.Identifier:var a=this.ReadVariable(t.Name,t);return a;case g.BinaryExpression:case g.LogicalExpression:return t.Out;case g.CallExpression:return this.VisitCallExpression(t);case g.MemberExpression:return this.ReadMemberVariable(t);default:this.ThrowUnexpectedNode(t)}},this.ThrowUnexpectedNode=function(t,e){var a=t.Marker,i=e||"执行异常";return this.ErrorHandler.ThrowError(a.Index,a.Line,a.Column,i)},this.ThrowError=function(){}}function y(){}function w(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this.Args[0];switch(t){case 1:case 7:case"EXCHANGE":this.DownloadHistoryData(t);break;case 9:case 18:case 30:case 32:case 33:case 34:case 38:case 40:case 41:case 42:case 43:case"CAPITAL":case"TOTALCAPITAL":case 100:this.DownloadRealtimeData(t);break;default:this.DownloadRealtimeData(t);break}},this.DownloadRealtimeData=function(t){var e=this,a=this.GetFieldList();if(!a)return this.Job.FunctionName2?message="".concat(this.Job.FunctionName2," can't support."):this.Job.FunctionName?message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],") can't support."):message="".concat(this.Args[0]," can't support."),this.ErrorCallback(message),void e.RecvCallback(null,e.Job,e.DataKey);u.JSNetwork.HttpRequest({url:this.RealtimeUrl,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:10},method:"POST",dataType:"json",async:!0,success:function(t){var a=e.RealtimeDataToHQChartData(t.data);e.RecvCallback(a,e.Job,e.DataKey)}})},this.DownloadHistoryData=function(t){var e=this,a=this.GetFieldList();if(!a)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],") can't support."),this.ErrorCallback(message),void e.RecvCallback(null,e.Job,e.DataKey);u.JSNetwork.HttpRequest({url:this.Url,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:200},method:"POST",dataType:"json",async:!0,success:function(t){var a=e.ToHQChartData(t.data);a&&a.sort((function(t,e){return t.Date-e.Date})),e.RecvCallback(a,e.Job,e.DataKey)}})},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 1:return["capital.total","capital.date"];case 7:return["capital.a","capital.date"];case"EXCHANGE":return["capital.a","capital.date"];case 9:return["finance.peruprofit","symbol","date"];case 18:return["finance.percreserve","symbol","date"];case 30:return["finance.nprofit","symbol","date"];case 32:return["finance.peruprofit","symbol","date"];case 33:return["finance.persearning","symbol","date"];case 34:return["finance.pernetasset","symbol","date"];case 38:return["finance.persearning","symbol","date"];case 40:return["capital.a","capital.date","symbol","date","price"];case 41:return["capital.total","capital.date","symbol","date","price"];case"CAPITAL":return["capital.a","capital.date","symbol","date"];case"TOTALCAPITAL":return["capital.total","capital.date","symbol","date"];case 42:return["company.releasedate","symbol","date"];case 43:return["dividendyield","symbol","date"];case 100:return["shareholder","symbol","date"];default:return null}},this.RealtimeDataToHQChartData=function(t,e){if(!t.stock||1!=t.stock.length)return null;var a=t.stock[0],i=(e=this.Args[0],a.date);switch(e){case 9:return a.finance?{Date:i,Value:a.finance.peruprofit}:null;case 18:return a.finance?{Date:i,Value:a.finance.percreserve}:null;case 30:return a.finance?{Date:i,Value:a.finance.nprofit}:null;case 32:return a.finance?{Date:i,Value:a.finance.peruprofit}:null;case 33:return a.finance?{Date:i,Value:a.finance.persearning}:null;case 34:return a.finance?{Date:i,Value:a.finance.pernetasset}:null;case 38:return a.finance?{Date:i,Value:a.finance.persearning}:null;case 40:return a.capital?{Date:i,Value:a.capital.a*a.price}:null;case 41:return a.capital?{Date:i,Value:a.capital.total*a.price}:null;case 42:if(!a.company)return null;var r=a.company.releasedate,n=parseInt(r/1e4),s=parseInt(r%1e4/100),o=r%100,h=new Date(n,s-1,o),l=new Date,u=parseInt((l.getTime()-h.getTime())/864e5);return{Date:i,Value:u+1};case 43:return a.dividendyield?{Date:i,Value:a.dividendyield.quarter4}:null;case 100:return a.shareholder?{Date:i,Value:a.shareholder.count}:null;case"CAPITAL":return a.capital?{Date:i,Value:a.capital.a/100}:null;case"TOTALCAPITAL":return a.capital?{Date:i,Value:a.capital.total/100}:null}},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new Set,i=t.stock[0],r=this.Args[0];for(var n in i.stockday){var s=i.stockday[n],o=this.ToHQChartItemData(s,r);o&&!a.has(o.Date)&&(e.push(o),a.add(o.Date))}return e},this.ToHQChartItemData=function(t,e){if(!t)return null;var a=t.date;switch(e){case 1:return t.capital?{Date:a,Value:t.capital.total}:null;case 7:case"EXCHANGE":return t.capital?{Date:a,Value:t.capital.a}:null;default:return null}}}function b(t){this.Url=t.Url,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],") can't support."),this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey);u.JSNetwork.HttpRequest({url:this.Url,data:{field:e,symbol:[this.Symbol],condition:[{item:["finance","doc","exists","true"]}],start:0,end:200},method:"POST",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e.data);a&&a.sort((function(t,e){return t.Date-e.Date})),t.RecvCallback(a,t.Job,t.DataKey)}})},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new Set,i=t.stock[0];for(var r in i.stockday){var n=i.stockday[r];if(n.announcement1){var s=this.ToHQChartItemData(n.announcement1,n.finance1,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement2){s=this.ToHQChartItemData(n.announcement2,n.finance2,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement3){s=this.ToHQChartItemData(n.announcement3,n.finance3,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement4){s=this.ToHQChartItemData(n.announcement4,n.finance4,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}}return e},this.ToHQChartItemData=function(t,e,a){var i=this.Args[0],r=1e4*t.year,n=t.quarter;switch(n){case 1:r+=331;break;case 2:r+=630;break;case 3:r+=930;break;case 4:r+=1231;break;default:return null}var s={Date:r,Value:0};switch(i){case 0:s.Value=r%1e6;break;case 1:s.Value=e.persearning;break;case 3:s.Value=e.peruprofit;break;case 4:s.Value=e.pernetasset;break;case 5:s.Value=e.percreserve;break;case 6:s.Value=e.woewa;break;case 7:s.Value=e.perccfo;break;case 8:s.Value=e.monetaryfunds;break;case 11:s.Value=e.areceivable;break}return s},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 0:return["finance.date"];case 1:return["finance.persearning"];case 3:return["finance.peruprofit"];case 4:return["finance.pernetasset"];case 5:return["finance.percreserve"];case 6:return["finance.woewa"];case 7:return["finance.perccfo"];case 8:return["finance.monetaryfunds"];case 11:return["finance.areceivable"];default:return null}}}function B(t){this.newMethod=b,this.newMethod(t),delete this.newMethod,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],", ").concat(this.Args[1],", ").concat(this.Args[2],") can't support."),this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey);var a=[{item:["finance","doc","exists","true"]}],i=this.Args[1],r=this.Args[2],n=0,s=3,o=null;0==i&&0==r||(0==i&&r<300?(n=r,s=200):0==r&&i<1e3?o=i:i>1909&&(331==r?(a=[{item:["announcement1.year","int32","eq",i]},{item:["finance1","doc","exists","true"]}],e.push("announcement1.year"),e.push("announcement1.quarter")):630==r?(a=[{item:["announcement2.year","int32","eq",i]},{item:["finance2","doc","exists","true"]}],e.push("announcement2.year"),e.push("announcement2.quarter")):930==r?(a=[{item:["announcement3.year","int32","eq",i]},{item:["finance3","doc","exists","true"]}],e.push("announcement4.year"),e.push("announcement4.quarter")):(a=[{item:["announcement4.year","int32","eq",i]},{item:["finance4","doc","exists","true"]}],e.push("announcement4.year"),e.push("announcement4.quarter")))),u.JSNetwork.HttpRequest({url:this.Url,data:{field:e,symbol:[this.Symbol],condition:a,start:0,end:s},method:"POST",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e.data),i=null;a&&a.length>0&&(a.sort((function(t,e){return e.Date-t.Date})),i=null==o?a[n]:t.GetPreYearData(a,o)),t.RecvCallback(i,t.Job,t.DataKey)}})},this.GetPreYearData=function(t,e){if(331!=e&&630!=e&&930!=e&&1231!=e){for(var a=t[0].Date%1e3,i=(r=1,0);r<t.length;++r){n=t[r];if(n.Date%1e4==a&&(++i,i==e))return n}return null}for(var r in t){var n=t[r];if(n.Date%1e4==e)return n}}}function P(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],", ").concat(this.Args[1],", ").concat(this.Args[2],") can't support."),this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey,!0);u.JSNetwork.HttpRequest({url:this.Url,data:{field:e,symbol:[this.Symbol],orderfield:"date",order:-1,start:0,end:5},method:"POST",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e.data);a&&a.length>0&&a.sort((function(t,e){return t.Date-e.Date})),t.RecvCallback(a,t.Job,t.DataKey)}})},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 1:return["shareholder","date","symbol"];case 2:return["tradedetail.buy","tradedetail.sell","date","symbol"];case 3:return["margin","date","symbol"];case 4:return["blocktrading.amount","blocktrading.price","date","symbol"];default:return null}},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new Set,i=t.stock[0],r=this.Args[0],n=this.Args[1];for(var s in i.stockday){var o=i.stockday[s],h=this.ToHQChartItemData(o,r,n);h&&!a.has(h.Date)&&(e.push(h),a.add(h.Date))}return e},this.ToHQChartItemData=function(t,e,a){if(!t)return null;var i=t.date;switch(e){case 1:return t.shareholder?{Date:i,Value:t.shareholder.count}:null;case 2:return!t.tradedetail&&t.tradedetail[0]?null:0==a?{Date:i,Value:t.tradedetail[0].buy}:{Date:i,Value:t.tradedetail[0].sell};case 3:if(!t.margin)return null;if(0==a){if(t.margin.buy)return{Date:i,Value:t.margin.buy.balance}}else if(t.margin.sell)return{Date:i,Value:t.margin.sell.balance};return null;case 4:return t.blocktrading?0==a?{Date:i,Value:t.blocktrading.price}:{Date:i,Value:t.blocktrading.amount}:null;default:return null}}}function V(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this.Args[0];switch(t){case"HYBLOCK":case"DYBLOCK":case"GNBLOCK":this.DownloadGroupName(t);break}},this.DownloadGroupName=function(t){var e=this,a=["name","symbol"];"HYBLOCK"==t?a.push("industry"):"DYBLOCK"==t?a.push("region"):"GNBLOCK"==t&&a.push("concept"),u.JSNetwork.HttpRequest({url:e.RealtimeUrl,data:{field:a,symbol:[this.Symbol]},method:"post",dataType:"json",async:!0,success:function(t){var a=e.RecvGroupName(t.data);e.RecvCallback(a,e.Job,e.DataKey,1)},error:function(t){e.ErrorCallback(t)}})},this.RecvGroupName=function(t){if(!t.stock||1!=t.stock.length)return null;var e=t.stock[0],a=this.Args[0],i=null;if("HYBLOCK"==a){var r=e.industry;if(!r)return null;for(var n in r){var s=r[n];i=s.name}}else if("DYBLOCK"==a){var o=e.region;if(!o)return null;for(var n in o){s=o[n];i=s.name}}else if("GNBLOCK"==a){var h=e.concept;if(!h)return null;for(var n in i="",h){s=h[n];i.length>0&&(i+=" "),i+=s.name}}return{Value:i}}}e.JS_EXECUTE_JOB_ID=O,y.Tokenize=function(t){h.JSConsole.Complier.Log("[JSComplier.Tokenize]",t);var e=new F(t),a=[];try{while(1){var i=e.GetNextToken();if(!i)break;a.push(i)}}catch(r){}return a},y.Parse=function(t){h.JSConsole.Complier.Log("[JSComplier.Parse]",t);var e=new E(t);e.Initialize();var a=e.ParseScript(),i=a;return i},y.ColorVarToRGB=function(t){var e=new Map([["COLORBLACK","rgb(0,0,0)"],["COLORBLUE","rgb(18,95,216)"],["COLORGREEN","rgb(25,158,0)"],["COLORCYAN","rgb(0,255,198)"],["COLORRED","rgb(238,21,21)"],["COLORMAGENTA","rgb(255,0,222)"],["COLORBROWN","rgb(149,94,15)"],["COLORLIGRAY","rgb(218,218,218)"],["COLORGRAY","rgb(133,133,133)"],["COLORLIBLUE","rgb(94,204,255)"],["COLORLIGREEN","rgb(183,255,190)"],["COLORLICYAN","rgb(154,255,242)"],["COLORLIRED","rgb(255,172,172)"],["COLORLIMAGENTA","rgb(255,145,241)"],["COLORWHITE","rgb(255,255,255)"],["COLORYELLOW","rgb(255,198,0)"]]);if(e.has(t))return e.get(t);if(0==t.indexOf("COLOR")){var a=t.substr(5);if(6!=a.length)return null;var i=a.substr(0,2),r=parseInt(i,16);i=a.substr(2,2);var n=parseInt(i,16);i=a.substr(4,2);var s=parseInt(i,16);return"rgb(".concat(s,",").concat(n,",").concat(r,")")}if(0==t.indexOf("RGBX")){a=t.substr(4);if(6!=a.length)return null;i=a.substr(0,2),s=parseInt(i,16);i=a.substr(2,2);n=parseInt(i,16);i=a.substr(4,2);r=parseInt(i,16);return"rgb(".concat(s,",").concat(n,",").concat(r,")")}return null},y.Execute=function(t,e,a){(function(){try{h.JSConsole.Complier.Log("[JSComplier.Execute] code ",t),h.JSConsole.Complier.Log("[JSComplier.Execute] parser .....");var i=new E(t);i.Initialize();var r=i.ParseScript(),n=r;h.JSConsole.Complier.Log("[JSComplier.Execute] parser finish.",n),h.JSConsole.Complier.Log("[JSComplier.Execute] execute .....");var s=new R(n,e);s.JobList=i.Node.GetDataJobList(),s.JobList.push({ID:O.JOB_RUN_SCRIPT});s.Execute()}catch(o){h.JSConsole.Complier.Log(o),a&&a(o)}})(),h.JSConsole.Complier.Log("[JSComplier.Execute] async execute.")},y.SetDomain=function(t,e){t&&(S.Domain=t),e&&(S.CacheDomain=e)},y.AddFunction=function(t){if(t&&t.Name){var e=t.Name.toUpperCase();S.CustomFunction.Data.set(e,t)}},y.AddVariant=function(t){if(t&&t.Name){var e=t.Name.toUpperCase();S.CustomVariant.Data.set(e,t)}};var G={JSComplier:y,g_JSComplierResource:S};e.JSCommonComplier=G},"6b93":function(t,e,a){var i=a("23e7"),r=a("867a");i({target:"Math",stat:!0},{log10:r})},"6d61":function(t,e,a){"use strict";var i=a("23e7"),r=a("da84"),n=a("e330"),s=a("94ca"),o=a("cb2d"),h=a("f183"),l=a("2266"),u=a("19aa"),C=a("1626"),D=a("7234"),m=a("861d"),c=a("d039"),S=a("1c7e"),f=a("d44e"),I=a("7156");t.exports=function(t,e,a){var d=-1!==t.indexOf("Map"),T=-1!==t.indexOf("Weak"),p=d?"set":"add",v=r[t],F=v&&v.prototype,g=v,A={},E=function(t){var e=n(F[t]);o(F,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(T&&!m(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return T&&!m(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(T&&!m(t))&&e(this,0===t?0:t)}:function(t,a){return e(this,0===t?0:t,a),this})},N=s(t,!C(v)||!(T||F.forEach&&!c((function(){(new v).entries().next()}))));if(N)g=a.getConstructor(e,t,d,p),h.enable();else if(s(t,!0)){var M=new g,L=M[p](T?{}:-0,1)!=M,x=c((function(){M.has(1)})),O=S((function(t){new v(t)})),R=!T&&c((function(){var t=new v,e=5;while(e--)t[p](e,e);return!t.has(-0)}));O||(g=e((function(t,e){u(t,F);var a=I(new v,t,g);return D(e)||l(e,a[p],{that:a,AS_ENTRIES:d}),a})),g.prototype=F,F.constructor=g),(x||R)&&(E("delete"),E("has"),d&&E("get")),(R||L)&&E(p),T&&F.clear&&delete F.clear}return A[t]=g,i({global:!0,constructor:!0,forced:g!=v},A),f(g,t),T||a.setStrong(g,t,d),g}},"6f48":function(t,e,a){"use strict";var i=a("6d61"),r=a("6566");i("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},"85bb":function(t,e,a){"use strict";function i(){}a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.HQIndexFormula=i,a("fb6a"),a("3c65"),i.EMA=function(t,e){var a=[],i=0;if(i>=t.length)return a;for(;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i]))break;var r=i,n=i+1;a[r]=t[r];for(var s=i+1;s<t.length;++s,++r,++n)a[n]=(2*t[n]+(e-1)*a[r])/(e+1);return a},i.SMA=function(t,e,a){for(var i=[],r=0,n=null;r<t.length;++r)if(null!=t[r]&&!isNaN(t[r])){n=t[r],i[r]=n;break}for(++r;r<t.length;++r)i[r]=(a*t[r]+(e-a)*n)/e,n=i[r];return i},i.DMA=function(t,e){var a=[];if(t.length<0||t.length!=e.length)return a;for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&!isNaN(e[i])){a[i]=t[i];break}for(i+=1;i<t.length;++i)null==t[i]||null==e[i]?a[i]=null:t[i]<1?a[i]=e[i]*t[i]+(1-e[i])*a[i-1]:a[i]=t[i];return a},i.HHV=function(t,e){var a=[];if(e>t.length)return a;for(var i=-1e4,r=e,n=0;r<t.length;++r,++n){if(r<e+i)i=t[r]<t[i]?i:r;else for(n=1+(i=r-e+1);n<=r;++n)t[n]>t[i]&&(i=n);a[r]=t[i]}return a},i.LLV=function(t,e){var a=[];if(e>t.length)return a;for(var i=-1e4,r=e;r<t.length;++r,++n){if(r<e+i)i=t[r]>t[i]?i:r;else for(var n=1+(i=r-e+1);n<=r;++n)t[n]<t[i]&&(i=n);a[r]=t[i]}return a},i.REF=function(t,e){var a=[];if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null);return a},i.REFDATE=function(t,e){var a=[];if(t.length<=0)return a;for(var i in e=t.length-1,t)a[i]=t[e];return a},i.SUM=function(t,e){var a=[];if(0==e){a[0]=t[0];for(var i=1;i<t.length;++i)a[i]=a[i-1]+t[i]}else{i=e-1;for(var r=0;i<t.length;++i,++r)for(var n=0;n<e;++n)0==n?a[i]=t[n+r]:a[i]+=t[n+r]}return a},i.ARRAY_SUBTRACT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]||isNaN(t[r])?a[r]=null:a[r]=t[r]-e;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=t[r]-e[r]:a[r]=null}return a},i.ARRAY_GT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]>e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]>e[r]?1:0:a[r]=null}return a},i.ARRAY_GTE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]>=e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]>=e[r]?1:0:a[r]=null}return a},i.ARRAY_LT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]<e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]<e[r]?1:0:a[r]=null}return a},i.ARRAY_LTE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]<=e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]<=e[r]?1:0:a[r]=null}return a},i.ARRAY_EQ=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]==e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]==e[r]?1:0:a[r]=null}return a},i.ARRAY_IF=function(t,e,a){var i=[],r=["number"==typeof e,"number"==typeof a];for(var n in t)t[n]?i[n]=r[0]?e:e[n]:i[n]=r[1]?a:a[n];return i},i.ARRAY_AND=function(t,e){var a=[],i="number"==typeof trueData;if(i)for(var r in t)a[r]=t[r]&&e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]&&e[r]?1:0:a[r]=0}return a},i.ARRAY_OR=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]||e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&t[r]||r<e.length&&e[r]?a[r]=1:a[r]=0}return a},i.ARRAY_MULTIPLY=function(t,e){if(2==arguments.length){var a=[],r="number"==typeof e;if(r)for(var n in t)null==t[n]||isNaN(t[n])?a[n]=null:a[n]=t[n]*e;else{var s=Math.max(t.length,e.length);for(n=0;n<s;++n)n<t.length&&n<e.length?a[n]=t[n]*e[n]:a[n]=null}return a}for(a=i.ARRAY_MULTIPLY(arguments[0],arguments[1]),n=2;n<arguments.length;++n)a=i.ARRAY_MULTIPLY(a,arguments[n]);return a},i.ARRAY_DIVIDE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]/e;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]||isNaN(t[r])||isNaN(e[r])||0==e[r]?a[r]=null:a[r]=t[r]/e[r]:a[r]=null}return a},i.ARRAY_ADD=function(t,e){if(2==arguments.length){var a=[],r="number"==typeof e;if(r)for(var n in t)a[n]=t[n]+e;else{var s=Math.max(t.length,e.length);for(n=0;n<s;++n)n<t.length&&n<e.length?null==t[n]||null==e[n]||isNaN(t[n])||isNaN(e[n])?a[n]=null:a[n]=t[n]+e[n]:a[n]=null}return a}for(a=i.ARRAY_ADD(arguments[0],arguments[1]),n=2;n<arguments.length;++n)a=i.ARRAY_ADD(a,arguments[n]);return a},i.MAX=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]?a[r]=null:a[r]=Math.max(t[r],e);else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=Math.max(t[r],e[r]):a[r]=null}return a},i.MIN=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]?a[r]=null:a[r]=Math.min(t[r],e);else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=Math.min(t[r],e[r]):a[r]=null}return a},i.ABS=function(t){var e=[];for(var a in t)null==t[a]?e[a]=null:e[a]=Math.abs(t[a]);return e},i.MA=function(t,e){for(var a=[],i=0,r=t.length;i<r;i++)if(i<e)a[i]=null;else{for(var n=0,s=0;s<e;s++)n+=t[i-s];a[i]=n/e}return a},i.EXPMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=e;i<t.length;++i)if(null!=t[i]){a[i]=t[i];break}for(i+=1;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},i.EXPMEMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=0;i<t.length;++i)if(t[i]&&!isNaN(t[i]))break;for(var r=0,n=0;i<t.length&&n<e;++n,++i)t[i]&&!isNaN(t[i])?r+=t[i]:r+=t[i-1];for(a[i-1]=r/e;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},i.STD=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.pow(t[n-s]-r[n],2);a[n]=Math.sqrt(i/e)}return a},i.AVEDEV=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.abs(t[n-s]-r[n]);a[n]=i/e}return a},i.COUNT=function(t,e){for(var a=[],i=e-1;i<t.length;++i){for(var r=0,n=0;n<e;++n)t[i-n]&&++r;a[i]=r}return a},i.CROSS=function(t,e){var a=[];if(t.length!=e.length)return[];for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&isNaN(e[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e[i]&&t[i-1]<e[i-1]?1:0;return a},i.MULAR=function(t,e){var a=[];if(t.length<e)return a;for(var i=e;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])){a[i]=t[i];break}for(++i;i<t.length;++i)a[i]=a[i-1]*t[i];return a},i.STICKLINE=function(t,e,a){var i=[];if(t.length<=0)return i;var r="number"==typeof e,n="number"==typeof a;for(var s in t)if(i[s]=null,!isNaN(t[s])&&t[s])if(r&&n)i[s]={Value:e,Value2:a};else if(r&&!n){if(isNaN(a[s]))continue;i[s]={Value:e,Value2:a[s]}}else if(!r&&n){if(isNaN(e[s]))continue;i[s]={Value:e[s],Value2:a}}else{if(isNaN(e[s])||isNaN(a[s]))continue;i[s]={Value:e[s],Value2:a[s]}}return i}},"867a":function(t,e){var a=Math.log,i=Math.LOG10E;t.exports=Math.log10||function(t){return a(t)*i}},8709:function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.CUSTOM_SECOND_PERIOD_START=e.CUSTOM_SECOND_PERIOD_END=e.CUSTOM_MINUTE_PERIOD_START=e.CUSTOM_MINUTE_PERIOD_END=e.CUSTOM_DAY_PERIOD_START=e.CUSTOM_DAY_PERIOD_END=void 0,e.ChartData=u,e.DataPlus=l,e.Guid=function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e.HQ_DATA_TYPE=void 0,e.HistoryData=s,e.JSCommonData=e.JSCHART_EVENT_ID=e.JSCHART_DATA_FIELD_ID=void 0,e.MinuteData=o,e.OVERLAY_STATUS_ID=void 0,e.PhoneDBClick=T,e.Rect=S,e.SingleData=h,e.ToFixedPoint=function(t){return parseInt(t)+.5},e.ToFixedRect=function(t){return.5+t<<0},a("d401"),a("d3b7"),a("25f0"),a("e25e"),a("14d9"),a("4ec9"),a("3ca3"),a("ddb0");var i=a("966c");function r(t){return null!=t&&(!isNaN(t)&&t>0)}function n(t){return null!=t&&!isNaN(t)}function s(){this.Date,this.YClose,this.Open,this.Close,this.High,this.Low,this.Vol,this.Amount,this.Time,this.FlowCapital=0,this.Position=null,this.Stop,this.Up,this.Down,this.Unchanged,this.ExtendData,this.BFactor,this.AFactor,this.ColorData}function o(){this.Close,this.Open,this.High,this.Low,this.Vol,this.Amount,this.DateTime,this.Increase,this.Risefall,this.AvPrice,this.Date,this.Time,this.Position=null,this.YClearing,this.ExtendData}function h(){this.Date,this.Value}function l(){}function u(){this.Data=new Array,this.DataOffset=0,this.Period=0,this.Right=0,this.Symbol,this.Data2=new Array,this.GetCloseMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Close;e[a]=r/t}return e},this.GetVolMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Vol;e[a]=r/t}return e},this.GetAmountMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Amount;e[a]=r/t}return e},this.GetClose=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Close;return t},this.GetYClose=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].YClose;return t},this.GetHigh=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].High;return t},this.GetLow=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Low;return t},this.GetOpen=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Open;return t},this.GetVol=function(t){var e=1;u.IsNumber(t)&&(e=t);var a=[];for(var i in this.Data)a[i]=this.Data[i].Vol/e;return a},this.GetAmount=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Amount;return t},this.GetPosition=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Position;return t},this.GetDate=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Date;return t},this.GetTime=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Time;return t},this.GetUp=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Up;return t},this.GetDown=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Down;return t},this.GetYear=function(){var t=new Array;for(var e in this.Data)t[e]=parseInt(this.Data[e].Date/1e4);return t},this.GetMonth=function(){var t=new Array;for(var e in this.Data)t[e]=parseInt(this.Data[e].Date%1e4/100);return t},this.GetAvPrice=function(){var t=new Array;for(var e in this.Data){var a=this.Data[e].AvPrice;u.IsNumber(a)?t[e]=a:t[e]=0}return t},this.GetSettlementPrice=function(){for(var t=[],e=0;e<this.Data.length;++e)t[e]=this.Data[e].FClose;return t},this.GetIsEqual=function(){for(var t=[],e=0;e<this.Data.length;++e){var a=this.Data[e];t[e]=a.Close==a.Open?1:0}return t},this.GetIsUp=function(){for(var t=[],e=0;e<this.Data.length;++e){var a=this.Data[e];t[e]=a.Close>a.Open?1:0}return t},this.GetIsDown=function(){for(var t=[],e=0;e<this.Data.length;++e){var a=this.Data[e];t[e]=a.Close<a.Open?1:0}return t},this.GetDateRange=function(){if(!this.Data||this.Data.length<=0)return null;var t=this.Data[0],e=this.Data[this.Data.length-1],a={Start:{Date:t.Date},End:{Date:e.Date}};return u.IsNumber(t.Time)&&(a.Start.Time=t.Time),u.IsNumber(e.Time)&&(a.End.Time=e.Time),a},this.GetDateIndex=function(t){for(var e=0,a=0;e<this.Data.length;){var i=this.Data[e].Date;if(a>=t.length)break;var r=t[a];r.Date==i?(r.Index=e,++a):r.Date<i?++a:++e}},this.GetDateTimeIndex=function(t){for(var e=0,a=0;e<this.Data.length;){var i=this.Data[e].Date,r=this.Data[e].Time;if(a>=t.length)break;var n=t[a];n.Date==i&&n.Time==r?(n.Index=e,++a):n.Date<i||n.Date==i&&n.Time<r?++a:++e}},this.GetMinutePeriodData=function(t){if(l.GetMinutePeriodData)return l.GetMinutePeriodData(t,this.Data,this);if(t>m&&t<=c)return this.GetMinuteCustomPeriodData(t-m);var e=[],a=5;if(5==t)a=5;else if(6==t)a=15;else if(7==t)a=30;else if(8==t)a=60;else if(11==t)a=120;else{if(12!=t)return this.Data;a=240}for(var i=!1,r=null,n=null,o=0;o<this.Data.length;){i=!0;for(var h=0;h<a&&o<this.Data.length;++o){i&&(r=new s,e.push(r),i=!1);var u=this.Data[o];if(null!=u){if((925!=u.Time||null!=n&&924==n)&&(930!=u.Time||null!=n&&929==n)&&(1300!=u.Time||null!=n&&1259==n)&&++h,r.Date=u.Date,r.Time=u.Time,n=r.Time,null!=u.Open&&null!=u.Close&&(null==r.Open||null==r.Close?(r.Open=u.Open,r.High=u.High,r.Low=u.Low,r.YClose=u.YClose,r.Close=u.Close,r.Vol=u.Vol,r.Amount=u.Amount,r.Position=u.Position,r.FlowCapital=u.FlowCapital):(r.High<u.High&&(r.High=u.High),r.Low>u.Low&&(r.Low=u.Low),r.Close=u.Close,r.Vol+=u.Vol,r.Amount+=u.Amount,r.Position=u.Position,r.FlowCapital=u.FlowCapital),o+1<this.Data.length)){var C=this.Data[o+1];if(C&&C.Date!=u.Date){++o;break}}}else++h}}return e},this.GetMinuteCustomPeriodData=function(t){for(var e=new Array,a=t,i=!1,r=null,n=0;n<this.Data.length;){i=!0;for(var o=0;o<a&&n<this.Data.length;++n,++o){i&&(r=new s,e.push(r),i=!1);var h=this.Data[n];null!=h&&(r.Date=h.Date,r.Time=h.Time,null!=h.Open&&null!=h.Close&&(null==r.Open||null==r.Close?(r.Open=h.Open,r.High=h.High,r.Low=h.Low,r.YClose=h.YClose,r.Close=h.Close,r.Vol=h.Vol,r.Amount=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position):(r.High<h.High&&(r.High=h.High),r.Low>h.Low&&(r.Low=h.Low),r.Close=h.Close,r.Vol+=h.Vol,r.Amount+=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position)))}}return e},this.GetDayPeriodData=function(t){if(t>C&&t<=D)return this.GetDayCustomPeriodData(t-C);var e=i.MARKET_SUFFIX_NAME.IsBIT(this.Symbol),a=[],r=0,n=2,o=null;for(var h in this.Data){var l=!1,m=this.Data[h];switch(t){case 1:if(e)var c=u.GetSunday(m.Date);else c=u.GetFirday(m.Date);c!=r&&(l=!0,r=c);break;case 21:if(e)c=u.GetSunday(m.Date);else c=u.GetFirday(m.Date);c!=r&&(++n,n>=2&&(l=!0,n=0),r=c);break;case 2:parseInt(m.Date/100)!=parseInt(r/100)&&(l=!0,r=m.Date);break;case 3:parseInt(m.Date/1e4)!=parseInt(r/1e4)&&(l=!0,r=m.Date);break;case 9:var S=u.GetQuarter(m.Date);S=10*parseInt(m.Date/1e4)+S;var f=u.GetQuarter(r);f=10*parseInt(r/1e4)+f,S!=f&&(l=!0,r=m.Date);break}if(l){if(o=new s,o.Date=m.Date,a.push(o),null==m.Open||null==m.Close)continue;o.Open=m.Open,o.High=m.High,o.Low=m.Low,o.YClose=m.YClose,o.Close=m.Close,o.Vol=m.Vol,o.Amount=m.Amount,o.FlowCapital=m.FlowCapital,o.Position=m.Position}else{if(null==o)continue;if(null==m.Open||null==m.Close)continue;null==o.Open||null==o.Close?(o.Open=m.Open,o.High=m.High,o.Low=m.Low,o.YClose=m.YClose,o.Close=m.Close,o.Vol=m.Vol,o.Amount=m.Amount,o.FlowCapital=m.FlowCapital,o.Position=m.Position):(o.High<m.High&&(o.High=m.High),o.Low>m.Low&&(o.Low=m.Low),o.Close=m.Close,o.Vol+=m.Vol,o.Amount+=m.Amount,o.Date=m.Date,o.FlowCapital=m.FlowCapital,o.Position=m.Position)}}return a},this.GetDayCustomPeriodData=function(t){for(var e=[],a=t,i=!1,r=null,n=0;n<this.Data.length;){i=!0;for(var o=0;o<a&&n<this.Data.length;++n,++o){i&&(r=new s,e.push(r),i=!1);var h=this.Data[n];null!=h&&(r.Date=h.Date,null!=h.Open&&null!=h.Close&&(null==r.Open||null==r.Close?(r.Open=h.Open,r.High=h.High,r.Low=h.Low,r.YClose=h.YClose,r.Close=h.Close,r.Vol=h.Vol,r.Amount=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position):(r.High<h.High&&(r.High=h.High),r.Low>h.Low&&(r.Low=h.Low),r.Close=h.Close,r.Vol+=h.Vol,r.Amount+=h.Amount,r.Position=h.Position,r.FlowCapital=h.FlowCapital)))}}return e},this.GetPeriodData=function(t){return 1==t||2==t||3==t||9==t||21==t||t>C&&t<=D?this.GetDayPeriodData(t):5==t||6==t||7==t||8==t||11==t||12==t||t>m&&t<=c?this.GetMinutePeriodData(t):void 0},this.GetRightData=function(t,e){var a=[];if(this.Data.length<=0)return a;if(e&&1==e.AlgorithmType){for(var i=0;i<this.Data.length;++i){var r=this.Data[i],n=1==t?r.BFactor:r.AFactor;a[i]=s.CopyRight(r,n)}return a}if(1==t){var o=this.Data.length-1,h=(n=1,this.Data[o].YClose);for(a[o]=s.Copy(this.Data[o]),--o;o>=0;--o){if(h!=this.Data[o].Close)break;a[o]=s.Copy(this.Data[o]),h=this.Data[o].YClose}for(;o>=0;--o)h!=this.Data[o].Close&&(n*=h/this.Data[o].Close),a[o]=s.CopyRight(this.Data[o],n),h=this.Data[o].YClose}else if(2==t){o=0,n=1;var l=this.Data[o].Close;for(a[o]=s.Copy(this.Data[o]),++o;o<this.Data.length;++o){if(l!=this.Data[o].YClose)break;a[o]=s.Copy(this.Data[o]),l=this.Data[o].Close}for(;o<this.Data.length;++o)l!=this.Data[o].YClose&&(n*=l/this.Data[o].YClose),a[o]=s.CopyRight(this.Data[o],n),l=this.Data[o].Close}return a},this.GetRightDate=this.GetRightData,this.GetOverlayData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i>=t.length)e[a]=new s,e[a].Date=r,++a;else{var n=t[i].Date;n==r?(e[a]=new s,e[a].Date=t[i].Date,e[a].YClose=t[i].YClose,e[a].Open=t[i].Open,e[a].High=t[i].High,e[a].Low=t[i].Low,e[a].Close=t[i].Close,e[a].Vol=t[i].Vol,e[a].Amount=t[i].Amount,e[a].Stop=t[i].Stop,e[a].Up=t[i].Up,e[a].Down=t[i].Down,e[a].Unchanged=t[i].Unchanged,++i,++a):n<r?++i:(e[a]=new s,e[a].Date=r,++a)}}return e},this.GetFittingData=function(t){for(var e=new Array,a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i>=t.length)e[a]=null,++a;else{var n=t[i].Date;if(n==r){var s=new h;s.Date=t[i].Date,s.Value=t[i].Value,e[a]=s,++i,++a}else n<r?++i:(e[a]=new h,e[a].Date=r,++a)}}return e},this.GetFittingData2=function(t,e){for(var a=new Array,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)a[i]=new h,a[i].Date=n,a[i].Value=e,++i;else{var s=t[r].Date;if(s==n){var o=new h;o.Date=t[r].Date,o.Value=t[r].Value,a[i]=o,++r,++i}else s<n?++r:(a[i]=new h,a[i].Date=n,a[i].Value=e,++i)}}return a},this.GetMinuteFittingData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date,n=this.Data[a].Time;if(i>=t.length)e[a]=null,++a;else{var s=t[i].Date,o=t[i].Time,l=t[i];if(s==r&&o==n){var u=new h;u.Date=l.Date,u.Time=l.Time,u.Value=l.Value,e[a]=u,++i,++a}else if(s<r||s==r&&o<n)++i;else{u=new h;u.Date=r,u.Time=n,e[a]=u,++a}}}return e},this.GetFittingFinanceData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i<t.length){var n=t[i].Date;if(r<n){++a;continue}}if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var s=new h;s.Date=r,s.Value=t[i].Value,s.FinanceDate=t[i].Date,e[a]=s,++a}}return e},this.GetMinuteFittingFinanceData=function(t){var e=[];if(!Array.isArray(t)||t.length<=0)return e;var a=0,i=t[0];for(a=0;a<this.Data.length;++a){var r=this.Data[a].Date,n=this.Data[a].Time;if(r>i.Date||r==i.Date&&n>=i.Time)break}for(var s=0;a<this.Data.length;){r=this.Data[a].Date,n=this.Data[a].Time;if(s+1<t.length&&(t[s].Date<r&&t[s+1].Date<=r||t[s].Date==r&&t[s].Time<n&&t[s+1].Time<=n))++s;else{var o=new h;o.Date=r,o.Time=n,s<t.length?(o.Value=t[s].Value,o.FinanceDate=t[s].Date,o.FinanceTime=t[s].Time):(o.Value=null,o.FinanceDate=null,o.FinanceTime=null),e[a]=o,++a}}return e},this.GetFittingMarketValueData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date,n=this.Data[a].Close;if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var s=new h;s.Date=r,s.Value=t[i].Value*n,s.FinanceDate=t[i].Date,e[a]=s,++a}}return e},this.GetFittingMonthData=function(t){for(var e=new Array,a=null,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)e[i]=null,++i;else{var s=t[r].Date;if(s==n){var o=new h;o.Date=t[r].Date,o.Value=t[r].Value,o.Text=t[r].Text,e[i]=o,++r,++i}else if(null!=a&&a<s&&n>s){o=new h;o.Date=n,o.OverlayDate=t[r].Date,o.Value=t[r].Value,o.Text=t[r].Text,e[i]=o,++r,++i}else s<n?++r:(e[i]=new h,e[i].Date=n,++i);a=n}}return e},this.GetValue=function(){var t=new Array;for(var e in this.Data)null==this.Data[e]||null==this.Data[e].Value?t[e]=null:isNaN(this.Data[e].Value)?this.Data[e].Value instanceof Array?t[e]=this.Data[e].Value:t[e]=null:t[e]=this.Data[e].Value;return t},this.GetObject=function(){var t=[];for(var e in this.Data)if(this.Data[e]&&this.Data[e].Value){var a=this.Data[e].Value;t[e]=a}else t[e]=null;return t},this.GetPeriodSingleData=function(t){var e=new Array,a=0,i=null;for(var r in this.Data){var n=!1,s=this.Data[r];if(null!=s&&null!=s.Date){switch(t){case 1:var o=u.GetFirday(s.Date);o!=a&&(n=!0,a=o);break;case 2:parseInt(s.Date/100)!=parseInt(a/100)&&(n=!0,a=s.Date);break;case 3:parseInt(s.Date/1e4)!=parseInt(a/1e4)&&(n=!0,a=s.Date);break}if(n)i=new h,i.Date=s.Date,i.Value=s.Value,e.push(i);else{if(null==i)continue;if(null==s.Value||isNaN(s.Value))continue;(null==i.Value||isNaN(i.Value))&&(i.Value=s.Value)}}}return e},this.GetMinuteAvPrice=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].AvPrice;return t},this.MergeMinuteData=function(t){if(!this.Data||this.Data.length<=0)return this.Data=t,!0;for(var e=this.Data[0],a=0,i=null,r=0;r<t.length;++r){var n=t[r];if(n.Date>e.Date){a=r,i=n;break}if(n.Date==e.Date&&n.Time>=e.Time){a=r,i=n;break}}if(null==i)return!1;var o=null,h=!1;for(r=this.Data.length-1;r>=0;--r){var l=this.Data[r].Date,u=this.Data[r].Time;if(i.Date>l||i.Date==l&&i.Time>=u){o=r,i.Date==l&&i.Time==u&&(h=!0);break}}if(null==o)return!1;var C=o;r=a;if(1==h){n=t[r];C-1>0&&!n.YClose&&(n.YClose=this.Data[C-1].Close);var D=s.Copy(n);this.Data[C]=D,++C,++r}else++C;for(;r<t.length;){n=t[r];if(C>=this.Data.length-1){C-1>0&&!n.YClose&&(n.YClose=this.Data[C-1].YClose);D=s.Copy(n);this.Data[C]=D,++C,++r}else{var m=this.Data[C];m.Date==n.Date&&m.Time==n.Time?(s.CopyTo(m,n),++C,++r):++C}}return!0},this.FitKLineIndex=function(t,e,a,i){for(var r=this.Data.length,n=t.length,s=[u.IsMinutePeriod(a,!0),u.IsMinutePeriod(i,!0)],o=[u.IsDayPeriod(a,!0),u.IsDayPeriod(i,!0)],h=u.GetKLineDataTime(this.Data[0]),l=[],C=n,D=0;D<n;++D){var m=u.GetKLineDataTime(t[D]);if(o[0]&&o[1]||s[0]&&o[1]){if(m.Date>=h.Date){C=D;break}}else if(s[0]&&s[1]){if(m.Date>h.Date){C=D;break}if(m.Date==h.Date&&m.Time>=h.Time){C=D;break}}}D=0;for(var c=C;D<r;){m=u.GetKLineDataTime(this.Data[D]);if(c>=n){var S={Date:m.Date,Time:m.Time,Index:-1};l[D]=S,++D}else{var f=u.GetKLineDataTime(t[c]);if(o[0]&&o[1]||s[0]&&o[1])if(f.Date==m.Date){S={Date:m.Date,Time:m.Time,Index:c,Data2:f.Date,Time2:f.Time};l[D]=S,++D}else if(c+1<n){var I=u.GetKLineDataTime(t[c+1]);if(f.Date<=m.Date&&I.Date>m.Date){S={Date:m.Date,Time:m.Time,Index:c+1,Data2:I.Date,Time2:I.Time};l[D]=S,++D}else if(I.Date<=m.Date)++c;else{S={Date:m.Date,Time:m.Time,Index:-1};l[D]=S,++D}}else++c;else if(s[0]&&s[1])if(f.Date==m.Date&&f.Time==m.Time){S={Date:m.Date,Time:m.Time,Index:c,Data2:f.Date,Time2:f.Time};l[D]=S,++D}else if(c+1<n){I=u.GetKLineDataTime(t[c+1]);if(f.Date<m.Date&&I.Date>m.Date||f.Date==m.Date&&f.Time<m.Time&&I.Date==m.Date&&I.Time>m.Time||f.Date==m.Date&&f.Time<m.Time&&I.Date>m.Date||f.Date<m.Date&&I.Date==m.Date&&I.Time>m.Time){S={Date:m.Date,Time:m.Time,Index:c+1,Data2:I.Date,Time2:I.Time};l[D]=S,++D}else if(I.Date<m.Date||I.Date==m.Date&&I.Time<=m.Time)++c;else{S={Date:m.Date,Time:m.Time,Index:-1};l[D]=S,++D}}else++c}}var d=[];for(var D in e){m=e[D];if(Array.isArray(m.Data)){var T=[];d[D]={Data:T,Name:m.Name};for(c=0;c<l.length;++c){var p=l[c];T[c]=null,p&&p.Index>=0&&p.Index<m.Data.length&&(T[c]=m.Data[p.Index])}}else d[D]={Data:m.Data,Name:m.Name}}return d},this.GetFittingTradeData=function(t,e,a){for(var i=[],r=!1,n=0,s=0;n<this.Data.length;){var o=this.Data[n].Date;if(s<t.length&&t[s].Date>o){var l=new h;l.Date=o,l.Value=e,i[n]=l,++n}else if(s+1<t.length&&t[s].Date<o&&t[s+1].Date<=o)++s,r=!1;else{l=new h;if(l.Date=o,l.Value=e,l.FinanceDate=null,s<t.length){var u=t[s];0==this.Period&&!0===a?u.Date==l.Date&&(l.Value=u.Value,l.FinanceDate=u.Date,r=!0):0==r&&(l.Value=u.Value,l.FinanceDate=u.Date,r=!0)}i[n]=l,++n}}return i},this.GetMinuteFittingTradeData=function(t,e,a){for(var i=[],r=!1,n=0,s=0;n<this.Data.length;){var o=this.Data[n].Date,l=this.Data[n].Time;if(s<t.length&&(t[s].Date>o||t[s].Date==o&&t[s].Time>l)){var u=new h;u.Date=o,u.Time=l,u.Value=e,i[n]=u,++n}else if(s+1<t.length&&(t[s].Date<o&&t[s+1].Date<=o||t[s].Date==o&&t[s].Time<l&&t[s+1].Time<=l))++s,r=!1;else{u=new h;if(u.Date=o,u.FinanceDate=null,u.Time=l,u.Value=e,s<t.length){var C=t[s];4==this.Period&&!0===a?C.Date==u.Date&&C.Time==u.Time&&(u.Value=C.Value,u.FinanceDate=C.Date,u.FinanceTime=C.Time,r=!0):0==r&&(u.Value=C.Value,u.FinanceDate=C.Date,u.FinanceTime=C.Time,r=!0)}i[n]=u,++n}}return i}}s.Copy=function(t){var e=new s;return e.Date=t.Date,n(t.Time)&&(e.Time=t.Time),e.YClose=t.YClose,e.Open=t.Open,e.Close=t.Close,e.High=t.High,e.Low=t.Low,e.Vol=t.Vol,e.Amount=t.Amount,r(t.FlowCapital)&&(e.FlowCapital=t.FlowCapital),r(t.Position)&&(e.Position=t.Position),r(t.Stop)&&(e.Stop=t.Stop),r(t.Up)&&(e.Up=t.Up),r(t.Down)&&(e.Down=t.Down),r(t.Unchanged)&&(e.Unchanged=t.Unchanged),r(t.BFactor)&&(e.BFactor=t.BFactor),r(t.AFactor)&&(e.AFactor=t.AFactor),t.ColorData&&(e.ColorData=t.ColorData),t.ExtendData&&(e.ExtendData=t.ExtendData),e},s.CopyTo=function(t,e){t.Date=e.Date,t.YClose=e.YClose,t.Open=e.Open,t.Close=e.Close,t.High=e.High,t.Low=e.Low,t.Vol=e.Vol,t.Amount=e.Amount,r(e.Time)&&(t.Time=e.Time),r(e.FlowCapital)&&(t.FlowCapital=e.FlowCapital),r(e.Stop)&&(t.Stop=e.Stop),r(e.Up)&&(t.Up=e.Up),r(e.Down)&&(t.Down=e.Down),r(e.Unchanged)&&(t.Unchanged=e.Unchanged),r(e.BFactor)&&(t.BFactor=e.BFactor),r(e.AFactor)&&(t.AFactor=e.AFactor),e.ColorData&&(t.ColorData=e.ColorData),e.ExtendData&&(t.ExtendData=e.ExtendData)},s.CopyRight=function(t,e){var a=new s;return a.Date=t.Date,n(t.Time)&&(a.Time=t.Time),a.YClose=t.YClose*e,a.Open=t.Open*e,a.Close=t.Close*e,a.High=t.High*e,a.Low=t.Low*e,a.Vol=t.Vol,a.Amount=t.Amount,a.FlowCapital=t.FlowCapital,a.Position=t.Position,t.ColorData&&(a.ColorData=t.ColorData),t.ExtendData&&(a.ExtendData=t.ExtendData),a},l.GetMinutePeriodData=null,u.IsNumber=function(t){return null!=t&&!isNaN(t)},u.DateTimeToNumber=function(t){return 1e4*t.Date+t.Time},u.GetKLineDataTime=function(t){var e={Date:t.Date,Time:0};return u.IsNumber(t.Time)&&(e.Time=t.Time),e},u.GetFirday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(5==a)return t;var i=e.getTime();if(a<5){var r=864e5*(5-a);i+=r}else{r=864e5*(a-5);i-=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n},u.GetSunday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(0==a)return t;var i=e.getTime();if(a>0){var r=864e5*(7-a);i+=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n},u.GetQuarter=function(t){var e=parseInt(t%1e4/100);return 1==e||2==e||3==e?1:4==e||5==e||6==e?2:7==e||8==e||9==e?3:10==e||11==e||12==e?4:0};var C=4e4,D=49999;e.CUSTOM_DAY_PERIOD_END=D,e.CUSTOM_DAY_PERIOD_START=C,u.IsDayPeriod=function(t,e){return 1==t||2==t||3==t||9==t||21==t||(t>C&&t<=D||0==t&&1==e)};var m=2e4,c=29999;e.CUSTOM_MINUTE_PERIOD_END=c,e.CUSTOM_MINUTE_PERIOD_START=m,u.IsMinutePeriod=function(t,e){return 5==t||6==t||7==t||8==t||11==t||12==t||(t>m&&t<=c||4==t&&1==e)};function S(t,e,a,i){this.Left=t,this.Top=e,this.Right=t+a,this.Bottom=e+i,this.IsPointIn=function(t,e){return t>=this.Left&&t<=this.Right&&e>=this.Top&&e<=this.Bottom}}e.CUSTOM_SECOND_PERIOD_END=32e3,e.CUSTOM_SECOND_PERIOD_START=3e4,u.IsSecondPeriod=function(t){return t>3e4&&t<=32e3},u.IsTickPeriod=function(t){return 10==t},u.GetPeriodName=function(t){var e=new Map([[0,"日线"],[1,"周线"],[2,"月线"],[3,"年线"],[9,"季线"],[21,"双周"],[4,"1分"],[5,"5分"],[6,"15分"],[7,"30分"],[8,"60分"],[11,"2小时"],[12,"4小时"],[10,"分笔"]]);return e.has(t)?e.get(t):""};var f={RECV_INDEX_DATA:2,RECV_HISTROY_DATA:3,RECV_TRAIN_MOVE_STEP:4,CHART_STATUS:5,BARRAGE_PLAY_END:6,RECV_OVERLAY_INDEX_DATA:7,RECV_START_AUTOUPDATE:9,RECV_STOP_AUTOUPDATE:10,ON_TITLE_DRAW:12,RECV_MINUTE_DATA:14,ON_CLICK_INDEXTITLE:15,RECV_KLINE_UPDATE_DATA:16,ON_INDEXTITLE_DRAW:19,ON_CUSTOM_VERTICAL_DRAW:20,ON_ENABLE_SPLASH_DRAW:22,ON_DRAW_DEPTH_TOOLTIP:25,ON_PHONE_TOUCH:27,ON_SPLIT_YCOORDINATE:29,ON_SPLIT_XCOORDINATE:31,ON_DRAW_KLINE_LAST_POINT:35,ON_DRAW_COUNTDOWN:41,ON_BIND_DRAWICON:42,ON_DRAW_DEAL_VOL_COLOR:43,ON_DRAW_DEAL_TEXT:44,ON_FILTER_DEAL_DATA:45,ON_FILTER_REPORT_DATA:46,ON_CLICK_REPORT_ROW:47,ON_REPORT_MARKET_STATUS:48,ON_DBCLICK_REPORT_ROW:49,ON_RCLICK_REPORT_ROW:50,ON_CLICK_REPORT_HEADER:51,ON_RCLICK_REPORT_HEADER:52,ON_REPORT_LOCAL_SORT:53,ON_DRAW_REPORT_NAME_COLOR:54,ON_DRAW_CUSTOM_TEXT:55,ON_CLICK_REPORT_TAB:56,ON_CLICK_REPORT_TABMENU:57,ON_DRAW_REPORT_FIXEDROW_TEXT:58,ON_CLICK_REPORT_FIXEDROW:59,ON_RCLICK_REPORT_FIXEDROW:60,ON_FORMAT_CORSSCURSOR_Y_TEXT:75,ON_FORMAT_INDEX_OUT_TEXT:76,ON_FORMAT_CORSSCURSOR_X_TEXT:77,ON_CUSTOM_UNCHANGE_KLINE_COLOR:95};e.JSCHART_EVENT_ID=f;e.JSCHART_DATA_FIELD_ID={MINUTE_MULTI_DAY_EXTENDDATA:21,MINUTE_DAY_EXTENDDATA:21,MINUTE_BEFOREOPEN_EXTENDDATA:21,MINUTE_AFTERCLOSE_EXTENDDATA:21,KLINE_COLOR_DATA:66,KLINE_DAY_EXTENDDATA:25,KLINE_MINUTE_EXTENDDATA:25};var I={KLINE_ID:0,MINUTE_ID:2,HISTORY_MINUTE_ID:3,MULTIDAY_MINUTE_ID:4};e.HQ_DATA_TYPE=I;var d={STATUS_NONE_ID:0,STATUS_REQUESTDATA_ID:1,STATUS_RECVDATA_ID:2,STATUS_FINISHED_ID:3};function T(){this.Start=[],this.Clear=function(){this.Start=[]},this.AddTouchStart=function(t,e,a){if(this.Start.length>0){var i=this.Start[this.Start.length-1],r=a-i.Time;r>0&&r<300?this.Start.push({X:t,Y:e,Time:a}):this.Start=[]}else this.Start.push({X:t,Y:e,Time:a})},this.IsVaildDBClick=function(){return 2==this.Start.length},this.AddTouchEnd=function(t){if(!(this.Start.length<=0)){var e=this.Start[this.Start.length-1],a=t-e.Time;a>=0&&a<150||(this.Start=[])}}}e.OVERLAY_STATUS_ID=d;var p={HistoryData:s,ChartData:u,SingleData:h,MinuteData:o,Rect:S,DataPlus:l,JSCHART_EVENT_ID:f,PhoneDBClick:T,HQ_DATA_TYPE:I,OVERLAY_STATUS_ID:d};e.JSCommonData=p},"8bf6":function(t,e,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.BackgroundPaint=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="BackgroundPaint",this.IsDynamic=!1,this.IsCallbackDraw=!0,this.FrameID=0,this.Data,this.ID=(0,s.Guid)(),this.ChartSubFrame,this.ChartBorder,this.KData,this.Period,this.XPointCount=0,this.SetOption=function(t){t.FrameID>0&&(this.FrameID=t.FrameID),l.IFrameSplitOperator.IsObjectExist(t.ID)&&(this.ID=t.ID)},this.Draw=function(){if(this.Data&&this.HQChart&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var t=this.HQChart.ChartPaint[0];if(t&&t.Data&&(this.ChartSubFrame=this.ChartFrame.SubFrame[this.FrameID].Frame,this.ChartBorder=this.ChartSubFrame.ChartBorder,this.KData=t.Data,this.Period=this.HQChart.Period,this.KData&&!(this.KData.Data.length<=0))){var e=!0===this.ChartSubFrame.IsHScreen;this.XPointCount=this.ChartSubFrame.XPointCount;var a=this.ChartSubFrame.XPointCount,i=this.KData.Data[this.KData.DataOffset],r=this.KData.DataOffset+a-1;r>=this.KData.Data.length&&(r=this.KData.Data.length-1);var n=this.KData.Data[r],o=this.GetShowData(i,n);if(o&&!(o.length<=0)){var h=this.BuildKLineMap(),l=this.ChartBorder.GetBottomEx(),u=this.ChartBorder.GetTopEx(),C=this.ChartBorder.GetHeightEx();for(var D in e&&(u=this.ChartBorder.GetRightEx(),l=this.ChartBorder.GetLeftEx(),C=this.ChartBorder.GetWidthEx()),o){var m=o[D],c=this.GetBGCoordinate(m,h);if(c){if(Array.isArray(m.Color)){var S;S=e?this.Canvas.createLinearGradient(l,c.Left,u,c.Left):this.Canvas.createLinearGradient(c.Left,u,c.Left,l);var f=1/m.Color.length;for(var D in m.Color)S.addColorStop(D*f,m.Color[D]);this.Canvas.fillStyle=S}else this.Canvas.fillStyle=m.Color;e?this.Canvas.fillRect((0,s.ToFixedRect)(l),(0,s.ToFixedRect)(c.Left),(0,s.ToFixedRect)(C),(0,s.ToFixedRect)(c.Width)):this.Canvas.fillRect((0,s.ToFixedRect)(c.Left),(0,s.ToFixedRect)(u),(0,s.ToFixedRect)(c.Width),(0,s.ToFixedRect)(C))}}}}}},this.GetShowData=function(t,e){var a=[];for(var i in this.Data){var r=this.Data[i],n={};r.Start.Date>=t.Date&&r.Start.Date<=e.Date&&(n.Start=r.Start),r.End.Date>=t.Date&&r.End.Date<=e.Date&&(n.End=r.End),(n.Start||n.End)&&(n.Color=r.Color,a.push(n))}return a},this.BuildKLineMap=function(){var t=!0===this.ChartSubFrame.IsHScreen,e=this.ChartSubFrame.DataWidth,a=this.ChartSubFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+h.g_JSChartResource.FrameLeftMargin;t&&(i=this.ChartBorder.GetTop()+a/2+h.g_JSChartResource.FrameLeftMargin);var r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());for(var n={Data:new Map},o=this.KData.DataOffset,l=0;o<this.KData.Data.length&&l<this.XPointCount;++o,++l,i+=e+a){var u=this.KData.Data[o],C=i,D=i+e;if(D>r)break;var m=C+(D-C)/2;0==l&&(n.XLeft=C),n.XRight=D;var c={Index:o,ShowIndex:l,X:m,Right:D,Left:C,Date:u.Date};if(s.ChartData.IsMinutePeriod(this.Period,!0)){var S="Date:".concat(u.Date," Time:").concat(u.Time);c.Time=u.Time}else S="Date:".concat(u.Date);n.Data.set(S,c)}return n},this.GetBGCoordinate=function(t,e){var a=null,i=null;if(t.Start){if(s.ChartData.IsMinutePeriod(this.Period,!0))var n="Date:".concat(t.Start.Date," Time:").concat(t.Start.Time);else n="Date:".concat(t.Start.Date);if(e.Data.has(n)){var o=e.Data.get(n);a=o.Left}else{var h,l=(0,r.default)(e.Data);try{for(l.s();!(h=l.n()).done;){var u=h.value,C=u[1];if(C.Date>t.Start.Date){a=C.Left;break}}}catch(S){l.e(S)}finally{l.f()}}}else a=e.XLeft;if(t.End){if(s.ChartData.IsMinutePeriod(this.Period,!0))n="Date:".concat(t.End.Date," Time:").concat(t.End.Time);else n="Date:".concat(t.End.Date);if(e.Data.has(n)){o=e.Data.get(n);i=o.Right}else{var D,m=null,c=(0,r.default)(e.Data);try{for(c.s();!(D=c.n()).done;){u=D.value,C=u[1];if(C.Date>t.End.Date){i=m;break}m=C.Right}}catch(S){c.e(S)}finally{c.f()}}}else i=e.XRight;return null==a||null==i?null:{Left:a,Right:i,Width:i-a}}},e.BarragePaint=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="BarragePaint",this.IsAnimation=!0,this.IsEraseBG=!0,this.HQChart,this.Font=h.g_JSChartResource.Barrage.Font,this.TextColor=h.g_JSChartResource.Barrage.Color,this.FontHeight=h.g_JSChartResource.Barrage.Height,this.BarrageList=new D,this.IsMoveStep=!1,this.SetOption=function(t){t&&(t.Step>0&&(this.BarrageList.Step=t.Step),t.MinLineHeight&&(this.Barrage.MinLineHeight=t.MinLineHeight))},this.DrawHScreen=function(){var t=this.ChartBorder.GetWidth(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetRightEx();this.ChartBorder.GetChartWidth();t!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(t),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:a,Left:e,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r){this.Canvas.save(),this.Canvas.translate(this.ChartBorder.GetChartHeight(),0),this.Canvas.rotate(90*Math.PI/180);for(var n=0;n<r.length;++n){var s=r[n];s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.TextColor,s.Font?this.Canvas.font=s.Font.Name:this.Canvas.font=this.Font;var o=this.FontHeight;s.Font&&s.Font.Height>0&&(o=s.Font.Height);var h=s.Y+parseInt((s.Height-o)/2);this.Canvas.fillText(s.Text,a-s.X,i+h)}this.Canvas.restore()}},this.Draw=function(){if(this.ChartFrame.IsHScreen)this.DrawHScreen();else{var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeight();i!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(i),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:e,Left:t,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r)for(var n=0;n<r.length;++n){var s=r[n];s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.TextColor,s.Font?this.Canvas.font=s.Font.Name:this.Canvas.font=this.Font;var o=this.FontHeight;s.Font&&s.Font.Height>0&&(o=s.Font.Height);var h=s.Y+parseInt((s.Height-o)/2);this.Canvas.fillText(s.Text,e-s.X,a+h)}}}},e.IExtendChartPainting=u,e.KLineTooltipPaint=C,e.MinuteTooltipPaint=function(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.ClassName="MinuteTooltipPaint",this.IsShowAveragePrice=!0,this.GetTop=function(){return this.IsHScreen?0==this.ShowPosition?this.ChartBorder.GetTop()+this.Left:this.ChartBorder.GetBottom()-this.Width-this.Left:this.ChartBorder.GetTop()+this.Top},this.GetLeft=function(){return this.IsHScreen?this.ChartBorder.GetRight()-this.Height-this.Top:0==this.ShowPosition?this.ChartBorder.GetLeft()+this.Left:this.ChartBorder.GetRight()-this.Width-this.Left},this.GetFormatTitle=function(t){if(t&&t.Data){var e,a=t.Data;this.HQChart.Symbol&&(e=this.HQChart.Symbol.toUpperCase());var i=o.JSCommonCoordinateData.GetfloatPrecision(this.HQChart.Symbol);this.YClose=this.KLineTitlePaint.YClose;var r,n,s,u,C=[],D={AryText:C};return l.IFrameSplitOperator.IsNumber(a.Date)&&(r=l.IFrameSplitOperator.FormatDateString(a.Date),C.push({Text:r,Color:this.TitleColor})),l.IFrameSplitOperator.IsNumber(a.Time)&&(r=l.IFrameSplitOperator.FormatTimeString(a.Time),C.push({Text:r,Color:this.TitleColor})),l.IFrameSplitOperator.IsNumber(a.Close)&&(n=h.g_JSChartLocalization.GetText("Tooltip-Price",this.LanguageID),s=this.KLineTitlePaint.GetColor(a.Close,this.YClose),r=a.Close.toFixed(i),C.push({Title:n,TitleColor:this.TitleColor,Text:r,Color:s})),l.IFrameSplitOperator.IsNumber(a.AvPrice)&&1==this.IsShowAveragePrice&&(n=h.g_JSChartLocalization.GetText("Tooltip-AvPrice",this.LanguageID),s=this.KLineTitlePaint.GetColor(a.AvPrice,this.YClose),r=a.AvPrice.toFixed(i),C.push({Title:n,TitleColor:this.TitleColor,Text:r,Color:s})),l.IFrameSplitOperator.IsNumber(a.Close)&&l.IFrameSplitOperator.IsNumber(this.YClose)&&(n=h.g_JSChartLocalization.GetText("Tooltip-Increase",this.LanguageID),u=(a.Close-this.YClose)/this.YClose*100,s=this.KLineTitlePaint.GetColor(u,0),r=u.toFixed(2)+"%",C.push({Title:n,TitleColor:this.TitleColor,Text:r,Color:s})),l.IFrameSplitOperator.IsNumber(a.Vol)&&(n=h.g_JSChartLocalization.GetText("Tooltip-Vol",this.LanguageID),r=this.HQChart.FormatValueString(a.Vol,2,this.LanguageID),C.push({Title:n,TitleColor:this.TitleColor,Text:r,Color:this.TitleColor})),l.IFrameSplitOperator.IsNumber(a.Amount)&&(n=h.g_JSChartLocalization.GetText("Tooltip-Amount",this.LanguageID),r=this.HQChart.FormatValueString(a.Amount,2,this.LanguageID),C.push({Title:n,TitleColor:this.TitleColor,Text:r,Color:this.TitleColor})),o.MARKET_SUFFIX_NAME.IsChinaFutures(e)&&l.IFrameSplitOperator.IsNumber(a.Position)&&(n=h.g_JSChartLocalization.GetText("Tooltip-Position",this.LanguageID),r=l.IFrameSplitOperator.FormatValueString(a.Position,2,this.LanguageID),C.push({Title:n,TitleColor:this.TitleColor,Text:r,Color:this.TitleColor})),D}}};var r=i(a("b85c"));a("14d9"),a("e25e"),a("3c65"),a("99af"),a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0");var n=a("c534"),s=a("8709"),o=a("966c"),h=a("ee32"),l=a("deed");function u(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.Data,this.ClassName="IExtendChartPainting",this.IsDynamic=!1,this.IsEraseBG=!1,this.IsAnimation=!1,this.DrawAfterTitle=!1,this.Left=5,this.Right=5,this.Top=5,this.Bottom=5,this.Draw=function(){},this.SetOption=function(t){}}function C(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.IsDynamic=!0,this.IsEraseBG=!0,this.DrawAfterTitle=!0,this.ClassName="KLineTooltipPaint",this.LatestPoint,this.ShowPosition=0,this.BorderColor=h.g_JSChartResource.TooltipPaint.BorderColor,this.BGColor=h.g_JSChartResource.TooltipPaint.BGColor,this.TitleColor=h.g_JSChartResource.TooltipPaint.TitleColor,this.Font=[h.g_JSChartResource.TooltipPaint.TitleFont],this.Mergin={Left:2,Top:3,Bottom:5,Right:5},this.ExtendLineWidth=5,this.Width=50,this.Height=100,this.LineHeight=15,this.LineSpace=2,this.Left=1,this.Top=0,this.HQChart,this.KLineTitlePaint,this.IsHScreen=!1,this.LanguageID=h.JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.GetLeft=function(){return this.IsHScreen?this.ChartBorder.GetRightEx()-this.Height-this.Top:0==this.ShowPosition?this.ChartBorder.GetLeft()+this.Left:this.ChartBorder.GetRight()-this.Width-this.Left},this.GetTop=function(){return this.IsHScreen?0==this.ShowPosition?this.ChartBorder.GetTop()+this.Left:this.ChartBorder.GetBottom()-this.Width-this.Left:this.ChartBorder.GetTopEx()+this.Top},this.IsEnableDraw=function(){if(!this.HQChart||!this.HQChart.TitlePaint||!this.HQChart.TitlePaint[0])return!1;if(this.HQChart.EnableClickModel){if(!1===this.HQChart.ClickModel.IsShowCorssCursor)return!1}else if(!this.HQChart.IsOnTouch)return!1;return!0},this.Draw=function(){if(this.IsEnableDraw()){this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.KLineTitlePaint=this.HQChart.TitlePaint[0];var t=this.KLineTitlePaint.GetCurrentKLineData();if(t){var e=this.GetFormatTitle({Data:t});e&&l.IFrameSplitOperator.IsNonEmptyArray(e.AryText)&&(this.CalculateTooltipSize(e),this.CalculateShowPosition(),this.DrawBG(),this.DrawTooltipData(e),this.DrawBorder())}}},this.GetFormatTitle=function(t){if(t&&t.Data){var e,a=t.Data;this.HQChart.Symbol&&(e=this.HQChart.Symbol.toUpperCase());var i,r,n=o.JSCommonCoordinateData.GetfloatPrecision(this.HQChart.Symbol),u=[],C={AryText:u};i=l.IFrameSplitOperator.FormatDateString(a.Date),u.push({Text:i,Color:this.TitleColor});var D=this.HQChart.Period;if(s.ChartData.IsMinutePeriod(D,!0)&&l.IFrameSplitOperator.IsNumber(a.Time)?(i=this.HQChart.FormatTimeString(a.Time),u.push({Text:i,Color:this.TitleColor})):s.ChartData.IsSecondPeriod(D)&&l.IFrameSplitOperator.IsNumber(a.Time)&&(i=this.HQChart.FormatTimeString(a.Time,"HH:MM:SS"),u.push({Text:i,Color:this.TitleColor})),l.IFrameSplitOperator.IsNumber(a.Open)){r=h.g_JSChartLocalization.GetText("Tooltip-Open",this.LanguageID);var m=this.KLineTitlePaint.GetColor(a.Open,a.YClose);i=a.Open.toFixed(n),u.push({Title:r,TitleColor:this.TitleColor,Text:i,Color:m})}if(l.IFrameSplitOperator.IsNumber(a.High)&&(r=h.g_JSChartLocalization.GetText("Tooltip-High",this.LanguageID),m=this.KLineTitlePaint.GetColor(a.High,a.YClose),i=a.High.toFixed(n),u.push({Title:r,TitleColor:this.TitleColor,Text:i,Color:m})),l.IFrameSplitOperator.IsNumber(a.Low)&&(r=h.g_JSChartLocalization.GetText("Tooltip-Low",this.LanguageID),m=this.KLineTitlePaint.GetColor(a.Low,a.YClose),i=a.Low.toFixed(n),u.push({Title:r,TitleColor:this.TitleColor,Text:i,Color:m})),l.IFrameSplitOperator.IsNumber(a.Close)&&(r=h.g_JSChartLocalization.GetText("Tooltip-Close",this.LanguageID),m=this.KLineTitlePaint.GetColor(a.Close,a.YClose),i=a.Close.toFixed(n),u.push({Title:r,TitleColor:this.TitleColor,Text:i,Color:m})),r=h.g_JSChartLocalization.GetText("Tooltip-Increase",this.LanguageID),a.YClose>0){var c=(a.Close-a.YClose)/a.YClose*100;m=this.KLineTitlePaint.GetColor(c,0),i=c.toFixed(2)+"%"}else i="--.--",m=this.KLineTitlePaint.GetColor(0,0);return u.push({Title:r,TitleColor:this.TitleColor,Text:i,Color:m}),l.IFrameSplitOperator.IsNumber(a.Vol)&&(r=h.g_JSChartLocalization.GetText("Tooltip-Vol",this.LanguageID),i=this.HQChart.FormatValueString(a.Vol,2,this.LanguageID),u.push({Title:r,TitleColor:this.TitleColor,Text:i,Color:this.TitleColor})),l.IFrameSplitOperator.IsNumber(a.Amount)&&(r=h.g_JSChartLocalization.GetText("Tooltip-Amount",this.LanguageID),i=this.HQChart.FormatValueString(a.Amount,2,this.LanguageID),u.push({Title:r,TitleColor:this.TitleColor,Text:i,Color:this.TitleColor})),o.MARKET_SUFFIX_NAME.IsChinaFutures(e)&&l.IFrameSplitOperator.IsNumber(a.Position)&&(r=h.g_JSChartLocalization.GetText("Tooltip-Position",this.LanguageID),i=l.IFrameSplitOperator.FormatValueString(a.Position,2,this.LanguageID),u.push({Title:r,TitleColor:this.TitleColor,Text:i,Color:this.TitleColor})),C}},this.CalculateTooltipSize=function(t){this.Canvas.font=this.Font[0],this.LineHeight=this.Canvas.measureText("擎").width;for(var e=0,a=0,i=0,r=0,n=0;n<t.AryText.length;++n){var s=t.AryText[n];e>0&&(e+=this.LineSpace);var o=0;if(s.Title){var h=this.Canvas.measureText(s.Title).width+2;a<h&&(a=h),o+=h}if(s.Text){h=this.Canvas.measureText(s.Text).width+2;i<h&&(i=h),o+=h}r<o&&(r=o),e+=this.LineHeight}return this.Height=e+(this.Mergin.Top+this.Mergin.Bottom),this.Width=r+(this.Mergin.Left+this.Mergin.Right)+this.ExtendLineWidth,{Height:this.Height,Width:this.Width,MaxTitleWidth:a,MaxTextWidth:i}},this.CalculateShowPosition=function(){if(this.ShowPosition=0,this.LatestPoint)if(this.IsHScreen){var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=t+e/2;this.LatestPoint.Y<a&&(this.ShowPosition=1)}else{var i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetWidth(),n=i+r/2;this.LatestPoint.X<n&&(this.ShowPosition=1)}},this.DrawBorder=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.strokeStyle=this.BorderColor,t?this.Canvas.strokeRect(this.HQChart.ToFixedPoint(e),this.HQChart.ToFixedPoint(a),this.HQChart.ToFixedRect(this.Height),this.HQChart.ToFixedRect(this.Width)):this.Canvas.strokeRect(this.HQChart.ToFixedPoint(e),this.HQChart.ToFixedPoint(a),this.HQChart.ToFixedRect(this.Width),this.HQChart.ToFixedRect(this.Height))},this.DrawBG=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.fillStyle=this.BGColor,t?this.Canvas.fillRect(e,a,this.Height,this.Width):this.Canvas.fillRect(e,a,this.Width,this.Height)},this.DrawTooltipData=function(t){var e=this.GetLeft(),a=this.GetTop();if(this.IsHScreen){this.Canvas.save();var i=this.GetLeft()+this.Height,r=this.GetTop();this.Canvas.translate(i,r),this.Canvas.rotate(90*Math.PI/180),e=0,a=0}this.Canvas.textBaseline="top";var n=e+this.Width-this.Mergin.Right;e+=this.Mergin.Left,a+=this.Mergin.Top;for(var s=0;s<t.AryText.length;++s){var o=t.AryText[s];o.Title&&(this.Canvas.textAlign="left",this.Canvas.fillStyle=o.TitleColor,this.Canvas.fillText(o.Title,e,a)),o.Text&&(this.Canvas.textAlign="right",this.Canvas.fillStyle=o.Color,this.Canvas.fillText(o.Text,n,a)),a+=this.LineHeight+this.LineSpace}this.IsHScreen&&this.Canvas.restore()},this.SetOption=function(t){t.LineHeight>0&&(this.LineHeight=t.LineHeight),t.BGColor&&(this.BGColor=t.BGColor),t.LanguageID>0&&(this.LanguageID=t.LanguageID)}}function D(){this.PlayList=[],this.Cache=[],this.MinLineHeight=40,this.Height,this.Step=1,this.GetPlayList=function(t){for(var e=t.Canves,a=t.Right,i=t.Left,r=a-i,n=t.IsMoveStep,s=[],o=0,h=0;h<this.PlayList.length;++h){var l=this.PlayList[h],u=this.MinLineHeight;l.Height>this.MinLineHeight&&(u=l.Height);for(var C=!0,D=!1,m=0;m<l.Data.length;++m){var c=l.Data[m],S={X:c.X,Y:o,Text:c.Text,Color:c.Color,Height:u,Font:c.Font,Info:c.Info};s.push(S),n&&(m==l.Data.length-1&&this.Cache.length>0?(C=!1,c.TextWidth||(c.Font&&c.Font.Name?e.font=c.Font.Name:e.font=t.Font,c.TextWidth=e.measureText(S.Text+"擎擎").width),c.X>=c.TextWidth&&(C=!0)):0==m&&(D=!1,c.TextWidth||(c.Font&&c.Font.Name?e.font=c.Font.Name:e.font=t.Font,c.TextWidth=e.measureText(S.Text+"擎擎").width),c.X>r+c.TextWidth&&(D=!0)),c.X+=this.Step)}if(n&&C&&this.Cache.length>0){var f=this.Cache.shift(),I={X:0,Text:f.Text,Color:f.Color,Font:f.Font,Info:f.Info};l.Data.push(I)}if(n&&D&&l.Data.length>0){var d=l.Data.shift();this.OnItemPlayEnd(t.HQChart,d)}o+=u}return s},this.CacluatePlayLine=function(t){this.Height=t;var e=parseInt(t/this.MinLineHeight);if(this.PlayList.length<e)for(var a=e-this.PlayList.length,i=0;i<a;++i)this.PlayList.push({Data:[]});else if(this.PlayList.length>e){var r=this.PlayList.length-e;for(i=0;i<r;++i)for(var s=this.PlayList.pop(),o=0;o<s.Data.length;++o){var h=s.Data[o],l={Text:h.Text,Color:h.Color,Font:h.Font,Info:h.Info};this.Cache.unshift(l)}}n.JSConsole.Chart.Log("[BarrageList::CacluatePlayLine] LineCount=".concat(this.PlayList.length," Height=").concat(this.Height))},this.AddBarrage=function(t){for(var e in t){var a=t[e];this.Cache.push(a)}},this.OnItemPlayEnd=function(t,e){var a=t.GetBarrageEvent();a&&a.Callback&&a.Callback(a,e,this)},this.Count=function(){return this.Cache.length}}},9594:function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSCommonIndexScript=void 0,e.JSIndexScript=n,a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0");var i={MINUTE_ID:101,MULTIDAY_MINUTE_ID:102,HISTORY_MINUTE_ID:103,KLINE_DAY_ID:0,KLINE_WEEK_ID:1,KLINE_MONTH_ID:2,KLINE_YEAR_ID:3,KLINE_MINUTE_ID:4,KLINE_5_MINUTE_ID:5,KLINE_15_MINUTE_ID:6,KLINE_30_MINUTE_ID:7,KLINE_60_MINUTE_ID:8};var r=new function(){this.DataMap=new Map,this.Get=function(t){return this.DataMap.has(t)?this.DataMap.get(t):null},this.Add=function(t){this.DataMap.set(t.ID,t)}};function n(){this.DataMap=new Map([["MA",this.MA],["均线",this.MA],["BOLL",this.BOLL],["BBI",this.BBI],["MA4",this.MA4],["MA5",this.MA5],["MA6",this.MA6],["MA7",this.MA7],["MA8",this.MA8],["DKX",this.DKX],["MIKE",this.MIKE],["PBX",this.PBX],["ENE",this.ENE],["MACD",this.MACD],["KDJ",this.KDJ],["MACD2",this.MACD2],["VOL",this.VOL],["成交量",this.VOL],["RSI",this.RSI],["BRAR",this.BRAR],["WR",this.WR],["BIAS",this.BIAS],["OBV",this.OBV],["DMI",this.DMI],["CR",this.CR],["PSY",this.PSY],["CCI",this.CCI],["DMA",this.DMA],["TRIX",this.TRIX],["VR",this.VR],["EMV",this.EMV],["ROC",this.ROC],["MIM",this.MIM],["FSL",this.FSL],["CYR",this.CYR],["MASS",this.MASS],["WAD",this.WAD],["CHO",this.CHO],["ADTM",this.ADTM],["HSL",this.HSL],["BIAS36",this.BIAS36],["BIAS_QL",this.BIAS_QL],["DPO",this.DPO],["OSC",this.OSC],["ATR",this.ATR],["NVI",this.NVI],["PVI",this.PVI],["UOS",this.UOS],["CYW",this.CYW],["LON",this.LON],["NDB",this.NDB],["SKDJ",this.SKDJ],["KD",this.KD],["FKX",this.FKX],["DKCOL",this.DKCOL],["UDL",this.UDL],["MFI",this.MFI],["LWR",this.LWR],["MARSI",this.MARSI],["CYD",this.CYD],["CYF",this.CYF],["TAPI",this.TAPI],["VMACD",this.VMACD],["QACD",this.QACD],["VPT",this.VPT],["WVAD",this.WVAD],["DBQR",this.DBQR],["JS",this.JS],["CYE",this.CYE],["QR",this.QR],["GDX",this.GDX],["JLHB",this.JLHB],["PCNT",this.PCNT],["BTX",this.BTX],["AMO",this.AMO],["VRSI",this.VRSI],["HSCOL",this.HSCOL],["DBQRV",this.DBQRV],["DBLB",this.DBLB],["ACD",this.ACD],["EXPMA",this.EXPMA],["EXPMA_S",this.EXPMA_S],["HMA",this.HMA],["LMA",this.LMA],["VMA",this.VMA],["AMV",this.AMV],["BBIBOLL",this.BBIBOLL],["ALLIGAT",this.ALLIGAT],["ZX",this.ZX],["XS",this.XS],["XS2",this.XS2],["SG-XDT",this.SG_XDT],["SG-SMX",this.SG_SMX],["SG-LB",this.SG_LB],["SG-PF",this.SG_PF],["RAD",this.RAD],["SHT",this.SHT],["ZLJC",this.ZLJC],["ZLMM",this.ZLMM],["SLZT",this.SLZT],["ADVOL",this.ADVOL],["CYC",this.CYC],["CYS",this.CYS],["CYQKL",this.CYQKL],["SQJZ",this.SQJZ],["XT",this.XT],["CFJT",this.CFJT],["CYX",this.CYX],["WAVE",this.WAVE],["SCR",this.SCR],["ASR",this.ASR],["SAR",this.SAR],["TJCJL",this.TJCJL],["量比",this.VOLRate],["EMPTY",this.EMPTY],["操盘BS点",this.FXG_BSPoint],["EMA",this.EMA3],["EMA4",this.EMA4],["EMA5",this.EMA5],["EMA6",this.EMA6],["CJL2",this.CJL],["Zealink-资金吸筹",this.Zealink_Index1],["Zealink-牛熊区间",this.Zealink_Index2],["Zealink-持仓信号",this.Zealink_Index3],["Zealink-增减持",this.Zealink_Index4],["Zealink-大宗交易",this.Zealink_Index5],["Zealink-信托持股",this.Zealink_Index6],["Zealink-官网新闻",this.Zealink_Index7],["Zealink-高管要闻",this.Zealink_Index8],["Zealink-股权质押",this.Zealink_Index9],["飞龙四式",this.Dragon4_Main],["飞龙四式-附图",this.Dragon4_Fig],["资金分析",this.FundsAnalysis],["融资占比",this.MarginProportion],["负面新闻",this.NewsNegative],["机构调研",this.NewsResearch],["董秘连线",this.NewsInteract],["涨跌趋势",this.UpDownAnalyze],["放心股-操盘BS点",this.FXG_BSPoint],["放心股-涨停多空线",this.FXG_INDEX],["放心股-涨停吸筹区",this.FXG_INDEX2],["放心股-量能黄金点",this.FXG_INDEX3],["五彩K线-十字星",this.COLOR_KSTAR1],["五彩K线-早晨之星",this.COLOR_KSTAR2],["五彩K线-黄昏之星",this.COLOR_KSTAR3],["五彩K线-长十字",this.COLOR_SHI1],["五彩K线-身怀六甲",this.COLOR_K220],["五彩K线-三个白武士",this.COLOR_K300],["五彩K线-三只乌鸦",this.COLOR_K310],["五彩K线-光头阳线",this.COLOR_K380],["五彩K线-光脚阴线",this.COLOR_K390],["五彩K线-垂死十字",this.COLOR_K134],["五彩K线-早晨十字星",this.COLOR_K140],["五彩K线-黄昏十字星",this.COLOR_K150],["五彩K线-射击之星",this.COLOR_K160],["五彩K线-倒转锤头",this.COLOR_K165],["五彩K线-锤头",this.COLOR_K170],["五彩K线-吊颈",this.COLOR_K180],["五彩K线-穿头破脚",this.COLOR_K190],["五彩K线-出水芙蓉",this.COLOR_CSFR],["五彩K线-乌云盖顶",this.COLOR_WYGD],["五彩K线-曙光初现",this.COLOR_SGCJ],["五彩K线-十字胎",this.COLOR_SZTAI],["五彩K线-剑",this.COLOR_SWORD],["五彩K线-平顶",this.COLOR_PINGDING],["五彩K线-平底",this.COLOR_PINGDI],["五彩K线-大阳烛",this.COLOR_DAYANZHU],["五彩K线-大阴烛",this.COLOR_DAYINGZHU],["五彩K线-好友反攻",this.COLOR_HYFG],["五彩K线-跳空缺口",this.COLOR_TKQK],["五彩K线-双飞乌鸦",this.COLOR_SFWY],["五彩K线-上升三部曲",this.COLOR_SSSBQ],["五彩K线-下跌三部曲",this.COLOR_XDSBQ],["五彩K线-长下影",this.COLOR_CHXY],["五彩K线-长上影",this.COLOR_CHSY],["五彩K线-分离",this.COLOR_FENLI],["交易系统-BIAS",this.TRADE_BIAS],["交易系统-CCI",this.TRADE_CCI],["交易系统-DMI",this.TRADE_DMI],["交易系统-KD",this.TRADE_KD],["交易系统-BOLL",this.TRADE_BOLL],["交易系统-KDJ",this.TRADE_KDJ],["交易系统-MA",this.TRADE_MA],["交易系统-MACD",this.TRADE_MACD],["交易系统-MTM",this.TRADE_MTM],["交易系统-PSY",this.TRADE_PSY],["交易系统-ROC",this.TRADE_ROC],["交易系统-RSI",this.TRADE_RSI],["交易系统-VR",this.TRADE_VR],["交易系统-DPSJ",this.TRADE_DPSJ],["TEST",this.TEST]])}n.AddIndex=function(t){for(var e in t)r.Add(t[e])},n.prototype.Get=function(t){var e=r.Get(t);if(e)return e;var a=this.DataMap.get(t);return a?a():(console.log("[JSIndexScript::Get] can't find index by id=".concat(t)),null)},n.prototype.MA=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);"}},n.prototype.MA4=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);"}},n.prototype.MA5=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);"}},n.prototype.MA6=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);"}},n.prototype.MA7=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0},{Name:"M7",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);"}},n.prototype.MA8=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0},{Name:"M7",Value:0},{Name:"M8",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"},{Name:"MA8",DynamicName:"MA{M8}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);\nMA8:MA(CLOSE,M8);"}},n.prototype.EMA3=function(){return{Name:"EMA",Description:"指数移动平均值",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);"}},n.prototype.EMA4=function(){return{Name:"EMA",Description:"指数移动平均值",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);"}},n.prototype.EMA5=function(){return{Name:"EMA",Description:"指数移动平均值",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);\nMA5:EMA(CLOSE,M5);"}},n.prototype.EMA6=function(){return{Name:"EMA",Description:"指数移动平均值",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);\nMA5:EMA(CLOSE,M5);\nMA6:EMA(CLOSE,M6);"}},n.prototype.BOLL=function(){return{Name:"BOLL",Description:"布林线",IsMainIndex:!0,KLineType:2,Args:[{Name:"M",Value:20}],Script:"BOLL:MA(CLOSE,M);\nUB:BOLL+2*STD(CLOSE,M);\nLB:BOLL-2*STD(CLOSE,M);"}},n.prototype.BBI=function(){return{Name:"BBI",Description:"多空均线",IsMainIndex:!0,Args:[{Name:"M1",Value:3},{Name:"M2",Value:6},{Name:"M3",Value:12},{Name:"M4",Value:24}],Script:"BBI:(MA(CLOSE,M1)+MA(CLOSE,M2)+MA(CLOSE,M3)+MA(CLOSE,M4))/4;"}},n.prototype.DKX=function(){return{Name:"DKX",Description:"多空线",IsMainIndex:!1,Args:[{Name:"M",Value:10}],Script:"MID:=(3*CLOSE+LOW+OPEN+HIGH)/6;\nDKX:(20*MID+19*REF(MID,1)+18*REF(MID,2)+17*REF(MID,3)+\n16*REF(MID,4)+15*REF(MID,5)+14*REF(MID,6)+\n13*REF(MID,7)+12*REF(MID,8)+11*REF(MID,9)+\n10*REF(MID,10)+9*REF(MID,11)+8*REF(MID,12)+\n7*REF(MID,13)+6*REF(MID,14)+5*REF(MID,15)+\n4*REF(MID,16)+3*REF(MID,17)+2*REF(MID,18)+REF(MID,20))/210;\nMADKX:MA(DKX,M);"}},n.prototype.MIKE=function(){return{Name:"MIKE",Description:"麦克支撑压力",IsMainIndex:!0,Args:[{Name:"N",Value:10}],Script:"HLC:=REF(MA((HIGH+LOW+CLOSE)/3,N),1);\nHV:=EMA(HHV(HIGH,N),3);\nLV:=EMA(LLV(LOW,N),3);\nSTOR:EMA(2*HV-LV,3);\nMIDR:EMA(HLC+HV-LV,3);\nWEKR:EMA(HLC*2-LV,3);\nWEKS:EMA(HLC*2-HV,3);\nMIDS:EMA(HLC-HV+LV,3);\nSTOS:EMA(2*LV-HV,3);"}},n.prototype.PBX=function(){return{Name:"PBX",Description:"瀑布线",IsMainIndex:!0,Args:[{Name:"M1",Value:4},{Name:"M2",Value:6},{Name:"M3",Value:9},{Name:"M4",Value:13},{Name:"M5",Value:18},{Name:"M6",Value:24}],Script:"PBX1:(EMA(CLOSE,M1)+MA(CLOSE,M1*2)+MA(CLOSE,M1*4))/3;\nPBX2:(EMA(CLOSE,M2)+MA(CLOSE,M2*2)+MA(CLOSE,M2*4))/3;\nPBX3:(EMA(CLOSE,M3)+MA(CLOSE,M3*2)+MA(CLOSE,M3*4))/3;\nPBX4:(EMA(CLOSE,M4)+MA(CLOSE,M4*2)+MA(CLOSE,M4*4))/3;\nPBX5:(EMA(CLOSE,M5)+MA(CLOSE,M5*2)+MA(CLOSE,M5*4))/3;\nPBX6:(EMA(CLOSE,M6)+MA(CLOSE,M6*2)+MA(CLOSE,M6*4))/3;"}},n.prototype.ENE=function(){return{Name:"ENE",Description:"轨道线",IsMainIndex:!0,Args:[{Name:"N",Value:25},{Name:"M1",Value:6},{Name:"M2",Value:6}],Script:"UPPER:(1+M1/100)*MA(CLOSE,N);\nLOWER:(1-M2/100)*MA(CLOSE,N);\nENE:(UPPER+LOWER)/2;"}},n.prototype.MACD=function(){return{Name:"MACD",Description:"平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA:EMA(DIF,MID);\nMACD:(DIF-DEA)*2,COLORSTICK;"}},n.prototype.MACD2=function(){return{Name:"MACD",Description:"平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF2:=EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA2:=EMA(DIF2,MID);\nMACD:(DIF2-DEA2)*2,COLORSTICK,LINETHICK50;\nDIF:DIF2;\nDEA:DEA2;"}},n.prototype.KDJ=function(){return{Name:"KDJ",Description:"随机指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:SMA(RSV,M1,1);\nD:SMA(K,M2,1);\nJ:3*K-2*D;"}},n.prototype.VOL=function(){return{Name:"VOL",Description:"成交量",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"}],Script:"VOLUME:=VOL;\nVOL:VOL,VOLSTICK;\nMA1:MA(VOLUME,M1);\nMA2:MA(VOLUME,M2);"}},n.prototype.RSI=function(){return{Name:"RSI",Description:"相对强弱指标",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"LC:=REF(CLOSE,1);\nRSI1:SMA(MAX(CLOSE-LC,0),N1,1)/SMA(ABS(CLOSE-LC),N1,1)*100;\nRSI2:SMA(MAX(CLOSE-LC,0),N2,1)/SMA(ABS(CLOSE-LC),N2,1)*100;\nRSI3:SMA(MAX(CLOSE-LC,0),N3,1)/SMA(ABS(CLOSE-LC),N3,1)*100;"}},n.prototype.BRAR=function(){return{Name:"BRAR",Description:"情绪指标",IsMainIndex:!1,Args:[{Name:"N",Value:26}],Script:"BR:SUM(MAX(0,HIGH-REF(CLOSE,1)),N)/SUM(MAX(0,REF(CLOSE,1)-LOW),N)*100;\nAR:SUM(HIGH-OPEN,N)/SUM(OPEN-LOW,N)*100;"}},n.prototype.WR=function(){return{Name:"WR",Description:"威廉指标",IsMainIndex:!1,Args:[{Name:"N",Value:10},{Name:"N1",Value:6}],Script:"WR1:100*(HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N));\nWR2:100*(HHV(HIGH,N1)-CLOSE)/(HHV(HIGH,N1)-LLV(LOW,N1));"}},n.prototype.BIAS=function(){return{Name:"BIAS",Description:"乖离率",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"BIAS1 :(CLOSE-MA(CLOSE,N1))/MA(CLOSE,N1)*100;\nBIAS2 :(CLOSE-MA(CLOSE,N2))/MA(CLOSE,N2)*100;\nBIAS3 :(CLOSE-MA(CLOSE,N3))/MA(CLOSE,N3)*100;"}},n.prototype.OBV=function(){return{Name:"OBV",Description:"累积能量线",IsMainIndex:!1,Args:[{Name:"M",Value:30}],Script:"VA:=IF(CLOSE>REF(CLOSE,1),VOL,-VOL);\nOBV:SUM(IF(CLOSE==REF(CLOSE,1),0,VA),0);\nMAOBV:MA(OBV,M);"}},n.prototype.DMI=function(){return{Name:"DMI",Description:"趋向指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"MM",Value:6}],Script:"MTR:=EXPMEMA(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(REF(CLOSE,1)-LOW)),N);\nHD :=HIGH-REF(HIGH,1);\nLD :=REF(LOW,1)-LOW;\nDMP:=EXPMEMA(IF(HD>0&&HD>LD,HD,0),N);\nDMM:=EXPMEMA(IF(LD>0&&LD>HD,LD,0),N);\nPDI: DMP*100/MTR;\nMDI: DMM*100/MTR;\nADX: EXPMEMA(ABS(MDI-PDI)/(MDI+PDI)*100,MM);\nADXR:EXPMEMA(ADX,MM);"}},n.prototype.CR=function(){return{Name:"CR",Description:"带状能量线",IsMainIndex:!1,Args:[{Name:"N",Value:26},{Name:"M1",Value:10},{Name:"M2",Value:20},{Name:"M3",Value:40},{Name:"M4",Value:62}],Script:"MID:=REF(HIGH+LOW,1)/2;\nCR:SUM(MAX(0,HIGH-MID),N)/SUM(MAX(0,MID-LOW),N)*100;\nMA1:REF(MA(CR,M1),M1/2.5+1);\nMA2:REF(MA(CR,M2),M2/2.5+1);\nMA3:REF(MA(CR,M3),M3/2.5+1);\nMA4:REF(MA(CR,M4),M4/2.5+1);"}},n.prototype.PSY=function(){return{Name:"PSY",Description:"心理线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"PSY:COUNT(CLOSE>REF(CLOSE,1),N)/N*100;\rPSYMA:MA(PSY,M);"}},n.prototype.CCI=function(){return{Name:"CCI",Description:"商品路径指标",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"TYP:=(HIGH+LOW+CLOSE)/3;\nCCI:(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));"}},n.prototype.DMA=function(){return{Name:"DMA",Description:"平均差",IsMainIndex:!1,Args:[{Name:"N1",Value:10},{Name:"N2",Value:50},{Name:"M",Value:10}],Script:"DIF:MA(CLOSE,N1)-MA(CLOSE,N2);\nDIFMA:MA(DIF,M);"}},n.prototype.TRIX=function(){return{Name:"TRIX",Description:"三重指数平均线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:9}],Script:"MTR:=EMA(EMA(EMA(CLOSE,N),N),N);\nTRIX:(MTR-REF(MTR,1))/REF(MTR,1)*100;\nMATRIX:MA(TRIX,M) ;"}},n.prototype.VR=function(){return{Name:"VR",Description:"成交量变异率",IsMainIndex:!1,Args:[{Name:"N",Value:26},{Name:"M",Value:6}],Script:"TH:=SUM(IF(CLOSE>REF(CLOSE,1),VOL,0),N);\nTL:=SUM(IF(CLOSE<REF(CLOSE,1),VOL,0),N);\nTQ:=SUM(IF(CLOSE==REF(CLOSE,1),VOL,0),N);\nVR:100*(TH*2+TQ)/(TL*2+TQ);\nMAVR:MA(VR,M);"}},n.prototype.EMV=function(){return{Name:"EMV",Description:"简易波动指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"M",Value:9}],Script:"VOLUME:=MA(VOL,N)/VOL;\nMID:=100*(HIGH+LOW-REF(HIGH+LOW,1))/(HIGH+LOW);\nEMV:MA(MID*VOLUME*(HIGH-LOW)/MA(HIGH-LOW,N),N);\nMAEMV:MA(EMV,M);"}},n.prototype.ROC=function(){return{Name:"ROC",Description:"变动率指标",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"ROC:100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\nMAROC:MA(ROC,M);"}},n.prototype.MIM=function(){return{Name:"MIM",Description:"动量线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"MTM:CLOSE-REF(CLOSE,N);\nMAMTM:MA(MTM,M);"}},n.prototype.FSL=function(){return{Name:"FSL",Description:"分水岭",IsMainIndex:!1,Args:[],Script:"SWL:(EMA(CLOSE,5)*7+EMA(CLOSE,10)*3)/10;\nSWS:DMA(EMA(CLOSE,12),MAX(1,100*(SUM(VOL,5)/(3*CAPITAL))));"}},n.prototype.CYR=function(){return{Name:"CYR",Description:"市场强弱",IsMainIndex:!1,Args:[{Name:"N",Value:13},{Name:"M",Value:5}],Script:"DIVE:=0.01*EMA(AMOUNT,N)/EMA(VOL,N);\nCYR:(DIVE/REF(DIVE,1)-1)*100;\nMACYR:MA(CYR,M);"}},n.prototype.MASS=function(){return{Name:"MASS",Description:"市场强弱",IsMainIndex:!1,Args:[{Name:"N1",Value:9},{Name:"N2",Value:25},{Name:"M",Value:6}],Script:"MASS:SUM(MA(HIGH-LOW,N1)/MA(MA(HIGH-LOW,N1),N1),N2);\nMAMASS:MA(MASS,M);"}},n.prototype.WAD=function(){return{Name:"WAD",Description:"威廉多空力度线",IsMainIndex:!1,Args:[{Name:"M",Value:30}],Script:"MIDA:=CLOSE-MIN(REF(CLOSE,1),LOW);\nMIDB:=IF(CLOSE<REF(CLOSE,1),CLOSE-MAX(REF(CLOSE,1),HIGH),0);\nWAD:SUM(IF(CLOSE>REF(CLOSE,1),MIDA,MIDB),0);\nMAWAD:MA(WAD,M);"}},n.prototype.CHO=function(){return{Name:"CHO",Description:"佳庆指标",IsMainIndex:!1,Args:[{Name:"N1",Value:10},{Name:"N2",Value:20},{Name:"M",Value:6}],Script:"MID:=SUM(VOL*(2*CLOSE-HIGH-LOW)/(HIGH+LOW),0);\nCHO:MA(MID,N1)-MA(MID,N2);\nMACHO:MA(CHO,M);"}},n.prototype.ADTM=function(){return{Name:"ADTM",Description:"动态买卖气指标",IsMainIndex:!1,Args:[{Name:"N",Value:23},{Name:"M",Value:8}],Script:"DTM:=IF(OPEN<=REF(OPEN,1),0,MAX((HIGH-OPEN),(OPEN-REF(OPEN,1))));\nDBM:=IF(OPEN>=REF(OPEN,1),0,MAX((OPEN-LOW),(OPEN-REF(OPEN,1))));\nSTM:=SUM(DTM,N);\nSBM:=SUM(DBM,N);\nADTM:IF(STM>SBM,(STM-SBM)/STM,IF(STM==SBM,0,(STM-SBM)/SBM));\nMAADTM:MA(ADTM,M);"}},n.prototype.HSL=function(){return{Name:"HSL",Description:"换手线",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"HSL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100);\nMAHSL:MA(HSL,N);"}},n.prototype.BIAS36=function(){return{Name:"BIAS36",Description:"三六乖离",IsMainIndex:!1,Args:[{Name:"M",Value:6}],Script:"BIAS36:MA(CLOSE,3)-MA(CLOSE,6);\nBIAS612:MA(CLOSE,6)-MA(CLOSE,12);\nMABIAS:MA(BIAS36,M);"}},n.prototype.BIAS_QL=function(){return{Name:"BIAS_QL",Description:"乖离率-传统版",IsMainIndex:!1,Args:[{Name:"N",Value:6},{Name:"M",Value:6}],Script:"BIAS :(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;\nBIASMA :MA(BIAS,M);"}},n.prototype.DPO=function(){return{Name:"DPO",Description:"区间震荡线",IsMainIndex:!1,Args:[{Name:"N",Value:20},{Name:"M",Value:6}],Script:"DPO:CLOSE-REF(MA(CLOSE,N),N/2+1);\nMADPO:MA(DPO,M);"}},n.prototype.OSC=function(){return{Name:"OSC",Description:"变动速率线",IsMainIndex:!1,Args:[{Name:"N",Value:20},{Name:"M",Value:6}],Script:"OSC:100*(CLOSE-MA(CLOSE,N));\nMAOSC:EXPMEMA(OSC,M);"}},n.prototype.ATR=function(){return{Name:"ATR",Description:"真实波幅",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"MTR:MAX(MAX((HIGH-LOW),ABS(REF(CLOSE,1)-HIGH)),ABS(REF(CLOSE,1)-LOW));\nATR:MA(MTR,N);"}},n.prototype.NVI=function(){return{Name:"ATR",Description:"负成交量",IsMainIndex:!1,Args:[{Name:"N",Value:72}],Script:"NVI:100*MULAR(IF(V<REF(V,1),C/REF(C,1),1),0);\nMANVI:MA(NVI,N);"}},n.prototype.PVI=function(){return{Name:"PVI",Description:"正成交量",IsMainIndex:!1,Args:[{Name:"N",Value:72}],Script:"NVI:100*MULAR(IF(V>REF(V,1),C/REF(C,1),1),0);\nMANVI:MA(NVI,N);"}},n.prototype.UOS=function(){return{Name:"UOS",Description:"终极指标",IsMainIndex:!1,Args:[{Name:"N1",Value:7},{Name:"N2",Value:14},{Name:"N3",Value:28},{Name:"M",Value:6}],Script:"TH:=MAX(HIGH,REF(CLOSE,1));\nTL:=MIN(LOW,REF(CLOSE,1));\nACC1:=SUM(CLOSE-TL,N1)/SUM(TH-TL,N1);\nACC2:=SUM(CLOSE-TL,N2)/SUM(TH-TL,N2);\nACC3:=SUM(CLOSE-TL,N3)/SUM(TH-TL,N3);\nUOS:(ACC1*N2*N3+ACC2*N1*N3+ACC3*N1*N2)*100/(N1*N2+N1*N3+N2*N3);\nMAUOS:EXPMEMA(UOS,M);"}},n.prototype.CYW=function(){return{Name:"CYW",Description:"主力控盘",IsMainIndex:!1,Args:[],Script:"VAR1:=CLOSE-LOW;\nVAR2:=HIGH-LOW;\nVAR3:=CLOSE-HIGH;\nVAR4:=IF(HIGH>LOW,(VAR1/VAR2+VAR3/VAR2)*VOL,0);\nCYW: SUM(VAR4,10)/10000, COLORSTICK;"}},n.prototype.LON=function(){return{Name:"LON",Description:"龙系长线",IsMainIndex:!1,Args:[{Name:"N",Value:10}],Script:"LC := REF(CLOSE,1);\nVID := SUM(VOL,2)/(((HHV(HIGH,2)-LLV(LOW,2)))*100);\nRC := (CLOSE-LC)*VID;\nLONG := SUM(RC,0);\nDIFF := SMA(LONG,10,1);\nDEA := SMA(LONG,20,1);\nLON : DIFF-DEA;\nLONMA : MA(LON,10);\nLONT : LON, COLORSTICK;"}},n.prototype.NDB=function(){return{Name:"NDB",Description:"脑电波",IsMainIndex:!1,Args:[{Name:"P1",Value:5},{Name:"P2",Value:10}],Script:"HH:=IF(C/REF(C,1)>1.098 AND L>REF(H,1),2*C-REF(C,1)-H,2*C-H-L);\nV1:= BARSCOUNT(C) - 1;\nV2:= 2 * REF(C, V1) - REF(H, V1) - REF(L, V1);\nDK: SUM(HH, 0) + V2;\nMDK5: MA(DK, P1);\nMDK10: MA(DK, P2);"}},n.prototype.SKDJ=function(){return{Name:"SKDJ",Description:"慢速随机指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M",Value:3}],Script:"LOWV:=LLV(LOW,N);\nHIGHV:=HHV(HIGH,N);\nRSV:=EMA((CLOSE-LOWV)/(HIGHV-LOWV)*100,M);\nK:EMA(RSV,M);\nD:MA(K,M);"}},n.prototype.KD=function(){return{Name:"KD",Description:"随机指标KD",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:SMA(RSV,M1,1);\nD:SMA(K,M2,1);"}},n.prototype.FKX=function(){return{Name:"FKX",Description:"反K线",IsMainIndex:!0,Args:[],Script:"DRAWKLINE(-LOW, -OPEN, -HIGH, -CLOSE);"}},n.prototype.DKCOL=function(){return{Name:"DKCOL",Description:"多空能量柱(适用于分时主图)",IsMainIndex:!0,Args:[{Name:"N",Value:5}],Script:"FF:=(C-REF(C,N))/REF(C,N);\nSTICKLINE(FF>0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORRED;\nSTICKLINE(FF<0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORGREEN;"}},n.prototype.UDL=function(){return{Name:"UDL",Description:"引力线",IsMainIndex:!1,Args:[{Name:"N1",Value:3},{Name:"N2",Value:5},{Name:"N3",Value:10},{Name:"N4",Value:20},{Name:"M",Value:6}],Script:"UDL:(MA(CLOSE,N1)+MA(CLOSE,N2)+MA(CLOSE,N3)+MA(CLOSE,N4))/4;\nMAUDL:MA(UDL,M);"}},n.prototype.MFI=function(){return{Name:"MFI",Description:"资金流量指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"N2",Value:6}],Script:"TYP := (HIGH + LOW + CLOSE)/3;\nV1:=SUM(IF(TYP>REF(TYP,1),TYP*VOL,0),N)/SUM(IF(TYP<REF(TYP,1),TYP*VOL,0),N);\nMFI:100-(100/(1+V1));"}},n.prototype.LWR=function(){return{Name:"LWR",Description:"LWR威廉指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:= (HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N))*100;\nLWR1:SMA(RSV,M1,1);\nLWR2:SMA(LWR1,M2,1);"}},n.prototype.MARSI=function(){return{Name:"MARSI",Description:"相对强弱平均线",IsMainIndex:!1,Args:[{Name:"M1",Value:10},{Name:"M2",Value:6}],Script:"DIF:=CLOSE-REF(CLOSE,1);\nVU:=IF(DIF>=0,DIF,0);\nVD:=IF(DIF<0,-DIF,0);\nMAU1:=MEMA(VU,M1);\nMAD1:=MEMA(VD,M1);\nMAU2:=MEMA(VU,M2);\nMAD2:=MEMA(VD,M2);\nRSI10:MA(100*MAU1/(MAU1+MAD1),M1);\nRSI6:MA(100*MAU2/(MAU2+MAD2),M2);"}},n.prototype.CYD=function(){return{Name:"CYD",Description:"承接因子",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"CYDS:WINNER(CLOSE)/(VOL/CAPITAL);\nCYDN:WINNER(CLOSE)/MA(VOL/CAPITAL,N);"}},n.prototype.CYF=function(){return{Name:"CYF",Description:"市场能量",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"CYF:100-100/(1+EMA(HSL,N));"}},n.prototype.TAPI=function(){return{Name:"TAPI",Description:"加权指数成交值",IsMainIndex:!1,Args:[{Name:"M",Value:6}],Script:"TAPI:AMOUNT/INDEXC;\nMATAIP:MA(TAPI,M);"}},n.prototype.VMACD=function(){return{Name:"VMACD",Description:"量平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:EMA(VOL,SHORT)-EMA(VOL,LONG);\nDEA:EMA(DIF,MID);\nMACD:DIF-DEA,COLORSTICK;"}},n.prototype.QACD=function(){return{Name:"QACD",Description:"快速异同平均",IsMainIndex:!1,Args:[{Name:"N1",Value:12},{Name:"N2",Value:26},{Name:"M",Value:9}],Script:"DIF:EMA(CLOSE,N1)-EMA(CLOSE,N2);\nMACD:EMA(DIF,M);\nDDIF:DIF-MACD;"}},n.prototype.VPT=function(){return{Name:"VPT",Description:"量价曲线",IsMainIndex:!1,Args:[{Name:"N",Value:51},{Name:"M",Value:6}],Script:"VPT:SUM(VOL*(CLOSE-REF(CLOSE,1))/REF(CLOSE,1),N);\nMAVPT:MA(VPT,M);"}},n.prototype.WVAD=function(){return{Name:"WVAD",Description:"威廉变异离散量",IsMainIndex:!1,Args:[{Name:"N",Value:24},{Name:"M",Value:6}],Script:"WVAD:SUM((CLOSE-OPEN)/(HIGH-LOW)*VOL,N)/10000;\nMAWVAD:MA(WVAD,M);"}},n.prototype.DBQR=function(){return{Name:"WVAD",Description:"对比强弱",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M1",Value:10},{Name:"M2",Value:20},{Name:"M3",Value:60}],Script:"ZS:(INDEXC-REF(INDEXC,N))/REF(INDEXC,N);\nGG:(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\nMADBQR1:MA(GG,M1);\nMADBQR2:MA(GG,M2);\nMADBQR3:MA(GG,M3);"}},n.prototype.JS=function(){return{Name:"JS",Description:"加速线",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],Script:"JS:100*(CLOSE-REF(CLOSE,N))/(N*REF(CLOSE,N));\nMAJS1:MA(JS,M1);\nMAJS2:MA(JS,M2);\nMAJS3:MA(JS,M3);"}},n.prototype.CYE=function(){return{Name:"CYE",Description:"市场趋势",IsMainIndex:!1,Args:[],Script:"MAL:=MA(CLOSE,5);\nMAS:=MA(MA(CLOSE,20),5);\nCYEL:(MAL-REF(MAL,1))/REF(MAL,1)*100;\nCYES:(MAS-REF(MAS,1))/REF(MAS,1)*100;"}},n.prototype.QR=function(){return{Name:"QR",Description:"强弱指标",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"个股: (CLOSE-REF(CLOSE,N))/REF(CLOSE,N)*100; \n大盘: (INDEXC-REF(INDEXC,N))/REF(INDEXC,N)*100; \n强弱值:EMA(个股-大盘,2),COLORSTICK;"}},n.prototype.GDX=function(){return{Name:"GDX",Description:"轨道线",IsMainIndex:!1,Args:[{Name:"N",Value:30},{Name:"M",Value:9}],Script:"AA:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,N))/MA(CLOSE,N); \n轨道:DMA(CLOSE,AA);\n压力线:(1+M/100)*轨道; \n支撑线:(1-M/100)*轨道;"}},n.prototype.JLHB=function(){return{Name:"JLHB",Description:"绝路航标",IsMainIndex:!1,Args:[{Name:"N",Value:7},{Name:"M",Value:5}],Script:"VAR1:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*80; \nB:SMA(VAR1,N,1); \nVAR2:SMA(B,M,1); \n绝路航标:IF(CROSS(B,VAR2) AND B<40,50,0);"}},n.prototype.PCNT=function(){return{Name:"PCNT",Description:"幅度比",IsMainIndex:!1,Args:[{Name:"M",Value:5}],Script:"PCNT:(CLOSE-REF(CLOSE,1))/CLOSE*100;\nMAPCNT:EXPMEMA(PCNT,M);"}},n.prototype.AMO=function(){return{Name:"AMO",Description:"成交金额",IsMainIndex:!1,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],Script:"AMOW:AMOUNT/10000.0,VOLSTICK;\nAMO1:MA(AMOW,M1);\nAMO2:MA(AMOW,M2);"}},n.prototype.VRSI=function(){return{Name:"VRSI",Description:"相对强弱量",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"LC:=REF(VOL,1);\nRSI1:SMA(MAX(VOL-LC,0),N1,1)/SMA(ABS(VOL-LC),N1,1)*100;\nRSI2:SMA(MAX(VOL-LC,0),N2,1)/SMA(ABS(VOL-LC),N2,1)*100;\nRSI3:SMA(MAX(VOL-LC,0),N3,1)/SMA(ABS(VOL-LC),N3,1)*100;"}},n.prototype.HSCOL=function(){return{Name:"HSCOL",Description:"换手柱",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"HSCOL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100),VOLSTICK;\nMAHSL:MA(HSCOL,N);"}},n.prototype.DBQRV=function(){return{Name:"DBQRV",Description:"对比强弱量(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"ZS:(INDEXV-REF(INDEXV,N))/REF(INDEXV,N);\nGG:(VOL-REF(VOL,N))/REF(VOL,N);"}},n.prototype.DBLB=function(){return{Name:"DBLB",Description:"对比量比(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M",Value:5}],Script:"GG:=VOL/SUM(REF(VOL,1),N);\nZS:=INDEXV/SUM(REF(INDEXV,1),N);\nDBLB:GG/ZS;\nMADBLB:MA(DBLB,M);"}},n.prototype.ACD=function(){return{Name:"ACD",Description:"升降线",IsMainIndex:!1,Args:[{Name:"M",Value:20}],Script:"LC:=REF(CLOSE,1);\nDIF:=CLOSE-IF(CLOSE>LC,MIN(LOW,LC),MAX(HIGH,LC));\nACD:SUM(IF(CLOSE==LC,0,DIF),0);\nMAACD:EXPMEMA(ACD,M);"}},n.prototype.EXPMA=function(){return{Name:"EXPMA",Description:"指数平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:12},{Name:"M2",Value:50}],Script:"EXP1:EMA(CLOSE,M1);\nEXP2:EMA(CLOSE,M2);"}},n.prototype.EXPMA_S=function(){return{Name:"EXPMA_S",Description:"指数平均线-副图",IsMainIndex:!1,Args:[{Name:"M1",Value:12},{Name:"M2",Value:50}],Script:"EXP1:EMA(CLOSE,M1);\nEXP2:EMA(CLOSE,M2);"}},n.prototype.HMA=function(){return{Name:"HMA",Description:"高价平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"HMA1:MA(HIGH,M1);\nHMA2:MA(HIGH,M2);\nHMA3:MA(HIGH,M3);\nHMA4:MA(HIGH,M4);\nHMA5:MA(HIGH,M5);"}},n.prototype.LMA=function(){return{Name:"LMA",Description:"低价平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"LMA1:MA(LOW,M1);\nLMA2:MA(LOW,M2);\nLMA3:MA(LOW,M3);\nLMA4:MA(LOW,M4);\nLMA5:MA(LOW,M5);"}},n.prototype.VMA=function(){return{Name:"VMA",Description:"变异平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"VV:=(HIGH+OPEN+LOW+CLOSE)/4;\nVMA1:MA(VV,M1);\nVMA2:MA(VV,M2);\nVMA3:MA(VV,M3);\nVMA4:MA(VV,M4);\nVMA5:MA(VV,M5);"}},n.prototype.AMV=function(){return{Name:"AMV",Description:"成本价均线",IsMainIndex:!1,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"AMOV:=VOL*(OPEN+CLOSE)/2;\nAMV1:SUM(AMOV,M1)/SUM(VOL,M1);\nAMV2:SUM(AMOV,M2)/SUM(VOL,M2);\nAMV3:SUM(AMOV,M3)/SUM(VOL,M3);\nAMV4:SUM(AMOV,M4)/SUM(VOL,M4);"}},n.prototype.BBIBOLL=function(){return{Name:"BBIBOLL",Description:"多空布林线",IsMainIndex:!0,Args:[{Name:"N",Value:11},{Name:"M",Value:6}],Script:"CV:=CLOSE;\nBBIBOLL:(MA(CV,3)+MA(CV,6)+MA(CV,12)+MA(CV,24))/4;\nUPR:BBIBOLL+M*STD(BBIBOLL,N);\nDWN:BBIBOLL-M*STD(BBIBOLL,N);"}},n.prototype.ALLIGAT=function(){return{Name:"ALLIGAT",Description:"鳄鱼线",IsMainIndex:!0,Args:[],Script:"NN:=(H+L)/2;\n上唇:REF(MA(NN,5),3),COLOR40FF40;\n牙齿:REF(MA(NN,8),5),COLOR0000C0;\n下颚:REF(MA(NN,13),8),COLORFF4040;"}},n.prototype.ZX=function(){return{Name:"ZX",Description:"重心线",IsMainIndex:!1,Args:[],Script:"AV:0.01*AMOUNT/VOL;"}},n.prototype.XS=function(){return{Name:"XS",Description:"薛斯通道",IsMainIndex:!0,Args:[{Name:"N",Value:13}],Script:"VAR2:=CLOSE*VOL;\nVAR3:=EMA((EMA(VAR2,3)/EMA(VOL,3)+EMA(VAR2,6)/EMA(VOL,6)+EMA(VAR2,12)/EMA(VOL,12)+EMA(VAR2,24)/EMA(VOL,24))/4,N);\nSUP:1.06*VAR3;\nSDN:VAR3*0.94;\nVAR4:=EMA(CLOSE,9);\nLUP:EMA(VAR4*1.14,5);\nLDN:EMA(VAR4*0.86,5);"}},n.prototype.XS2=function(){return{Name:"XS2",Description:"薛斯通道II",IsMainIndex:!0,Args:[{Name:"N",Value:102},{Name:"M",Value:7}],Script:"AA:=MA((2*CLOSE+HIGH+LOW)/4,5); \n通道1:AA*N/100; \n通道2:AA*(200-N)/100; \nCC:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,20))/MA(CLOSE,20); \nDD:=DMA(CLOSE,CC); \n通道3:(1+M/100)*DD; \n通道4:(1-M/100)*DD;"}},n.prototype.SG_XDT=function(){return{Name:"SG-XDT",Description:"心电图(需下载日线)",IsMainIndex:!1,Args:[{Name:"P1",Value:5},{Name:"P2",Value:10}],Script:"QR:CLOSE/INDEXC*1000;\nMQR1:MA(QR,5);\nMQR2:MA(QR,10);"}},n.prototype.SG_SMX=function(){return{Name:"SG-SMX",Description:"生命线(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:50}],Script:"H1:=HHV(HIGH,N);\nL1:=LLV(LOW,N);\nH2:=HHV(INDEXH,N);\nL2:=LLV(INDEXL,N);\nZY:=CLOSE/INDEXC*2000;\nZY1:EMA(ZY,3);\nZY2:EMA(ZY,17);\nZY3:EMA(ZY,34);"}},n.prototype.SG_LB=function(){return{Name:"SG-LB",Description:"量比(需下载日线)",IsMainIndex:!1,Args:[],Script:"ZY2:=VOL/INDEXV*1000;\n量比:ZY2;\nMA5:MA(ZY2,5);\nMA10:MA(ZY2,10);"}},n.prototype.SG_PF=function(){return{Name:"SG-PF",Description:"强势股评分(需下载日线)",IsMainIndex:!1,Args:[],Script:"ZY1:=CLOSE/INDEXC*1000;\nA1:=IF(ZY1>HHV(ZY1,3),10,0);\nA2:=IF(ZY1>HHV(ZY1,5),15,0);\nA3:=IF(ZY1>HHV(ZY1,10),20,0);\nA4:=IF(ZY1>HHV(ZY1,2),10,0);\nA5:=COUNT(ZY1>REF(ZY1,1) ,9)*5;\n强势股评分:A1+A2+A3+A4+A5;"}},n.prototype.RAD=function(){return{Name:"RAD",Description:"威力雷达(需下载日线)",IsMainIndex:!1,Args:[{Name:"D",Value:3},{Name:"S",Value:30},{Name:"M",Value:30}],Script:"SM:=(OPEN+HIGH+CLOSE+LOW)/4;\nSMID:=MA(SM,D);\nIM:=(INDEXO+INDEXH+INDEXL+INDEXC)/4;\nIMID:=MA(IM,D);\nSI1:=(SMID-REF(SMID,1))/SMID;\nII:=(IMID-REF(IMID,1))/IMID;\nRADER1:SUM((SI1-II)*2,S)*1000;\nRADERMA:SMA(RADER1,M,1);"}},n.prototype.SHT=function(){return{Name:"SHT",Description:"龙系短线",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"VAR1:=MA((VOL-REF(VOL,1))/REF(VOL,1),5);\nVAR2:=(CLOSE-MA(CLOSE,24))/MA(CLOSE,24)*100;\nMY: VAR2*(1+VAR1);\nSHT: MY, COLORSTICK;\nSHTMA: MA(SHT,N);"}},n.prototype.ZLJC=function(){return{Name:"ZLJC",Description:"主力进出",IsMainIndex:!1,Args:[],Script:"VAR1:=(CLOSE+LOW+HIGH)/3; \nVAR2:=SUM(((VAR1-REF(LOW,1))-(HIGH-VAR1))*VOL/100000/(HIGH-LOW),0); \nVAR3:=EMA(VAR2,1); \nJCS:VAR3; \nJCM:MA(VAR3,12); \nJCL:MA(VAR3,26);"}},n.prototype.ZLMM=function(){return{Name:"ZLMM",Description:"主力买卖",IsMainIndex:!1,Args:[],Script:"LC :=REF(CLOSE,1);\nRSI2:=SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100;\nRSI3:=SMA(MAX(CLOSE-LC,0),18,1)/SMA(ABS(CLOSE-LC),18,1)*100;\nMMS:MA(3*RSI2-2*SMA(MAX(CLOSE-LC,0),16,1)/SMA(ABS(CLOSE-LC),16,1)*100,3);\nMMM:EMA(MMS,8);\nMML:MA(3*RSI3-2*SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100,5);"}},n.prototype.SLZT=function(){return{Name:"SLZT",Description:"神龙在天",IsMainIndex:!1,Args:[],Script:"白龙: MA(CLOSE,125);\n黄龙: 白龙+2*STD(CLOSE,170);\n紫龙: 白龙-2*STD(CLOSE,145);\n青龙: SAR(125,1,7), LINESTICK;\nVAR2:=HHV(HIGH,70);\nVAR3:=HHV(HIGH,20);\n红龙: VAR2*0.83;\n蓝龙: VAR3*0.91;"}},n.prototype.ADVOL=function(){return{Name:"ADVOL",Description:"龙系离散量",IsMainIndex:!1,Args:[],Script:"A:=SUM(((CLOSE-LOW)-(HIGH-CLOSE))*VOL/10000/(HIGH-LOW),0);\nADVOL:A;\nMA1:MA(A,30);\nMA2:MA(MA1,100);"}},n.prototype.CYC=function(){return{Name:"CYC",Description:"成本均线",IsMainIndex:!0,Args:[{Name:"P1",Value:5},{Name:"P2",Value:13},{Name:"P3",Value:34}],Script:"JJJ:=IF(DYNAINFO(8)>0.01,0.01*DYNAINFO(10)/DYNAINFO(8),DYNAINFO(3));\nDDD:=(DYNAINFO(5)<0.01 || DYNAINFO(6)<0.01);\nJJJT:=IF(DDD,1,(JJJ<(DYNAINFO(5)+0.01) && JJJ>(DYNAINFO(6)-0.01)));\nCYC1:IF(JJJT,0.01*EMA(AMOUNT,P1)/EMA(VOL,P1),EMA((HIGH+LOW+CLOSE)/3,P1));\nCYC2:IF(JJJT,0.01*EMA(AMOUNT,P2)/EMA(VOL,P2),EMA((HIGH+LOW+CLOSE)/3,P2));\nCYC3:IF(JJJT,0.01*EMA(AMOUNT,P3)/EMA(VOL,P3),EMA((HIGH+LOW+CLOSE)/3,P3));\nCYC4:IF(JJJT,DMA(AMOUNT/(100*VOL),100*VOL/FINANCE(7)),EMA((HIGH+LOW+CLOSE)/3,120));"}},n.prototype.CYS=function(){return{Name:"CYS",Description:"市场盈亏",IsMainIndex:!1,Args:[],Script:"CYC13:EMA(AMOUNT,13)/EMA(VOL,13);\nCYS:(CLOSE-CYC13)/CYC13*100;"}},n.prototype.CYQKL=function(){return{Name:"CYQKL",Description:"博弈K线长度",IsMainIndex:!1,Args:[],Script:"KL:100*(WINNER(CLOSE)-WINNER(OPEN));"}},n.prototype.SCR=function(){return{Name:"SCR",Description:"筹码集中度",IsMainIndex:!1,Args:[{Name:"P1",Value:90}],Script:"A:=P1+(100-P1)/2;\nB:=(100-P1)/2;\nCC:=COST(A);\nDD:=COST(B);\nSCR:(CC-DD)/(CC+DD)*100/2;"}},n.prototype.ASR=function(){return{Name:"ASR",Description:"浮筹比例",IsMainIndex:!1,Args:[],Script:"ASR:(WINNER(C*1.1)-WINNER(C*0.9))/WINNER(HHV(H,0))*100;"}},n.prototype.SAR=function(){return{Name:"SAR",Description:"抛物转向",IsMainIndex:!0,Args:[{Name:"P",Value:10},{Name:"STEP",Value:2},{Name:"MAXP",Value:20}],Script:"S:SAR(P,STEP,MAXP),UPDOWNDOT;"}},n.prototype.TJCJL=function(){return{Name:"太极成交量",Description:"太极成交量",IsMainIndex:!0,Args:[],Script:"总手:VOL,NODRAW;\nZZ:=IF(REF(C,1)>REF(O,1) AND O>REF(C,1)*1.014 AND C<O*1.02,1,3);\nV5:=MA(V,5);\nV12:=MA(V,12);\nV34:=MA(V,34);\nC6:=MA(C,6);\nSTICKLINE(VOL,0,VOL,10,0),COLORLIGRAY;\nSTICKLINE(CROSS(C,C6) AND V>V5*1.2 AND V>V12*1.2 AND ZZ>2 AND C>H*0.975,0,VOL,10,0),COLORRED;\nSTICKLINE(CROSS(C6,C) AND V>V5*1.2 AND V>V12*1.2,0,VOL,10,0),COLORGREEN;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05,0,VOL,10,0),COLORYELLOW;\nSTICKLINE(VOL<MA(VOL,5)/2 AND V<V12/2,0,VOL,10,0),COLORBLUE;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05 AND CROSS(C,C6) AND V>V5*1.2 AND V>V12*1.2 AND ZZ>2 AND C>H*0.975,VOL*0.5,0,10,0),COLORRED;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05 AND CROSS(C6,C) AND V>V5*1.2 AND V>V12*1.2,VOL*0.5,0,10,0),COLORRED;"}},n.prototype.VOLRate=function(){var t={Name:"量比",Description:"量比",IsMainIndex:!1,Condition:{Period:[i.MINUTE_ID,i.MULTIDAY_MINUTE_ID]},Args:[],Script:"LIANGBI:VOLR;"};return t},n.prototype.Dragon4_Main=function(){return{Name:"飞龙四式",Description:"飞龙四式",IsMainIndex:!0,Args:[{Name:"N1",Value:5},{Name:"N2",Value:10},{Name:"N3",Value:50},{Name:"N4",Value:60}],Script:"蜻蜓点水:=EMA(CLOSE,N1),COLORGRAY;\n魔界:=EMA(CLOSE,N2),COLORGREEN;\n水:=EMA(CLOSE,N3),COLORRED;\nDRAWKLINE(HIGH,OPEN,LOW,CLOSE);\n生命线:MA(CLOSE,N4),COLORBLUE,LINETHICK2;\nDRAWBAND(魔界,'RGB(186,225,250)',水,'RGB(253,194,124)');\nDRAWBAND(蜻蜓点水,'RGB(128,138,135)',魔界,'RGB(0,0,255)');"}},n.prototype.Dragon4_Fig=function(){return{Name:"飞龙四式",Description:"飞龙四式",IsMainIndex:!1,Args:[],Script:"倍:VOL>=REF(V,1)*1.90 AND C>REF(C,1),COLORYELLOW;\n低:VOL<REF(LLV(VOL,13),1),COLORGREEN;\n地:VOL<REF(LLV(VOL,100),1),COLORMAGENTA; \n平:=ABS(VOL-HHV(REF(VOL,1),5))/HHV(REF(VOL,1),5)<=0.03 OR ABS(VOL-REF(VOL,1))/REF(VOL,1)<=0.03,NODRAW,COLORWHITE;\n倍缩:VOL<=REF(V,1)*0.5,COLORFF8000;\n梯量:COUNT(V>REF(V,1),3)==3 AND COUNT(C>O,3)==3,COLORBROWN;\n缩量涨:COUNT(C>REF(C,1),2)==2 AND COUNT(V<REF(V,1),2)==2,COLORBLUE;\nSTICKLINE(C>=REF(C,1),V,0,2,0),COLORRED;\nSTICKLINE(C<REF(C,1),V,0,2,0),COLORGREEN;\nSTICKLINE(倍,0,V,2,0),COLORYELLOW;\nSTICKLINE(低,0,V,2,0),COLORGREEN;\nSTICKLINE(地,0,V,2,0),COLORLIMAGENTA;\nSTICKLINE(平,0,V,2,0),COLORGRAY;\nSTICKLINE(倍缩,0,V,2,0),COLORFF8000;\nSTICKLINE(梯量,0,V,2,0),COLORBROWN;\nSTICKLINE(缩量涨,0,V,2,0),COLORBLUE;"}},n.prototype.FundsAnalysis=function(){return{Name:"资金分析",Description:"资金分析",IsMainIndex:!1,Args:[{Name:"M",Value:55},{Name:"N",Value:34}],Script:"LC:=REF(CLOSE,1);\nRSI:=((SMA(MAX((CLOSE - LC),0),3,1) / SMA(ABS((CLOSE - LC)),3,1)) * 100);\nFF:=EMA(CLOSE,3);\nMA15:=EMA(CLOSE,21); DRAWTEXT(CROSS(85,RSI),75,'▼'),COLORGREEN;\nVAR1:=IF(YEAR>=2038 AND MONTH>=1,0,1);\nVAR2:=REF(LOW,1)*VAR1;\nVAR3:=SMA(ABS(LOW-VAR2),3,1)/SMA(MAX(LOW-VAR2,0),3,1)*100*VAR1;\nVAR4:=EMA(IF(CLOSE*1.3,VAR3*10,VAR3/10),3)*VAR1;\nVAR5:=LLV(LOW,30)*VAR1;\nVAR6:=HHV(VAR4,30)*VAR1;\nVAR7:=IF(MA(CLOSE,58),1,0)*VAR1;\nVAR8:=EMA(IF(LOW<=VAR5,(VAR4+VAR6*2)/2,0),3)/618*VAR7*VAR1;\n吸筹A:IF(VAR8>100,100,VAR8)*VAR1,COLORFB2F3B;\n{吸筹B}STICKLINE(吸筹A>-150,0,吸筹A,8,0),COLORFB2F3B;\n\n散户线: 100*(HHV(HIGH,M)-CLOSE)/(HHV(HIGH,M)-LLV(LOW,M)),COLORAA89BD,LINETHICK2;\nRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:=SMA(RSV,3,1);\nD:=SMA(K,3,1);\nJ:=3*K-2*D;\n主力线:EMA(J,5),COLORF39800,LINETHICK2;\nDRAWICON(CROSS(主力线,散户线),主力线,1);\nDRAWICON(CROSS(散户线,主力线),主力线,2);"}},n.prototype.MarginProportion=function(){return{Name:"融资占比(%)",Description:"融资占比",IsMainIndex:!1,Args:[],Script:"占比:MARGIN(2);"}},n.prototype.BTX=function(){return{Name:"BTX",Description:"宝塔线",IsMainIndex:!1,Args:[],Script:"B1:=REF(C,1);\nB2:= REF(C, 2);\nSS:= IF(C > REF(C, 1) AND REF(C, 1) >= REF(C, 2), 1, IF(C < REF(C, 1) AND REF(C, 1) <= REF(C, 2), -1, IF(C > REF(C, 2) AND REF(C, 2) > REF(C, 1), 2, IF(C < REF(C, 2) AND REF(C, 2) < REF(C, 1), -2, 0))));\nSM:= IF(REF(SS, 1) <> 0, REF(SS, 1), IF(REF(SS, 2) <> 0, REF(SS, 2), IF(REF(SS, 3) <> 0, REF(SS, 3), IF(REF(SS, 5) <> 0, REF(SS, 5), IF(REF(SS, 6) <> 0, REF(SS, 6), IF(REF(SS, 7) <> 0, REF(SS, 7), 0))))));\nMC:= IF(REF(SS, 1) <> 0, B2, IF(SM > 0, MIN(B1, B2), MAX(B1, B2)));\nTOW1:= IF(C > REF(C, 1), C, REF(C, 1));\nTOW2:= IF((SS == -1 OR SS == -2) AND SM > 0, B2, TOW1);\nTOWER:= IF(TOW1 > TOW2, TOW1, TOW2);\nSTICKLINE(SS == 1 OR SM >= 1 AND SS == 0, B1, C, 10, 1), COLORRED;\nSTICKLINE(SS == -1 OR SM <= -1 AND SS == 0, B1, C, 10, 0), COLORCYAN;\nSTICKLINE(SS == 2, B2, C, 10, 1), COLORRED;\nSTICKLINE(SS == -2, B2, C, 10, 0), COLORCYAN;\nSTICKLINE((SS == -1 OR SS == -2) AND SM > 0, B2, B1, 10, 1), COLORRED;\nSTICKLINE((SS == 1 OR SS == 2) AND SM < 0, B2, B1, 10, 0), COLORCYAN;"}},n.prototype.EMPTY=function(){return{Name:"",Description:"空指标",IsMainIndex:!0,Args:[],Script:"VAR2:=C;"}},n.prototype.FXG_BSPoint=function(){return{Name:"操盘BS点",Description:"操盘BS点",IsMainIndex:!0,Args:[],Script:"MA5:MA(CLOSE,5);\n        MA13:MA(CLOSE,13);\n        MA21:MA(CLOSE,21);\n        MA34:MA(CLOSE,34);\n        {MA55:MA(CLOSE,55),COLOR0000FF;}\n        {MA120:=MA(CLOSE,120),COLORFFFF00;}\n        天使:=EMA(C,2),COLOR000000;\n        魔鬼:=EMA(SLOPE(C,21)*20+C,42),COLOR000000;\n        买:=CROSS(天使,魔鬼);\n        卖:=CROSS(魔鬼,天使);\n        DRAWICON(买,L*0.99,13),COLORYELLOW;\n        DRAWICON(卖,H*1.01,14),COLORGREEN;\n        DRAWKLINE_IF(天使>=魔鬼,HIGH,CLOSE,LOW,OPEN),COLORRED;\n        DRAWKLINE_IF(天使<魔鬼,HIGH,CLOSE,LOW,OPEN),COLORBLUE;\n        DRAWKLINE_IF(CROSS(天使,魔鬼),HIGH,CLOSE,LOW,OPEN),COLORYELLOW;\n        DRAWKLINE_IF(CROSS(魔鬼,天使),HIGH,CLOSE,LOW,OPEN),COLORBLACK;"}},n.prototype.NewsNegative=function(){return{Name:"负面新闻",Description:"负面新闻统计",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"N2",Value:10}],Script:"负面:NEWS(1);\n                MA1:MA(负面,N);\n                MA2:MA(负面,N2);"}},n.prototype.NewsResearch=function(){return{Name:"机构调研",Description:"机构调研统计",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"N2",Value:10}],Script:"次数:NEWS(2);\n                MA1:MA(次数,N);\n                MA2:MA(次数,N2);"}},n.prototype.NewsInteract=function(){return{Name:"董秘连线",Description:"互动易统计",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"N2",Value:10}],Script:"个数:NEWS(3);\n                MA1:MA(个数,N);\n                MA2:MA(个数,N2);"}},n.prototype.UpDownAnalyze=function(){return{Name:"涨跌趋势",Description:"涨跌趋势",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"上涨家数:UPCOUNT('CNA.CI'),COLORRED;\n下跌家数:DOWNCOUNT('CNA.CI'),COLORGREEN;"}},n.prototype.FXG_BSPoint=function(){return{Name:"操盘BS点",Description:"操盘BS点",IsMainIndex:!0,Args:[],Script:'MA5:MA(CLOSE,5);\n        MA13:MA(CLOSE,13);\n        MA21:MA(CLOSE,21);\n        MA34:MA(CLOSE,34);\n        {MA55:MA(CLOSE,55),COLOR0000FF;}\n        {MA120:=MA(CLOSE,120),COLORFFFF00;}\n        天使:=EMA(C,2),COLOR000000;\n        魔鬼:=EMA(SLOPE(C,21)*20+C,42),COLOR000000;\n        买:=CROSS(天使,魔鬼);\n        卖:=CROSS(魔鬼,天使);\n        SUPERDRAWTEXT(买,L,"B",2,5),COLORYELLOW;\n        SUPERDRAWTEXT(卖,L,"S",1,5),COLORGREEN;\n        DRAWKLINE_IF(天使>=魔鬼,HIGH,CLOSE,LOW,OPEN),COLORRED;\n        DRAWKLINE_IF(天使<魔鬼,HIGH,CLOSE,LOW,OPEN),COLORBLUE;\n        DRAWKLINE_IF(CROSS(天使,魔鬼),HIGH,CLOSE,LOW,OPEN),COLORYELLOW;\n        DRAWKLINE_IF(CROSS(魔鬼,天使),HIGH,CLOSE,LOW,OPEN),COLORBLACK;'}},n.prototype.FXG_INDEX=function(){return{Name:"涨停多空线",Description:"涨停多空线",IsMainIndex:!1,Args:[],Script:"做多能量线: SMA((CLOSE-LLV(LOW,9))/(HHV(HIGH,9)-LLV(LOW,9))*100,5,1)-8,COLORRED,LINETHICK3;\n做空能量线: SMA((HHV(HIGH,36)-CLOSE)/(HHV(HIGH,36)-LLV(LOW,36))*100,2,1),COLORGREEN,LINETHICK3;\n20,POINTDOT,COLORF00FF0;\n50,POINTDOT,COLORGREEN;\n80,POINTDOT,COLORLIBLUE;"}},n.prototype.FXG_INDEX2=function(){return{Name:"涨停吸筹区",Description:"涨停吸筹区",IsMainIndex:!1,Args:[],Script:"VAR0:=EMA(HHV(HIGH,500),21); \nVAR1:=EMA(HHV(HIGH,250),21);\nVAR2:=EMA(HHV(HIGH,90),21); \nVAR3:=EMA(LLV(LOW,500),21); \nVAR4:=EMA(LLV(LOW,250),21); \nVAR5:=EMA(LLV(LOW,90),21);\n\nVAR6:=EMA((VAR3*0.96+VAR4*0.96+VAR5*0.96+VAR0*0.558+VAR1*0.558+VAR2*0.558)/6,21); \nVAR7:=EMA((VAR3*1.25+VAR4*1.23+VAR5*1.2+VAR0*0.55+VAR1*0.55+VAR2*0.65)/6,21); \nVAR8:=EMA((VAR3*1.3+VAR4*1.3+VAR5*1.3+VAR0*0.68+VAR1*0.68+VAR2*0.68)/6,21); \nVAR9:=EMA((VAR6*3+VAR7*2+VAR8)/6*1.738,21); \nVAR10:=REF(LOW,1); \nVAR11:=SMA(ABS(LOW-VAR10),3,1)/SMA(MAX(LOW-VAR10,0),3,1)*100; \nVAR12:=EMA(IFF(CLOSE*1.35<=VAR9,VAR11*10,VAR11/10),3); \nVAR13:=LLV(LOW,30); \nVAR14:=HHV(VAR12,30); \nVAR15:=IFF(MA(CLOSE,58),1,0); \nVAR16:=EMA(IFF(LOW<=VAR13,(VAR12+VAR14*2)/2,0),3)/618*VAR15;\n\n资金入场:IFF(VAR16>0,VAR16,0),LINETHICK,LINETHICK2, COLORFF0000; \n\nA1:IFF(资金入场>0,资金入场*1.2,0),STICK,LINETHICK5, COLORFF0000;\nA2:IFF(资金入场>0,资金入场*0.8,0),STICK,LINETHICK5, COLORFF6600;\nA3:IFF(资金入场>0,资金入场*0.6,0),STICK,LINETHICK5, COLORFF9900;\nA4:IFF(资金入场>0,资金入场*0.4,0) ,STICK,LINETHICK5,COLORFFCC00;\nA5:IFF(资金入场>0,资金入场*0.2,0) ,STICK,LINETHICK5,COLORFFFF00;"}},n.prototype.FXG_INDEX3=function(){return{Name:"量能黄金点",Description:"量能黄金点",IsMainIndex:!1,Args:[],Script:"A:=IFF((CLOSE>126.32),VOL,VOL); \n主力:=MA(A,4),COLORRED;\n游资:=MA(A,8),COLORYELLOW;\n大户:=MA(A,16),COLORF0F000;\n散户:=MA(A,32),COLOR00FF00;\n主比:=ABS(((主力)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORRED;\n游比:=ABS(((游资)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORYELLOW;\n大比:=ABS(((大户)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORF0F000;\n散比:=ABS(((散户)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLOR00FF00;\n警戒线:MA(A,180),COLORFF66FF;\nSTICKLINE((主力 > 0),0,主力,2.5,0),COLOR1020BB;\nSTICKLINE((主力 > 0),0,主力,0.7,0),COLORRED;\nSTICKLINE((游资 > 0),0,游资,2.5,0),COLOR009CFF;\nSTICKLINE((游资 > 0),0,游资,0.7,0),COLORYELLOW;\nSTICKLINE((大户 > 0),0,大户,2.5,0),COLORFF8800;\nSTICKLINE((大户 > 0),0,大户,0.7,0),COLORLIBLUE;\nSTICKLINE((散户 > 0),0,散户,2.5,0),COLOR00CA00;\nSTICKLINE((散户 > 0),0,散户,0.7,0),COLORGREEN;"}},n.prototype.COLOR_KSTAR1=function(){return{Name:"十字星",Description:"十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&HIGH>LOW;"}},n.prototype.COLOR_KSTAR2=function(){return{Name:"早晨之星",Description:"早晨之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:(REF(CLOSE,2)/REF(OPEN,2)<0.95) && (REF(OPEN,1) < REF(CLOSE,2)) && (ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03) && CLOSE/OPEN>1.05 && CLOSE>REF(CLOSE,2);"}},n.prototype.COLOR_KSTAR3=function(){return{Name:"黄昏之星",Description:"黄昏之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05 && REF(OPEN,1)>REF(CLOSE,2) && ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03 && CLOSE/OPEN<0.95 && CLOSE<REF(CLOSE,2);"}},n.prototype.COLOR_SHI1=function(){return{Name:"长十字",Description:"长十字",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&HIGH/LOW>1.03;"}},n.prototype.COLOR_K220=function(){return{Name:"身怀六甲",Description:"身怀六甲",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1)>0.04&&\n            ABS(CLOSE-OPEN)/CLOSE<0.005&&\n            MAX(CLOSE,OPEN)<MAX(REF(CLOSE,1),REF(OPEN,1))&&\n            MIN(CLOSE,OPEN)>MIN(REF(CLOSE,1),REF(OPEN,1));"}},n.prototype.COLOR_K300=function(){return{Name:"三个白武士",Description:"三个白武士",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:UPNDAY(CLOSE,3)&&NDAY(CLOSE,OPEN,3);"}},n.prototype.COLOR_K310=function(){return{Name:"三只乌鸦",Description:"三只乌鸦",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:DOWNNDAY(CLOSE,3)&&NDAY(OPEN,CLOSE,3);"}},n.prototype.COLOR_K380=function(){return{Name:"光头阳线",Description:"光头阳线",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:HIGH==CLOSE&&HIGH>LOW;"}},n.prototype.COLOR_K390=function(){return{Name:"光脚阴线",Description:"光脚阴线",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:LOW==CLOSE&&HIGH>LOW;"}},n.prototype.COLOR_K134=function(){return{Name:"垂死十字",Description:"垂死十字",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&CLOSE==LOW&&CLOSE<HIGH;"}},n.prototype.COLOR_K140=function(){return{Name:"早晨十字星",Description:"早晨十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)<0.95&&\nREF(OPEN,1)<REF(CLOSE,2)&&\nREF(OPEN,1)==REF(CLOSE,1)&&\nCLOSE/OPEN>1.05&&CLOSE>REF(CLOSE,2);"}},n.prototype.COLOR_K150=function(){return{Name:"黄昏十字星",Description:"黄昏十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05&&\nREF(OPEN,1)>REF(CLOSE,2)&&\nREF(OPEN,1)=REF(CLOSE,1)&&\nCLOSE/OPEN<0.95&&CLOSE<REF(CLOSE,2);"}},n.prototype.COLOR_K160=function(){return{Name:"射击之星",Description:"射击之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:MIN(OPEN,CLOSE)==LOW&&\nHIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&\nCLOSE>MA(CLOSE,5);"}},n.prototype.COLOR_K165=function(){return{Name:"倒转锤头",Description:"倒转锤头",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:MIN(OPEN,CLOSE)==LOW&&\nHIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&\nCLOSE<MA(CLOSE,5);"}},n.prototype.COLOR_K170=function(){return{Name:"锤头",Description:"锤头",IsMainIndex:!0,InstructionType:2,Script:"OUT:HIGH==MAX(OPEN,CLOSE)&&\nHIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&\nCLOSE<MA(CLOSE,5);"}},n.prototype.COLOR_K180=function(){return{Name:"吊颈",Description:"吊颈",IsMainIndex:!0,InstructionType:2,Script:"OUT:HIGH==MAX(OPEN,CLOSE)&&\nHIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&\nCLOSE>MA(CLOSE,5);"}},n.prototype.COLOR_K190=function(){return{Name:"穿头破脚",Description:"穿头破脚",IsMainIndex:!0,InstructionType:2,Script:"OUT:(REF(CLOSE,1)/REF(OPEN,1)>1.03&&\nCLOSE/OPEN<0.96&&\nCLOSE<REF(OPEN,1)&&OPEN>REF(CLOSE,1))||\n(REF(CLOSE,1)/REF(OPEN,1)<0.97&&\nCLOSE/OPEN>1.04&&\nCLOSE>REF(OPEN,1)&&OPEN<REF(CLOSE,1));"}},n.prototype.COLOR_SWORD=function(){return{Name:"剑",Description:"剑",IsMainIndex:!0,InstructionType:2,Script:"AA:=VOL>REF(VOL,1)||VOL>(CAPITAL*0.1);\nBB:=OPEN>=(REF(HIGH,1))&&REF(HIGH,1)>(REF(HIGH,2)*1.06);\nCC:=CLOSE>(REF(CLOSE,1))-(REF(CLOSE,1)*0.01);\nDD:=CLOSE<(HIGH*0.965) && HIGH>(OPEN*1.05);\nEE:=LOW<OPEN && LOW<CLOSE&&HIGH>(REF(CLOSE,1)*1.06);\nFF:=(HIGH-(MAX(OPEN,CLOSE)))/2>(MIN(OPEN,CLOSE))-LOW;\nGG:=(ABS(OPEN-CLOSE))/2<(MIN(OPEN,CLOSE)-LOW);\nSWORDO:AA&&BB&&CC&&DD&&EE&&FF&&GG;"}},n.prototype.COLOR_CSFR=function(){return{Name:"出水芙蓉",Description:"出水芙蓉",IsMainIndex:!0,InstructionType:2,Script:"A:=CLOSE>OPEN;\nB:=A&&CLOSE>MA(CLOSE,S)&&CLOSE>MA(CLOSE,M)&&CLOSE>MA(CLOSE,LL);\nCC:=B&&OPEN<MA(CLOSE,M)&&OPEN<MA(CLOSE,LL);\nCSFRO:CC&&(CLOSE-OPEN)>0.0618*CLOSE;"}},n.prototype.COLOR_WYGD=function(){return{Name:"乌云盖顶",Description:"乌云盖顶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,1)/REF(OPEN,1)>1.03 AND \nCLOSE/OPEN<0.97 AND \nOPEN>REF(CLOSE,1) AND CLOSE<REF(CLOSE,1), 3);"}},n.prototype.COLOR_SGCJ=function(){return{Name:"乌云盖顶",Description:"乌云盖顶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,1)/REF(OPEN,1)<0.97 AND \nCLOSE/OPEN>1.03 AND \nOPEN<REF(CLOSE,1) AND CLOSE>REF(CLOSE,1), 3);"}},n.prototype.COLOR_SZTAI=function(){return{Name:"十字胎",Description:"十字胎",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1) > 0.04 AND \nCLOSE==OPEN AND CLOSE < MAX(REF(CLOSE,1),REF(OPEN,1)) AND \nCLOSE > MIN(REF(CLOSE,1),REF(OPEN,1)), 2);"}},n.prototype.COLOR_PINGDING=function(){return{Name:"平顶",Description:"平顶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET(ABS(HIGH-REF(HIGH,1))/HIGH<0.001,2);"}},n.prototype.COLOR_PINGDI=function(){return{Name:"平底",Description:"平底",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET((ABS(LOW-REF(LOW,1))/LOW<0.001 AND \nABS(REF(LOW,1)-REF(LOW,2))/REF(LOW,1)<=0.001),2);"}},n.prototype.COLOR_DAYANZHU=function(){return{Name:"大阳烛",Description:"大阳烛",IsMainIndex:!0,InstructionType:2,Script:"VAR1:CLOSE/OPEN>1.05 AND HIGH/LOW < CLOSE/OPEN+0.018;"}},n.prototype.COLOR_DAYINGZHU=function(){return{Name:"大阴烛",Description:"大阴烛",IsMainIndex:!0,InstructionType:2,Script:"VAR1:OPEN/CLOSE > 1.05 AND HIGH/LOW < OPEN/CLOSE+0.018;"}},n.prototype.COLOR_HYFG=function(){return{Name:"好友反攻",Description:"好友反攻",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( (REF(CLOSE,1)<REF(OPEN,1) AND \nCLOSE>OPEN AND ABS(CLOSE-REF(CLOSE,1))/CLOSE<0.002),2);"}},n.prototype.COLOR_TKQK=function(){return{Name:"跳空缺口",Description:"跳空缺口",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( HIGH<REF(LOW,1) OR LOW>REF(HIGH,1),2);"}},n.prototype.COLOR_SFWY=function(){return{Name:"双飞乌鸦",Description:"双飞乌鸦",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( REF(CLOSE,1)<REF(OPEN,1) AND CLOSE<OPEN AND CLOSE/OPEN<0.98,1);"}},n.prototype.COLOR_SSSBQ=function(){return{Name:"上升三部曲",Description:"上升三部曲",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,4)/REF(OPEN,4)>1.03 AND \nREF(CLOSE,3)<REF(OPEN,3) AND \nREF(CLOSE,2)<REF(OPEN,2) AND \nREF(CLOSE,1)<REF(OPEN,1) AND \nREF(LOW,4)<REF(LOW,3) AND \nREF(LOW,4)<REF(LOW,2) AND \nREF(LOW,4)<REF(LOW,1) AND \nREF(HIGH,4)>REF(HIGH,3) AND \nREF(HIGH,4)>REF(HIGH,2) AND \nREF(HIGH,4)>REF(HIGH,1) AND \nCLOSE/OPEN>1.03 AND \nCLOSE>REF(CLOSE,4), 5);"}},n.prototype.COLOR_XDSBQ=function(){return{Name:"下跌三部曲",Description:"下跌三部曲",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,4)/REF(OPEN,4)<0.97 AND \nREF(CLOSE,3)>REF(OPEN,3) AND \nREF(CLOSE,2)>REF(OPEN,2) AND \nREF(CLOSE,1)>REF(OPEN,1) AND \nREF(LOW,4)<REF(LOW,3) AND \nREF(LOW,4)<REF(LOW,2) AND \nREF(LOW,4)<REF(LOW,1) AND \nREF(HIGH,4)>REF(HIGH,3) AND \nREF(HIGH,4)>REF(HIGH,2) AND \nREF(HIGH,4)>REF(HIGH,1) AND \nCLOSE/OPEN<0.97 AND \nCLOSE<REF(CLOSE,4), 5);"}},n.prototype.COLOR_CHXY=function(){return{Name:"长下影",Description:"长下影",IsMainIndex:!0,InstructionType:2,Script:"VAR2:(MIN(CLOSE,OPEN)-LOW)/(HIGH-LOW)>0.667;"}},n.prototype.COLOR_CHSY=function(){return{Name:"长上影",Description:"长上影",IsMainIndex:!0,InstructionType:2,Script:"VAR2:(HIGH-MAX(CLOSE,OPEN))/(HIGH-LOW)>0.667,COLORBLUE;"}},n.prototype.COLOR_FENLI=function(){return{Name:"分离",Description:"分离",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( OPEN==REF(OPEN,1) AND (CLOSE-OPEN)*(REF(CLOSE,1)-REF(OPEN,1))<0,2);"}},n.prototype.TRADE_BIAS=function(){return{Name:"BIAS",Description:"乖离率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"LL",Value:6},{Name:"LH",Value:6}],Script:"BIAS:=(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;\nENTERLONG:CROSS(-LL,BIAS);\nEXITLONG:CROSS(BIAS,LH);"}},n.prototype.TRADE_CCI=function(){return{Name:"CCI",Description:"CCI专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:14}],Script:"TYP:=(HIGH+LOW+CLOSE)/3;\nCCI:=(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));\nINDEX:=CCI;\nENTERLONG:CROSS(INDEX,-100);\nEXITLONG:CROSS(100,INDEX);"}},n.prototype.TRADE_DMI=function(){return{Name:"DMI",Description:"趋向专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:14}],Script:"MTR:=SUM(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(LOW-REF(CLOSE,1))),N);\nHD :=HIGH-REF(HIGH,1);\nLD :=REF(LOW,1)-LOW;\nPDM:=SUM(IF(HD>0&&HD>LD,HD,0),N);\nMDM:=SUM(IF(LD>0&&LD>HD,LD,0),N);\nPDI:=PDM*100/MTR;\nMDI:=MDM*100/MTR;\nENTERLONG:CROSS(PDI,MDI);\nEXITLONG:CROSS(MDI,PDI);"}},n.prototype.TRADE_KD=function(){return{Name:"KD",Description:"KD指标专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"WRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nWK:=SMA(WRSV,M1,1);\nD:=SMA(WK,M2,1);\nENTERLONG:CROSS(WK,D)&&WK<20;\nEXITLONG:CROSS(D,WK)&&WK>80;"}},n.prototype.TRADE_BOLL=function(){return{Name:"BOLL",Description:"布林带专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:20}],Script:"MID :=MA(CLOSE,N);\nUPPER:=MID+2*STD(CLOSE,N);\nLOWER:=MID-2*STD(CLOSE,N);\nENTERLONG:CROSS(CLOSE,LOWER);\nEXITLONG:CROSS(CLOSE,UPPER);"}},n.prototype.TRADE_KDJ=function(){return{Name:"KDJ",Description:"KDJ专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:=SMA(RSV,M1,1);\nD:=SMA(K,M1,1);\nJ:=3*K-2*D;\nENTERLONG:CROSS(J,0);\nEXITLONG:CROSS(100,J);"}},n.prototype.TRADE_MA=function(){return{Name:"MA",Description:"均线专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"SHORT",Value:5},{Name:"LONG",Value:20}],Script:"ENTERLONG:CROSS(MA(CLOSE,SHORT),MA(CLOSE,LONG));\nEXITLONG:CROSS(MA(CLOSE,LONG),MA(CLOSE,SHORT));"}},n.prototype.TRADE_MACD=function(){return{Name:"MACD",Description:"MACD专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"LONG",Value:26},{Name:"SHORT",Value:12},{Name:"M",Value:9}],Script:"DIFF:=EMA(CLOSE,SHORT) - EMA(CLOSE,LONG);\nDEA  := EMA(DIFF,M);\nMACD := 2*(DIFF-DEA);\nENTERLONG:CROSS(MACD,0);\nEXITLONG:CROSS(0,MACD);"}},n.prototype.TRADE_MTM=function(){return{Name:"MTM",Description:"动力指标专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:6}],Script:"WMTM:=C-REF(C,N);\nENTERLONG:CROSS(WMTM,0);\nEXITLONG:CROSS(0,WMTM);"}},n.prototype.TRADE_PSY=function(){return{Name:"PSY",Description:"PSY心理线专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"LL",Value:10},{Name:"LH",Value:85}],Script:"MYPSY:=COUNT(CLOSE>REF(CLOSE,1),N)/N*100;\nENTERLONG:CROSS(LL,MYPSY);\nEXITLONG:CROSS(MYPSY,LH);"}},n.prototype.TRADE_ROC=function(){return{Name:"ROC",Description:"变动速率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"WROC:=MA(100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N),M);\nENTERLONG:CROSS(WROC,0);\nEXITLONG:CROSS(0,WROC);"}},n.prototype.TRADE_RSI=function(){return{Name:"RSI",Description:"相对强弱专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:6},{Name:"LL",Value:20},{Name:"LH",Value:80}],Script:"LC:=REF(CLOSE,1);\nWRSI:=SMA(MAX(CLOSE-LC,0),N,1)/SMA(ABS(CLOSE-LC),N,1)*100;\nENTERLONG:CROSS(WRSI,LL);\nEXITLONG:CROSS(LH,WRSI);"}},n.prototype.TRADE_VR=function(){return{Name:"VR",Description:"VR容量比率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:26},{Name:"LL",Value:70},{Name:"LH",Value:250}],Script:"WVR := SUM((IF(CLOSE>OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)/SUM((IF(CLOSE<OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)*100;\nENTERLONG:CROSS(LL,WVR);\nEXITLONG:CROSS(WVR,LH);"}},n.prototype.TRADE_DPSJ=function(){return{Name:"DPSJ",Description:"大盘随机专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N1",Value:18},{Name:"N2",Value:12}],Script:"RSV:=(INDEXC-LLV(INDEXL,N1))/(HHV(INDEXH,N1)-LLV(INDEXL,N1))*100;\nK:=SMA(RSV,N2,1);\nHSL:VOL/100/(FINANCE(7));\nENTERLONG: CROSS(K,20);\nEXITLONG: (CROSS(HSL,5) OR CROSS(K,80));"}},n.prototype.TEST=function(){return{Name:"TEST",Description:"测试脚本",IsMainIndex:!0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:15}],Script:"T:EXCHANGE;"}},n.prototype.Zealink_Index1=function(){return{Name:"资金吸筹",Description:"资金吸筹",IsMainIndex:!1,Args:[],Script:"VAR1:=REF((LOW+OPEN+CLOSE+HIGH)/4,1);  \nVAR2:= SMA(ABS(LOW - VAR1), 13, 1) / SMA(MAX(LOW - VAR1, 0), 10, 1);\nVAR3:= EMA(VAR2, 10);\nVAR4:= LLV(LOW, 33);\nVAR5:= EMA(IF(LOW <= VAR4, VAR3, 0), 3) * 0.2;\n主力进场: IF(VAR5 > REF(VAR5, 1), VAR5,0), COLORRED, NODRAW;\n洗盘: IF(VAR5 < REF(VAR5, 1), VAR5,0), COLORYELLOW, NODRAW;\nSTICKLINE(VAR5> REF(VAR5, 1),0, VAR5, 50, 0), COLORRED;\nSTICKLINE(VAR5 < REF(VAR5, 1), 0, VAR5, 50, 0), COLORYELLOW;"}},n.prototype.Zealink_Index2=function(){return{Name:"牛熊区间",Description:"牛熊区间",IsMainIndex:!1,YSpecificMaxMin:{Max:100,Min:1,Count:4},YSplitScale:[1,50,100],Args:[],Script:"短高H:=(20*H+19*REF(H,1)+18*REF(H,2)+17*REF(H,3)+16*REF(H,4)+15*REF(H,5)+14*REF(H,6)\n+ 13 * REF(H, 7) + 12 * REF(H, 8) + 11 * REF(H, 9) + 10 * REF(H, 10) + 9 * REF(H, 11) + 8 * REF(H, 12)\n+ 7 * REF(H, 13) + 6 * REF(H, 14) + 5 * REF(H, 15) + 4 * REF(H, 16) + 3 * REF(H, 17) + 2 * REF(H, 18) +\nREF(H, 20))/ 210, COLORBLUE, LINETHICK1;\n短低L:= (20 * L + 19 * REF(L, 1) + 18 * REF(L, 2) + 17 * REF(L, 3) + 16 * REF(L, 4) + 15 * REF(L, 5) + 14 * REF(L, 6)\n+ 13 * REF(L, 7) + 12 * REF(L, 8) + 11 * REF(L, 9) + 10 * REF(L, 10) + 9 * REF(L, 11) + 8 * REF(L, 12)\n+ 7 * REF(L, 13) + 6 * REF(L, 14) + 5 * REF(L, 15) + 4 * REF(L, 16) + 3 * REF(L, 17) + 2 * REF(L, 18) +\nREF(L, 20)) / 210, COLORBLUE, LINETHICK1;\nD90H:= EMA(短高H, 90), COLORRED, LINETHICK1;\nD90L:= EMA(短低L, 90), COLORRED, LINETHICK1;\nD90差:= D90H - D90L;\nD90顶:= D90H + D90差 * 2, COLORRED, LINETHICK1;\nD90底:= D90L - D90差 * 2, COLORRED, LINETHICK1;\n高0:= (EMA(EMA(H, 25), 25) - EMA(EMA(L, 25), 25)) * 1 + EMA(EMA(H, 25), 25), LINETHICK1, COLORWHITE;\n低0:= EMA(EMA(L, 25), 25) - (EMA(EMA(H, 25), 25) - EMA(EMA(L, 25), 25)) * 1, LINETHICK1, COLORWHITE;\n多头定位:= 低0 >= D90底 AND 高0 >= D90顶;\n空头定位:= 高0 <= D90顶 AND 低0 <= D90底;\n震荡定位:= 低0 >= D90底 AND 高0 <= D90顶;\n牛市: IF(多头定位 == 1, 100, 1), COLORRED, NODRAW;\n熊市: IF(空头定位 == 1, 100, 1), COLORGREEN, NODRAW;\n震荡: IF(震荡定位 == 1, 100, 1), COLORGRAY, NODRAW;\nSTICKLINE(多头定位 == 1, 100, 1, 100, 0), COLORRED;\nSTICKLINE(空头定位 == 1, 100, 1, 100, 0), COLORGREEN;\nSTICKLINE(震荡定位 == 1, 100, 1, 100, 0), COLORGRAY;"}},n.prototype.Zealink_Index3=function(){return{Name:"持仓信号",Description:"持仓信号",IsMainIndex:!0,Args:[],Script:'买线:=EMA(C,2);\n卖线:=EMA(SLOPE(C,30)*5+C,20); \nBU:=CROSS(买线,卖线);\nSEL:=CROSS(卖线,买线);\n\nSTICKLINE(买线>=卖线 AND CLOSE>OPEN,LOW,HIGH,0,1),COLORRED;\nSTICKLINE(买线>=卖线 AND CLOSE<OPEN,LOW,HIGH,0,1),COLORRED;\nSTICKLINE(买线>=卖线 AND CLOSE>OPEN,CLOSE,OPEN,50,1),COLORRED;\nSTICKLINE(买线>=卖线 AND CLOSE<OPEN,CLOSE,OPEN,50,0),COLORRED;\nSTICKLINE(买线<卖线 AND CLOSE<OPEN,LOW,HIGH,0,1),COLORGREEN;\nSTICKLINE(买线<卖线 AND CLOSE>OPEN,LOW,HIGH,0,1),COLORGREEN;\nSTICKLINE(买线<卖线 AND CLOSE<OPEN,CLOSE,OPEN,50,0),COLORGREEN;\nSTICKLINE(买线<卖线 AND CLOSE>OPEN,CLOSE,OPEN,50,1),COLORGREEN;\n\nHHJSJDA:=(3*CLOSE+OPEN+LOW+HIGH)/6;\nHHJSJDB:=(19*HHJSJDA+19*REF(HHJSJDA,1)+18*REF(HHJSJDA,2)+17*REF(HHJSJDA,3)+16*REF(HHJSJDA,4)+15*REF(HHJSJDA,5)+14*REF(HHJSJDA,6)\n+13*REF(HHJSJDA,7)+12*REF(HHJSJDA,8)+11*REF(HHJSJDA,9)+10*REF(HHJSJDA,10)+9*REF(HHJSJDA,11)+8*REF(HHJSJDA,12)+7*REF(HHJSJDA,13)+6*REF(HHJSJDA,14)+5*REF(HHJSJDA,15)+4*REF(HHJSJDA,16)+3*REF(HHJSJDA,17)+2*REF\n(HHJSJDA,20)+REF(HHJSJDA,19))/210,COLORYELLOW;\nHHJSJDC:=MA(HHJSJDB,5),COLORRED;\n快线:HHJSJDB,COLORYELLOW;\n慢线:HHJSJDC,COLORRED;\n\nSVAR11:=HHV(HIGH,34);\nSVAR14:=CLOSE-REF(CLOSE,1);\nSVAR15:=MAX(SVAR14,0);\nSVAR16:=ABS(SVAR14);\nSVAR17:=SMA(SVAR15,7,1)/SMA(SVAR16,7,1)*100;\nSVAR18:=SMA(SVAR15,13,1)/SMA(SVAR16,13,1)*100;\nSVAR19:=BARSCOUNT(CLOSE);\nSVAR20:=SMA(MAX(SVAR14,0),6,1)/SMA(ABS(SVAR14),6,1)*100;\nSVAR21:=(-200)*(HHV(HIGH,60)-CLOSE)/(HHV(HIGH,60)-LLV(LOW,60))+100;\nSVAR1A:=(CLOSE-LLV(LOW,15))/(HHV(HIGH,15)-LLV(LOW,15))*100;\nSVAR1B:=SMA((SMA(SVAR1A,4,1)-50)*2,3,1);\nSVAR1C:=(INDEXC-LLV(INDEXL,14))/(HHV(INDEXH,14)-LLV(INDEXL,14))*100;\nSVAR1D:=SMA(SVAR1C,4,1);\nSVAR1E:=SMA(SVAR1D,3,1);\nSVAR1F:=(HHV(HIGH,30)-CLOSE)/CLOSE*100;\nSVAR22:=SVAR20<=25 AND SVAR21<-95 AND SVAR1F>20 AND SVAR1B<-30 AND SVAR1E<30 AND SVAR11-CLOSE>=-0.25 AND SVAR17<22 AND SVAR18<28 AND SVAR19>50;\nBUY3:=CROSS(SVAR22,0.5) AND COUNT(SVAR22==1,10)==1;\n\nSVARF:=LOW*0.9;\nSVAR10X:=100-3*SMA((OPEN-LLV(LOW,75))/(HHV(HIGH,75)-LLV(LOW,75))*100,20,1)+2*SMA(SMA((OPEN-LLV(LOW,75))/(HHV(HIGH,75)-LLV(LOW,75))*100,20,1),15,1);\nSVAR11X:=SVARF<REF(SVAR10X,1) AND VOL>REF(VOL,1) AND CLOSE>REF(CLOSE,1);\nBUY2:=SVAR11X AND COUNT(SVAR11X,30)==1;\n\nVAR1:=(CLOSE+HIGH+LOW+OPEN)/4;\nVAR2:=SUMBARS(VOL,CAPITAL);\nVAR3:=HHV(VAR1,VAR2);\nVAR4:=LLV(VAR1,VAR2);\nVAR5:=(2*VAR1-VAR4-REF(VAR4,1))/(VAR3-VAR4);\nVAR6:=(VAR1-VAR4)/(VAR3-VAR4);\nVAR7:=IF(VAR1<=VAR4,VAR5*60,VAR6*60);\nVAR8:=600*(EMA(CLOSE,3)-EMA(LOW,30))/EMA(LOW,30);\nVAR9:=EMA(VAR8,7);\nVARC:=HHV(HIGH,9)-LLV(LOW,9);\nVARD:=HHV(HIGH,9)-CLOSE;\nVARE:=CLOSE-LLV(LOW,9);\nVARF:=VARD/VARC*100-70;\nVAR10:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*100;\nVAR11:=(2*CLOSE+HIGH+LOW)/4;\nVAR12:=SMA(VARE/VARC*100,3,1);\nVAR13:=LLV(LOW,34);\nVAR14:=SMA(VAR12,3,1)-SMA(VARF,9,1);\nVAR15:=IF(VAR14>100,VAR14-100,0);\nVAR16:=HHV(HIGH,34);\nVAR17:=EMA((VAR11-VAR13)/(VAR16-VAR13)*100,8);\nVAR18:=EMA(VAR17,5);\nBUY:=STICKLINE(VAR17-VAR18>0,VAR17,VAR18,8,1),COLORRED;\nSELL:=STICKLINE(VAR17-VAR18<0,VAR17,VAR18,8,1),COLORGREEN;\nBUY1:=VAR17>VAR18 AND REF(VAR17,1)<REF(VAR18,1);\nSELL1:=VAR17<VAR18 AND REF(VAR17,1)>REF(VAR18,1);\n\n短高H:=(20*H+19*REF(H,1)+18*REF(H,2)+17*REF(H,3)+16*REF(H,4)+15*REF(H,5)+14*REF(H,6)\n+13*REF(H,7)+12*REF(H,8)+11*REF(H,9)+10*REF(H,10)+9*REF(H,11)+8*REF(H,12)\n+7*REF(H,13)+6*REF(H,14)+5*REF(H,15)+4*REF(H,16)+3*REF(H,17)+2*REF(H,18)+\nREF(H,20))/210,COLORBLUE,LINETHICK1;\n短低L:=(20*L+19*REF(L,1)+18*REF(L,2)+17*REF(L,3)+16*REF(L,4)+15*REF(L,5)+14*REF(L,6)\n+13*REF(L,7)+12*REF(L,8)+11*REF(L,9)+10*REF(L,10)+9*REF(L,11)+8*REF(L,12)\n+7*REF(L,13)+6*REF(L,14)+5*REF(L,15)+4*REF(L,16)+3*REF(L,17)+2*REF(L,18)+\nREF(L,20))/210,COLORBLUE,LINETHICK1;\nD90H:=EMA(短高H,90),COLORRED,LINETHICK1;\nD90L:=EMA(短低L,90),COLORRED,LINETHICK1;\nD90差:=D90H-D90L;\nD90顶:=D90H+D90差*2,COLORRED,LINETHICK1;\nD90底:=D90L-D90差*2,COLORRED,LINETHICK1;\n高0:=(EMA(EMA(H,25),25)-EMA(EMA(L,25),25))*1+EMA(EMA(H,25),25),LINETHICK1,COLORWHITE;\n低0:=EMA(EMA(L,25),25)-(EMA(EMA(H,25),25)-EMA(EMA(L,25),25))*1,LINETHICK1,COLORWHITE;\n多头定位:=低0>=D90底 AND 高0>=D90顶;\n空头定位:=高0<=D90顶 AND 低0<=D90底;\n震荡定位:=低0>=D90底 AND 高0<=D90顶;\n\n牛市:=多头定位==1;\n熊市:=空头定位==1;\n震荡:=震荡定位==1;\n\n非牛市:=熊市 OR 震荡;\n非熊市:=牛市 OR 震荡;\n\nBUY11:=BUY1 AND 非熊市;\nSELL11:=SELL1 AND 震荡定位==0;\n\nBUY111:=BUY11 AND COUNT(BUY11,10)<2;\nBUY0:=BUY111 AND COUNT(BUY111,21)==1;\nSELL111:=SELL11 AND COUNT(SELL11,10)<2;\nSELL0:=SELL111 AND COUNT(SELL111,10)==1;\n\nXK1:=EMA(100*(CLOSE-LLV(LOW,34))/(HHV(HIGH,34)-LLV(LOW,34)),3)/4;\n上穿:=REF(XK1,1)<5 AND XK1>=5;\nBUY4:=上穿 AND COUNT(XK1<2,12)<1;\n\nSELL2:=REF(XK1,1)<=22.5 AND XK1>22.5 AND COUNT(REF(XK1,1)>=22.5 AND XK1<22.5,5)>0;\nSELL3:=REF(XK1,1)>=21.5 AND XK1<21.5 AND COUNT(REF(XK1,1)>=22.5 AND XK1<22.5,12)>1;\nSELL4:=SELL2 OR SELL3 AND COUNT((SELL2 OR SELL3)==1,5)==1;\n\nSUPERDRAWTEXT(BUY0,L,"机会",2,10),COLORRED;\nSUPERDRAWTEXT(SELL0,H,"风险",1,10),COLORGREEN;\nSUPERDRAWTEXT(BUY2,L,"机会",2,10),COLORRED;\nSUPERDRAWTEXT(BUY4,L,"机会",2,10),COLORRED;\nSUPERDRAWTEXT(SELL4,H,"风险",1,10),COLORGREEN;'}},n.prototype.Zealink_Index4=function(){return{Name:"股东实际增减持",Description:"股东实际增减持",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"增持:NEWS(4),NODRAW,COLORRED;\n减持:NEWS(5),NODRAW,COLORGREEN;\nSTICKLINE(增持>0,0,增持,1,0),COLORRED;\nSTICKLINE(减持<0,0,减持,1,0),COLORGREEN;"}},n.prototype.Zealink_Index5=function(){return{Name:"大宗交易",Description:"大宗交易",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"交易次数:NEWS(7);"}},n.prototype.Zealink_Index6=function(){return{Name:"信托持股",Description:"信托持股",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"家数:NEWS(6);"}},n.prototype.Zealink_Index7=function(){return{Name:"官网新闻",Description:"官网新闻",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"个数:NEWS(8);"}},n.prototype.Zealink_Index8=function(){return{Name:"高管要闻",Description:"高管要闻",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"个数:NEWS(9);"}},n.prototype.Zealink_Index9=function(){return{Name:"股权质押",Description:"股权质押",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"次数:NEWS(10);"}},n.prototype.CJL=function(){return{Name:"CJL",Description:"期货持仓量",IsMainIndex:!1,Args:[],Script:"成交量:VOL,VOLSTICK;\n持仓量:VOLINSTK,LINEOVERLAY;"}},n.prototype.SQJZ=function(){return{Name:"SQJZ",Description:"神奇九转",IsMainIndex:!0,Script:"B:=C<REF(C,4);\nN:=CURRBARSCOUNT;\nB1:=(N=6 AND REFXV(COUNT(B,6),5)=6) OR (N=7 AND REFXV(COUNT(B,7),6)=7) OR (N=8 AND REFXV(COUNT(B,8),7)=8) OR (N>=9 AND REFXV(COUNT(B,9),8)=9);\nDRAWNUMBER(B1 AND REF(B,1)=0,L,1),COLORMAGENTA;\nB2:=(N=5 AND REFXV(COUNT(B,6),4)=6) OR (N=6 AND REFXV(COUNT(B,7),5)=7) OR (N=7 AND REFXV(COUNT(B,8),6)=8) OR (N>=8 AND REFXV(COUNT(B,9),7)=9);\nDRAWNUMBER(B2 AND REF(B,2)=0,L,2),COLORMAGENTA;\nB8:=(N=1 AND COUNT(B,8)=8) OR (N>=2 AND REFXV(COUNT(B,9),1)=9);\nDRAWNUMBER(B8 AND REF(B,8)=0,L,8),COLORMAGENTA;\nB9:=(N>=1 AND COUNT(B,9)=9);\nDRAWNUMBER(B9 AND REF(B,9)=0,L,9),COLORBROWN;\nS:=C>REF(C,4);\nS1:=(N=6 AND REFXV(COUNT(S,6),5)=6) OR (N=7 AND REFXV(COUNT(S,7),6)=7) OR (N=8 AND REFXV(COUNT(S,8),7)=8) OR (N>=9 AND REFXV(COUNT(S,9),8)=9);\nDRAWNUMBER(S1 AND REF(S,1)=0,H,1),COLORMAGENTA,DRAWABOVE;\nS2:=(N=5 AND REFXV(COUNT(S,6),4)=6) OR (N=6 AND REFXV(COUNT(S,7),5)=7) OR (N=7 AND REFXV(COUNT(S,8),6)=8) OR (N>=8 AND REFXV(COUNT(S,9),7)=9);\nDRAWNUMBER(S2 AND REF(S,2)=0,H,2),COLORMAGENTA,DRAWABOVE;\nS8:=(N=1 AND COUNT(S,8)=8) OR (N>=2 AND REFXV(COUNT(S,9),1)=9);\nDRAWNUMBER(S8 AND REF(S,8)=0,H,8),COLORMAGENTA,DRAWABOVE;\nS9:=(N>=1 AND COUNT(S,9)=9);\nDRAWNUMBER(S9 AND REF(S,9)=0,H,9),COLORGREEN,DRAWABOVE;"}},n.prototype.XT=function(){return{Name:"XT",Description:"箱体",IsMainIndex:!0,Args:[{Name:"N",Value:10}],Script:"【箱顶】:PEAK(CLOSE,N,1)*0.98;\n【箱底】:TROUGH(CLOSE,N,1)*1.02;\n【箱高】:100*(【箱顶】-【箱底】)/【箱底】,NODRAW;"}},n.prototype.CFJT=function(){return{Name:"CFJT",Description:"财富阶梯",IsMainIndex:!0,Script:"突破:=REF(EMA(C,14),1);\nA1X:=(EMA(C,10)-突破)/突破*100;\n多方:=IF(A1X>=0,REF(EMA(C,10),BARSLAST(CROSS(A1X,0))+1),DRAWNULL);\n空方:=IF(A1X<0,REF(EMA(C,10),BARSLAST(CROSS(0,A1X))+1),DRAWNULL);\nSTICKLINE(A1X>=0,多方,突破,110,0),COLORRED;\nSTICKLINE(A1X<0,空方,突破,110,0),COLORGREEN;"}},n.prototype.CYX=function(){return{Name:"CYX",Description:"撑压线",IsMainIndex:!0,Args:[{Name:"N",Value:7}],Script:"Z1:=STRCAT(HYBLOCK,' ');\nZ2:=STRCAT(Z1,DYBLOCK);\nZ3:=STRCAT(Z2,' ');\nDRAWTEXT_FIX(ISLASTBAR,0,0,0,STRCAT(Z3,GNBLOCK)),COLOR00C0C0;\nA1:=REF(H,N)=HHV(H,2*N+1);\nB1:=FILTER(A1,N);\nC1:=BACKSET(B1,N+1);\nD1:=FILTER(C1,N);\nA2:=REF(L,N)=LLV(L,2*N+1);\nB2:=FILTER(A2,N);\nC2:=BACKSET(B2,N+1);\nD2:=FILTER(C2,N);\nE1:=(REF(LLV(L,2*N),1)+REF(HHV(H,2*N),1))/2;\nE2:=(H+L)/2;\nH1:=(D1 AND NOT(D2 AND E1>=E2)) OR ISLASTBAR OR BARSCOUNT(C)=1;\nL1:=(D2 AND NOT(D1 AND E1<E2));\nH2:=D1 AND NOT(D2 AND E1>=E2);\nX1:=REF(BARSLAST(H1),1)+1;\nF1:=BACKSET(H1 AND COUNT(L1,X1)>0,LLVBARS(IF(L1,L,10000),X1));\nG1:=F1>REF(F1,1);\nI1:=BACKSET(G1,2);\nLD:=I1>REF(I1,1);\nL2:=LD OR ISLASTBAR OR BARSCOUNT(C)=1;\nX2:=REF(BARSLAST(L2),1)+1;\nF2:=BACKSET(L2 AND COUNT(H2,X2)>0,HHVBARS(IF(H2,H,0),X2));\nG2:=F2>REF(F2,1);\nI2:=BACKSET(G2,2);\nHD:=I2>REF(I2,1);\nR1:=BACKSET(ISLASTBAR,BARSLAST(HD)+1);\nS1:=R1>REF(R1,1);\nT1:=BACKSET(ISLASTBAR,BARSLAST(LD)+1);\nU1:=T1>REF(T1,1);\nR2:=BACKSET(S1,REF(BARSLAST(HD),1)+2);\nS2:=R2>REF(R2,1);\nT2:=BACKSET(U1,REF(BARSLAST(LD),1)+2);\nU2:=T2>REF(T2,1);\nDRAWLINE(S2,H,S1,H,1),LINETHICK2,COLORRED;\nDRAWLINE(U2,L,U1,L,1),LINETHICK2,COLORGREEN;"}},n.prototype.WAVE=function(){return{Name:"WAVE",Description:"波浪分析",IsMainIndex:!0,Args:[{Name:"N",Value:5}],Script:"ZIG(3,N);"}};var s={JSIndexScript:n};e.JSCommonIndexScript=s},"966c":function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.GetfloatPrecision=I,e.g_TOCOMTimeData=e.g_NYMEXTimeData=e.g_NYBOTTimeData=e.g_MinuteTimeStringData=e.g_MinuteCoordinateData=e.g_LMETimeData=e.g_IPETimeData=e.g_FuturesTimeData=e.g_COMEXTimeData=e.g_CBOTTimeData=e.MARKET_SUFFIX_NAME=e.JSCommonCoordinateData=void 0,a("c975"),a("ac1f"),a("5319"),a("e25e"),a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("14d9");var i=a("8709");function r(t){if("number"===typeof t){var e=new Date,a=e.getTime(),i=6e4*e.getTimezoneOffset(),r=a+i;return new Date(r+36e5*t)}}var n={SH:".SH",SZ:".SZ",SHSZ_C_Index:".CI",BJ:".BJ",SHO:".SHO",SZO:".SZO",HK:".HK",FHK:".FHK",SHFE:".SHF",SHFE2:".SHFE",CFFEX:".CFE",DCE:".DCE",CZCE:".CZC",GZFE:".GZFE",USA:".USA",FTSE:".FTSE",BIT:".BIT",BIZ:".BIZ",FOREX:".FOREX",NYMEX:".NYMEX",COMEX:".COMEX",NYBOT:".NYBOT",CBOT:".CBOT",LME:".LME",TOCOM:".TOCOM",IPE:".IPE",TW:".TW",JP:".JP",HSX:".HSX",HNX:".HNX",UPCOM:".UPCOM",ET:".ET",IsET:function(t){return!!t&&t.indexOf(this.ET)>0},IsETShowAvPrice:function(t){return!1},IsHSX:function(t){return!!t&&t.indexOf(this.HSX)>0},IsHNX:function(t){return!!t&&t.indexOf(this.HNX)>0},IsUPCOM:function(t){return!!t&&t.indexOf(this.UPCOM)>0},IsNYMEX:function(t){return!!t&&t.indexOf(this.NYMEX)>0},IsCOMEX:function(t){return!!t&&t.indexOf(this.COMEX)>0},IsNYBOT:function(t){return!!t&&t.indexOf(this.NYBOT)>0},IsCBOT:function(t){return!!t&&t.indexOf(this.CBOT)>0},IsLME:function(t){return!!t&&t.indexOf(this.LME)>0},IsTOCOM:function(t){return!!t&&t.indexOf(this.TOCOM)>0},IsIPE:function(t){return!!t&&t.indexOf(this.IPE)>0},IsForeignExchange:function(t){return!!t&&t.indexOf(this.FOREX)>0},IsFTSE:function(t){return!!t&&t.indexOf(this.FTSE)>0},IsFHK:function(t){return!!t&&t.indexOf(this.FHK)>0},IsBIT:function(t){return!!t&&(t.indexOf(this.BIT)>0||t.indexOf(this.BIZ)>0)},IsUSA:function(t){return!!t&&t.indexOf(this.USA)>0},IsSH:function(t){var e=t.length-this.SH.length,a=t.indexOf(this.SH);return a==e},IsSZ:function(t){var e=t.length-this.SZ.length,a=t.indexOf(this.SZ);return a==e},IsBJ:function(t){var e=t.length-this.BJ.length,a=t.indexOf(this.BJ);return a==e},IsSHSZCustomIndex:function(t){var e=t.length-this.SHSZ_C_Index.length,a=t.indexOf(this.SHSZ_C_Index);return a==e},IsSHO:function(t){var e=t.length-this.SHO.length,a=t.indexOf(this.SHO);return a==e},IsSZO:function(t){var e=t.length-this.SZO.length,a=t.indexOf(this.SZO);return a==e},IsHK:function(t){var e=t.length-this.HK.length,a=t.indexOf(this.HK);return a==e},IsTW:function(t){var e=t.length-this.TW.length,a=t.indexOf(this.TW);return a==e},IsJP:function(t){var e=t.length-this.JP.length,a=t.indexOf(this.JP);return a==e},IsSHFE:function(t){return!!t&&(t.indexOf(this.SHFE)>0||t.indexOf(this.SHFE2)>0)},IsCFFEX:function(t){return!!t&&t.indexOf(this.CFFEX)>0},IsDCE:function(t){return!!t&&t.indexOf(this.DCE)>0},IsCZCE:function(t){return!!t&&t.indexOf(this.CZCE)>0},IsGZFE:function(t){return!!t&&t.indexOf(this.GZFE)>0},IsChinaFutures:function(t){return this.IsCFFEX(t)||this.IsCZCE(t)||this.IsDCE(t)||this.IsSHFE(t)||this.IsGZFE(t)},IsFutures:function(t){return this.IsChinaFutures(t)||this.IsNYMEX(t)||this.IsCOMEX(t)||this.IsNYBOT(t)||this.IsCBOT(t)||this.IsLME(t)},IsSHSZ:function(t){return this.IsSZ(t)||this.IsSH(t)||this.IsSHSZCustomIndex(t)},IsSHSZFund:function(t){if(!t)return!1;if(this.IsSH(t)){if("5"==t.charAt(0)&&"1"==t.charAt(1))return!0}else if(this.IsSZ(t)&&"1"==t.charAt(0)&&("5"==t.charAt(1)||"6"==t.charAt(1)||"7"==t.charAt(1)||"8"==t.charAt(1)))return!0;return!1},IsSHSZIndex:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){var a=e.replace(".SH","");if("0"==e.charAt(0)&&parseInt(a)<=3e3)return!0}else if(this.IsSZ(e)){if("3"==e.charAt(0)&&"9"==e.charAt(1))return!0}else if(this.IsSHSZCustomIndex(e))return!0;return!1},IsSHSZStockA:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){e.replace(".SH","");if("6"==e.charAt(0))return!0}else if(this.IsSZ(e))if("0"==e.charAt(0)){if("0"==e.charAt(1)&&"2"==e.charAt(2))return!0;if("7"!=e.charAt(1)&&"8"!=e.charAt(1))return!0}else if("3"==e.charAt(0)&&"0"==e.charAt(1)){if("0"==e.charAt(2))return!0;if("1"==e.charAt(2))return!0}return!1},IsBJStock:function(t){if(!t)return!1;var e=t.toUpperCase();if(!this.IsBJ(e))return!1;var a=e.charAt(0);return"4"==a||"8"==a},IsSHStockSTAR:function(t){if(!t)return!1;var e=t.toUpperCase();return!!this.IsSH(e)&&("6"==e.charAt(0)&&"8"==e.charAt(1)&&"8"==e.charAt(2))},GetMarketStatus:function(t){if(!t)return 0;var e=t.toUpperCase(),a=new Date,i=a.getDay(),n=100*a.getHours()+a.getMinutes();if(this.IsUSA(e)){var s=r(-4);i=s.getDay(),n=100*s.getHours()+s.getMinutes();return 6==i||0==i?0:n>1730?3:n<930?1:2}return this.IsBIT(e)||this.IsForeignExchange(e)?2:this.IsFTSE(e)?6==i||0==i?0:n>=830&&n<=2359||n>=0&&n<=500?2:0:this.IsFHK(e)?6==i||0==i?0:n>=900&&n<=2359||n>=0&&n<=120?2:0:this.IsET(e)?this.GetETMarketStatus(t):this.IsHK(e)?6==i||0==i?0:n>1630?3:n<925?1:2:this.IsTW(e)?6==i||0==i?0:n>1410?3:n<820?1:2:this.IsJP(e)?6==i||0==i?0:n>1520?3:n<830?1:2:this.IsNYMEX(e)?this.GetNYMEXMarketStatus(e):this.IsCOMEX(e)?this.GetCOMEXMarketStatus(e):this.IsNYBOT(e)?this.GetNYBOTMarketStatus(e):this.IsCBOT(e)?this.GetCBOTMarketStatus(e):this.IsChinaFutures(e)?6==i||0==i?0:n>=2100||n<=240||n>=830&&n<=1510?2:1:6==i||0==i?0:n>1540?3:n<925?1:2},GetDefaultDecimal:function(t){return 2},GetFHKDecimal:function(t){return 0},GetFTSEDecimal:function(t){return 0},GetForeignExchangeDecimal:function(t){return 4},GetBITDecimal:function(t){return 2},GetETDecimal:function(t){return 2},GetHKDecimal:function(t){return 2},GetTWDecimal:function(t){return 2},GetJPDecimal:function(t){return 2},GetHSXDecimal:function(t){return 2},GetHNXDecimal:function(t){return 2},GetUPCOMDecimal:function(t){return 2},GetSHODecimal:function(t){return 4},GetNYMEXDecimal:function(t){return u.GetDecimal(t)},GetCOMEXDecimal:function(t){return C.GetDecimal(t)},GetNYBOTDecimal:function(t){return D.GetDecimal(t)},GetCBOTDecimal:function(t){return m.GetDecimal(t)},GetLMEDecimal:function(t){return c.GetDecimal(t)},GetTOCOMDecimal:function(t){return S.GetDecimal(t)},GetIPEDecimal:function(t){return f.GetDecimal(t)},GetETMarketStatus:function(t){return 2},GetCOMEXMarketStatus:function(t){return C.GetMarketStatus(t)},GetNYBOTMarketStatus:function(t){return D.GetMarketStatus(t)},GetCBOTMarketStatus:function(t){return m.GetMarketStatus(t)},GetNYMEXMarketStatus:function(t){return u.GetMarketStatus(t)},GetLimitPriceRange:function(t,e){return this.IsSHSZStockA(t)?this.IsSHStockSTAR(t)?{Max:.2,Min:-.2}:e?e.indexOf("ST")>=0?{Max:.05,Min:-.05}:{Max:.1,Min:-.1}:null:null},IsEnableRight:function(t,e,a){return!(!n.IsSHSZStockA(e)&&!n.IsBJStock(e))&&(!!(i.ChartData.IsNumber(a)&&a>=1)||(i.ChartData.IsMinutePeriod(t,!0),!1))}};function s(){this.MarketSuffix=".NYMEX",this.TimeType=0,this.TIME_SPLIT=[{Name:"6:00-5:00",Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.TIME_SPLIT2=[{Name:"7:00-6:00",Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1900,Text:"19:00"},{Value:500,Text:"5:00"}]}}],this.FUTURES_LIST=[{Symbol:"CL",Decimal:2,Time:0},{Symbol:"NG",Decimal:3,Time:0},{Symbol:"RB",Decimal:4,Time:0},{Symbol:"PL",Decimal:1,Time:0},{Symbol:"PA",Decimal:2,Time:0},{Symbol:"HR",Decimal:0,Time:0},{Symbol:"QM",Decimal:3,Time:0},{Symbol:"HO",Decimal:4,Time:0}],this.GetFuturesInfo=function(t){if(t.indexOf(this.MarketSuffix)<=0)return null;for(var e in this.FUTURES_LIST){var a=this.FUTURES_LIST[e];if(0==t.indexOf(a.Symbol))return a}return null},this.GetSplitData=function(t){var e=0==this.TimeType?this.TIME_SPLIT:this.TIME_SPLIT2,a=this.GetFuturesInfo(t);return a?e[a.Time]:e[0]},this.GetDecimal=function(t){var e=this.GetFuturesInfo(t);return e?e.Decimal:3},this.GetMarketStatus=function(t){var e=r(-4),a=new Date,i=e.getDay(),n=100*a.getHours()+a.getMinutes();return 6==i||0==i?0:n>430&&n<730?1:2},this.AddNewFutures=function(t){if(t){for(var e={Symbol:t.Symbol,Time:t.Time,Decimal:t.Decimal,Name:t.Name},a=0;a<this.FUTURES_LIST.length;++a){var i=this.FUTURES_LIST[a];if(i.Symbol==e.Symbol)return void(this.FUTURES_LIST[a]=e)}this.FUTURES_LIST.push(e)}}}e.MARKET_SUFFIX_NAME=n;var o=new function(){this.SHSZ=null,this.HK=null,this.Futures=new Map,this.USA=null,this.FTSE=null,this.FHK=null,this.BIT=null,this.TW=null,this.JP=null,this.Initialize=function(){},this.GetET=function(t){throw{Name:"MinuteTimeStringData::GetET",Error:"not implement"}},this.GetSHSZ=function(t){return this.SHSZ||(this.SHSZ=this.CreateSHSZData()),this.SHSZ},this.GetBJ=function(t){return this.BJ||(this.BJ=this.CreateBJData()),this.BJ},this.GetSHO=function(){return this.SHO||(this.SHO=this.CreateSHOData()),this.SHO},this.GetHK=function(t){return this.HK||(this.HK=this.CreateHKData()),this.HK},this.GetTW=function(t){return this.TW&&(this.TW=this.CreateTWData()),this.TW},this.GetJP=function(t){return this.JP&&(this.JP=this.CreateJPData()),this.JP},this.GetHSX=function(t){return this.HSX&&(this.HSX=this.CreateHSXData()),this.HSX},this.GetHNX=function(t){return this.HNX&&(this.HSX=this.CreateHNXData()),this.HNX},this.GetUPCOM=function(t){return this.UPCOM&&(this.UPCOM=this.CreateUPCOMData()),this.UPCOM},this.GetFutures=function(t){if(!this.Futures.has(t.Name)){var e=this.CreateTimeData(t.Data);this.Futures.set(t.Name,e)}return this.Futures.get(t.Name)},this.GetUSA=function(){return this.USA||(this.USA=this.CreateUSAData()),this.USA},this.GetFTSE=function(){return this.FTSE||(this.FTSE=this.CreateFTSEData()),this.FTSE},this.GetFHK=function(){return this.FHK||(this.FHK=this.CreateFHKData()),this.FHK},this.GetBIT=function(t){return this.BIT||(this.BIT=this.CreateBITData()),this.BIT},this.GetForeignExchange=function(){return this.ForeEx||(this.ForeEx=this.CreateForeignExchangeData()),this.ForeEx},this.CreateSHSZData=function(){return this.CreateTimeData([{Start:925,End:925},{Start:930,End:1130},{Start:1300,End:1500}])},this.CreateSHOData=function(){return this.CreateTimeData([{Start:930,End:1129},{Start:1300,End:1500}])},this.CreateHKData=function(){return this.CreateTimeData([{Start:930,End:1200},{Start:1300,End:1600}])},this.CreateTWData=function(){return this.CreateTimeData([{Start:900,End:1330}])},this.CreateJPData=function(){return this.CreateTimeData([{Start:900,End:1130},{Start:1230,End:1500}])},this.CreateHSXData=function(){throw{Name:"MinuteTimeStringData::CreateHSXData",Error:"not implement"}},this.CreateHNXData=function(){throw{Name:"MinuteTimeStringData::CreateHNXData",Error:"not implement"}},this.CreateUPCOMData=function(){throw{Name:"MinuteTimeStringData::CreateUPCOMData",Error:"not implement"}},this.CreateUSAData=function(){return this.CreateTimeData([{Start:930,End:1600}])},this.CreateFTSEData=function(){return this.CreateTimeData([{Start:1700,End:2359},{Start:0,End:445},{Start:900,End:1630}])},this.CreateFHKData=function(){return this.CreateTimeData([{Start:1715,End:2359},{Start:0,End:100},{Start:915,End:1200},{Start:1300,End:1630}])},this.CreateForeignExchangeData=function(){return this.CreateTimeData([{Start:600,End:2359},{Start:0,End:559}])},this.CreateBITData=function(){return this.CreateTimeData([{Start:600,End:2359},{Start:0,End:559}])},this.CreateTimeData=function(t){var e=[];for(var a in t)for(var i=t[a],r=i.Start;r<=i.End;++r)r%100>=60||e.push(r);return e},this.GetTimeData=function(t){if(!t)return this.SHSZ;var e=t.toLocaleUpperCase();if(n.IsSH(e)||n.IsSZ(e)||n.IsSHSZIndex(e))return this.GetSHSZ(e);if(n.IsBJ(e))return this.GetBJ(e);if(n.IsSHO(e)||n.IsSZO(e))return this.GetSHO();if(n.IsHK(e))return this.GetHK(e);if(n.IsTW(e))return this.GetTW(e);if(n.IsJP(e))return this.GetJP(e);if(n.IsUSA(e))return this.GetUSA(!0);if(n.IsCFFEX(e)||n.IsCZCE(e)||n.IsDCE(e)||n.IsSHFE(e)||n.IsGZFE(e)){var a=l.GetSplitData(e);return a?this.GetFutures(a):null}if(n.IsForeignExchange(e))return this.GetForeignExchange();if(n.IsFTSE(e))return this.GetFTSE();if(n.IsFHK(e))return this.GetFHK();if(n.IsET(e))return this.GetET(e);if(n.IsBIT(e))return this.GetBIT(e);if(n.IsHSX(e))return this.GetHSX(e);if(n.IsHNX(e))return this.GetHNX(e);if(n.IsUPCOM(e))return this.GetUPCOM(e);if(n.IsNYMEX(e)){a=u.GetSplitData(e);return a?this.GetFutures(a):null}if(n.IsCOMEX(e)){a=C.GetSplitData(e);return a?this.GetFutures(a):null}if(n.IsNYBOT(e)){a=D.GetSplitData(e);return a?this.GetFutures(a):null}if(n.IsCBOT(e)){a=m.GetSplitData(e);return a?this.GetFutures(a):null}if(n.IsLME(e)){a=c.GetSplitData(e);return a?this.GetFutures(a):null}if(n.IsTOCOM(e)){a=S.GetSplitData(e);return a?this.GetFutures(a):null}if(n.IsIPE(e)){a=f.GetSplitData(e);return a?this.GetFutures(a):null}}};e.g_MinuteTimeStringData=o;var h=new function(){var t={Full:[[0,0,"rgb(200,200,200)","09:30"],[31,0,"RGB(200,200,200)","10:00"],[61,0,"RGB(200,200,200)","10:30"],[91,0,"RGB(200,200,200)","11:00"],[122,1,"RGB(200,200,200)","13:00"],[152,0,"RGB(200,200,200)","13:30"],[182,0,"RGB(200,200,200)","14:00"],[212,0,"RGB(200,200,200)","14:30"],[242,1,"RGB(200,200,200)","15:00"]],Simple:[[0,0,"rgb(200,200,200)","09:30"],[61,0,"RGB(200,200,200)","10:30"],[122,1,"RGB(200,200,200)","13:00"],[182,0,"RGB(200,200,200)","14:00"],[242,1,"RGB(200,200,200)","15:00"]],Min:[[0,0,"rgb(200,200,200)","09:30"],[122,1,"RGB(200,200,200)","13:00"],[242,1,"RGB(200,200,200)","15:00"]],Count:243,MiddleCount:122,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},e={Full:[[0,0,"rgb(200,200,200)","09:30"],[30,0,"RGB(200,200,200)","10:00"],[60,0,"RGB(200,200,200)","10:30"],[90,0,"RGB(200,200,200)","11:00"],[120,1,"RGB(200,200,200)","13:00"],[150,0,"RGB(200,200,200)","13:30"],[180,0,"RGB(200,200,200)","14:00"],[210,0,"RGB(200,200,200)","14:30"],[240,1,"RGB(200,200,200)","15:00"]],Simple:[[0,0,"rgb(200,200,200)","09:30"],[60,0,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","13:00"],[180,0,"RGB(200,200,200)","14:00"],[240,1,"RGB(200,200,200)","15:00"]],Min:[[0,0,"rgb(200,200,200)","09:30"],[120,1,"RGB(200,200,200)","13:00"],[240,1,"RGB(200,200,200)","15:00"]],Count:241,MiddleCount:120,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},a={Full:[[0,1,"RGB(200,200,200)","09:30"],[30,0,"RGB(200,200,200)","10:00"],[60,1,"RGB(200,200,200)","10:30"],[90,0,"RGB(200,200,200)","11:00"],[120,1,"RGB(200,200,200)","11:30"],[151,0,"RGB(200,200,200)","13:00"],[181,1,"RGB(200,200,200)","13:30"],[211,0,"RGB(200,200,200)","14:00"],[241,1,"RGB(200,200,200)","14:30"],[271,0,"RGB(200,200,200)","15:00"],[301,1,"RGB(200,200,200)","15:30"],[331,1,"RGB(200,200,200)","16:00"]],Simple:[[0,1,"RGB(200,200,200)","09:30"],[60,1,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","11:30"],[211,0,"RGB(200,200,200)","14:00"],[271,0,"RGB(200,200,200)","15:00"],[331,1,"RGB(200,200,200)","16:00"]],Min:[[0,1,"RGB(200,200,200)","09:30"],[151,0,"RGB(200,200,200)","13:00"],[331,1,"RGB(200,200,200)","16:00"]],Count:332,MiddleCount:151,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},i={Full:[[0,0,"rgb(200,200,200)","9:30"],[30,0,"RGB(200,200,200)","10:00"],[90,1,"RGB(200,200,200)","11:00"],[150,0,"RGB(200,200,200)","12:00"],[210,0,"RGB(200,200,200)","13:00"],[270,0,"RGB(200,200,200)","14:00"],[330,0,"RGB(200,200,200)","15:00"],[390,0,"RGB(200,200,200)","16:00"]],Simple:[[30,0,"rgb(200,200,200)","10:00"],[150,1,"RGB(200,200,200)","12:00"],[270,0,"RGB(200,200,200)","14:00"],[390,0,"RGB(200,200,200)","16:00"]],Min:[[30,0,"rgb(200,200,200)","10:00"],[210,1,"RGB(200,200,200)","13:00"],[390,0,"RGB(200,200,200)","16:00"]],Count:391,MiddleCount:211,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},r={Full:[[0,1,"RGB(200,200,200)","17:00"],[120,1,"RGB(200,200,200)","19:00"],[240,1,"RGB(200,200,200)","21:00"],[360,1,"RGB(200,200,200)","23:00"],[480,1,"RGB(200,200,200)","01:00"],[600,1,"RGB(200,200,200)","03:00"],[706,1,"RGB(200,200,200)","09:00"],[826,1,"RGB(200,200,200)","11:00"],[946,1,"RGB(200,200,200)","13:00"],[1066,1,"RGB(200,200,200)","15:00"],[1156,1,"RGB(200,200,200)","16:30"]],Simple:[[0,1,"RGB(200,200,200)","17:00"],[240,1,"RGB(200,200,200)","21:00"],[480,1,"RGB(200,200,200)","01:00"],[706,1,"RGB(200,200,200)","09:00"],[946,1,"RGB(200,200,200)","13:00"],[1156,1,"RGB(200,200,200)","16:30"]],Min:[[0,1,"RGB(200,200,200)","17:00"],[706,1,"RGB(200,200,200)","09:00"],[1156,1,"RGB(200,200,200)","16:30"]],Count:1157,MiddleCount:707,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},s={Full:[[0,1,"RGB(200,200,200)","17:15"],[105,1,"RGB(200,200,200)","19:00"],[225,1,"RGB(200,200,200)","21:00"],[345,1,"RGB(200,200,200)","23:00"],[466,0,"RGB(200,200,200)","09:15"],[571,1,"RGB(200,200,200)","11:00"],[692,1,"RGB(200,200,200)","14:00"],[843,1,"RGB(200,200,200)","16:30"]],Simple:[[0,1,"RGB(200,200,200)","17:15"],[225,1,"RGB(200,200,200)","21:00"],[466,0,"RGB(200,200,200)","09:15"],[632,1,"RGB(200,200,200)","13:00"],[843,1,"RGB(200,200,200)","16:30"]],Min:[[0,1,"RGB(200,200,200)","17:15"],[466,0,"RGB(200,200,200)","09:15"],[843,1,"RGB(200,200,200)","16:30"]],Count:843,MiddleCount:466,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},h={Full:[[0,1,"RGB(200,200,200)","06:00"],[120,1,"RGB(200,200,200)","08:00"],[240,1,"RGB(200,200,200)","10:00"],[360,1,"RGB(200,200,200)","12:00"],[480,0,"RGB(200,200,200)","14:00"],[600,1,"RGB(200,200,200)","16:00"],[720,1,"RGB(200,200,200)","18:00"],[840,1,"RGB(200,200,200)","20:00"],[960,1,"RGB(200,200,200)","22:00"],[1080,1,"RGB(200,200,200)","0:00"],[1200,1,"RGB(200,200,200)","02:00"],[1320,1,"RGB(200,200,200)","04:00"]],Simple:[[0,1,"RGB(200,200,200)","06:00"],[240,1,"RGB(200,200,200)","10:00"],[480,0,"RGB(200,200,200)","14:00"],[720,1,"RGB(200,200,200)","18:00"],[960,1,"RGB(200,200,200)","22:00"],[1200,1,"RGB(200,200,200)","02:00"]],Min:[[0,1,"RGB(200,200,200)","06:00"],[480,0,"RGB(200,200,200)","14:00"],[960,1,"RGB(200,200,200)","22:00"]],Count:1440,MiddleCount:600,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},I={Full:[[0,1,"RGB(200,200,200)","09:00"],[30,0,"RGB(200,200,200)","09:30"],[60,1,"RGB(200,200,200)","10:00"],[90,0,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","11:00"],[150,0,"RGB(200,200,200)","11:30"],[180,1,"RGB(200,200,200)","12:00"],[210,0,"RGB(200,200,200)","12:30"],[240,1,"RGB(200,200,200)","13:00"],[270,0,"RGB(200,200,200)","13:30"]],Simple:[[0,1,"RGB(200,200,200)","09:00"],[60,1,"RGB(200,200,200)","10:00"],[120,1,"RGB(200,200,200)","11:00"],[180,1,"RGB(200,200,200)","12:00"],[270,0,"RGB(200,200,200)","13:30"]],Min:[[0,1,"RGB(200,200,200)","09:00"],[60,1,"RGB(200,200,200)","11:00"],[270,0,"RGB(200,200,200)","13:30"]],Count:271,MiddleCount:151,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}};this.GetCoordinateData=function(e,a){var i=null;if(e){var r=e.toLocaleUpperCase();if(n.IsSH(r)||n.IsSZ(r))i=this.GetSHSZData(r,a);else if(n.IsBJ(r))i=this.GetBJData(r,a);else if(n.IsSHO(r)||n.IsSZO(r))i=this.GetSHOData(r,a);else if(n.IsHK(r))i=this.GetHKData(r,a);else if(n.IsTW(r))i=this.GetTWData(r,a);else if(n.IsJP(r))i=this.GetJPData(r,a);else{if(n.IsCFFEX(r)||n.IsCZCE(r)||n.IsDCE(r)||n.IsSHFE(r)||n.IsGZFE(r))return this.GetChinatFuturesData(r,a);if(n.IsUSA(r))i=this.GetUSAData(r,a);else if(n.IsFTSE(r,a))i=this.GetFTSEData(r,a);else if(n.IsFHK(r,a))i=this.GetFHKData(r,a);else if(n.IsForeignExchange(r))i=this.GetForeignExchangeData(r);else if(n.IsET(r))i=this.GetETData(r,a);else{if(n.IsNYMEX(r,a))return this.GetNYMEXData(r,a);if(n.IsCOMEX(r,a))return this.GetCOMEXData(r,a);if(n.IsNYBOT(r,a))return this.GetNYBOTData(r,a);if(n.IsCBOT(r,a))return this.GetCBOTData(r,a);if(n.IsLME(r,a))return this.GetLMEData(r,a);if(n.IsTOCOM(r))return this.GetTOCOMData(r,a);if(n.IsIPE(r))return this.GetIPEData(r,a);if(n.IsBIT(r,a))i=this.GetBITData(r,a);else{if(n.IsHSX(r))return this.GetHSXData(r,a);if(n.IsHNX(r))return this.GetHNXData(r,a);if(n.IsUPCOM(r))return this.GetUPCOMData(r,a)}}}}else i=t;var s={Count:i.Count,MiddleCount:i.MiddleCount,Data:i.GetData(a)};return s},this.GetSHSZData=function(e,a){var i=t;return i},this.GetBJData=function(e,a){var i=t;return i},this.GetUSAData=function(t,e){var a=i;return a},this.GetHKData=function(t,e){var i=a;return i},this.GetTWData=function(t,e){return I},this.GetFuturesData=function(t,e,a){var i=a.GetSplitData(t);if(!i)return null;var r=o.GetFutures(i);if(!r)return null;var n={Count:r.length},s=null;s=e<200?i.Coordinate.Min:e<480?i.Coordinate.Simple:i.Coordinate.Full;for(var h=[],l=0;l<r.length;++l)for(var u=r[l],C=0;C<s.length;++C){var D=s[C];if(u==D.Value){var m=[l,0,"RGB(200,200,200)",D.Text];h.push(m);break}}return n.Data=h,n},this.GetChinatFuturesData=function(t,e){return this.GetFuturesData(t,e,l)},this.GetNYMEXData=function(t,e){return this.GetFuturesData(t,e,u)},this.GetCOMEXData=function(t,e){return this.GetFuturesData(t,e,C)},this.GetNYBOTData=function(t,e){return this.GetFuturesData(t,e,D)},this.GetCBOTData=function(t,e){return this.GetFuturesData(t,e,m)},this.GetLMEData=function(t,e){return this.GetFuturesData(t,e,c)},this.GetTOCOMData=function(t,e){return this.GetFuturesData(t,e,S)},this.GetIPEData=function(t,e){return this.GetFuturesData(t,e,f)},this.GetFTSEData=function(t,e){var a=r;return a},this.GetFHKData=function(t,e){var a=s;return a},this.GetForeignExchangeData=function(t,e){var a=h;return a},this.GetETData=function(t,e){throw{Name:"MinuteCoordinateData::GetETData",Error:"not implement"}},this.GetBITData=function(t,e){throw{Name:"MinuteCoordinateData::GetBITData",Error:"not implement"}},this.GetSHOData=function(t,a){var i=e;return i},this.GetJPData=function(t,e){throw{Name:"MinuteCoordinateData::GetJPData",Error:"not implement"}},this.GetHSXData=function(t,e){throw{Name:"MinuteCoordinateData::GetHSXData",Error:"not implement"}},this.GetHNXData=function(t,e){throw{Name:"MinuteCoordinateData::GetHNXData",Error:"not implement"}},this.GetUPCOMData=function(t,e){throw{Name:"MinuteCoordinateData::GetUPCOMData",Error:"not implement"}}};e.g_MinuteCoordinateData=h;var l=new function(){this.TIME_SPLIT=[{Name:"9:00-10:15,10:31-11:30,13:31-15:00",Data:[{Start:900,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1330,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Min:[{Value:900,Text:"9:00"},{Value:1330,Text:"13:30"},{Value:1500,Text:"15:00"}]}},{Name:"9:30-11:30,13:01-15:15",Data:[{Start:930,End:1130},{Start:1301,End:1515}],Coordinate:{Full:[{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1515,Text:"15:15"}],Simple:[{Value:930,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1515,Text:"15:15"}],Min:[{Value:930,Text:"9:30"},{Value:1300,Text:"13:00"},{Value:1515,Text:"15:15"}]}},{Name:"9:30-11:30,13:00-15:00",Data:[{Start:930,End:1130},{Start:1301,End:1500}],Coordinate:{Full:[{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:930,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:930,Text:"9:30"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:30,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2330},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-1:00,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2100,End:2359},{Start:0,End:100},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-2:30,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2100,End:2359},{Start:0,End:230},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:00,9:01-10:15,10:30-11:30,13:31-15:00",Data:[{Start:2100,End:2300},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}},{Name:"9:00-11:30,13:00-15:00",Data:[{Start:900,End:1130},{Start:1300,End:1500}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:00,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2300},{Start:900,End:1015},{Start:1030,End:1130},{Start:1330,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}},{Name:"9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:901,Text:"9:00"},{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:901,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1330,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Min:[{Value:901,Text:"9:00"},{Value:1330,Text:"13:30"},{Value:1500,Text:"15:00"}]}}],this.MAP_TWOWORDS=new Map([[n.DCE+"-JD",{Time:0,Decimal:0,Name:"鸡蛋"}],[n.DCE+"-FB",{Time:0,Decimal:2,Name:"纤板"}],[n.DCE+"-BB",{Time:0,Decimal:2,Name:"胶板"}],[n.DCE+"-PP",{Time:6,Decimal:0,Name:"丙烯"}],[n.DCE+"-JM",{Time:6,Decimal:1,Name:"焦煤"}],[n.DCE+"-EG",{Time:6,Decimal:0,Name:"乙二醇"}],[n.DCE+"-EB",{Time:6,Decimal:0,Name:"苯乙烯"}],[n.DCE+"-CS",{Time:6,Decimal:0,Name:"淀粉"}],[n.DCE+"-PG",{Time:6,Decimal:0,Name:"液化气"}],[n.DCE+"-RR",{Time:6,Decimal:0,Name:"梗米"}],[n.DCE+"-LH",{Time:0,Decimal:0,Name:"生猪"}],[n.SHFE+"-CU",{Time:4,Decimal:0,Name:"铜"}],[n.SHFE+"-AL",{Time:4,Decimal:0,Name:"铝"}],[n.SHFE+"-NI",{Time:4,Decimal:0,Name:"镍"}],[n.SHFE+"-SN",{Time:4,Decimal:0,Name:"沪锡"}],[n.SHFE+"-ZN",{Time:4,Decimal:0,Name:"沪锌"}],[n.SHFE+"-PB",{Time:4,Decimal:0,Name:"沪铅"}],[n.SHFE+"-RU",{Time:6,Decimal:0,Name:"天然橡胶"}],[n.SHFE+"-FU",{Time:6,Decimal:0,Name:"燃料油"}],[n.SHFE+"-RB",{Time:6,Decimal:0,Name:"螺纹钢"}],[n.SHFE+"-BU",{Time:6,Decimal:0,Name:"石油沥青"}],[n.SHFE+"-HC",{Time:6,Decimal:0,Name:"热轧卷板"}],[n.SHFE+"-SP",{Time:6,Decimal:0,Name:"纸浆"}],[n.SHFE+"-WR",{Time:0,Decimal:0,Name:"线材"}],[n.SHFE+"-AG",{Time:5,Decimal:0,Name:"白银"}],[n.SHFE+"-AU",{Time:5,Decimal:2,Name:"黄金"}],[n.SHFE+"-SS",{Time:4,Decimal:0,Name:"不锈钢"}],[n.SHFE+"-NR",{Time:6,Decimal:1,Name:"20号胶"}],[n.SHFE+"-SC",{Time:5,Decimal:1,Name:"原油"}],[n.SHFE+"-LU",{Time:6,Decimal:0,Name:"低硫燃油"}],[n.SHFE+"-BC",{Time:4,Decimal:0,Name:"国际铜"}],[n.CZCE+"-CF",{Time:6,Decimal:0,Name:"棉花"}],[n.CZCE+"-SR",{Time:6,Decimal:0,Name:"白糖"}],[n.CZCE+"-MA",{Time:6,Decimal:0,Name:"甲醇"}],[n.CZCE+"-ZC",{Time:6,Decimal:1,Name:"动力煤"}],[n.CZCE+"-TA",{Time:6,Decimal:0,Name:"精对苯二甲酸(PTA)"}],[n.CZCE+"-RM",{Time:6,Decimal:0,Name:"菜籽粕"}],[n.CZCE+"-OI",{Time:6,Decimal:0,Name:"菜籽油"}],[n.CZCE+"-ME",{Time:3,Decimal:0,Name:"甲醇(老)"}],[n.CZCE+"-FG",{Time:6,Decimal:0,Name:"平板玻璃"}],[n.CZCE+"-WS",{Time:0,Decimal:0}],[n.CZCE+"-WT",{Time:0,Decimal:0}],[n.CZCE+"-GN",{Time:0,Decimal:0}],[n.CZCE+"-RO",{Time:0,Decimal:0}],[n.CZCE+"-RS",{Time:0,Decimal:0,Name:"菜籽"}],[n.CZCE+"-ER",{Time:0,Decimal:0}],[n.CZCE+"-RI",{Time:0,Decimal:0,Name:"早籼稻"}],[n.CZCE+"-WH",{Time:0,Decimal:0,Name:"强麦"}],[n.CZCE+"-AP",{Time:0,Decimal:0,Name:"苹果"}],[n.CZCE+"-PM",{Time:0,Decimal:0,Name:"普麦"}],[n.CZCE+"-QM",{Time:0,Decimal:0}],[n.CZCE+"-TC",{Time:0,Decimal:0}],[n.CZCE+"-JR",{Time:0,Decimal:0,Name:"粳稻"}],[n.CZCE+"-LR",{Time:0,Decimal:0,Name:"晚籼稻"}],[n.CZCE+"-SF",{Time:0,Decimal:0,Name:"硅铁"}],[n.CZCE+"-SM",{Time:0,Decimal:0,Name:"锰硅"}],[n.CZCE+"-CJ",{Time:0,Decimal:2,Name:"红枣"}],[n.CZCE+"-CY",{Time:6,Decimal:0,Name:"棉纱"}],[n.CZCE+"-UR",{Time:0,Decimal:0,Name:"尿素"}],[n.CZCE+"-SA",{Time:6,Decimal:0,Name:"纯碱"}],[n.CZCE+"-PF",{Time:6,Decimal:0,Name:"短纤"}],[n.CZCE+"-PK",{Time:0,Decimal:0,Name:"花生"}],[n.CFFEX+"-TF",{Time:1,Decimal:3,Name:"二债"}],[n.CFFEX+"-TS",{Time:1,Decimal:3,Name:"五债"}],[n.CFFEX+"-IH",{Time:2,Decimal:1,Name:"上证股指期货"}],[n.CFFEX+"-IC",{Time:2,Decimal:1,Name:"中证股指期货"}],[n.CFFEX+"-IF",{Time:2,Decimal:1,Name:"沪深股指期货"}],[n.CFFEX+"-IM",{Time:2,Decimal:1,Name:"中证1000股指期货"}],[n.GZFE+"-SI",{Time:0,Decimal:2,Name:"工业硅"}]]),this.MAP_ONEWORD=new Map([[n.DCE+"-C",{Time:6,Decimal:0,Name:"玉米"}],[n.DCE+"-L",{Time:6,Decimal:0,Name:"乙烯"}],[n.DCE+"-V",{Time:6,Decimal:0,Name:"PVC"}],[n.DCE+"-A",{Time:6,Decimal:0,Name:"豆一"}],[n.DCE+"-B",{Time:6,Decimal:0,Name:"豆二"}],[n.DCE+"-M",{Time:6,Decimal:0,Name:"豆粕"}],[n.DCE+"-Y",{Time:6,Decimal:0,Name:"豆油"}],[n.DCE+"-P",{Time:6,Decimal:0,Name:"棕榈"}],[n.DCE+"-J",{Time:6,Decimal:1,Name:"焦炭"}],[n.DCE+"-I",{Time:6,Decimal:1,Name:"铁矿"}],[n.CFFEX+"-T",{Time:1,Decimal:3,Name:"十债"}]]),this.GetData=function(t){var e=t.charAt(0),a=t.substr(0,2),i=null,r=null;return n.IsDCE(t)?(i=n.DCE+"-"+e,r=n.DCE+"-"+a):n.IsSHFE(t)?(i=n.SHFE+"-"+e,r=n.SHFE+"-"+a):n.IsCFFEX(t)?(i=n.CFFEX+"-"+e,r=n.CFFEX+"-"+a):n.IsCZCE(t)?(i=n.CZCE+"-"+e,r=n.CZCE+"-"+a):n.IsGZFE(t)&&(i=n.GZFE+"-"+e,r=n.GZFE+"-"+a),this.MAP_TWOWORDS.has(r)?this.MAP_TWOWORDS.get(r):this.MAP_ONEWORD.has(i)?this.MAP_ONEWORD.get(i):null},this.GetSplitData=function(t){var e=this.GetData(t);return e?this.TIME_SPLIT[e.Time]:null},this.GetDecimal=function(t){var e=this.GetData(t);return e?e.Decimal:2},this.AddNewFutures=function(t){if(t){var e=t.Suffix+"-"+t.Symbol,a={Time:t.Time,Decimal:t.Decimal,Name:t.Name};1==t.Symbol.length?this.MAP_ONEWORD.set(e,a):2==t.Symbol.length&&this.MAP_TWOWORDS.set(e,a)}}};e.g_FuturesTimeData=l;var u=new s;e.g_NYMEXTimeData=u;var C=new function(){this.newMethod=s,this.newMethod(),delete this.newMethod,this.FUTURES_LIST=[{Symbol:"GC",Decimal:1,Time:0,Name:"COMEX黄金"},{Symbol:"QO",Decimal:2,Time:0,Name:"迷你黄金"},{Symbol:"MG",Decimal:1,Time:0,Name:"微型黄金"},{Symbol:"QI",Decimal:4,Time:0,Name:"迷你白银"},{Symbol:"SI",Decimal:3,Time:0,Name:"COMEX白银"},{Symbol:"HG",Decimal:4,Time:0,Name:"COMEX铜"}],this.MarketSuffix=".COMEX"};e.g_COMEXTimeData=C;var D=new function(){this.newMethod=s,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"9:00-2:20",Data:[{Start:900,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1700,Text:"17:00"},{Value:100,Text:"1:00"}]}},{Name:"15:30-1:00",Data:[{Start:1530,End:2359},{Start:0,End:100}],Coordinate:{Full:[{Value:1600,Text:"16:00"},{Value:1700,Text:"17:00"},{Value:1800,Text:"18:00"},{Value:1900,Text:"19:00"},{Value:2e3,Text:"20:00"},{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:0,Text:"0:00"},{Value:100,Text:"1:00"}],Simple:[{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"}],Min:[{Value:1600,Text:"16:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}]}}],this.TIME_SPLIT2=[{Name:"10:00-3:20",Data:[{Start:1e3,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:1e3,Text:"10:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"16:30-2:00",Data:[{Start:1630,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:1700,Text:"17:00"},{Value:1800,Text:"18:00"},{Value:1900,Text:"19:00"},{Value:2e3,Text:"20:00"},{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:0,Text:"0:00"},{Value:100,Text:"1:00"},{Value:200,Text:"2:00"}],Simple:[{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"}],Min:[{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:200,Text:"2:00"}]}}],this.FUTURES_LIST=[{Symbol:"SB",Decimal:2,Time:1},{Symbol:"CT",Decimal:2,Time:0}],this.MarketSuffix=".NYBOT",this.GetMarketStatus=function(t){var e=r(-4),a=e.getDay(),i=100*e.getHours()+e.getMinutes();if(6==a||0==a)return 0;var n=this.GetFuturesInfo(t);if(!n)return 2;if("SB"==n.Symbol){if(i>300&&i<1400)return 2}else if("CT"==n.Symbol)return i>=0&&i<=1500||i>=2e3&&i<=2359?2:1;return 0}};e.g_NYBOTTimeData=D;var m=new function(){this.newMethod=s,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"8:00-2:20",Data:[{Start:800,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"8:00-2:45",Data:[{Start:800,End:2359},{Start:0,End:245}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"6:00-5:00",Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}},{Name:"08:00-20:45 21:31-02:20",Data:[{Start:800,End:2045},{Start:2131,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"8:00-2:45",Data:[{Start:800,End:2045},{Start:2131,End:2359},{Start:0,End:245}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"06:00-04:15 04:31-05:00",Data:[{Start:600,End:2359},{Start:0,End:415},{Start:431,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.TIME_SPLIT2=[{Name:"9:00-3:20",Data:[{Start:900,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"9:00-3:45",Data:[{Start:900,End:2359},{Start:0,End:345}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"7:00-6:00",Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}},{Name:"09:00-21:45 22:31-03:20",Data:[{Start:900,End:2145},{Start:2231,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"09:00-21:45 22:31-03:45",Data:[{Start:900,End:2145},{Start:2231,End:2359},{Start:0,End:345}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"07:00-05:15 05:31-06:00",Data:[{Start:700,End:2359},{Start:0,End:515},{Start:531,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.FUTURES_LIST=[{Symbol:"ZC",Decimal:2,Time:0,Name:"玉米"},{Symbol:"XC",Decimal:2,Time:1,Name:"迷你玉米"},{Symbol:"ZS",Decimal:2,Time:0,Name:"大豆"},{Symbol:"XK",Decimal:2,Time:1,Name:"迷你大豆"},{Symbol:"ZL",Decimal:2,Time:0,Name:"豆油"},{Symbol:"ZR",Decimal:2,Time:0,Name:"稻谷"},{Symbol:"ZO",Decimal:2,Time:0,Name:"燕麦"},{Symbol:"ZW",Decimal:2,Time:0,Name:"小麦"},{Symbol:"XW",Decimal:2,Time:1,Name:"迷你小麦"},{Symbol:"ZM",Decimal:1,Time:0,Name:"豆粕"},{Symbol:"EH",Decimal:3,Time:2},{Symbol:"YM",Decimal:0,Time:2,Name:"小型道指"},{Symbol:"ES",Decimal:2,Time:2,Name:"小型标普"},{Symbol:"NQ",Decimal:2,Time:2,Name:"小型纳指"},{Symbol:"TY",Decimal:4,Time:2,Name:"10年美国债"},{Symbol:"TU",Decimal:4,Time:2,Name:"2年美国债"},{Symbol:"FV",Decimal:4,Time:2,Name:"5年美国债"},{Symbol:"US",Decimal:4,Time:2,Name:"30年美国债"},{Symbol:"UL",Decimal:4,Time:2,Name:"超国债"}],this.MarketSuffix=".CBOT"};e.g_CBOTTimeData=m;var c=new function(){this.newMethod=s,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"LME 9:00-3:00",Data:[{Start:900,End:2359},{Start:0,End:300}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1800,Text:"18:00"},{Value:300,Text:"3:00"}]}}],this.TIME_SPLIT=[{Name:"LME 8:00-2:00",Data:[{Start:800,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}}],this.FUTURES_LIST=[{Symbol:"SN",Decimal:0,Time:0,Name:"LME锡"},{Symbol:"AH",Decimal:2,Time:0,Name:"LME铝"},{Symbol:"PB",Decimal:2,Time:0,Name:"LME铅"},{Symbol:"ZS",Decimal:2,Time:0,Name:"LME锌"},{Symbol:"CA",Decimal:2,Time:0,Name:"LME铜"},{Symbol:"NI",Decimal:0,Time:0,Name:"LME镍"}],this.MarketSuffix=".LME"};e.g_LMETimeData=c;var S=new function(){this.newMethod=s,this.newMethod(),delete this.newMethod,this.TimeType=0,this.TIME_SPLIT=[{Name:"15:30-04:30 07:46-14:15",Data:[{Start:1530,End:2359},{Start:0,End:430},{Start:746,End:1415}],Coordinate:{Full:[{Value:1530,Text:"15:30"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:300,Text:"3:00"},{Value:430,Text:"4:30"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1415,Text:"14:15"}],Simple:[{Value:1530,Text:"15:30"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:430,Text:"4:30"},{Value:1100,Text:"11:00"},{Value:1415,Text:"14:15"}],Min:[{Value:1530,Text:"15:30"},{Value:100,Text:"1:00"},{Value:1415,Text:"14:15"}]}}],this.FUTURES_LIST=[{Symbol:"JRV",Decimal:0,Time:0,Name:"东京TSR20橡胶"},{Symbol:"JPL",Decimal:0,Time:0,Name:"东京铂金"},{Symbol:"JAU",Decimal:0,Time:0,Name:"东京黄金"},{Symbol:"JCO",Decimal:0,Time:0,Name:"中东原油"},{Symbol:"JRU",Decimal:1,Time:0,Name:"东京RSS3橡胶橡胶"},{Symbol:"JAG",Decimal:1,Time:0,Name:"日白银"},{Symbol:"JPA",Decimal:1,Time:0,Name:"日钯金"}],this.MarketSuffix=".TOCOM"};e.g_TOCOMTimeData=S;var f=new function(){this.newMethod=s,this.newMethod(),delete this.newMethod,this.MarketSuffix=".IPE",this.TIME_SPLIT=[{Name:"8:00-6:00",Data:[{Start:800,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"},{Value:600,Text:"6:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"},{Value:400,Text:"4:00"},{Value:600,Text:"6:00"}],Min:[{Value:800,Text:"8:00"},{Value:2e3,Text:"20:00"},{Value:600,Text:"6:00"}]}}],this.TIME_SPLIT2=[{Name:"09:00-07:00",Data:[{Start:900,End:2359},{Start:0,End:700}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"},{Value:700,Text:"7:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"},{Value:500,Text:"5:00"},{Value:700,Text:"7:00"}],Min:[{Value:900,Text:"9:00"},{Value:2100,Text:"21:00"},{Value:700,Text:"7:00"}]}}],this.FUTURES_LIST=[{Symbol:"RC",Decimal:2,Time:0,Name:"罗布斯塔咖啡"},{Symbol:"W",Decimal:2,Time:0,Name:"白糖"},{Symbol:"C",Decimal:2,Time:0,Name:"伦敦可可"},{Symbol:"R",Decimal:2,Time:0,Name:"长期英国国债"},{Symbol:"L",Decimal:2,Time:0,Name:"3个月英镑利率"},{Symbol:"T",Decimal:2,Time:0,Name:"WTI原油"},{Symbol:"G",Decimal:2,Time:0,Name:"低硫柴油"},{Symbol:"B",Decimal:2,Time:0,Name:"布伦特原油"}]};function I(t){var e=2;if(!t)return e;var a=t.toUpperCase();return"function"==typeof n.GetCustomDecimal?n.GetCustomDecimal(a):(e=n.IsSHSZFund(a)?3:n.IsSHO(a)||n.IsSZO(a)?n.GetSHODecimal(a):n.IsChinaFutures(a)?l.GetDecimal(a):n.IsFHK(a)?n.GetFHKDecimal(a):n.IsFTSE(a)?n.GetFTSEDecimal(a):n.IsForeignExchange(a)?n.GetForeignExchangeDecimal(a):n.IsBIT(a)?n.GetBITDecimal(a):n.IsET(a)?n.GetETDecimal(a):n.IsNYMEX(a)?u.GetDecimal(a):n.IsCOMEX(a)?C.GetDecimal(a):n.IsNYBOT(a)?D.GetDecimal(a):n.IsCBOT(a)?m.GetDecimal(a):n.IsTOCOM(a)?S.GetDecimal(a):n.IsIPE(a)?f.GetDecimal(a):n.IsHK(a)?n.GetHKDecimal(a):n.IsTW(a)?n.GetTWDecimal(a):n.IsJP(a)?n.GetJPDecimal(a):n.IsHSX(a)?n.GetHSXDecimal(a):n.IsHNX(a)?n.GetHNXDecimal(a):n.IsUPCOM(a)?n.GetUPCOMDecimal(a):n.GetDefaultDecimal(a),e)}e.g_IPETimeData=f;var d={MinuteCoordinateData:h,MinuteTimeStringData:o,MARKET_SUFFIX_NAME:n,GetfloatPrecision:I};e.JSCommonCoordinateData=d},a2a9:function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSCommon=void 0,a("e9c4"),a("e25e"),a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("99af"),a("d401"),a("81b2"),a("0eb6"),a("b7ef"),a("8bd4"),a("14d9"),a("4de4"),a("a434"),a("ac1f"),a("00b4"),a("25f0"),a("c975"),a("a9e3"),a("4e82"),a("acd8"),a("fb6a"),a("a630"),a("5319");var i=a("c534"),r=a("514b"),n=a("630d"),s=a("8709"),o=a("52e0"),h=a("966c"),l=a("698c"),u=a("9594"),C=(a("85bb"),a("ca79")),D=a("d552"),m=a("8bf6"),c=a("b1ef"),S=a("ee32"),f=a("deed"),I=a("b0e7");function d(t){this.JSChartContainer,this.CanvasElement=t,this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(i.JSConsole.Chart.Log("[JSChart:AddEventCallback] ",t),this.JSChartContainer.AddEventCallback(t))},this.SetLanguage=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetLanguage&&(i.JSConsole.Chart.Log("[JSChart:SetLanguage] ",t),this.JSChartContainer.SetLanguage(t))},this.OnSize=function(t){t&&(f.IFrameSplitOperator.IsNumber(t.Width)&&(this.CanvasElement.Width=t.Width),f.IFrameSplitOperator.IsNumber(t.Height)&&(this.CanvasElement.Height=t.Height)),t&&0==t.Redraw||this.JSChartContainer&&(t&&1==t.Type&&this.JSChartContainer.OnSize?this.JSChartContainer.OnSize():(this.JSChartContainer.Frame&&this.JSChartContainer.Frame.SetSizeChage(!0),this.JSChartContainer.Draw()))},this.SetChartBorder=function(t,e){if(e.Border){var a=e.Border;f.IFrameSplitOperator.IsNumber(e.Border.Left)?t.Frame.ChartBorder.Left=e.Border.Left:e.Border.Left=t.Frame.ChartBorder.Left,f.IFrameSplitOperator.IsNumber(e.Border.Right)?t.Frame.ChartBorder.Right=e.Border.Right:e.Border.Right=t.Frame.ChartBorder.Right,f.IFrameSplitOperator.IsNumber(e.Border.Top)?t.Frame.ChartBorder.Top=e.Border.Top:e.Border.Top=t.Frame.ChartBorder.Top,f.IFrameSplitOperator.IsNumber(e.Border.Bottom)?t.Frame.ChartBorder.Bottom=e.Border.Bottom:e.Border.Bottom=t.Frame.ChartBorder.Bottom,a.AutoLeft&&(t.Frame.AutoLeftBorder={},f.IFrameSplitOperator.IsNumber(a.AutoLeft.Blank)&&(t.Frame.AutoLeftBorder.Blank=a.AutoLeft.Blank),f.IFrameSplitOperator.IsNumber(a.AutoLeft.MinWidth)&&(t.Frame.AutoLeftBorder.MinWidth=a.AutoLeft.MinWidth)),a.AutoRight&&(t.Frame.AutoRightBorder={},f.IFrameSplitOperator.IsNumber(a.AutoRight.Blank)&&(t.Frame.AutoRightBorder.Blank=a.AutoRight.Blank),f.IFrameSplitOperator.IsNumber(a.AutoRight.MinWidth)&&(t.Frame.AutoRightBorder.MinWidth=a.AutoRight.MinWidth))}},this.CreateKLineChartContainer=function(t){var e=null;if(e="历史K线图横屏"===t.Type?new P(this.CanvasElement):new y(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxRequestDataCount>0&&(e.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),t.KLine.Policy&&t.KLine.Policy.length>0&&e.SetPolicyInfo(t.KLine.Policy,!1),0==t.KLine.KLineDoubleClick&&(e.MinuteDialog=this.MinuteDialog=null),t.KLine.MaxRequestMinuteDayCount>0&&(e.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(e.KLineDrawType=t.KLine.DrawType),t.KLine.RightSpaceCount>=0&&(e.RightSpaceCount=t.KLine.RightSpaceCount),t.KLine.DataWidth>=1&&(e.KLineSize={DataWidth:t.KLine.DataWidth}),f.IFrameSplitOperator.IsNumber(t.KLine.RightFormula)&&(e.RightFormula=t.KLine.RightFormula)),f.IFrameSplitOperator.IsString(t.SplashTitle)&&(e.LoadDataSplashTitle=t.SplashTitle),f.IFrameSplitOperator.IsBool(t.EnableZoomIndexWindow)&&(e.EnableZoomIndexWindow=t.EnableZoomIndexWindow),!t.Windows||t.Windows.length<=0)return null;if(t.Language){var a=S.g_JSChartLocalization.GetLanguageID(t.Language);f.IFrameSplitOperator.IsNumber(a)&&(e.LanguageID=a)}if(t.SourceDatatLimit&&e.SetSourceDatatLimit(t.SourceDatatLimit),t.EnableZoomUpDown&&(e.EnableZoomUpDown=t.EnableZoomUpDown),t.ZoomStepPixel>0&&(e.ZoomStepPixel=t.ZoomStepPixel),f.IFrameSplitOperator.IsNumber(t.DrawMoveWaitTime)&&(e.DrawMoveWaitTime=t.DrawMoveWaitTime),f.IFrameSplitOperator.IsNumber(t.PressTime)&&(e.PressTime=t.PressTime),e.Create(t.Windows.length),this.SetChartBorder(e,t),t.KLine){if(t.KLine.PageSize>0){var i=e.GetMaxPageSize();i<t.KLine.PageSize?e.PageSize=i:e.PageSize=t.KLine.PageSize}t.KLine.InfoDrawType&&(e.ChartPaint[0].InfoDrawType=t.KLine.InfoDrawType)}if(t.DragDownload&&(t.DragDownload.Day&&1==t.DragDownload.Day.Enable&&(e.DragDownload.Day.Enable=!0),t.DragDownload.Minute&&1==t.DragDownload.Minute.Enable&&(e.DragDownload.Minute.Enable=!0)),1==t.IsApiPeriod&&(e.IsApiPeriod=t.IsApiPeriod),1==t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(e.IsClickShowCorssCursor=t.IsClickShowCorssCursor),1==t.IsFullDraw&&(e.IsFullDraw=t.IsFullDraw),t.CorssCursorInfo){var r=t.CorssCursorInfo;isNaN(t.CorssCursorInfo.Left)||(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(e.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),f.IFrameSplitOperator.IsNumber(t.CorssCursorInfo.HPenType)&&(e.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(e.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType),f.IFrameSplitOperator.IsNumber(r.DateFormatType)&&(e.ChartCorssCursor.StringFormatX.DateFormatType=r.DateFormatType),f.IFrameSplitOperator.IsNumber(r.PriceFormatType)&&(e.ChartCorssCursor.StringFormatY.PriceFormatType=r.PriceFormatType),f.IFrameSplitOperator.IsNumber(r.DataFormatType)&&(e.ChartCorssCursor.StringFormatY.DataFormatType=r.DataFormatType)}if("function"==typeof t.UpdateUICallback&&(e.UpdateUICallback=t.UpdateUICallback),t.Frame)for(var n in t.Frame){r=t.Frame[n];e.Frame.SubFrame[n]&&(r.SplitCount&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(e.Frame.SubFrame[n].Frame.YSplitOperator.StringFormat=r.StringFormat),isNaN(r.Height)||(e.Frame.SubFrame[n].Height=r.Height),0==r.IsShowBorder&&(e.Frame.SubFrame[n].Frame.IsShowBorder=r.IsShowBorder),0==r.IsShowXLine&&(e.Frame.SubFrame[n].Frame.IsShowXLine=r.IsShowXLine),0==r.IsShowYLine&&(e.Frame.SubFrame[n].Frame.IsShowYLine=r.IsShowYLine),"bottom"==r.XMessageAlign&&(e.Frame.SubFrame[n].Frame.XMessageAlign=r.XMessageAlign),0==r.IsShowTitle&&(e.Frame.SubFrame[n].Frame.IsShowTitle=!1),f.IFrameSplitOperator.IsBool(r.IsShowIndexTitle)&&(e.Frame.SubFrame[n].Frame.IsShowTitle=r.IsShowIndexTitle),r.UpdateTitleUICallback&&e.Frame.SubFrame[n].Frame.TitlePaint&&(e.Frame.SubFrame[n].Frame.TitlePaint.UpdateUICallback=r.UpdateTitleUICallback),!1!==r.IsShowLeftText&&!0!==r.IsShowLeftText||(e.Frame.SubFrame[n].Frame.IsShowYText[0]=r.IsShowLeftText),!1!==r.IsShowRightText&&!0!==r.IsShowRightText||(e.Frame.SubFrame[n].Frame.IsShowYText[1]=r.IsShowRightText),r.TopSpace>=0&&(e.Frame.SubFrame[n].Frame.ChartBorder.TopSpace=r.TopSpace),r.BottomSpace>=0&&(e.Frame.SubFrame[n].Frame.ChartBorder.BottomSpace=r.BottomSpace),r.Custom&&(e.Frame.SubFrame[n].Frame.YSplitOperator.Custom=r.Custom),f.IFrameSplitOperator.IsNumber(r.SplitType)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitType=r.SplitType,e.Frame.SubFrame[n].Frame.YSplitOperator.DefaultSplitType=r.SplitType),f.IFrameSplitOperator.IsNumber(r.FloatPrecision)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.FloatPrecision=r.FloatPrecision),f.IFrameSplitOperator.IsNumber(r.BorderLine)&&(e.Frame.SubFrame[n].Frame.BorderLine=r.BorderLine),f.IFrameSplitOperator.IsNumber(r.YTextBaseline)&&(e.Frame.SubFrame[n].Frame.YTextBaseline=r.YTextBaseline))}if(t.KLine&&(0==t.KLine.ShowKLine&&(e.ChartPaint[0].IsShow=!1),0==t.KLine.IsShowMaxMinPrice&&(e.ChartPaint[0].IsShowMaxMinPrice=!1)),t.KLineTitle){r=t.KLineTitle;0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1),0==t.KLineTitle.IsShow&&(e.TitlePaint[0].IsShow=!1),t.KLineTitle.UpdateUICallback&&(e.TitlePaint[0].UpdateUICallback=t.KLineTitle.UpdateUICallback),t.KLineTitle.LineCount>1&&(e.TitlePaint[0].LineCount=t.KLineTitle.LineCount),f.IFrameSplitOperator.IsNumber(r.TextSpace)&&(e.TitlePaint[0].TextSpace=r.TextSpace),f.IFrameSplitOperator.IsNumber(r.PeriodSpace)&&(e.TitlePaint[0].PeriodSpace=r.PeriodSpace),f.IFrameSplitOperator.IsNumber(r.DateTimeSpace)&&(e.TitlePaint[0].DateTimeSpace=r.DateTimeSpace),f.IFrameSplitOperator.IsNumber(r.NameSpace)&&(e.TitlePaint[0].NameSpace=r.NameSpace)}for(var n in t.Overlay){r=t.Overlay[n];if(r.Symbol){e.OverlayChartPaint[0].Symbol=r.Symbol,r.Color&&(e.OverlayChartPaint[0].Color=r.Color),e.OverlayChartPaint[0].SetOption(r);break}}if(t.ExtendChart)for(var n in t.ExtendChart){r=t.ExtendChart[n];e.CreateExtendChart(r.Name,r)}var s=new u.JSCommonIndexScript.JSIndexScript;if(t.ColorIndex){r=t.ColorIndex;var o=s.Get(r.Index);o&&(e.ColorIndex=new c.ScriptIndex(o.Name,o.Script,o.Args,o))}if(t.TradeIndex){r=t.TradeIndex;var h=s.Get(r.Index);h&&(e.TradeIndex=new c.ScriptIndex(h.Name,h.Script,h.Args,h))}for(n=0;n<t.Windows.length;++n){r=t.Windows[n];if(r.Script)e.WindowIndex[n]=new c.ScriptIndex(r.Name,r.Script,r.Args,r);else if(r.API){var l=r.API;e.WindowIndex[n]=new c.APIScriptIndex(l.Name,l.Script,l.Args,r)}else{var C=R.Get(r.Index);if(C)e.WindowIndex[n]=C.Create(),e.CreateWindowIndex(n);else{var D=s.Get(r.Index);if(!D)continue;r.Lock&&(D.Lock=r.Lock),D.ID=r.Index;var m=D.Args;r.Args&&(m=r.Args),r.TitleFont&&(D.TitleFont=r.TitleFont),f.IFrameSplitOperator.IsNumber(r.IsShortTitle)&&(D.IsShortTitle=r.IsShortTitle),e.WindowIndex[n]=new c.ScriptIndex(D.Name,D.Script,m,D),r.StringFormat>0&&(e.WindowIndex[n].StringFormat=r.StringFormat),r.FloatPrecision>=0&&(e.WindowIndex[n].FloatPrecision=r.FloatPrecision)}}null!=r.Modify&&(e.Frame.SubFrame[n].Frame.ModifyIndex=r.Modify),null!=r.Change&&(e.Frame.SubFrame[n].Frame.ChangeIndex=r.Change),f.IFrameSplitOperator.IsBool(r.IsDrawTitleBG)&&(e.Frame.SubFrame[n].Frame.IsDrawTitleBG=r.IsDrawTitleBG),f.IFrameSplitOperator.IsBool(r.IsShowNameArrow)&&(e.Frame.SubFrame[n].Frame.IsShowNameArrow=r.IsShowNameArrow),"function"==typeof r.UpdateUICallback&&(e.WindowIndex[n].UpdateUICallback=r.UpdateUICallback),isNaN(r.TitleHeight)||(e.Frame.SubFrame[n].Frame.ChartBorder.TitleHeight=r.TitleHeight),0==r.IsShowIndexName&&(e.Frame.SubFrame[n].Frame.IsShowIndexName=!1),r.IndexParamSpace>=0&&(e.Frame.SubFrame[n].Frame.IndexParamSpace=r.IndexParamSpace),r.IndexTitleSpace>=0&&(e.Frame.SubFrame[n].Frame.IndexTitleSpace=r.IndexTitleSpace)}if(f.IFrameSplitOperator.IsNonEmptyArray(t.OverlayIndex))for(n=0;n<t.OverlayIndex.length;++n){r=t.OverlayIndex[n];if(!(r.Windows>=e.Frame.SubFrame.length)){var I=JSON.stringify(r),d=JSON.parse(I);r.Index&&(d.IndexName=r.Index),r.Windows>=0&&(d.WindowIndex=r.Windows),e.CreateOverlayWindowsIndex(d)}}return e},this.CreateCustomKLineChartContainer=function(t){var e=new B(this.CanvasElement);if(t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxRequestDataCount>0&&(e.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),0==t.KLine.KLineDoubleClick&&(e.MinuteDialog=this.MinuteDialog=null),t.KLine.PageSize>0&&(e.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(e.IsShowTooltip=!1)),t.CustomStock&&(e.CustomStock=t.CustomStock),t.QueryDate&&(e.QueryDate=t.QueryDate),"function"==typeof t.UpdateUICallback&&(e.UpdateUICallback=t.UpdateUICallback),!t.Windows||t.Windows.length<=0)return null;if(e.Create(t.Windows.length),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Frame)for(var a in t.Frame){var i=t.Frame[a];i.SplitCount&&(e.Frame.SubFrame[a].Frame.YSplitOperator.SplitCount=i.SplitCount),i.StringFormat&&(e.Frame.SubFrame[a].Frame.YSplitOperator.StringFormat=i.StringFormat),"bottom"==i.XMessageAlign&&(e.Frame.SubFrame[a].Frame.XMessageAlign=i.XMessageAlign)}t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1));var r=new u.JSCommonIndexScript.JSIndexScript;for(var a in t.Windows){i=t.Windows[a];if(i.Script)e.WindowIndex[a]=new c.ScriptIndex(i.Name,i.Script,i.Args,i);else{var n=R.Get(i.Index);if(n)e.WindowIndex[a]=n.Create(),e.CreateWindowIndex(a);else{var s=r.Get(i.Index);if(!s)continue;i.Lock&&(s.Lock=i.Lock),e.WindowIndex[a]=new c.ScriptIndex(s.Name,s.Script,s.Args,s)}}null!=i.Modify&&(e.Frame.SubFrame[a].Frame.ModifyIndex=i.Modify),null!=i.Change&&(e.Frame.SubFrame[a].Frame.ChangeIndex=i.Change),isNaN(i.TitleHeight)||(e.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight=i.TitleHeight)}return e},this.CreateMinuteChartContainer=function(t){var e=null;e="分钟走势图横屏"===t.Type?new V(this.CanvasElement):new w(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter);var a=2;if(t.Windows&&t.Windows.length>0&&(a+=t.Windows.length),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),t.Info&&t.Info.length>0&&e.SetMinuteInfo(t.Info,!1),f.IFrameSplitOperator.IsString(t.SplashTitle)&&(e.LoadDataSplashTitle=t.SplashTitle),f.IFrameSplitOperator.IsBool(t.EnableZoomIndexWindow)&&(e.EnableZoomIndexWindow=t.EnableZoomIndexWindow),f.IFrameSplitOperator.IsNumber(t.DrawMoveWaitTime)&&(e.DrawMoveWaitTime=t.DrawMoveWaitTime),f.IFrameSplitOperator.IsNumber(t.PressTime)&&(e.PressTime=t.PressTime),t.Language){var i=S.g_JSChartLocalization.GetLanguageID(t.Language);f.IFrameSplitOperator.IsNumber(i)&&(e.LanguageID=i)}if(e.Create(a),1==t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsFullDraw&&(e.IsFullDraw=t.IsFullDraw),t.CorssCursorInfo){var r=t.CorssCursorInfo;isNaN(t.CorssCursorInfo.Left)||(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),f.IFrameSplitOperator.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(e.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime),f.IFrameSplitOperator.IsNumber(r.PriceFormatType)&&(e.ChartCorssCursor.StringFormatY.PriceFormatType=r.PriceFormatType),f.IFrameSplitOperator.IsNumber(r.DataFormatType)&&(e.ChartCorssCursor.StringFormatY.DataFormatType=r.DataFormatType)}if(t.MinuteInfo&&e.CreateMinuteInfo(t.MinuteInfo),t.DayCount>1&&(e.DayCount=t.DayCount),this.SetChartBorder(e,t),t.Frame){for(var n=0;n<t.Frame.length;++n){r=t.Frame[n];e.Frame.SubFrame[n]&&(r.SplitCount&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(e.Frame.SubFrame[n].Frame.YSplitOperator.StringFormat=r.StringFormat),f.IFrameSplitOperator.IsNumber(r.SplitType)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitType=r.SplitType,e.Frame.SubFrame[n].Frame.YSplitOperator.DefaultSplitType=r.SplitType),"bottom"==r.XMessageAlign&&(e.Frame.SubFrame[n].Frame.XMessageAlign=r.XMessageAlign),!1!==r.IsShowLeftText&&!0!==r.IsShowLeftText||(e.Frame.SubFrame[n].Frame.IsShowYText[0]=r.IsShowLeftText),!1!==r.IsShowRightText&&!0!==r.IsShowRightText||(e.Frame.SubFrame[n].Frame.IsShowYText[1]=r.IsShowRightText),r.Height>=0&&(e.Frame.SubFrame[n].Height=r.Height),r.Custom&&(e.Frame.SubFrame[n].Frame.YSplitOperator.Custom=r.Custom),f.IFrameSplitOperator.IsNumber(r.BorderLine)&&(e.Frame.SubFrame[n].Frame.BorderLine=r.BorderLine),f.IFrameSplitOperator.IsNumber(r.YTextBaseline)&&(e.Frame.SubFrame[n].Frame.YTextBaseline=r.YTextBaseline),f.IFrameSplitOperator.IsBool(r.IsShowXLine)&&(e.Frame.SubFrame[n].Frame.IsShowXLine=r.IsShowXLine),f.IFrameSplitOperator.IsBool(r.IsShowYLine)&&(e.Frame.SubFrame[n].Frame.IsShowYLine=r.IsShowYLine))}e.UpdateXShowText()}if(t.MinuteTitle){r=t.MinuteTitle;0==t.MinuteTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.MinuteTitle.IsShow&&(e.TitlePaint[0].IsShow=!1),t.MinuteTitle.UpdateUICallback&&(e.TitlePaint[0].UpdateUICallback=t.MinuteTitle.UpdateUICallback),t.MinuteTitle.LineCount>1&&(e.TitlePaint[0].LineCount=t.MinuteTitle.LineCount),f.IFrameSplitOperator.IsNumber(r.TextSpace)&&(e.TitlePaint[0].TextSpace=r.TextSpace)}if("function"==typeof t.UpdateUICallback&&(e.UpdateUICallback=t.UpdateUICallback),t.ExtendChart)for(var n in t.ExtendChart){r=t.ExtendChart[n];e.CreateExtendChart(r.Name,r)}for(var n in t.Overlay){r=t.Overlay[n];if(r.Symbol){e.OverlayChartPaint[0].Symbol=r.Symbol,r.Color&&(e.OverlayChartPaint[0].Color=r.Color);break}}if(t.Overlay&&t.Overlay.length&&(e.OverlayChartPaint[0].Symbol=t.Overlay[0].Symbol),t.MinuteLine){if(0==t.MinuteLine.IsDrawAreaPrice&&(e.ChartPaint[0].IsDrawArea=!1),0==t.MinuteLine.IsShowAveragePrice)for(var n in e.ChartPaint[1].IsShow=!1,e.TitlePaint[0].IsShowAveragePrice=!1,e.ExtendChartPaint){r=e.ExtendChartPaint[n];"MinuteTooltipPaint"==r.ClassName&&(r.IsShowAveragePrice=!1)}t.MinuteLine.SplitType>0&&(e.Frame.SubFrame[0].Frame.YSplitOperator.SplitType=t.MinuteLine.SplitType)}var s=new u.JSCommonIndexScript.JSIndexScript;for(n=0;n<t.Windows.length;++n){var o=n+2;r=t.Windows[n];if(r.Script)e.WindowIndex[2+n]=new c.ScriptIndex(r.Name,r.Script,r.Args,r);else if(r.API){var h=r.API;e.WindowIndex[2+n]=new c.APIScriptIndex(h.Name,h.Script,h.Args,r)}else{var l=R.Get(r.Index);if(l)e.WindowIndex[2+n]=l.Create(),e.CreateWindowIndex(o);else{var C=s.Get(r.Index);if(!C)continue;var D=C.Args;r.Args&&(D=r.Args),r.Lock&&(C.Lock=r.Lock),r.TitleFont&&(C.TitleFont=r.TitleFont),f.IFrameSplitOperator.IsNumber(r.IsShortTitle)&&(C.IsShortTitle=r.IsShortTitle),e.WindowIndex[2+n]=new c.ScriptIndex(C.Name,C.Script,D,C),r.StringFormat>0&&(e.WindowIndex[o].StringFormat=r.StringFormat),r.FloatPrecision>=0&&(e.WindowIndex[o].FloatPrecision=r.FloatPrecision)}}isNaN(r.TitleHeight)||(e.Frame.SubFrame[o].Frame.ChartBorder.TitleHeight=r.TitleHeight),f.IFrameSplitOperator.IsBool(r.IsDrawTitleBG)&&(e.Frame.SubFrame[o].Frame.IsDrawTitleBG=r.IsDrawTitleBG),f.IFrameSplitOperator.IsBool(r.IsShowNameArrow)&&(e.Frame.SubFrame[o].Frame.IsShowNameArrow=r.IsShowNameArrow),f.IFrameSplitOperator.IsNumber(r.YSplitType)&&(e.Frame.SubFrame[o].Frame.YSplitOperator.SplitType=r.YSplitType)}return e},this.CreateHistoryMinuteChartContainer=function(t){var e=new b(this.CanvasElement),a=2;if(t.Windows&&t.Windows.length>0&&(a+=t.Windows.length),e.Create(a),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),t.Frame)for(var i in t.Frame){var r=t.Frame[i];r.SplitCount&&(e.Frame.SubFrame[i].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(e.Frame.SubFrame[i].Frame.YSplitOperator.StringFormat=r.StringFormat),"bottom"==r.XMessageAlign&&(e.Frame.SubFrame[i].Frame.XMessageAlign=r.XMessageAlign)}var n=new u.JSCommonIndexScript.JSIndexScript;for(var i in t.Windows){r=t.Windows[i];if(r.Script)e.WindowIndex[2+parseInt(i)]=new c.ScriptIndex(r.Name,r.Script,r.Args,r);else{var s=R.Get(r.Index);if(s)e.WindowIndex[2+parseInt(i)]=s.Create(),e.CreateWindowIndex(2+parseInt(i));else{var o=n.Get(r.Index);if(!o)continue;r.Lock&&(o.Lock=r.Lock),e.WindowIndex[2+parseInt(i)]=new c.ScriptIndex(o.Name,o.Script,o.Args,o)}}isNaN(r.TitleHeight)||(e.Frame.SubFrame[2+parseInt(i)].Frame.ChartBorder.TitleHeight=r.TitleHeight)}return e.TradeDate=20181009,t.HistoryMinute&&(t.HistoryMinute.TradeDate&&(e.TradeDate=t.HistoryMinute.TradeDate),null!=t.HistoryMinute.IsShowName&&(e.TitlePaint[0].IsShowName=t.HistoryMinute.IsShowName),null!=t.HistoryMinute.IsShowDate&&(e.TitlePaint[0].IsShowDate=t.HistoryMinute.IsShowDate)),e},this.CreateKLineTrainChartContainer=function(t){if("简单K线训练"==t.Type||"简单K线训练横屏"==t.Type)var e="简单K线训练横屏"==t.Type,a=new H(this.CanvasElement,e);else e="K线训练横屏"==t.Type,a=new G(this.CanvasElement,e);if(t.NetworkFilter&&(a.NetworkFilter=t.NetworkFilter),1==t.IsApiPeriod&&(a.IsApiPeriod=t.IsApiPeriod),t.KLine&&(t.KLine.Right>=0&&(a.Right=t.KLine.Right),t.KLine.Period>=0&&(a.Period=t.KLine.Period),t.KLine.MaxRequestDataCount>0&&(a.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&a.SetKLineInfo(t.KLine.Info,!1),t.KLine.PageSize>0&&(a.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(a.IsShowTooltip=!1),t.KLine.MaxRequestMinuteDayCount>0&&(a.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(a.KLineDrawType=t.KLine.DrawType)),t.Train&&(t.Train.DataCount&&(a.TrainDataCount=t.Train.DataCount),t.Train.Callback&&(a.TrainCallback=t.Train.Callback),t.Train.StartDate&&(a.TrainStartDate=t.Train.StartDate)),!t.Windows||t.Windows.length<=0)return null;if(a.Create(t.Windows.length),this.SetChartBorder(a,t),t.ExtendChart)for(var i in t.ExtendChart){var r=t.ExtendChart[i];a.CreateExtendChart(r.Name,r)}if(0==t.IsShowCorssCursorInfo&&(a.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),1==t.CorssCursorTouchEnd&&(a.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(a.IsClickShowCorssCursor=t.IsClickShowCorssCursor),1==t.IsFullDraw&&(a.IsFullDraw=t.IsFullDraw),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(a.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(a.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(a.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(a.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(a.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),t.CorssCursorInfo.HPenType>0&&(a.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(a.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType),f.IFrameSplitOperator.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(a.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime)),t.Frame)for(var i in t.Frame)if(a.Frame.SubFrame[i]){r=t.Frame[i];r.SplitCount&&(a.Frame.SubFrame[i].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(a.Frame.SubFrame[i].Frame.YSplitOperator.StringFormat=r.StringFormat),r.Height>0&&(a.Frame.SubFrame[i].Height=r.Height),!1!==r.IsShowLeftText&&!0!==r.IsShowLeftText||(a.Frame.SubFrame[i].Frame.IsShowYText[0]=r.IsShowLeftText),!1!==r.IsShowRightText&&!0!==r.IsShowRightText||(a.Frame.SubFrame[i].Frame.IsShowYText[1]=r.IsShowRightText)}t.KLine&&(0==t.KLine.ShowKLine&&(a.ChartPaint[0].IsShow=!1),0==t.KLine.IsShowMaxMinPrice&&(a.ChartPaint[0].IsShowMaxMinPrice=!1)),a.TitlePaint[0].IsShowName=!1,a.TitlePaint[0].IsShowSettingInfo=!1,a.TitlePaint[0].IsShowDateTime=!1;var n=new u.JSCommonIndexScript.JSIndexScript;for(var i in t.Windows){r=t.Windows[i];if(r.Script)a.WindowIndex[i]=new c.ScriptIndex(r.Name,r.Script,r.Args,r);else{var s=R.Get(r.Index);if(s)a.WindowIndex[i]=s.Create(),a.CreateWindowIndex(i);else{var o=n.Get(r.Index);if(!o)continue;r.Lock&&(o.Lock=r.Lock),a.WindowIndex[i]=new c.ScriptIndex(o.Name,o.Script,o.Args,o)}}null!=r.Modify&&(a.Frame.SubFrame[i].Frame.ModifyIndex=r.Modify),null!=r.Change&&(a.Frame.SubFrame[i].Frame.ChangeIndex=r.Change),isNaN(r.TitleHeight)||(a.Frame.SubFrame[i].Frame.ChartBorder.TitleHeight=r.TitleHeight)}return a},this.CreateDepthChartContainer=function(t){var e=null;if(e=new _(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),f.IFrameSplitOperator.IsPlusNumber(t.MaxVolRate)&&(e.MaxVolRate=t.MaxVolRate),t.ZoomStepPixel>0&&(e.ZoomStepPixel=t.ZoomStepPixel),f.IFrameSplitOperator.IsString(t.SplashTitle)&&(e.LoadDataSplashTitle=t.SplashTitle),t.Language){var a=S.g_JSChartLocalization.GetLanguageID(t.Language);f.IFrameSplitOperator.IsNumber(a)&&(e.LanguageID=a)}if(e.Create(t.Listener),t.Border&&(f.IFrameSplitOperator.IsNumber(t.Border.Left)?e.Frame.ChartBorder.Left=t.Border.Left:t.Border.Left=e.Frame.ChartBorder.Left,f.IFrameSplitOperator.IsNumber(t.Border.Right)?e.Frame.ChartBorder.Right=t.Border.Right:t.Border.Right=e.Frame.ChartBorder.Right,f.IFrameSplitOperator.IsNumber(t.Border.Top)?e.Frame.ChartBorder.Top=t.Border.Top:t.Border.Top=e.Frame.ChartBorder.Top,f.IFrameSplitOperator.IsNumber(t.Border.Bottom)?e.Frame.ChartBorder.Bottom=t.Border.Bottom:t.Border.Bottom=e.Frame.ChartBorder.Bottom),1==t.IsFullDraw&&(e.IsFullDraw=t.IsFullDraw),!0===t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),t.CorssCursorInfo){var i=t.CorssCursorInfo;f.IFrameSplitOperator.IsNumber(i.HPenType)&&(e.ChartCorssCursor.HPenType=i.HPenType),f.IFrameSplitOperator.IsNumber(i.VPenType)&&(e.ChartCorssCursor.VPenType=i.VPenType),f.IFrameSplitOperator.IsBool(i.IsShowTooltip)&&(e.ChartCorssCursor.IsShowTooltip=i.IsShowTooltip)}if(t.Frame){i=t.Frame;i.SplitCount&&(e.Frame.YSplitOperator.SplitCount=i.SplitCount),f.IFrameSplitOperator.IsNumber(i.SplitType)&&(e.Frame.YSplitOperator.SplitType=i.SplitType),f.IFrameSplitOperator.IsNumber(i.Height)&&(e.Frame.Height=i.Height),f.IFrameSplitOperator.IsNumber(i.LineType)&&(e.Frame.YSplitOperator.LineType=i.LineType),Array.isArray(i.IgnoreYValue)&&(e.Frame.YSplitOperator.IgnoreYValue=i.IgnoreYValue),!1!==i.IsShowLeftText&&!0!==i.IsShowLeftText||(e.Frame.IsShowYText[0]=i.IsShowLeftText,e.Frame.YSplitOperator.IsShowLeftText=i.IsShowLeftText),!1!==i.IsShowRightText&&!0!==i.IsShowRightText||(e.Frame.IsShowYText[1]=i.IsShowRightText,e.Frame.YSplitOperator.IsShowRightText=i.IsShowRightText),0==i.IsShowXLine&&(e.Frame.IsShowXLine=i.IsShowXLine),0==i.IsShowYLine&&(e.Frame.IsShowYLine=i.IsShowYLine),f.IFrameSplitOperator.IsNumber(i.XSplitCount)&&(e.Frame.XSplitOperator.SplitCount=i.XSplitCount)}return e},this.SetOption=function(t){i.JSConsole.Chart.Log("[JSChart::SetOption]",t);var e=null;switch(t.Type){case"历史K线图":case"历史K线图横屏":e=this.CreateKLineChartContainer(t);break;case"自定义指数历史K线图":e=this.CreateCustomKLineChartContainer(t);break;case"分钟走势图":case"分钟走势图横屏":e=this.CreateMinuteChartContainer(t);break;case"历史分钟走势图":e=this.CreateHistoryMinuteChartContainer(t);break;case"K线训练":case"K线训练横屏":case"简单K线训练":case"简单K线训练横屏":e=this.CreateKLineTrainChartContainer(t);break;case"深度图":e=this.CreateDepthChartContainer(t);break;default:return!1}if(!e)return!1;for(var a in t.OnCreatedCallback&&t.OnCreatedCallback(e),1!=t.IsAutoUpdate&&1!=t.IsAutoUpate||(e.IsAutoUpdate=!0),t.AutoUpdateFrequency>0&&(e.AutoUpdateFrequency=t.AutoUpdateFrequency),t.EventCallback){var r=t.EventCallback[a];e.AddEventCallback(r)}if(!t.Symbol)return!1;this.JSChartContainer=e,e.Draw(),e.ChangeSymbol(t.Symbol),this.JSChartContainer.Draw(),!f.IFrameSplitOperator.IsBool(t.CheckLatestVerion)||t.CheckLatestVerion},this.ChangeSymbol=function(t){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t)},this.ChangeIndex=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndex&&this.JSChartContainer.ChangeIndex(t,e,a)},this.ChangeScriptIndex=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeScriptIndex&&this.JSChartContainer.ChangeScriptIndex(t,e)},this.GetIndexInfo=function(){return this.JSChartContainer&&"function"==typeof this.JSChartContainer.GetIndexInfo?this.JSChartContainer.GetIndexInfo():[]},this.ChangePeriod=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangePeriod&&this.JSChartContainer.ChangePeriod(t,e)},this.ChangeInstructionIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionIndex(t)},this.ChangeInstructionScriptIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionScriptIndex(t)},this.AddIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddIndexWindow&&this.JSChartContainer.AddIndexWindow(t,e)},this.AddScriptIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddScriptIndexWindow&&this.JSChartContainer.AddScriptIndexWindow(t,e)},this.AddAPIIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddAPIIndexWindow&&this.JSChartContainer.AddAPIIndexWindow(t,e)},this.RemoveIndexWindow=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.RemoveIndexWindow&&this.JSChartContainer.RemoveIndexWindow(t)},this.CancelInstructionIndex=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.CancelInstructionIndex&&this.JSChartContainer.CancelInstructionIndex()},this.ChangeIndexTemplate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndexTemplate&&(i.JSConsole.Chart.Log("[JSChart:ChangeIndexTemplate] ",t),this.JSChartContainer.ChangeIndexTemplate(t))},this.ChangeRight=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeRight&&this.JSChartContainer.ChangeRight(t)},this.SetFirstShowDate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetFirstShowDate&&this.JSChartContainer.SetFirstShowDate(t)},this.ChangeKLineDrawType=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeKLineDrawType&&this.JSChartContainer.ChangeKLineDrawType(t)},this.ChangMainDataControl=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetMainDataConotrl&&this.JSChartContainer.SetMainDataConotrl(t)},this.OverlaySymbol=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.OverlaySymbol&&this.JSChartContainer.OverlaySymbol(t,e)},this.ForceLandscape=function(t){this.JSChartContainer&&(i.JSConsole.Chart.Log("[JSChart::ForceLandscape] bForceLandscape="+t),this.JSChartContainer.IsForceLandscape=t)},this.LockIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.LockIndex&&(i.JSConsole.Chart.Log("[JSChart:LockIndex] lockData",t),this.JSChartContainer.LockIndex(t))},this.ChangeTradeDate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeTradeDate&&(i.JSConsole.Chart.Log("[JSChart:ChangeTradeDate] date",t),this.JSChartContainer.ChangeTradeDate(t))},this.ChangeDayCount=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeDayCount&&(i.JSConsole.Chart.Log("[JSChart:ChangeDayCount] count",t),this.JSChartContainer.ChangeDayCount(t))},this.StopAutoUpdate=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.StopAutoUpdate&&(i.JSConsole.Chart.Log("[JSChart::StopAutoUpdate] Stop."),this.JSChartContainer.StopAutoUpdate())},this.StopAutoUpdata=this.StopAutoUpdate,this.ChartDestory=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestory&&(i.JSConsole.Chart.Log("[JSChart::ChartDestory]"),this.JSChartContainer.ChartDestory())},this.OnTouchStart=function(t){this.JSChartContainer&&this.JSChartContainer.ontouchstart(t)},this.OnTouchMove=function(t){this.JSChartContainer&&this.JSChartContainer.ontouchmove(t)},this.OnTouchEnd=function(t){this.JSChartContainer&&this.JSChartContainer.ontouchend(t)},this.SaveToImage=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SaveToImage&&this.JSChartContainer.SaveToImage(t)},this.EnableSplashScreen=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.EnableSplashScreen&&this.JSChartContainer.EnableSplashScreen(t)},this.AddOverlayIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddOverlayIndex&&this.JSChartContainer.AddOverlayIndex(t)},this.DeleteOverlayWindowsIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.DeleteOverlayWindowsIndex&&this.JSChartContainer.DeleteOverlayWindowsIndex(t)}}d.LastVersion=null,d.Init=function(t){i.JSConsole.Chart.Log("[JSChart.Init] uielement",t);var e=new d(t);return e.OnSize(),e},d.SetDomain=function(t,e){t&&(S.g_JSChartResource.Domain=t,S.g_JSChartResource.Index.StockHistoryDayApiUrl=t+"/API/StockHistoryDay",S.g_JSChartResource.Index.MarketLongShortApiUrl=t+"/API/FactorTiming",S.g_JSChartResource.Index.MarketAttentionApiUrl=t+"/API/MarketAttention",S.g_JSChartResource.Index.MarketHeatApiUrl=t+"/API/MarketHeat"),e&&(S.g_JSChartResource.CacheDomain=e),l.JSCommonComplier.JSComplier.SetDomain(t,e)},d.SetStyle=function(t){t&&S.g_JSChartResource.SetStyle(t)},d.GetResource=function(){return S.g_JSChartResource},d.GetMinuteTimeStringData=function(){return h.JSCommonCoordinateData.MinuteTimeStringData},d.GetMinuteCoordinateData=function(){return h.JSCommonCoordinateData.MinuteCoordinateData},d.GetKLineZoom=function(){return C.ZOOM_SEED},d.SetUSATimeType=function(t){h.g_NYMEXTimeData.TimeType=t,h.g_COMEXTimeData.TimeType=t,h.g_NYBOTTimeData.TimeType=t,h.g_CBOTTimeData.TimeType=t},d.GetChinaFuturesTimeData=function(){return h.g_FuturesTimeData},d.GetInternalTimeData=function(t){switch(t){case"NYMEXTimeData":return h.g_NYMEXTimeData;case"COMEXTimeData":return h.g_COMEXTimeData;case"NYBOTTimeData":return h.g_NYBOTTimeData;case"CBOTTimeData":return h.g_CBOTTimeData;case"LMETimeData":return h.g_LMETimeData;case"FuturesTimeData":return h.g_FuturesTimeData;case"TOCOMTimeData":return h.g_TOCOMTimeData;case"IPETimeData":return h.g_IPETimeData;default:return null}},d.GetDivTooltipDataFormat=function(){return f.g_DivTooltipDataForamt},d.ToFixedPoint=function(t){return F(t)},d.ToFixedRect=function(t){return g(t)};var T={OP_SCROLL_LEFT:1,OP_SCROLL_RIGHT:2,OP_ZOOM_OUT:3,OP_ZOOM_IN:4,OP_GOTO_HOME:5,OP_GOTO_END:6,OP_GOTO:16};function p(t){this.ClassName="JSChartContainer";this.Frame,this.ChartPaint=new Array,this.ChartPaintEx=[],this.ChartInfo=new Array,this.ChartInfoPaint,this.ExtendChartPaint=new Array,this.TitlePaint=new Array,this.OverlayChartPaint=new Array,this.ChartDrawPicture=new Array,this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture=null,this.ChartCorssCursor,this.IsClickShowCorssCursor=!1,this.ChartSplashPaint=null,this.LoadDataSplashTitle="数据加载中",this.Canvas=t.GetContext("2d"),this.UIElement=t,this.MouseDrag,this.DragMode=1,this.PhoneTouchInfo,this.EnableScrollUpDown=!1,this.TouchTimer=null,this.LastDrawStatus,this.LastDrawID=1,this.SnapshotType=0,this.CursorIndex=0,this.LastPoint=new A,this.IsForceLandscape=!1,this.CorssCursorTouchEnd=!1,this.EnableAnimation=!1,this.FrameSplitData=new Map,this.FrameSplitData.set("double",new f.SplitData),this.FrameSplitData.set("price",new f.PriceSplitData),this.UpdateUICallback,this.IsOnTouch=!1,this.IsFullDraw=!1,this.LanguageID=S.JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.PressTime=800,this.FormatDateString=f.IFrameSplitOperator.FormatDateString,this.FormatValueString=f.IFrameSplitOperator.FormatValueString,this.ToFixedPoint=F,this.ToFixedRect=g,this.FormatTimeString=f.IFrameSplitOperator.FormatTimeString,this.mapEvent=new Map,this.NetworkFilter,this.IsDestroy=!1,this.LastMovePoint,this.DrawMoveTimer=null,this.DrawMoveWaitTime=60,this.EnableZoomIndexWindow=!1,this.PhoneDBClick=new s.PhoneDBClick,this.ClickModel={IsShowCorssCursor:!1},this.EnableClickModel=!1,this.ChartDestory=function(){this.IsDestroy=!0,this.StopAutoUpdate(),null!=this.GetLatestVersionTimer&&(clearTimeout(this.GetLatestVersionTimer),this.GetLatestVersionTimer=null)},this.GetLatestVersionTimer=null,this.GetLatestVersion=function(){var t=this;if(null!=this.GetLatestVersionTimer&&(clearTimeout(this.GetLatestVersionTimer),this.GetLatestVersionTimer=null),null==d.LastVersion){var e=Math.floor(50*Math.random()),a=18e4+1e3*e;i.JSConsole.Chart.Log("[JSChartContainer::GetLatestVersion] wait for get hqchart latest version. ",a),this.GetLatestVersionTimer=setTimeout((function(){var e=0,a=0;t.Frame&&t.Frame.ChartBorder&&(e=t.Frame.ChartBorder.GetChartWidth(),a=t.Frame.ChartBorder.GetChartHeight());var n="".concat(atob("aHR0cHM6Ly9ocWNoYXJ0LnplYWxpbmsuY29tL2FwaS9HZXRWZXJzaW9u"),"?width=").concat(e,"&height=").concat(a,"&type=uniapp");null==d.LastVersion&&r.JSNetwork.HttpRequest({url:n,method:"get",dataType:"json",async:!0,success:function(t){d.LastVersion=t.data},fail:function(t,e,a){i.JSConsole.Chart.Log("[JSChartContainer::GetLatestVersion] Get HQChart latest version failed.",t)}})}),a)}},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEvent=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.GetEventCallback=this.GetEvent,this.GetIndexEvent=function(){return this.GetEvent(s.JSCHART_EVENT_ID.RECV_INDEX_DATA)},this.GetBarrageEvent=function(){return this.GetEvent(s.JSCHART_EVENT_ID.BARRAGE_PLAY_END)},this.GetEnableSplashEvent=function(){return this.GetEvent(s.JSCHART_EVENT_ID.ON_ENABLE_SPLASH_DRAW)},this.IsPhoneDragging=function(t){var e=t.changedTouches.length,a=t.touches.length;return 1==e&&1==a},this.IsPhonePinching=function(t){var e=t.changedTouches.length,a=t.touches.length;return(1==e||2==e)&&2==a},this.IsSingleTouch=function(t){var e=t.touches.length;return 1==e},this.GetToucheData=function(t,e){for(var a=new Array,i=0;i<t.touches.length;++i){var r=t.touches[i];e?a.push({clientX:r.y,clientY:r.x,pageX:r.y,pageY:r.x}):a.push({clientX:r.x,clientY:r.y,pageX:r.x,pageY:r.y})}return a},this.ClearDrawMoveTimer=function(){null!=this.DrawMoveTimer&&(clearTimeout(this.DrawMoveTimer),this.DrawMoveTimer=null)},this.ClearTouchTimer=function(){null!=this.TouchTimer&&(clearTimeout(this.TouchTimer),this.TouchTimer=null)},this.ontouchstart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this;if(e.IsOnTouch=!0,e.PhonePinch=null,this.TouchDrawCount=0,this.IsPhoneDragging(t)){if(e.TryClickLock||this.TryClickIndexTitle){var a=this.GetToucheData(t,e.IsForceLandscape),r=a[0].clientX,n=a[0].clientY;if(e.TryClickLock&&e.TryClickLock(r,n))return;if(e.TryClickIndexTitle&&e.TryClickIndexTitle(r,n))return}null!=this.TouchTimer&&clearTimeout(this.TouchTimer);var o=1==this.ChartCorssCursor.IsShow;this.EnableClickModel&&(o=1!=this.ClickModel.IsShowCorssCursor),o&&(this.TouchTimer=setTimeout((function(){if(h.Click.X==h.LastMove.X&&h.Click.Y==h.LastMove.Y){e.MouseDrag;e.MouseDrag=null;var a=h.Click.X,i=h.Click.Y;e.IsForceLandscape&&(i=e.UIElement.Height-h.Click.Y),!0===e.EnableClickModel&&(e.ClickModel.IsShowCorssCursor=!0),e.OnMouseMove(a,i,t)}}),e.PressTime));var h={Click:{},LastMove:{}};a=this.GetToucheData(t,e.IsForceLandscape);if(h.Click.X=a[0].clientX,h.Click.Y=a[0].clientY,h.LastMove.X=a[0].clientX,h.LastMove.Y=a[0].clientY,1==e.DragMode&&(e.MouseDrag=h),this.PhoneTouchInfo={Start:{X:a[0].clientX,Y:a[0].clientY},End:{X:a[0].clientX,Y:a[0].clientY}},this.EnableZoomIndexWindow&&(this.PhoneDBClick.AddTouchStart(a[0].clientX,a[0].clientY,Date.now()),i.JSConsole.Chart.Log("[JSChartContainer::OnTouchStart] PhoneDBClick ",this.PhoneDBClick)),this.EnableClickModel);else if(e.IsClickShowCorssCursor){r=h.Click.X,n=h.Click.Y;e.OnMouseMove(r,n,t,!0)}this.TouchEvent({EventID:s.JSCHART_EVENT_ID.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},t)}else if(this.IsPhonePinching(t)){var l={Start:{},Last:{}};a=this.GetToucheData(t,e.IsForceLandscape);l.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},l.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},e.PhonePinch=l}}},this.ontouchmove=function(t){var e=this;if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=this.GetToucheData(t,this.IsForceLandscape);if(this.IsPhoneDragging(t)){var i=this.MouseDrag;if(null==i){var r=a[0].clientX,n=a[0].clientY;if(this.LastMovePoint={X:r,Y:n},this.DrawMoveTimer)return;this.DrawMoveTimer=setTimeout((function(){e.LastMovePoint&&(e.OnMouseMove(e.LastMovePoint.X,e.LastMovePoint.Y,t),e.DrawMoveTimer=null)}),this.DrawMoveWaitTime)}else{var s=Math.abs(i.LastMove.X-a[0].clientX);s=parseInt(s);var o=!1;if(this.EnableClickModel&&(o=!0===this.ClickModel.IsShowCorssCursor),o)this.MouseDrag=null,this.MoveCorssCursor(i.Click,t);else if(1==this.DragMode){if(s<5)return;var h=!0;i.LastMove.X<a[0].clientX&&(h=!1),this.DataMove(s,h)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):this.DragDownloadData&&this.DragDownloadData(),i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}}this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=a[0].clientX,this.PhoneTouchInfo.End.Y=a[0].clientY)}else if(this.IsPhonePinching(t)){var l=this.PhonePinch;if(!l)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var u=Math.abs(a[0].pageY-a[1].pageY),C=Math.abs(l.Last.Y-l.Last.Y2),D=u-C,m=Math.abs(a[0].pageX-a[1].pageX),c=Math.abs(l.Last.X-l.Last.X2),S=m-c,f=this.ZoomStepPixel;if(Math.abs(D)<f&&Math.abs(S)<f)return;var I=D;if(Math.abs(D)<f&&(I=S),I>0){var d={IsLockRight:this.IsZoomLockRight};if(d.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(d))return;this.CursorIndex=d.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}else{d={IsLockRight:this.IsZoomLockRight};if(d.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(d))return;this.CursorIndex=d.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}l.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}}},this.ontouchend=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){if(this.EnableZoomIndexWindow){var e=Date.now();this.PhoneDBClick.AddTouchEnd(e),this.PhoneDBClick.IsVaildDBClick()&&(this.OnTouchDBClick(this.PhoneDBClick.Start),this.PhoneDBClick.Clear())}this.IsOnTouch=!1,this.LastMovePoint=null,i.JSConsole.Chart.Log("[JSChartContainer:ontouchend] IsOnTouch="+this.IsOnTouch+" LastDrawStatus="+this.LastDrawStatus),this.ClearDrawMoveTimer(),this.ClearTouchTimer(),this.TouchEvent({EventID:s.JSCHART_EVENT_ID.ON_PHONE_TOUCH,FunctionName:"OnTouchEnd"},t),this.OnTouchFinished(),this.TouchDrawCount=0}},this.OnTouchFinished=function(){if(!0===this.EnableClickModel){if(1==this.ClickModel.IsShowCorssCursor&&this.TouchDrawCount>0)return;return this.ClickModel.IsShowCorssCursor=!1,void this.Draw()}this.Draw()},this.OnTouchDBClick=function(t){var e=t[0].X,a=t[0].Y;i.JSConsole.Chart.Log("[JSChartContainer:OnTouchDBClick] Phone dbclick",e,a);var r=this.Frame.PtInFrame(e,a);return i.JSConsole.Chart.Log("[JSChartContainer::OnTouchDBClick] frameId",r),!!(r>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(r,{X:e,Y:a}))&&(this.Frame.SetSizeChage(!0),this.Draw(),!0)},this.ZoomIndexWindow=function(t,e){return!(t<0||t>=this.Frame.SubFrame.length)&&this.Frame.ZoomIndexWindow(t,e)},this.TouchEvent=function(t,e){var a=t.EventID,i=this.GetEvent(a);if(!i||!i.Callback)return!1;var r=this.PhoneTouchInfo;if(!r||!r.Start||!r.End)return!1;var n,o=r.End.X,h=r.End.Y,l=r.End.X,u=r.End.Y,C={X:o,Y:h,FrameID:-1,FunctionName:t.FunctionName,Drag:{Start:{X:r.Start.X,Y:r.Start.Y},End:{X:r.End.X,Y:r.End.Y}}},D=new s.Rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight());if(n=D.IsPointIn(l,u),n)if(this.Frame&&this.Frame.IsHScreen){var m={},c=this.Frame.GetYData(l,m);if(f.IFrameSplitOperator.IsNumber(m.FrameID)&&m.FrameID>=0){var S=this.Frame.GetXData(u);C.FrameID=m.FrameID,C.Data={X:S,Y:c}}}else{m={},c=this.Frame.GetYData(u,m);if(f.IFrameSplitOperator.IsNumber(m.FrameID)&&m.FrameID>=0){S=this.Frame.GetXData(l);C.FrameID=m.FrameID,C.Data={X:S,Y:c}}}return i.Callback(i,C,this),!0},this.FullDraw=function(t){var e=this;if(this.Canvas.clearRect(0,0,this.UIElement.Width,this.UIElement.Height),this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.ClearCoordinateText(),this.Frame.Draw({IsEnableSplash:this.ChartSplashPaint.IsEnableSplash}),this.ChartSplashPaint.Draw(),this.LastDrawStatus="FullDraw",void this.Canvas.draw();if(this.Frame.SetDrawOtherChart((function(){for(var t in e.ExtendChartPaint){var a=e.ExtendChartPaint[t];a.IsCallbackDraw&&a.Draw()}})),this.Frame.Draw(),this.Frame.DrawCustomVertical){var a=this.GetEvent(s.JSCHART_EVENT_ID.ON_CUSTOM_VERTICAL_DRAW);this.Frame.DrawCustomVertical(a)}for(var i=0;i<this.ChartPaint.length;++i){var r=this.ChartPaint[i];r.IsDrawFirst&&r.Draw()}this.Frame.DrawOveraly&&this.Frame.DrawOveraly(!0);for(i=0;i<this.ChartPaint.length;++i){r=this.ChartPaint[i];r.IsDrawFirst||r.Draw()}for(i=0;i<this.ChartPaintEx.length;++i){r=this.ChartPaintEx[i];r.Draw()}for(i=0;i<this.OverlayChartPaint.length;++i){r=this.OverlayChartPaint[i];r.Draw()}this.Frame.DrawOveraly&&this.Frame.DrawOveraly(!1),this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.KLineIncreaseCustomHorizontal(),this.Frame.DrawCustomHorizontal&&this.Frame.DrawCustomHorizontal(),this.ChartInfoPaint&&this.ChartInfoPaint.Draw(),this.Frame.DrawLock(),this.Frame.DrawLogo();var n="DrawDynamicInfo"==t||this.IsOnTouch;1==this.EnableClickModel&&(n=1==this.ClickModel.IsShowCorssCursor),n&&this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex,this.ChartCorssCursor.Draw());var o=this.GetEvent(s.JSCHART_EVENT_ID.ON_TITLE_DRAW),h=this.GetEvent(s.JSCHART_EVENT_ID.ON_INDEXTITLE_DRAW);for(i=0;i<this.TitlePaint.length;++i){r=this.TitlePaint[i];if(r.IsDynamic){if("DynamicChartTitlePainting"==r.ClassName?r.OnDrawEvent=h:r.OnDrawEvent=o,r.CursorIndex=this.CursorIndex,!n&&this.ChartPaint[0]&&this.ChartPaint[0].Data&&this.ChartPaint[0].Data.Data){var l=this.GetLastDataIndex();f.IFrameSplitOperator.IsNumber(l)&&(r.CursorIndex=l)}r.FullDraw&&r.FullDraw()}}if(n)for(var i in this.ExtendChartPaint){r=this.ExtendChartPaint[i];r.IsCallbackDraw||(r.LatestPoint={X:this.LastPoint.X,Y:this.LastPoint.Y},r.IsDynamic&&r.DrawAfterTitle&&r.Draw())}this.LastDrawStatus="FullDraw",this.Canvas.draw(!1)},this.KLineIncreaseCustomHorizontal=function(){if(this.Frame&&this.Frame.SubFrame){var t=this.Frame.SubFrame[0].Frame;if(t){var e=(0,h.GetfloatPrecision)(this.Symbol),a=!1;t.YSplitOperator&&1==t.YSplitOperator.CoordinateType&&(a=!0);for(var i=!1,r=0;r<t.CustomHorizontalInfo.length;++r){var n=t.CustomHorizontalInfo[r];if(4==n.Type&&(i=!0),a&&3==n.Type||2==n.Type){var s=this.ChartPaint[0];if(!s)continue;var o=s.Data;if(!o||!f.IFrameSplitOperator.IsNonEmptyArray(o.Data))continue;if(!f.IFrameSplitOperator.IsNumber(s.DrawKRange.Start)||!f.IFrameSplitOperator.IsNumber(s.DrawKRange.End))continue;var l=o.Data[s.DrawKRange.Start],u=o.Data[s.DrawKRange.End],C=(u.Close-l.Close)/l.Close;n.Value=u.Close,2==n.Type?(n.Message[1]=u.Close.toFixed(e),u.Close>u.Open?n.LineColor=S.g_JSChartResource.FrameLatestPrice.UpBarColor:u.Close<u.Open?n.LineColor=S.g_JSChartResource.FrameLatestPrice.DownBarColor:n.LineColor=S.g_JSChartResource.FrameLatestPrice.UnchagneBarColor):n.Message[1]=C.toFixed(2)+"%",this.Name&&(n.Title=this.Name)}}if(i){var D=t.CustomHorizontalInfo.filter((function(t,e,a){return 4!=t.Type}));t.CustomHorizontalInfo=D}for(r=0;r<this.OverlayChartPaint.length;++r){s=this.OverlayChartPaint[r];if(s&&4==s.YInfoType){o=s.Data;if(o&&f.IFrameSplitOperator.IsNonEmptyArray(o.Data)&&f.IFrameSplitOperator.IsNumber(s.DrawKRange.Start)&&f.IFrameSplitOperator.IsNumber(s.DrawKRange.End)){l=o.Data[s.DrawKRange.Start],u=o.Data[s.DrawKRange.End],C=(u.Close-l.Close)/l.Close*100,n=new f.CoordinateInfo;n.Value=u.Close/s.ShowRange.FirstOverlayOpen*s.ShowRange.FirstOpen,n.Message[1]=C.toFixed(2)+"%",n.LineType=-1,n.Type=s.YInfoType,n.LineColor=s.Color,n.TextColor=S.g_JSChartResource.FrameLatestPrice.OverlayTextColor,s.Title&&(n.Title=s.Title),t.CustomHorizontalInfo.push(n)}}}}}},this.GetLastDataIndex=function(){if(!this.ChartPaint[0]||!this.ChartPaint[0].Data||!this.ChartPaint[0].Data.Data)return null;var t=this.ChartPaint[0].Data,e=t.Data.length;return e>0?e-1-t.DataOffset:null},this.Draw=function(){var t=this;if(!this.IsDestroy){if(this.IsFullDraw)return this.FullDraw("Draw"),void++this.TouchDrawCount;if(1!=this.IsOnTouch||"MinuteChartContainer"!=this.ClassName&&"MinuteChartHScreenContainer"!=this.ClassName){var e=this;if(this.Canvas.clearRect(0,0,this.UIElement.Width,this.UIElement.Height),this.Frame.SetDrawOtherChart((function(){for(var e in t.ExtendChartPaint){var a=t.ExtendChartPaint[e];a.IsCallbackDraw&&a.Draw()}})),this.Frame.Draw(),this.Frame.DrawCustomVertical){var a=this.GetEvent(s.JSCHART_EVENT_ID.ON_CUSTOM_VERTICAL_DRAW);this.Frame.DrawCustomVertical(a)}if(this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.DrawInsideHorizontal(),this.ChartSplashPaint.Draw(),this.LastDrawStatus="Draw",void this.Canvas.draw();for(var i=0;i<this.ChartPaint.length;++i){var r=this.ChartPaint[i];r.IsDrawFirst&&r.Draw()}this.Frame.DrawOveraly&&this.Frame.DrawOveraly(!0);for(i=0;i<this.ChartPaint.length;++i){r=this.ChartPaint[i];r.IsDrawFirst||r.Draw()}for(i=0;i<this.ChartPaintEx.length;++i){r=this.ChartPaintEx[i];r.Draw()}for(i=0;i<this.OverlayChartPaint.length;++i){r=this.OverlayChartPaint[i];r.Draw()}this.Frame.DrawOveraly&&this.Frame.DrawOveraly(!1);for(i=0;i<this.ExtendChartPaint.length;++i){r=this.ExtendChartPaint[i];r.IsCallbackDraw||(r.IsDynamic||r.IsAnimation||r.Draw())}this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.Frame.DrawCustomHorizontal&&this.Frame.DrawCustomHorizontal(),this.ChartInfoPaint&&this.ChartInfoPaint.Draw(),this.Frame.DrawLock(),this.Frame.DrawLogo();var n=this.GetEvent(s.JSCHART_EVENT_ID.ON_TITLE_DRAW),o=this.GetEvent(s.JSCHART_EVENT_ID.ON_INDEXTITLE_DRAW);for(i=0;i<this.TitlePaint.length;++i){r=this.TitlePaint[i];r.IsDynamic&&("DynamicChartTitlePainting"==r.ClassName?r.OnDrawEvent=o:r.OnDrawEvent=n,"function"==typeof r.DrawTitle&&r.DrawTitle())}if(this.LastDrawStatus="Draw",this.IsOnTouch)this.Canvas.draw(!1);else{++this.LastDrawID;this.LastDrawID;this.Canvas.draw(!1,(function(){e.Frame.Snapshot(e.SnapshotType)}))}}}},this.TempImage=null,this.DrawDynamicInfo=function(){if(this.IsFullDraw)return this.FullDraw("DrawDynamicInfo"),void++this.TouchDrawCount;var t=this,e=this.Frame.ChartBorder.GetChartWidth(),a=this.Frame.ChartBorder.GetChartHeight();if(1==t.SnapshotType){if(null==this.Frame.ScreenImageData)return;wx.canvasPutImageData({canvasId:this.UIElement.ID,x:0,y:0,width:e,height:a,data:this.Frame.ScreenImageData,success:function(e){t.DrawDynamicChart(!0)}})}else{if(null==this.Frame.ScreenImagePath)return;t.Canvas&&t.Canvas.DomNode?(this.TempImage||(this.TempImage=t.Canvas.DomNode.createImage()),this.TempImage.src=this.Frame.ScreenImagePath,this.TempImage.onload=function(){t.Canvas.clearRect(0,0,e,a),t.Canvas.drawImage(t.TempImage,0,0,e,a),t.DrawDynamicChart(!1)}):(t.Canvas.drawImage(this.Frame.ScreenImagePath,0,0,e,a),t.DrawDynamicChart(!1))}},this.DrawDynamicChart=function(t){for(var e in this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex,this.ChartCorssCursor.Draw()),this.TitlePaint){var a=this.TitlePaint[e];a.IsDynamic&&(a.CursorIndex=this.CursorIndex,a.Draw())}for(var e in this.ExtendChartPaint){a=this.ExtendChartPaint[e];a.IsDynamic&&a.DrawAfterTitle&&a.Draw()}if(this.EnableAnimation)for(var e in this.ExtendChartPaint){a=this.ExtendChartPaint[e];!0===a.IsAnimation&&a.Draw()}this.LastDrawStatus="DrawDynamicInfo",i.JSConsole.Chart.Log("[JSChartContainer:DrawDynamicChart][ID="+this.UIElement.ID+"] draw ....."),this.Canvas.draw(t,(function(){i.JSConsole.Chart.Log("[JSChartContainer:DrawDynamicChart] finish.")}))},this.DrawAnimation=function(){var t=this;if(this.EnableAnimation){if(this.Frame.ScreenImagePath&&!this.IsOnTouch){for(var e in this.ExtendChartPaint){var a=this.ExtendChartPaint[e];!0===a.IsAnimation&&(a.IsMoveStep=!0)}this.DrawDynamicInfo()}this.UIElement.WebGLCanvas.requestAnimationFrame((function(){t.DrawAnimation()}))}},this.StartAnimation=function(t){var e=this;if(i.JSConsole.Chart.Log("[JSChartContainer::StartAnimation] ",this.UIElement.WebGLCanvas),this.UIElement.WebGLCanvas){var a=!1,r=null;for(var n in this.ExtendChartPaint){var s=this.ExtendChartPaint[n];if("BarragePaint"===s.ClassName){a=!0,r=s.BarrageList;break}}if(!a){var o=new m.BarragePaint;o.Canvas=this.Canvas,o.ChartBorder=this.Frame.ChartBorder,o.ChartFrame=this.Frame,o.HQChart=this,o.SetOption(t),this.ExtendChartPaint.push(o),r=o.BarrageList}this.EnableAnimation=!0;return this.UIElement.WebGLCanvas.requestAnimationFrame((function(){e.DrawAnimation()})),r}},this.StopAnimation=function(){this.EnableAnimation=!1,this.DrawDynamicInfo()},this.OnMouseMove=function(t,e,a,i){var r=this.LastPoint.Y;this.LastPoint.X=t,this.LastPoint.Y=e;var n=this.CursorIndex;if(this.CursorIndex=this.Frame.GetXData(t),"KLineChartContainer"==this.ClassName||"KLineChartHScreenContainer"==this.ClassName){if(n==this.CursorIndex&&Math.abs(r-e)<1)return}else if(parseInt(n-.5)==parseInt(this.CursorIndex-.5)&&Math.abs(r-e)<1)return;i?this.FullDraw():this.IsForceLandscape?this.Draw():this.DrawDynamicInfo()},this.MoveCorssCursor=function(t,e){var a=t.X,i=t.Y;this.OnMouseMove(a,i,e,!0)},this.OnDoubleClick=function(t,e,a){},this.UpdatePointByCursorIndex=function(){this.LastPoint.X=this.Frame.GetXFromIndex(this.CursorIndex);var t=Math.abs(this.CursorIndex-.5);t=parseInt(t.toFixed(0)),"KLineChartContainer"==this.ClassName&&(t=this.CursorIndex);var e=this.Frame.Data;if(!(e.DataOffset+t>=e.Data.length)){var a=e.Data[e.DataOffset+t].Close;this.LastPoint.Y=this.Frame.GetYFromData(a)}},this.ResetFrameXYSplit=function(){"function"==typeof this.Frame.ResetXYSplit&&this.Frame.ResetXYSplit()},this.UpdateFrameMaxMin=function(){for(var t=new Array,e=new Array,a=0;a<this.ChartPaint.length;++a){var i=this.ChartPaint[a];0!=i.IsShow&&e.push(i)}for(a=0;a<this.OverlayChartPaint.length;++a)e.push(this.OverlayChartPaint[a]);for(a=0;a<e.length;++a){var r=e[a],n=r.GetMaxMin();if(null!=n&&null!=n.Max&&null!=n.Min){for(var s=null,o=0;o<t.length;++o)if(t[o].Frame==r.ChartFrame){s=t[o];break}s?(s.Range.Max<n.Max&&(s.Range.Max=n.Max),s.Range.Min>n.Min&&(s.Range.Min=n.Min)):(s={OverlayFrame:[]},s.Frame=r.ChartFrame,s.Range=n,t.push(s))}}var h=new Map;for(a=0;a<t.length;++a){i=t[a];h.set(i.Frame.Identify,i)}for(a=0;a<this.Frame.SubFrame.length;++a){var l=this.Frame.SubFrame[a];for(o=0;o<l.OverlayIndex.length;++o){var u=l.OverlayIndex[o],C=u.Frame;if(1==C.IsShareY&&(C.MainFrame&&h.has(C.MainFrame.Identify))){s=h.get(C.MainFrame.Identify);if(s&&(s.OverlayFrame.push(C),!1!==C.IsCalculateYMaxMin))for(var D=0;D<u.ChartPaint.length;++D){r=u.ChartPaint[D],n=r.GetMaxMin();null!=n&&null!=n.Max&&null!=n.Min&&(s.Range.Max<n.Max&&(s.Range.Max=n.Max),s.Range.Min>n.Min&&(s.Range.Min=n.Min))}}}}for(a=0;a<t.length;++a){i=t[a];if(i.Frame&&i.Range&&(null!=i.Range.Max&&null!=i.Range.Min)){i.Frame.YSpecificMaxMin?(i.Frame.HorizontalMax=i.Frame.YSpecificMaxMin.Max,i.Frame.HorizontalMin=i.Frame.YSpecificMaxMin.Min):(i.Frame.HorizontalMax=i.Range.Max,i.Frame.HorizontalMin=i.Range.Min),i.Frame.XYSplit=!0;for(o=0;o<i.OverlayFrame.length;++o)i.OverlayFrame[o].XYSplit=!0}}for(a=0;a<this.Frame.SubFrame.length;++a)for(l=this.Frame.SubFrame[a],o=0;o<l.OverlayIndex.length;++o){u=l.OverlayIndex[o];!0!==u.Frame.IsShareY&&u.UpdateFrameMaxMin()}},this.DataMoveLeft=function(){var t=null;return t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!!t&&(!(t.DataOffset<=0)&&(--t.DataOffset,!0))},this.DataMoveRight=function(){var t=null;if(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!t)return!1;var e=0;return e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!!e&&(!(e+t.DataOffset>=t.Data.length)&&(++t.DataOffset,!0))},this.UpdataDataoffset=function(){var t=null;if(t=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.Data&&(a.Data.DataOffset=t.DataOffset)}for(e=0;e<this.OverlayChartPaint.length;++e){a=this.OverlayChartPaint[e];a.Data&&(a.Data.DataOffset=t.DataOffset)}for(e=0;e<this.Frame.SubFrame.length;++e)for(var i=this.Frame.SubFrame[e],r=0;r<i.OverlayIndex.length;++r)for(var n=i.OverlayIndex[r],s=0;s<n.ChartPaint.length;++s){a=n.ChartPaint[s];a.Data&&(a.Data.DataOffset=t.DataOffset)}}},this.DataMove=function(t,e){if(t=parseInt(t/this.StepPixel),t<=0)return!1;var a=null;if(a=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!a)return!1;var i=0;if(i=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!i)return!1;if(e){if(this.RightSpaceCount>0){if(i+a.DataOffset>=a.Data.length+this.RightSpaceCount-1)return!1;a.DataOffset+=t,a.DataOffset+i>=a.Data.length+this.RightSpaceCount&&(a.DataOffset=a.Data.length-(i-this.RightSpaceCount))}else{if(i+a.DataOffset>=a.Data.length)return!1;a.DataOffset+=t,a.DataOffset+i>=a.Data.length&&(a.DataOffset=a.Data.length-i)}return!0}return!(a.DataOffset<=0)&&(a.DataOffset-=t,a.DataOffset<0&&(a.DataOffset=0),!0)},this.GetSubFrameIndex=function(t,e){if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return-1;for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a].Frame,r=i.ChartBorder.GetLeft(),n=i.ChartBorder.GetTop(),s=i.ChartBorder.GetHeight(),o=i.ChartBorder.GetWidth();if(this.Canvas.rect(r,n,o,s),this.Canvas.isPointInPath(t,e))return parseInt(a)}return 0},this.GetDataIndexByPoint=function(t){var e=this.Frame;this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&(e=this.Frame.SubFrame[0].Frame);var a=null;if(a=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,a&&e){var i=parseInt(e.GetXData(t));return a.DataOffset+i}},this.SaveToImage=function(t){var e=this.UIElement.Width,a=this.UIElement.Height;i.JSConsole.Chart.Log("[JSChartContainer::SaveToImage]",this.UIElement),wx.canvasToTempFilePath({x:0,y:0,width:e,height:a,canvasId:this.UIElement.ID,success:function(i){var r={ImagePath:i.tempFilePath,Width:e,Height:a};"function"==typeof t&&t(r)}})},this.EnableSplashScreen=function(t){this.ChartSplashPaint&&t&&(f.IFrameSplitOperator.IsString(t.Title)&&this.ChartSplashPaint.SetTitle(t.Title),this.ChartSplashPaint.EnableSplash(!0),!1!==t.Draw&&this.Draw())},this.SetSubFrameAttribute=function(t,e,a){if(t&&t.Frame){var i=t.Frame;e&&(f.IFrameSplitOperator.IsNumber(e.IndexParamSpace)&&(i.IndexParamSpace=e.IndexParamSpace),f.IFrameSplitOperator.IsNumber(e.IndexTitleSpace)&&(i.IndexTitleSpace=e.IndexTitleSpace),f.IFrameSplitOperator.IsBool(e.IsDrawTitleBG)&&(i.IsDrawTitleBG=e.IsDrawTitleBG),f.IFrameSplitOperator.IsBool(e.IsShowNameArrow)&&(i.IsShowNameArrow=e.IsShowNameArrow)),a&&(f.IFrameSplitOperator.IsNumber(a.SplitCount)&&(i.YSplitOperator.SplitCount=a.SplitCount),f.IFrameSplitOperator.IsBool(a.IsShowBorder)&&(i.IsShowBorder=a.IsShowBorder),f.IFrameSplitOperator.IsBool(a.IsShowXLine)&&(i.IsShowXLine=a.IsShowXLine),f.IFrameSplitOperator.IsBool(a.IsShowYLine)&&(i.IsShowYLine=a.IsShowYLine),f.IFrameSplitOperator.IsBool(a.IsShowLeftText)&&(i.IsShowYText[0]=a.IsShowLeftText),f.IFrameSplitOperator.IsBool(a.IsShowRightText)&&(i.IsShowYText[1]=a.IsShowRightText))}},this.AddNewSubFrame=function(t){var e=this,a=this.Frame.SubFrame.length,i=this.CreateSubFrameItem(a);this.Frame.SubFrame[a]=i;var r=new I.DynamicChartTitlePainting;if(r.Frame=this.Frame.SubFrame[a].Frame,r.Canvas=this.Canvas,r.LanguageID=this.LanguageID,r.GetEventCallback=function(t){return e.GetEventCallback(t)},this.TitlePaint[a+1]=r,t){if(t.Window){var n=t.Window;f.IFrameSplitOperator.IsBool(n.IsDrawTitleBG)&&(i.Frame.IsDrawTitleBG=n.IsDrawTitleBG),f.IFrameSplitOperator.IsBool(n.IsShowNameArrow)&&(i.Frame.IsShowNameArrow=n.IsShowNameArrow)}f.IFrameSplitOperator.IsNumber(t.SplitCount)&&(i.Frame.YSplitOperator.SplitCount=t.SplitCount),f.IFrameSplitOperator.IsNumber(t.TitleHeight)&&(i.Frame.ChartBorder.TitleHeight=t.TitleHeight),f.IFrameSplitOperator.IsBool(t.IsShowTitleArraw)&&(i.Frame.IsShowTitleArraw=t.IsShowTitleArraw),f.IFrameSplitOperator.IsBool(t.IsShowIndexName)&&(i.Frame.IsShowIndexName=t.IsShowIndexName),f.IFrameSplitOperator.IsBool(t.IsShowOverlayIndexName)&&(i.Frame.IsShowOverlayIndexName=t.IsShowOverlayIndexName),f.IFrameSplitOperator.IsNumber(t.IndexParamSpace)&&(i.Frame.IndexParamSpace=t.IndexParamSpace),f.IFrameSplitOperator.IsNumber(t.IndexTitleSpace)&&(i.Frame.IndexTitleSpace=t.IndexTitleSpace),f.IFrameSplitOperator.IsBool(t.IsShowXLine)&&(i.Frame.IsShowXLine=t.IsShowXLine),f.IFrameSplitOperator.IsBool(t.IsShowYLine)&&(i.Frame.IsShowYLine=t.IsShowYLine),f.IFrameSplitOperator.IsBool(t.IsShowIndexTitle)&&(i.Frame.IsShowTitle=t.IsShowIndexTitle),f.IFrameSplitOperator.IsBool(t.IsShowLeftText)&&(i.Frame.IsShowYText[0]=t.IsShowLeftText),f.IFrameSplitOperator.IsBool(t.IsShowRightText)&&(i.Frame.IsShowYText[1]=t.IsShowRightText)}for(var s=0;s<this.Frame.SubFrame.length;++s){n=this.Frame.SubFrame[s].Frame;s==this.Frame.SubFrame.length-1?n.XSplitOperator.ShowText=!0:n.XSplitOperator.ShowText=!1}return this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw(),a},this.AddIndexWindow=function(t,e){var a=new u.JSCommonIndexScript.JSIndexScript,i=a.Get(t);if(i){var r=this.AddNewSubFrame(e),n={Name:i.Name,Script:i.Script,Args:i.Args,ID:t,KLineType:i.KLineType,YSpecificMaxMin:i.YSpecificMaxMin,YSplitScale:i.YSplitScale,FloatPrecision:i.FloatPrecision,Condition:i.Condition,StringFormat:i.StringFormat,OutName:i.OutName};if(e&&(e.FloatPrecision>=0&&(n.FloatPrecision=e.FloatPrecision),e.StringFormat>0&&(n.StringFormat=e.StringFormat),e.Args&&(n.Args=e.Args)),this.WindowIndex[r]=new c.ScriptIndex(n.Name,n.Script,n.Args,n),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var s=this.SourceData;else s=this.ChartPaint[0].Data;this.BindIndexData(r,s)}},this.AddScriptIndexWindow=function(t,e){if(t&&t.Script&&t.Name){var a=this.AddNewSubFrame(e);if(this.WindowIndex[a]=new c.ScriptIndex(t.Name,t.Script,t.Args,t),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var i=this.SourceData;else i=this.ChartPaint[0].Data;this.BindIndexData(a,i)}},this.AddAPIIndexWindow=function(t,e){if(t.API){var a=t.API,i=this.AddNewSubFrame(e);if(this.WindowIndex[i]=new c.APIScriptIndex(a.Name,a.Script,a.Args,t),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var r=this.SourceData;else r=this.ChartPaint[0].Data;this.BindIndexData(i,r)}},this.SetLanguage=function(t){var e=S.g_JSChartLocalization.GetLanguageID(t);if(f.IFrameSplitOperator.IsNumber(e)){if(this.LanguageID!=e){this.LanguageID=e,this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID);for(var a=0;a<this.TitlePaint.length;++a){var i=this.TitlePaint[a];i&&(i.LanguageID=this.LanguageID)}for(a=0;a<this.ExtendChartPaint.length;++a){i=this.ExtendChartPaint[a];i&&(i.LanguageID=this.LanguageID)}this.Frame&&this.Frame.SetLanguage&&this.Frame.SetLanguage(this.LanguageID),this.Frame.SetSizeChage(!0),this.Draw()}}else console.warn("[JSChartContainer::SetLanguage] language=".concat(t," error"))},this.CreateOverlayFrame=function(){switch(this.ClassName){case"KLineChartContainer":return new C.OverlayKLineFrame;case"KLineChartHScreenContainer":return new C.OverlayKLineHScreenFrame;case"MinuteChartContainer":return new C.OverlayMinuteFrame;case"MinuteChartHScreenContainer":return new C.OverlayMinuteHScreenFrame}},this.GetMainData=function(){switch(this.ClassName){case"MinuteChartContainer":case"MinuteChartHScreenContainer":return this.SourceData;case"KLineChartContainer":case"KLineChartHScreenContainer":return this.ChartPaint[0].Data}},this.BindAllOverlayIndexData=function(t){if(this.Frame&&this.Frame.SubFrame)for(var e=0;e<this.Frame.SubFrame.length;++e)for(var a=this.Frame.SubFrame[e],i=0;i<a.OverlayIndex.length;++i){var r=a.OverlayIndex[i];this.BindOverlayIndexData(r,e,t)}},this.GetOverlayIndexEvent=function(){return this.GetEventCallback(s.JSCHART_EVENT_ID.RECV_OVERLAY_INDEX_DATA)},this.DeleteOverlayIndex=function(t,e){var a=null;if(f.IFrameSplitOperator.IsNumber(e)){if(e>=0&&e<this.Frame.SubFrame.length)for(var i=this.Frame.SubFrame[e],r=0;r<i.OverlayIndex.length;++r){var n=i.OverlayIndex[r];if(n.Identify===t){for(var s=0;s<n.ChartPaint.length;++s){var o=n.ChartPaint[s];o&&o.OnDestroy&&o.OnDestroy()}i.OverlayIndex.splice(r,1),a=e;break}}}else for(var h=0;h<this.Frame.SubFrame.length;++h)for(i=this.Frame.SubFrame[h],r=0;r<i.OverlayIndex.length;++r){n=i.OverlayIndex[r];if(n.Identify===t){for(s=0;s<n.ChartPaint.length;++s){o=n.ChartPaint[s];o&&o.OnDestroy&&o.OnDestroy()}i.OverlayIndex.splice(r,1),a=h;break}}if(null==a)return console.warn("[JSChartContainer::DeleteOverlayIndex] can't find overlay index. [identify=".concat(t,"]")),!1;var l=a+1,u=this.TitlePaint[l];return u.OverlayIndex.has(t)&&u.OverlayIndex.delete(t),u.OverlayDynamicTitle.has(t)&&u.OverlayDynamicTitle.delete(t),!0}}function v(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function F(t){return parseInt(t)+.5}function g(t){return.5+t<<0}function A(){this.X,this.Y}function E(){this.UIElement,this.Left=50,this.Right=80,this.Top=50,this.Bottom=50,this.TitleHeight=15,this.TopSpace=0,this.BottomSpace=0,this.LeftExtendWidth=0,this.RightExtendWidth=0,this.GetBorder=function(){var t={Left:this.Left,LeftEx:this.Left+this.LeftExtendWidth,Right:this.UIElement.Width-this.Right,RightEx:this.UIElement.Width-this.Right-this.RightExtendWidth,Top:this.Top,TopEx:this.Top+this.TitleHeight+this.TopSpace,TopTitle:this.Top+this.TitleHeight,Bottom:this.UIElement.Height-this.Bottom,BottomEx:this.UIElement.Height-this.Bottom-this.BottomSpace,ChartWidth:this.UIElement.Width,ChartHeight:this.UIElement.Height};return t},this.GetHScreenBorder=function(){var t={Left:this.Left,LeftEx:this.Left+this.BottomSpace,Right:this.UIElement.Width-this.Right,RightEx:this.UIElement.Width-this.Right-this.TitleHeight-this.TopSpace,RightTitle:this.UIElement.Width-this.Right-this.TitleHeight,Top:this.Top,TopEx:this.Top+this.LeftExtendWidth,Bottom:this.UIElement.Height-this.Bottom,BottomEx:this.UIElement.Height-this.Bottom-this.RightExtendWidth,ChartWidth:this.UIElement.Width,ChartHeight:this.UIElement.Height};return t},this.GetChartWidth=function(){return this.UIElement.Width},this.GetChartHeight=function(){return this.UIElement.Height},this.GetLeft=function(){return this.Left},this.GetRight=function(){return this.UIElement.Width-this.Right},this.GetTop=function(){return this.Top},this.GetTopEx=function(){return this.Top+this.TitleHeight+this.TopSpace},this.GetTopTitle=function(){return this.Top+this.TitleHeight},this.GetBottom=function(){return this.UIElement.Height-this.Bottom},this.GetBottomEx=function(){return this.UIElement.Height-this.Bottom-this.BottomSpace},this.GetWidth=function(){return this.UIElement.Width-this.Left-this.Right},this.GetHeight=function(){return this.UIElement.Height-this.Top-this.Bottom},this.GetHeightEx=function(){return this.UIElement.Height-this.Top-this.Bottom-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetRightEx=function(){return this.UIElement.Width-this.Right-this.TitleHeight-this.TopSpace},this.GetWidthEx=function(){return this.UIElement.Width-this.Left-this.Right-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetLeftEx=function(){return this.Left+this.BottomSpace},this.GetRightTitle=function(){return this.UIElement.Width-this.Right-this.TitleHeight},this.GetTitleHeight=function(){return this.TitleHeight}}function N(){this.Frame,this.Height,this.OverlayIndex=[]}function M(){this.Frame,this.ChartPaint=[],this.Identify=v(),this.Scprit,this.UpdateFrameMaxMin=function(){var t={Max:null,Min:null};if(this.Frame.IsShareY)this.Frame.XYSplit=!0;else{if(this.Frame.YSpecificMaxMin)t.Max=this.Frame.YSpecificMaxMin.Max,t.Min=this.Frame.YSpecificMaxMin.Min;else for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e],i=a.GetMaxMin();f.IFrameSplitOperator.IsNumber(i.Max)&&(null==t.Max||t.Max<i.Max)&&(t.Max=i.Max),f.IFrameSplitOperator.IsNumber(i.Min)&&(null==t.Min||t.Min>i.Min)&&(t.Min=i.Min)}null!=t.Max&&null!=t.Min&&(this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,this.Frame.XYSplit=!0)}}}function L(){this.ClassName="HQTradeFrame",this.SubFrame=new Array,this.SizeChange=!0,this.ChartBorder,this.Canvas,this.ScreenImagePath,this.ScreenImageData=null,this.Data,this.Position,this.SizeChange=!0,this.SnapshotID=0,this.CurrentSnapshotID=0,this.SnapshotStatus=0,this.AutoLeftBorder=null,this.AutoRightBorder=null,this.ZoomWindowsInfo=null,this.ZoomStartWindowIndex=1,this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=0;for(var i in this.SubFrame){var r=this.SubFrame[i];a+=r.Height}for(var i in this.SubFrame){r=this.SubFrame[i];r.Frame.ChartBorder.Top=t,r.Frame.ChartBorder.Left=this.ChartBorder.Left,r.Frame.ChartBorder.Right=this.ChartBorder.Right;var n=e*(r.Height/a)+t;r.Frame.ChartBorder.Bottom=this.ChartBorder.GetChartHeight()-n,t=n}}},this.GetScaleTextWidth=function(){for(var t={Left:null,Right:null},e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];if(!(a.Height<=0)){var i=a.Frame;if(i&&i.XSplitOperator){var r=i.HorizontalMax,n=i.HorizontalMin;i.YSplitOperator.Operator();var s=i.GetScaleTextWidth();if(i.HorizontalMax=r,i.HorizontalMin=n,s&&s.TextWidth){var o=s.TextWidth;f.IFrameSplitOperator.IsNumber(o.Left)&&(null==t.Left||t.Left<o.Left)&&(t.Left=o.Left),f.IFrameSplitOperator.IsNumber(o.Right)&&(null==t.Right||t.Right<o.Right)&&(t.Right=o.Right)}}}}return t},this.IsFrameXYSplit=function(){for(var t in this.SubFrame)if(this.SubFrame[t].Frame.XYSplit)return!0;return!1},this.Draw=function(t){!0===this.SizeChange&&this.CalculateChartBorder();var e=!1;if(t&&!0===t.IsEnableSplash&&(e=!0),0==e&&(this.AutoLeftBorder||this.AutoRightBorder)&&this.IsFrameXYSplit()){var a=this.GetScaleTextWidth();if(f.IFrameSplitOperator.IsNumber(a.Left)&&this.AutoLeftBorder){var i=0;f.IFrameSplitOperator.IsNumber(this.AutoLeftBorder.Blank)&&(i=this.AutoLeftBorder.Blank);var r=a.Left+i;f.IFrameSplitOperator.IsNumber(this.AutoLeftBorder.MinWidth)&&this.AutoLeftBorder.MinWidth>r&&(r=this.AutoLeftBorder.MinWidth),this.IsHScreen?this.ChartBorder.Top=r:this.ChartBorder.Left=r;for(var n=0;n<this.SubFrame.length;++n){var s=this.SubFrame[n];this.IsHScreen?s.Frame.ChartBorder.Top=r:s.Frame.ChartBorder.Left=r}}if(f.IFrameSplitOperator.IsNumber(a.Right)&&this.AutoRightBorder){i=0;f.IFrameSplitOperator.IsNumber(this.AutoRightBorder.Blank)&&(i=this.AutoRightBorder.Blank);r=a.Right+i;f.IFrameSplitOperator.IsNumber(this.AutoRightBorder.MinWidth)&&this.AutoRightBorder.MinWidth>r&&(r=this.AutoRightBorder.MinWidth),this.IsHScreen?this.ChartBorder.Bottom=r:this.ChartBorder.Right=r;for(n=0;n<this.SubFrame.length;++n){s=this.SubFrame[n];this.IsHScreen?s.Frame.ChartBorder.Bottom=r:s.Frame.ChartBorder.Right=r}}}for(n=0;n<this.SubFrame.length;++n){s=this.SubFrame[n];if(!(s.Height<=0)){s.Frame.Draw();for(var o=0;o<s.OverlayIndex.length;++o){var h=s.OverlayIndex[o];h.Frame.DataWidth=s.Frame.DataWidth,h.Frame.DistanceWidth=s.Frame.DistanceWidth,h.Frame.XPointCount=s.Frame.XPointCount,h.ChartPaint.length>0&&h.Frame&&h.Frame.Draw()}}}this.SizeChange=!1},this.DrawOveraly=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];if(!(a.Height<=0))for(var i=0;i<a.OverlayIndex.length;++i)for(var r=a.OverlayIndex[i],n=0;n<r.ChartPaint.length;++n){var s=r.ChartPaint[n];s.IsShow&&(t?s.IsDrawFirst&&s.Draw():s.IsDrawFirst||s.Draw())}}},this.DrawLock=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawLock()}},this.DrawLogo=function(){for(var t=0;t<this.SubFrame.length;++t){var e=this.SubFrame[t];if(e.Frame.DrawLogo){e.Frame.DrawLogo();break}}},this.DrawInsideHorizontal=function(){for(var t=0;t<this.SubFrame.length;++t){var e=this.SubFrame[t];e.Frame.DrawInsideHorizontal()}},this.DrawCustomHorizontal=function(){for(var t=0;t<this.SubFrame.length;++t){var e=this.SubFrame[t];e.Frame.DrawCustomHorizontal&&e.Frame.DrawCustomHorizontal()}},this.DrawCustomVertical=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];a.Frame.DrawCustomVerticalEvent=t,a.Frame.DrawCustomVertical&&a.Frame.DrawCustomVertical()}},this.SetSizeChage=function(t){for(var e in this.SizeChange=t,this.SubFrame){var a=this.SubFrame[e];a.Frame.SizeChange=t}this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}},this.SetDrawOtherChart=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];a.Frame.DrawOtherChart=t}},this.Snapshot=function(t){1==t?this.SnapshotImageData():this.SnapshotImagePath()},this.SnapshotImagePath=function(){var t=this,e=this.ChartBorder.GetChartWidth(),a=this.ChartBorder.GetChartHeight();++this.SnapshotID;var r=this.SnapshotID;this.SnapshotStatus=1,this.Canvas&&this.Canvas.DomNode?wx.canvasToTempFilePath({x:0,y:0,width:e,height:a,canvas:this.Canvas.DomNode,success:function(e){t.ScreenImagePath=e.tempFilePath,t.SnapshotStatus=0,t.CurrentSnapshotID=r,i.JSConsole.Chart.Log("[HQTradeFrame::SnapshotImagePath] SnapshotID(".concat(t.SnapshotID,", ").concat(t.CurrentSnapshotID,"), Path=").concat(e.tempFilePath))}}):wx.canvasToTempFilePath({x:0,y:0,width:e,height:a,canvasId:this.ChartBorder.UIElement.ID,success:function(e){t.ScreenImagePath=e.tempFilePath,t.SnapshotStatus=0,t.CurrentSnapshotID=r}})},this.SnapshotImageData=function(){var t=this,e=this.ChartBorder.GetChartWidth(),a=this.ChartBorder.GetChartHeight();i.JSConsole.Chart.Log("[HQTradeFrame::SnapshotImageData][ID=".concat(this.ChartBorder.UIElement.ID," invoke canvasGetImageData(").concat(e,", ").concat(a,") SnapshotStatus=").concat(this.SnapshotStatus)),++this.SnapshotID;var r=this.SnapshotID;this.SnapshotStatus=1,wx.canvasGetImageData({canvasId:this.ChartBorder.UIElement.ID,x:0,y:0,width:e,height:a,success:function(e){t.ScreenImageData=e.data,t.SnapshotStatus=0,t.CurrentSnapshotID=r,i.JSConsole.Chart.Log("[HQTradeFrame::SnapshotImageData] SnapshotID=".concat(t.SnapshotID,", CurrentSnapshotID=").concat(t.CurrentSnapshotID,", size=").concat(e.data.length))}})},this.GetXData=function(t){return this.SubFrame[0].Frame.GetXData(t)},this.GetYData=function(t,e){for(var a,i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeft(),o=r.Frame.ChartBorder.GetTopEx(),h=r.Frame.ChartBorder.GetWidth(),l=r.Frame.ChartBorder.GetHeightEx(),u=new s.Rect(n,o,h,l);if(u.IsPointIn(n,t)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a){var C=a.GetYData(t);if(1==a.YSplitOperator.CoordinateType){var D=a.YSplitOperator.GetFirstOpenPrice();e.RightYValue=((C-D)/D*100).toFixed(2)+"%"}return C}},this.GetXFromIndex=function(t){return this.SubFrame[0].Frame.GetXFromIndex(t)},this.GetYFromData=function(t){return this.SubFrame[0].Frame.GetYFromData(t)},this.PtInFrame=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a],r=i.Frame.ChartBorder.GetLeft(),n=i.Frame.ChartBorder.GetTop(),o=i.Frame.ChartBorder.GetWidth(),h=i.Frame.ChartBorder.GetHeight(),l=new s.Rect(r,n,o,h),u=l.IsPointIn(t,e);if(u)return a}return-1},this.ZoomUp=function(t){var e=this.SubFrame[0].Frame.ZoomUp(t);return this.UpdateAllFrame(),e},this.ZoomDown=function(t){var e=this.SubFrame[0].Frame.ZoomDown(t);return this.UpdateAllFrame(),e},this.SetXShowCount=function(t){var e=this.SubFrame[0].Frame.SetXShowCount(t);return this.UpdateAllFrame(),e},this.SetDataWidth=function(t){var e=this.SubFrame[0].Frame.SetDataWidth(t);return this.UpdateAllFrame(),e},this.OnSize=function(){var t={};return this.SubFrame[0].Frame.OnSize(t),this.UpdateAllFrame(),t},this.UpdateAllFrame=function(){for(var t=this.SubFrame[0].Frame,e=1;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame.XPointCount=t.XPointCount,a.Frame.ZoomIndex=t.ZoomIndex,a.Frame.DataWidth=t.DataWidth,a.Frame.DistanceWidth=t.DistanceWidth,a.Frame.LastCalculateStatus.Width=t.LastCalculateStatus.Width,a.Frame.LastCalculateStatus.XPointCount=t.LastCalculateStatus.XPointCount}},this.ResetXYSplit=function(){for(var t in this.SubFrame)this.SubFrame[t].Frame.XYSplit=!0},this.SetLanguage=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];a&&a.Frame&&(a.Frame.YSplitOperator&&(a.Frame.YSplitOperator.LanguageID=t),a.Frame.XSplitOperator&&(a.Frame.XSplitOperator.LanguageID=t))}},this.GetCurrentPageSize=function(){if(this.SubFrame.length<=0)return null;var t=this.SubFrame[0];return t&&t.Frame?t.Frame.XPointCount:null},this.ClearCoordinateText=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame&&a.Frame.ClearCoordinateText(t)}},this.RestoreIndexWindows=function(){if(!this.ZoomWindowsInfo)return!1;this.SubFrame[this.ZoomWindowsInfo.FrameID];for(var t=this.ZoomStartWindowIndex;t<this.ZoomWindowsInfo.Data.length;++t){var e=this.ZoomWindowsInfo.Data[t],a=this.SubFrame[t];a.Height=e.Height,a.Frame.IsMinSize=!1,a.Frame.XSplitOperator.ShowText=e.ShowXText,a.Frame.XYSplit=!0}return this.ZoomWindowsInfo=null,!0},this.ZoomIndexWindow=function(t,e){var a=this.SubFrame[t];if(!a)return!1;if(this.ZoomWindowsInfo)return this.RestoreIndexWindows();for(var i={FrameID:t,Data:[]},r=0;r<this.SubFrame.length;++r){var n=this.SubFrame[r];i.Data[r]={Height:n.Height,ShowXText:n.Frame.XSplitOperator.ShowText}}this.ZoomWindowsInfo=i;var s=0;for(r=this.ZoomStartWindowIndex;r<this.SubFrame.length;++r){n=this.SubFrame[r];var o=n.Frame;o.XYSplit=!0,s+=n.Height,r!=t&&(n.Height=0,o.IsMinSize=!0,o.XSplitOperator.ShowText=!1)}return a.Height=s,a.Frame.XSplitOperator.ShowText=!0,!0}}function x(){this.newMethod=L,this.newMethod(),delete this.newMethod,this.ClassName="HQTradeHScreenFrame",this.IsHScreen=!0,this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){var t=this.ChartBorder.Right,e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetWidth(),i=0;for(var r in this.SubFrame){var n=this.SubFrame[r];i+=n.Height}for(var r in this.SubFrame){n=this.SubFrame[r];n.Frame.ChartBorder.Top=this.ChartBorder.Top,n.Frame.ChartBorder.Bottom=this.ChartBorder.Bottom;var s=a*(n.Height/i);n.Frame.ChartBorder.Right=t,n.Frame.ChartBorder.Left=e-s,t+=s,e-=s}}},this.GetYData=function(t,e){for(var a,i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeftEx(),o=r.Frame.ChartBorder.GetTop(),h=r.Frame.ChartBorder.GetWidthEx(),l=r.Frame.ChartBorder.GetHeight(),u=new s.Rect(n,o,h,l);if(u.IsPointIn(t,o)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a)return a.GetYData(t)}}function O(){this.ChartPaint,this.Data}function R(){}function y(t){this.newMethod=p,this.newMethod(t),delete this.newMethod,this.ClassName="KLineChartContainer",this.WindowIndex=new Array,this.ColorIndex,this.TradeIndex,this.Symbol,this.Name,this.Period=0,this.RightFormula=0,this.IsApiPeriod=!1,this.Right=0,this.SourceData,this.MaxRequestDataCount=3e3,this.MaxRequestMinuteDayCount=5,this.PageSize=200,this.KLineDrawType=0,this.LoadDataSplashTitle="下载历史数据",this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer=null,this.RightSpaceCount=1,this.SourceDataLimit=new Map,this.IsZoomLockRight=!1,this.KLineSize=null,this.StepPixel=4,this.ZoomStepPixel=5,this.EnableZoomUpDown=null,this.DragDownload={Day:{Enable:!1,IsEnd:!1,Status:0},Minute:{Enable:!1,IsEnd:!1,Status:0}},this.KLineApiUrl=S.g_JSChartResource.Domain+"/API/KLine2",this.MinuteKLineApiUrl=S.g_JSChartResource.Domain+"/API/KLine3",this.RealtimeApiUrl=S.g_JSChartResource.Domain+"/API/Stock",this.KLineMatchUrl=S.g_JSChartResource.Domain+"/API/KLineMatch",this.DragMinuteKLineApiUrl=S.g_JSChartResource.Domain+"/API/KLine4",this.DragKLineApiUrl=S.g_JSChartResource.Domain+"/API/KLine5",this.BeforeBindMainData=null,this.AfterBindMainData=null,this.ResetDragDownload=function(){this.DragDownload.Day.Status=0,this.DragDownload.Day.IsEnd=!1,this.DragDownload.Minute.Status=0,this.DragDownload.Minute.IsEnd=!1},this.AddCustomKLine=function(t,e){var a=this.ChartPaint[0];if(a&&t){if(a.CustomKLine||(a.CustomKLine=new Map),Array.isArray(t))for(var i=0;i<t.length;++i){var r=t[i];a.CustomKLine.set(r.Key,r.Data)}else t&&a.CustomKLine.set(t.Key,t.Data);e&&1==e.Draw&&this.Draw()}},this.ClearCustomKLine=function(t){var e=this.ChartPaint[0];e&&(e.ClearCustomKLine(),t&&1==t.Draw&&this.Draw())},this.GetZoomInfo=function(){var t={};return t.DataWidth=this.Frame.SubFrame[0].Frame.DataWidth,t.XPointCount=this.Frame.SubFrame[0].Frame.XPointCount,t},this.ChartOperator=function(t){var e=t.ID;if(e===T.OP_SCROLL_LEFT||e===T.OP_SCROLL_RIGHT){var a=e===T.OP_SCROLL_LEFT,r=1;t.Step>0&&(r=t.Step),this.DataMove(r*this.StepPixel,a)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):e===T.OP_SCROLL_RIGHT&&this.DragDownloadData&&this.DragDownloadData()}else if(e===T.OP_ZOOM_IN||e===T.OP_ZOOM_OUT){var n={};if(n.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),e===T.OP_ZOOM_IN){if(!this.Frame.ZoomUp(n))return}else if(!this.Frame.ZoomDown(n))return;this.CursorIndex=n.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else if(e===T.OP_GOTO_HOME){var o=this.ChartOperator_Temp_GetHistroyData();if(!o)return;var h=this.Frame.SubFrame[0].Frame.XPointCount;h-=this.RightSpaceCount;var l=o.Data.length-h;o.DataOffset=l,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,i.JSConsole.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO_HOME, dataOffset=".concat(o.DataOffset," CursorIndex=").concat(this.CursorIndex," PageSize=").concat(h)),this.ChartOperator_Temp_Update()}else if(e===T.OP_GOTO_END){o=this.ChartOperator_Temp_GetHistroyData();if(!o)return;o.DataOffset=0,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,i.JSConsole.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO_END "),this.ChartOperator_Temp_Update()}else if(e==T.OP_GOTO){if(!f.IFrameSplitOperator.IsNumber(t.Date))return;o=this.ChartOperator_Temp_GetHistroyData();if(!o)return;l=null;if(s.ChartData.IsDayPeriod(this.Period,!0))for(var u=0;u<o.Data.length;++u){var C=o.Data[u];if(C.Date>=t.Date){l=u;break}}else if(s.ChartData.IsMinutePeriod(this.Period,!0)){var D=t.Time;if(f.IFrameSplitOperator.IsPlusNumber(D))for(u=0;u<o.Data.length;++u){C=o.Data[u];if(C.Date>t.Date||C.Date==t.Date&&C.Time>=D){l=u;break}}else for(u=0;u<o.Data.length;++u){C=o.Data[u];if(C.Date>=t.Date){l=u;break}}}if(null===l)return void i.JSConsole.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO can't find date=".concat(t.Date," time=").concat(t.Time));var m=this.Frame.SubFrame[0].Frame.XPointCount,c=m;t.PageSize>0&&(c=t.PageSize),c!=m&&this.Frame.SetXShowCount(c),o.DataOffset=l,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,this.ChartOperator_Temp_Update()}},this.ChartOperator_Temp_GetHistroyData=function(){var t=null;return t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,t||null},this.ChartOperator_Temp_Update=function(){this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()},this.Create=function(t){var e=this;for(var a in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=f.g_DivTooltipDataForamt.Create("CorssCursor_XStringFormat"),this.ChartCorssCursor.StringFormatX.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartCorssCursor.StringFormatX.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY=f.g_DivTooltipDataForamt.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartSplashPaint=new D.ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SplashTitle=this.LoadDataSplashTitle,this.ChartSplashPaint.HQChart=this,this.Frame=new L,this.Frame.ChartBorder=new E,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var i=new I.DynamicChartTitlePainting;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.LanguageID=this.LanguageID,i.GetEventCallback=function(t){return e.GetEventCallback(t)},this.Frame.SubFrame[a].Frame.TitlePaint=i,this.TitlePaint.push(i)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame,this.ChartCorssCursor.StringFormatY.Frame=this.Frame},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new E;i.UIElement=this.UIElement;var r=new C.KLineFrame;r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,r.RightSpaceCount=this.RightSpaceCount,r.HorizontalMax=20,r.HorizontalMin=10,0==a?(r.YSplitOperator=new f.FrameSplitKLinePriceY,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.FrameSplitData2=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},r.GetEventCallback=function(t){return e.GetEventCallback(t)},i.BottomSpace=12,i.TopSpace=12):(r.YSplitOperator=new f.FrameSplitY,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)}),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new f.FrameSplitKLineX,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,a!=t-1&&(r.XSplitOperator.ShowText=!1);for(var n=r.HorizontalMin;n<=r.HorizontalMax;n+=1)r.HorizontalInfo[n]=new f.CoordinateInfo,r.HorizontalInfo[n].Value=n,0==a&&n==r.HorizontalMin||(r.HorizontalInfo[n].Message[1]=n.toString(),r.HorizontalInfo[n].Font="14px 微软雅黑");var s=new N;s.Frame=r,s.Height=0==a?20:10,this.Frame.SubFrame[a]=s}},this.CreateSubFrameItem=function(t){var e=new E;e.UIElement=this.UIElement;var a=new C.KLineFrame;a.Canvas=this.Canvas,a.ChartBorder=e,a.Identify=t,this.ModifyIndexDialog&&(a.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(a.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),a.HorizontalMax=20,a.HorizontalMin=10,a.YSplitOperator=new f.FrameSplitY,a.YSplitOperator.LanguageID=this.LanguageID,a.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),a.YSplitOperator.Frame=a,a.YSplitOperator.ChartBorder=e,a.XSplitOperator=new f.FrameSplitKLineX,a.XSplitOperator.Frame=a,a.XSplitOperator.ChartBorder=e,a.XSplitOperator.ShowText=!1,a.XSplitOperator.Period=this.Period;var i=this.Frame.SubFrame[0].Frame.XPointCount;a.XPointCount=i,a.Data=this.ChartPaint[0].Data;for(var r=a.HorizontalMin;r<=a.HorizontalMax;r+=1)a.HorizontalInfo[r]=new f.CoordinateInfo,a.HorizontalInfo[r].Value=r,a.HorizontalInfo[r].Message[1]=r.toString(),a.HorizontalInfo[r].Font="14px 微软雅黑";var n=new N;return n.Frame=a,n.Height=10,n},this.CreateMainKLine=function(){var t=this,e=new D.ChartKLine;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Main-KLine",e.DrawType=this.KLineDrawType,e.GetEventCallback=function(e){return t.GetEventCallback(e)},this.ChartPaint[0]=e,this.TitlePaint[0]=new I.DynamicKLineTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].LanguageID=this.LanguageID,this.TitlePaint[0].HQChart=this;var a=new D.ChartOverlayKLine;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,a.ChartFrame=this.Frame.SubFrame[0].Frame,a.Name="Overlay-KLine",a.DrawType=this.KLineDrawType,this.OverlayChartPaint[0]=a},this.BindMainData=function(t,e){if(this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,this.KLineSize)if(null==this.KLineSize.DataWidth)e=this.Frame.SubFrame[0].Frame.XPointCount-this.RightSpaceCount;else{var a=this.Frame.SetDataWidth(this.KLineSize.DataWidth);e=a.XPointCount-this.RightSpaceCount,this.KLineSize.DataWidth=null}for(var i in this.Frame.SubFrame){var r=this.Frame.SubFrame[i].Frame;r.XPointCount=e+this.RightSpaceCount,r.Data=this.ChartPaint[0].Data,r.XSplitOperator.Symbol=this.Symbol,r.XSplitOperator.Period=this.Period}this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].Period=this.Period,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint[0].MainData=this.ChartPaint[0].Data;var n=t.Data.length-e;n<0&&(n=0),this.ChartPaint[0].Data.DataOffset=n,this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.CursorIndex=e,this.CursorIndex+n>=t.Data.length&&(this.CursorIndex=t.Data.length-1-n),this.CursorIndex<0&&(this.CursorIndex=0)},this.UpdateMainData=function(t,e){var a=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(a=this.Frame.SubFrame[0].Frame.Data):a=this.Frame.Data,a){var r=this.Frame.SubFrame[0].Frame.XPointCount,n=0;for(var s in e>0&&t.Data.length>e?(n=t.Data.length-e,i.JSConsole.Chart.Log("[KLineChartContainer::UpdateMainData]  [count=".concat(e,"->").concat(t.Data.length,"], [newDataCount=").concat(n,"], [Pagesize=").concat(r,"]"))):0==e&&t.Data.length>r&&(n=t.Data.length-r,i.JSConsole.Chart.Log("[KLineChartContainer::UpdateMainData] history data is empty. [count=".concat(e,"->").concat(t.Data.length,"], [newDataCount=").concat(n,"], [Pagesize=").concat(r,"]"))),this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,t.Data.length>r&&(this.ChartPaint[0].Data.DataOffset=a.DataOffset+n),this.Frame.SubFrame){var o=this.Frame.SubFrame[s].Frame;o.Data=this.ChartPaint[0].Data,0==s&&(o.YSplitOperator.Symbol=this.Symbol,o.YSplitOperator.Data=this.ChartPaint[0].Data,o.YSplitOperator.Period=this.Period)}for(var s in this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint){o=this.OverlayChartPaint[s];o.MainData=this.ChartPaint[0].Data}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol}},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.BindIndexData=function(t,e){this.WindowIndex[t]&&("function"!=typeof this.WindowIndex[t].RequestData?"function"!=typeof this.WindowIndex[t].ExecuteScript?this.WindowIndex[t].BindData(this,t,e):this.WindowIndex[t].ExecuteScript(this,t,e):this.WindowIndex[t].RequestData(this,t,e))},this.BindOverlayIndexData=function(t,e,a){t.Script&&("function"!=typeof t.Script.RequestData?"function"!=typeof t.Script.ExecuteScript?t.Script.BindData(this,e,a):t.Script.ExecuteScript(this,e,a):t.Script.RequestData(this,e,a))},this.BindInstructionIndexData=function(t){this.ColorIndex&&"function"==typeof this.ColorIndex.ExecuteScript&&this.ColorIndex.ExecuteScript(this,0,t),this.TradeIndex&&"function"==typeof this.TradeIndex.ExecuteScript&&this.TradeIndex.ExecuteScript(this,0,t)},this.GetChartPaint=function(t){var e=new Array;for(var a in this.ChartPaint)if(0!=a){var i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return e},this.AutoUpdateEvent=function(t,e){var a=t?s.JSCHART_EVENT_ID.RECV_START_AUTOUPDATE:s.JSCHART_EVENT_ID.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,Right:this.Right,Period:this.Period},Explain:e};t&&(n.Callback=function(t){s.ChartData.IsDayPeriod(i.Period,!0)?i.RecvRealtimeData(t):(s.ChartData.IsMinutePeriod(i.Period,!0)||s.ChartData.IsSecondPeriod(i.Period))&&i.RecvMinuteRealtimeData(t)}),r.Callback(r,n,this)}},this.RequestHistoryData=function(){var t=this;if(this.CancelAutoUpdate(),this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.ResetDragDownload(),this.Draw(),this.NetworkFilter){var e={Name:"KLineChartContainer::RequestHistoryData",Explain:"日K数据",Request:{Url:t.KLineApiUrl,Type:"POST",Data:{symbol:t.Symbol,count:t.MaxRequestDataCount,field:["name","symbol","yclose","open","price","high","low","vol"],period:this.Period,right:this.Right}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e),t.AutoUpdateEvent(!0,"KLineChartContainer::RequestHistoryData"),t.AutoUpdate()})),1==e.PreventDefault)return}r.JSNetwork.HttpRequest({url:this.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestDataCount},method:"POST",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e),t.AutoUpdateEvent(!0,"KLineChartContainer::RequestHistoryData"),t.AutoUpdate()}})},this.RecvHistoryData=function(t){var e=t.data,a=y.JsonDataToHistoryData(e),i=new s.ChartData;i.Data=a,i.DataType=0,i.Symbol=e.symbol,this.SourceData=i,this.BeforeBindMainData&&this.BeforeBindMainData("RecvHistoryData");var r,n=new s.ChartData;if(n.Data=a,n.Right=this.Right,n.Period=this.Period,n.DataType=0,n.Right>0&&!this.IsApiPeriod){var o=n.GetRightData(n.Right,{AlgorithmType:this.RightFormula});n.Data=o}if(s.ChartData.IsDayPeriod(n.Period,!1)&&!this.IsApiPeriod){var h=n.GetPeriodData(n.Period);n.Data=h}this.Symbol=e.symbol,this.Name=e.name,this.BindMainData(n,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("RecvHistoryData"),this.Frame.SetSizeChage(!0),this.Frame.SubFrame[0]&&(r=this.Frame.SubFrame[0].Frame),r&&r.YSplitOperator&&(r.YSplitOperator.Symbol=this.Symbol,r.YSplitOperator.Data=this.ChartPaint[0].Data,r.YSplitOperator.Period=this.Period),this.ReqeustKLineInfoData({FunctionName:"RecvHistoryData"}),this.RequestOverlayHistoryData(),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.BindInstructionIndexData(n);for(var l=0;l<this.Frame.SubFrame.length;++l)this.BindIndexData(l,n);if(this.BindAllOverlayIndexData(n),this.mapEvent.has(s.JSCHART_EVENT_ID.RECV_HISTROY_DATA)){var u=this.mapEvent.get(s.JSCHART_EVENT_ID.RECV_HISTROY_DATA);e={HistoryData:n,Stock:{Symbol:this.Symbol,Name:this.Name}};u.Callback(u,e,this)}else"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvHistroyData",this),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvHistoryData",this)},this.ReqeustHistoryMinuteData=function(){var t=this;if(this.CancelAutoUpdate(),this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.ResetDragDownload(),this.Draw(),this.NetworkFilter){var e={Name:"KLineChartContainer::ReqeustHistoryMinuteData",Explain:"1分钟K线数据",Request:{Url:t.MinuteKLineApiUrl,Type:"POST",Data:{symbol:t.Symbol,count:t.MaxRequestMinuteDayCount,field:["name","symbol","yclose","open","price","high","low","vol"],period:this.Period,right:this.Right}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteHistoryData(e),t.AutoUpdateEvent(!0,"KLineChartContainer::ReqeustHistoryMinuteData"),t.AutoUpdate()})),1==e.PreventDefault)return}r.JSNetwork.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount},method:"POST",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteHistoryData(e),t.AutoUpdateEvent(!0,"KLineChartContainer::ReqeustHistoryMinuteData"),t.AutoUpdate()}})},this.RecvMinuteHistoryData=function(t){var e=t.data,a=y.JsonDataToMinuteHistoryData(e),i=new s.ChartData;i.Data=a,i.DataType=1,i.Symbol=e.symbol,this.SourceData=i,this.BeforeBindMainData&&this.BeforeBindMainData("RecvMinuteHistoryData");var r,n=new s.ChartData;if(n.Data=a,n.Right=this.Right,n.Period=this.Period,n.DataType=1,n.Symbol=e.symbol,n.Right>0&&!this.IsApiPeriod&&this.RightFormula>=1){var o=n.GetRightData(n.Right,{AlgorithmType:this.RightFormula});n.Data=o}if(s.ChartData.IsMinutePeriod(n.Period,!1)&&!this.IsApiPeriod){var h=n.GetPeriodData(n.Period);n.Data=h}this.Symbol=e.symbol,this.Name=e.name,this.BindMainData(n,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("RecvMinuteHistoryData"),this.Frame.SetSizeChage(!0),this.Frame.SubFrame[0]&&(r=this.Frame.SubFrame[0].Frame),r&&r.YSplitOperator&&(r.YSplitOperator.Symbol=this.Symbol,r.YSplitOperator.Data=this.ChartPaint[0].Data),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.BindInstructionIndexData(n);for(var l=0;l<this.Frame.SubFrame.length;++l)this.BindIndexData(l,n);if(this.BindAllOverlayIndexData(n),this.mapEvent.has(s.JSCHART_EVENT_ID.RECV_HISTROY_DATA)){var u=this.mapEvent.get(s.JSCHART_EVENT_ID.RECV_HISTROY_DATA);e={HistoryData:n,Stock:{Symbol:this.Symbol,Name:this.Name}};u.Callback(u,e,this)}else"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvMinuteHistoryData",this)},this.RequestRealtimeData=function(){var t=this;if(this.NetworkFilter){var e={Name:"KLineChartContainer::RequestRealtimeData",Explain:"当天最新日线数据",Request:{Url:t.RealtimeApiUrl,Data:{symbol:[t.Symbol],field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time"],period:this.Period,right:this.Right},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.RecvRealtimeData(e),t.AutoUpdate()})),1==e.PreventDefault)return}r.JSNetwork.HttpRequest({url:this.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time"],symbol:[t.Symbol],start:-1},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvRealtimeData(e),t.AutoUpdate()}})},this.RecvRealtimeData=function(t){if(1!=this.IsOnTouch){var e=t.data,a=y.JsonDataToRealtimeData(e,this.Symbol);if(a){var r=this.SourceData.Data[this.SourceData.Data.length-1],n=this.GetHistoryDataCount();if(0==this.SourceData.Data.length){var o=new s.HistoryData;s.HistoryData.CopyTo(o,a),this.SourceData.Data.push(o)}else if(r.Date==a.Date)i.JSConsole.Chart.Log("[KLineChartContainer::RecvRealtimeData] update kline by minute data",a),s.HistoryData.CopyTo(r,a);else{if(!(r.Date<a.Date))return;i.JSConsole.Chart.Log("[KLineChartContainer::RecvRealtimeData] insert kline by minute data",a);o=new s.HistoryData;s.HistoryData.CopyTo(o,a),!f.IFrameSplitOperator.IsNumber(o.YClose)&&this.SourceData.Data.length>0&&(o.YClose=this.SourceData.Data[this.SourceData.Data.length-1].YClose),this.SourceData.Data.push(o)}var h=new s.ChartData;if(h.Data=this.SourceData.Data,h.Period=this.Period,h.Right=this.Right,h.DataType=this.SourceData.DataType,h.Symbol=this.Symbol,h.Right>0&&s.ChartData.IsDayPeriod(h.Period,!0)&&!this.IsApiPeriod){var l=h.GetRightData(h.Right,{AlgorithmType:this.RightFormula});h.Data=l}if(!this.IsApiPeriod&&(s.ChartData.IsDayPeriod(h.Period,!1)||s.ChartData.IsMinutePeriod(h.Period,!1))){var u=h.GetPeriodData(h.Period);h.Data=u}this.UpdateMainData(h,n),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(h);for(var C=0;C<this.Frame.SubFrame.length;++C)this.BindIndexData(C,h);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(h),this.BindAllOverlayIndexData(h)}else i.JSConsole.Chart.Log("[KLineChartContainer::RecvRealtimeData] recvdata error",t)}},this.GetHistoryDataCount=function(){var t=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(t=this.Frame.SubFrame[0].Frame.Data):t=this.Frame.Data,!t)return-1;var e=t.Data.length;return e},this.RequestMinuteRealtimeData=function(){var t=this;if(this.NetworkFilter){var e={Name:"KLineChartContainer::RequestMinuteRealtimeData",Explain:"当天1分钟K线数据",Request:{Url:t.RealtimeApiUrl,Data:{symbol:[t.Symbol],field:["name","symbol","price","yclose","minutecount","minute","date","time"],period:this.Period,right:this.Right},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()})),1==e.PreventDefault)return}r.JSNetwork.HttpRequest({url:this.RealtimeApiUrl,data:{field:["name","symbol","price","yclose","minutecount","minute","date","time"],symbol:[t.Symbol],start:-1},method:"POST",dataType:"json",async:!0,success:function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()}})},this.SetSourceDatatLimit=function(t){for(var e in this.SourceDataLimit=new Map,t){var a=t[e];this.SourceDataLimit.set(a.Period,a.MaxCount),i.JSConsole.Chart.Log("[KLineChartContainer::SetSourceDatatLimit] Period=".concat(a.Period,", MaxCount=").concat(a.MaxCount))}},this.ReduceSourceData=function(){if(this.SourceDataLimit&&this.SourceDataLimit.has(this.Period)){var t=this.SourceDataLimit.get(this.Period);if(!(t<50)){var e=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(e=this.Frame.SubFrame[0].Frame.Data):e=this.Frame.Data,e){var a=e.DataOffset,r=0;while(this.SourceData.Data.length>t)this.SourceData.Data.shift(),--a,++r;r>0&&(a<0&&(a=0),e.DataOffset=a,i.JSConsole.Chart.Log("[KLineChartContainer::ReduceSourceData] remove data ".concat(r,", dataOffset=").concat(a)))}}}},this.RecvMinuteRealtimeData=function(t){var e=t.data;if(1!=this.IsOnTouch)if(2!=e.ver){if(e.stock&&e.stock[0]&&this.Symbol==e.stock[0].symbol){var a=y.JsonDataToMinuteRealtimeData(e);if(a){this.IsApiPeriod&&this.ReduceSourceData();var r=this.GetHistoryDataCount(),n=this.SourceData.Data.length;if(this.SourceData.MergeMinuteData(a)){i.JSConsole.Chart.Log("[KLineChartContainer::RecvMinuteRealtimeData] update kline by 1 minute data [".concat(n,"->").concat(this.SourceData.Data.length,"]"));var o=new s.ChartData;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,o.Right>0&&s.ChartData.IsDayPeriod(o.Period,!0)&&!this.IsApiPeriod){var h=o.GetRightData(o.Right,{AlgorithmType:this.RightFormula});o.Data=h}if(!this.IsApiPeriod&&(s.ChartData.IsDayPeriod(o.Period,!1)||s.ChartData.IsMinutePeriod(o.Period,!1))){var l=o.GetPeriodData(o.Period);o.Data=l}this.UpdateMainData(o,r),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(o);for(var u=0;u<this.Frame.SubFrame.length;++u)this.BindIndexData(u,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(o),this.BindAllOverlayIndexData(o)}}}}else this.RecvMinuteRealtimeDataV2(e)},this.RecvMinuteRealtimeDataV2=function(t){if(1!=this.IsOnTouch){var e=y.JsonDataToMinuteHistoryData(t);if(e&&!(e.length<=0)){this.IsApiPeriod&&this.ReduceSourceData();var a=this.GetHistoryDataCount();if(this.SourceData.MergeMinuteData(e)){i.JSConsole.Chart.Log("[KLineChartContainer::RecvMinuteRealtimeDataV2] update kline by 1 minute data [".concat(a,"->").concat(this.SourceData.Data.length,"]"));var r=new s.ChartData;if(r.Data=this.SourceData.Data,r.Period=this.Period,r.Right=this.Right,r.DataType=this.SourceData.DataType,r.Symbol=this.Symbol,r.Right>0&&s.ChartData.IsDayPeriod(r.Period,!0)&&!this.IsApiPeriod){var n=r.GetRightData(r.Right,{AlgorithmType:this.RightFormula});r.Data=n}if((s.ChartData.IsDayPeriod(r.Period,!1)||s.ChartData.IsMinutePeriod(r.Period,!1))&&!this.IsApiPeriod){var o=r.GetPeriodData(r.Period);r.Data=o}this.UpdateMainData(r,a),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(r);for(var h=0;h<this.Frame.SubFrame.length;++h)this.BindIndexData(h,r);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(r),this.BindAllOverlayIndexData(r)}}}},this.SendKLineUpdateEvent=function(t){var e=this.GetEvent(s.JSCHART_EVENT_ID.RECV_KLINE_UPDATE_DATA);if(e&&e.Callback){var a={HistoryData:t,Stock:{Symbol:this.Symbol,Name:this.Name}};return e.Callback(e,a,this),!0}return!1},this.ClearIndexPaint=function(){if(this.Frame&&this.Frame.SubFrame)for(var t=0;t<this.Frame.SubFrame.length;++t){this.DeleteIndexPaint(t,!0);for(var e=this.Frame.SubFrame[t],a=0;a<e.OverlayIndex.length;++a){for(var i=e.OverlayIndex[a],r=0;r<i.ChartPaint.length;++r){var n=i.ChartPaint[r];n&&n.OnDestroy&&n.OnDestroy()}i.ChartPaint=[]}}for(t=1;t<this.TitlePaint.length;++t){e=this.TitlePaint[t];e.OverlayIndex=new Map}},this.ChangePeriod=function(t,e){var a=!1,i=null;if(e&&e.KLine&&(f.IFrameSplitOperator.IsNumber(e.KLine.DrawType)&&(a=!0),f.IFrameSplitOperator.IsNumber(e.KLine.Right)&&(i=e.KLine.Right)),this.Period!=t){a&&this.ChangeKLineDrawType(e.KLine.DrawType,!1);var r=!0;if(this.SourceData){r=!1;if(t>s.CUSTOM_DAY_PERIOD_START&&t<=s.CUSTOM_DAY_PERIOD_END)0!=this.SourceData.DataType&&(r=!0);else if(t>s.CUSTOM_MINUTE_PERIOD_START&&t<=s.CUSTOM_MINUTE_PERIOD_END||t>s.CUSTOM_SECOND_PERIOD_START&&t<=s.CUSTOM_SECOND_PERIOD_END)1!=this.SourceData.DataType&&(r=!0);else switch(t){case 0:case 1:case 2:case 3:case 21:0!=this.SourceData.DataType&&(r=!0);break;case 4:case 5:case 6:case 7:case 8:case 11:case 12:1!=this.SourceData.DataType&&(r=!0);break}}this.Period=t,null!=i&&(this.Right=i),this.ClearCustomKLine(),0!=r||this.IsApiPeriod?s.ChartData.IsDayPeriod(this.Period,!0)?(this.ClearIndexPaint(),this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangePeriod"),this.RequestHistoryData()):(s.ChartData.IsMinutePeriod(this.Period,!0)||s.ChartData.IsSecondPeriod(this.Period))&&(this.ClearIndexPaint(),this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangePeriod"),this.ReqeustHistoryMinuteData()):this.Update()}else a&&this.ChangeKLineDrawType(e.KLine.DrawType)},this.ChangeRight=function(t){h.MARKET_SUFFIX_NAME.IsEnableRight(this.Period,this.Symbol,this.RightFormula)&&(t<0||t>2||this.Right!=t&&(this.Right=t,this.IsApiPeriod?s.ChartData.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeRight"),this.RequestHistoryData()):(s.ChartData.IsMinutePeriod(this.Period,!0)||s.ChartData.IsSecondPeriod(this.Period))&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeRight"),this.ReqeustHistoryMinuteData()):this.Update()))},this.SetFirstShowDate=function(t){if(t&&t.Date){var e={ID:T.OP_GOTO,Date:t.Date};f.IFrameSplitOperator.IsNumber(t.Time)&&(e.Time=t.Time),f.IFrameSplitOperator.IsNumber(t.PageSize)&&(e.PageSize=t.PageSize),this.ChartOperator(e)}},this.DeleteIndexPaint=function(t,e){for(var a=new Array,i=0;i<this.ChartPaint.length;++i){var r=this.ChartPaint[i];0==i||r.ChartFrame!=this.Frame.SubFrame[t].Frame?a.push(r):!0===e&&r&&r.OnDestroy&&r.OnDestroy()}var n=this.Frame.SubFrame[t].Frame;n.YSpecificMaxMin=null,n.IsLocked=!1,n.YSplitScale=null,n.YSplitOperator.SplitType=n.YSplitOperator.DefaultSplitType,this.ChartPaint=a;var s=t+1;this.TitlePaint[s].Data=[],this.TitlePaint[s].Title=null},this.ShowKLine=function(t){this.ChartPaint.length<=0||!this.ChartPaint[0]||(this.ChartPaint[0].IsShow=t)},this.SetInstructionData=function(t,e){this.ChartPaint.length<=0||!this.ChartPaint[0]||(2==t?this.ChartPaint[0].ColorData=e.Data:1==t&&(this.ChartPaint[0].TradeData={Sell:e.Sell,Buy:e.Buy}))},this.ChangeInstructionIndex=function(t){var e=new u.JSCommonIndexScript.JSIndexScript,a=e.Get(t);a&&(1!=a.InstructionType&&2!=a.InstructionType||this.ChangeInstructionScriptIndex(a))},this.ChangeInstructionScriptIndex=function(t){if(1==t.InstructionType)this.TradeIndex=new c.ScriptIndex(t.Name,t.Script,t.Args,t);else{if(2!=t.InstructionType)return;this.ColorIndex=new c.ScriptIndex(t.Name,t.Script,t.Args,t)}var e=this.ChartPaint[0].Data;this.BindInstructionIndexData(e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.CancelInstructionIndex=function(){this.ChartPaint.length<=0||!this.ChartPaint[0]||(this.ColorIndex=null,this.TradeIndex=null,this.ChartPaint[0].ColorData=null,this.ChartPaint[0].TradeData=null,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw())},this.ChangeScriptIndex=function(t,e){this.DeleteIndexPaint(t,!0),this.WindowIndex[t]=new c.ScriptIndex(e.Name,e.Script,e.Args,e);var a=this.ChartPaint[0].Data;this.BindIndexData(t,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeAPIIndex=function(t,e){this.DeleteIndexPaint(t,!0);var a=e.API;this.WindowIndex[t]=new c.APIScriptIndex(a.Name,a.Script,a.Args,e);var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(a&&a.API)return this.ChangeAPIIndex(t,a);var i=R.Get(e);if(!i){var r=new u.JSCommonIndexScript.JSIndexScript,n=r.Get(e);if(!n)return;n.IsMainIndex?t=0:0==t&&(t=1);var s=n;return a&&(a.FloatPrecision>=0&&(s.FloatPrecision=a.FloatPrecision),a.StringFormat>0&&(s.StringFormat=a.StringFormat),a.Args&&(s.Args=a.Args),f.IFrameSplitOperator.IsNumber(a.IsShortTitle)&&(s.IsShortTitle=a.IsShortTitle)),this.ChangeScriptIndex(t,s)}i.IsMainIndex?t>0&&(t=0):0==t&&(t=1);var o=new Array;for(var h in this.ChartPaint){var l=this.ChartPaint[h];0!=h&&l.ChartFrame==this.Frame.SubFrame[t].Frame||o.push(l)}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.YSplitScale=null,this.ChartPaint=o;var C=t+1;this.TitlePaint[C].Data=[],this.TitlePaint[C].Title=null,this.WindowIndex[t]=i.Create(),this.CreateWindowIndex(t);var D=this.ChartPaint[0].Data;this.BindIndexData(t,D),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeKLineDrawType=function(t,e){if(this.KLineDrawType!=t){for(var a in this.KLineDrawType=t,this.ChartPaint){var i=this.ChartPaint[a];0==a?i.DrawType=this.KLineDrawType:"ChartVolStick"==i.ClassName&&(i.KLineDrawType=this.KLineDrawType)}this.OverlayChartPaint[0]&&(this.OverlayChartPaint[0].DrawType=this.KLineDrawType),0!=e&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())}},this.GetIndexInfo=function(){var t=[];for(var e in this.WindowIndex){var a=this.WindowIndex[e],i={Name:a.Name};a.ID&&(i.ID=a.ID),t.push(i)}return t},this.ChangeIndexTemplate=function(t){var e=this;if(t.Windows){var a=t.Windows.length;if(!(a<=0)){var i=this.Frame.SubFrame.length,r=null,n=null;t.KLine&&(f.IFrameSplitOperator.IsNumber(t.KLine.Period)&&t.KLine.Period!=this.Period&&(r=t.KLine.Period),f.IFrameSplitOperator.IsNumber(t.KLine.Right)&&t.KLine.Right!=this.Right&&(n=t.KLine.Right));for(var s=null!=r||null!=n,o=0;o<i;++o){this.DeleteIndexPaint(o,!0);var h=this.Frame.SubFrame[o];h.YSpecificMaxMin=null,h.IsLocked=!1,h.YSplitScale=null}if(i>a)this.Frame.SubFrame.splice(a,i-a),this.WindowIndex.splice(a,i-a);else for(o=i;o<a;++o){var l=this.CreateSubFrameItem(o);this.Frame.SubFrame[o]=l;var C=new I.DynamicChartTitlePainting;C.Frame=this.Frame.SubFrame[o].Frame,C.Canvas=this.Canvas,C.LanguageID=this.LanguageID,C.GetEventCallback=function(t){return e.GetEventCallback(t)},this.TitlePaint[o+1]=C}var D=new u.JSCommonIndexScript.JSIndexScript;for(o=0;o<a;++o){var m=o,S=t.Windows[o],d=null;t.Frame&&t.Frame.length>o&&(d=t.Frame[o]);var T=m+1;if(this.TitlePaint[T].Data=[],this.TitlePaint[T].Title=null,S.Script)this.WindowIndex[o]=new c.ScriptIndex(S.Name,S.Script,S.Args,S);else if(S.API){var p=S.API;this.WindowIndex[o]=new c.APIScriptIndex(p.Name,p.Script,p.Args,S)}else{var v=S.Index,F=R.Get(v);if(F)this.WindowIndex[o]=F.Create(),this.CreateWindowIndex(m);else{var g=D.Get(v);if(g){var A=g.Args;t.Windows[o].Args&&(A=t.Windows[o].Args);var E={Name:g.Name,Script:g.Script,Args:A,ID:v,KLineType:g.KLineType,YSpecificMaxMin:g.YSpecificMaxMin,YSplitScale:g.YSplitScale,FloatPrecision:g.FloatPrecision,Condition:g.Condition,OutName:g.OutName};this.WindowIndex[o]=new c.ScriptIndex(E.Name,E.Script,E.Args,E)}}}this.SetSubFrameAttribute(this.Frame.SubFrame[o],S,d)}for(o=0;o<this.Frame.SubFrame.length;++o){S=this.Frame.SubFrame[o].Frame;o==this.Frame.SubFrame.length-1?S.XSplitOperator.ShowText=!0:S.XSplitOperator.ShowText=!1}if(s)this.Frame.SetSizeChage(!0),null!=r?this.ChangePeriod(r,t):null!=n&&this.ChangeRight(n);else{var N=this.ChartPaint[0].Data;for(o=0;o<a;++o)this.BindIndexData(o,N);this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}}}},this.RemoveIndexWindow=function(t){if(i.JSConsole.Chart.Log("[KLineChartContainer::RemoveIndexWindow] remove id",t),0!=t&&this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){var e=this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t,!0),this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var a=0;a<this.Frame.SubFrame.length;++a){var r=this.Frame.SubFrame[a].Frame;a==this.Frame.SubFrame.length-1?r.XSplitOperator.ShowText=!0:r.XSplitOperator.ShowText=!1,r.Identify=a}if(this.ChartDrawPicture.length>0){var n=[];for(a=0;a<this.ChartDrawPicture.length;++a){r=this.ChartDrawPicture[a];r.Frame!=e&&n.push(r)}this.ChartDrawPicture=n}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}},this.CreateExtendChart=function(t,e){var a;switch(t){case"KLineTooltip":return a=e.Create&&"function"==typeof e.Create?e.Create():new m.KLineTooltipPaint,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"背景图":return a=new m.BackgroundPaint,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return null}},this.LockIndex=function(t){if(t&&t.IndexName)for(var e in this.WindowIndex){var a=this.WindowIndex[e];if(a||conintue,a.Name==t.IndexName){a.SetLock(t),this.Update();break}}},this.TryClickLock=function(t,e){for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a];if(i.Frame.IsLocked&&i.Frame.LockPaint){var r=new O;if(i.Frame.LockPaint.GetTooltipData(t,e,r))return r.HQChart=this,r.Data.Callback&&r.Data.Callback(r),!0}}return!1},this.TryClickIndexTitle=function(t,e){for(var a in this.TitlePaint){var r=this.TitlePaint[a];if(r.IsClickTitle&&r.IsClickTitle(t,e)){var n={Point:{X:t,Y:e},Title:r.Title,FrameID:r.Frame.Identify};i.JSConsole.Chart.Log("[KLineChartContainer::TryClickIndexTitle] click title ",n);var o=this.GetEvent(s.JSCHART_EVENT_ID.ON_CLICK_INDEXTITLE);return o&&o.Callback&&o.Callback(o,n,this),!0}}return!1},this.StopAutoUpdate=function(){this.IsAutoUpdate=!1,this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::StopAutoUpdate")},this.Update=function(){if(this.SourceData){this.BeforeBindMainData&&this.BeforeBindMainData("Update");var t=new s.ChartData;if(t.Data=this.SourceData.Data,t.Period=this.Period,t.Right=this.Right,t.DataType=this.SourceData.DataType,t.Symbol=this.Symbol,t.Right>0&&s.ChartData.IsDayPeriod(t.Period,!0)){var e=t.GetRightData(t.Right,{AlgorithmType:this.RightFormula});t.Data=e}else if(t.Right>0&&s.ChartData.IsMinutePeriod(t.Period,!0)&&this.RightFormula>=1){e=t.GetRightData(t.Right,{AlgorithmType:this.RightFormula});t.Data=e}if(s.ChartData.IsDayPeriod(t.Period,!1)||s.ChartData.IsMinutePeriod(t.Period,!1)){var a=t.GetPeriodData(t.Period);t.Data=a}this.BindMainData(t,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("Update");for(var i=null,r=0;r<this.Frame.SubFrame.length;++r)0==r&&(i=this.Frame.SubFrame[r].Frame),this.BindIndexData(r,t);if(i&&i.YSplitOperator&&(i.YSplitOperator.Symbol=this.Symbol,i.YSplitOperator.Data=this.ChartPaint[0].Data,i.YSplitOperator.Period=this.Period),this.OverlayChartPaint[0].SourceData)if(s.ChartData.IsMinutePeriod(this.Period,!0))this.OverlayChartPaint[0].Data=null;else{t=new s.ChartData;if(t.Data=this.OverlayChartPaint[0].SourceData.Data,t.Period=this.Period,t.Right=this.Right,t.Right>0&&!k(this.OverlayChartPaint[0].Symbol)){e=t.GetRightData(t.Right,{AlgorithmType:this.RightFormula});t.Data=e}var n=this.SourceData.GetOverlayData(t.Data);if(t.Data=n,s.ChartData.IsDayPeriod(t.Period,!1)){a=t.GetPeriodData(t.Period);t.Data=a}this.OverlayChartPaint[0].Data=t}this.ReqeustKLineInfoData({FunctionName:"Update"}),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.ChangeSymbol=function(t){this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeSymbol"),this.ClearCustomKLine(),this.Symbol=t,k(t)&&(this.Right=0),this.ClearIndexPaint(),s.ChartData.IsDayPeriod(this.Period,!0)?this.RequestHistoryData():(s.ChartData.IsMinutePeriod(this.Period,!0)||s.ChartData.IsSecondPeriod(this.Period))&&this.ReqeustHistoryMinuteData()},this.ReqeustKLineInfoData=function(t){if(t&&"RecvDragDayData"==t.FunctionName)t.Update=!0;else{if(this.ChartPaint.length>0){var e=this.ChartPaint[0];e.InfoData=new Map}t.Update=!1}for(var a in this.ChartInfo)this.ChartInfo[a].RequestData(this,t)},this.SetKLineInfo=function(t,e){this.ChartInfo=[];for(var a=0;a<t.length;++a){var i=o.JSKLineInfoMap.Get(t[a]);if(i){var r=i.Create();r.MaxRequestDataCount=this.MaxRequestDataCount,this.ChartInfo.push(r)}}1==e&&this.ReqeustKLineInfoData({FunctionName:"SetKLineInfo"})},this.AddKLineInfo=function(t,e){var a=o.JSKLineInfoMap.GetClassInfo(t);if(a){for(var i=0;i<this.ChartInfo.length;++i){var r=this.ChartInfo[i];if(r.ClassName==a.ClassName)return}var n=o.JSKLineInfoMap.Get(t);if(n){r=n.Create();r.MaxRequestDataCount=this.MaxRequestDataCount,this.ChartInfo.push(r),1==e&&r.RequestData(this)}}else console.warn("[KLineChartContainer::AddKLineInfo] can't find infoname=",t)},this.DeleteKLineInfo=function(t){var e=o.JSKLineInfoMap.GetClassInfo(t);if(e)for(var a=0;a<this.ChartInfo.length;++a){var i=this.ChartInfo[a];if(i.ClassName==e.ClassName){this.ChartInfo.splice(a,1),this.UpdataChartInfo(),this.Draw();break}}else console.warn("[KLineChartContainer::DeleteKLineInfo] can't find infoname=".concat(t))},this.SetPolicyInfo=function(t,e){if(t&&t.length){var a=o.JSKLineInfoMap.Get("策略选股");if(a){var i=a.Create();i.SetPolicyList(t),i.MaxRequestDataCount=this.MaxRequestDataCount,this.ChartInfo.push(i),1==e&&this.ReqeustKLineInfoData()}}},this.OverlaySymbol=function(t,e){var a=this.OverlayChartPaint[0];return!!a.MainData&&(a.Symbol=t,e&&a.Color&&(a.Color=e.Color),s.ChartData.IsDayPeriod(this.Period,!0)&&this.RequestOverlayHistoryData(),!0)},this.GetRequestDataCount=function(){var t={MaxRequestDataCount:this.MaxRequestDataCount,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount};if(!this.SourceData||!this.SourceData.Data||this.SourceData.Data.length<=0)return t;if(s.ChartData.IsDayPeriod(this.Period,!0)){var e=this.SourceData.Data.length;e>t.MaxRequestDataCount&&(t.MaxRequestDataCount=e)}else s.ChartData.IsMinutePeriod(this.Period,!0);return t},this.RequestOverlayHistoryData=function(){if(this.OverlayChartPaint.length){var t=this.OverlayChartPaint[0];if(t){var e=t.Symbol;if(e){var a=this,i=this.GetRequestDataCount(),n=this.SourceData.Data[0].Date;if(t.Status=s.OVERLAY_STATUS_ID.STATUS_REQUESTDATA_ID,this.NetworkFilter){var o={Name:"KLineChartContainer::RequestOverlayHistoryData",Explain:"叠加股票日K线数据",Request:{Url:a.KLineApiUrl,Data:{symbol:e,count:i.MaxRequestDataCount,first:{date:n},field:["name","symbol","yclose","open","price","high","vol","amount"]},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(o,(function(e){t.Status=s.OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,a.RecvOverlayHistoryData(e)})),1==o.PreventDefault)return}r.JSNetwork.HttpRequest({url:this.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high"],symbol:e,start:-1,count:this.MaxRequestDataCount},method:"POST",dataType:"json",async:!0,success:function(e){t.Status=s.OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,a.RecvOverlayHistoryData(e)}})}}}},this.RecvOverlayHistoryData=function(t){var e=t.data,a=y.JsonDataToHistoryData(e),i=new s.ChartData;i.Data=a;var r=new s.ChartData;if(r.Data=a,r.Period=this.Period,r.Right=this.Right,r.Right>0&&!k(e.symbol)){var n=r.GetRightData(r.Right,{AlgorithmType:this.RightFormula});r.Data=n}var o=this.SourceData.GetOverlayData(r.Data);if(r.Data=o,s.ChartData.IsDayPeriod(r.Period,!1)){var h=r.GetPeriodData(r.Period);r.Data=h}var l=this.OverlayChartPaint[0];l&&(l.Data=r,l.SourceData=i,l.Title=e.name,l.Symbol=e.symbol,l.Status=s.OVERLAY_STATUS_ID.STATUS_FINISHED_ID,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=1),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.ClearOverlaySymbol=function(){this.OverlayChartPaint[0].Symbol=null,this.OverlayChartPaint[0].Data=null,this.OverlayChartPaint[0].SourceData=null,this.OverlayChartPaint[0].TooltipRect=[],this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0,this.UpdateFrameMaxMin(),this.Draw()},this.CreateChartDrawPicture=function(t){return!1},this.SetChartDrawPictureFirstPoint=function(t,e){var a=this.CurrentChartDrawPicture;if(!a)return!1;if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return!1;for(var i in this.Frame.SubFrame){var r=this.Frame.SubFrame[i].Frame,n=r.ChartBorder.GetLeft(),s=r.ChartBorder.GetTopEx(),o=r.ChartBorder.GetHeight(),h=r.ChartBorder.GetWidth();if(this.Canvas.rect(n,s,h,o),this.Canvas.isPointInPath(t,e)){a.Frame=r;break}}if(!a.Frame)return!1;a.Point[0]=new A,a.Point[0].X=t-this.UIElement.getBoundingClientRect().left,a.Point[0].Y=e-this.UIElement.getBoundingClientRect().top,a.Status=1},this.SetChartDrawPictureSecondPoint=function(t,e){var a=this.CurrentChartDrawPicture;if(!a)return!1;a.Point[1]=new A,a.Point[1].X=t-this.UIElement.getBoundingClientRect().left,a.Point[1].Y=e-this.UIElement.getBoundingClientRect().top,a.Status=2},this.MoveChartDrawPicture=function(t,e){var a=this.CurrentChartDrawPicture;return!!a&&(a.Move(t,e),!0)},this.FinishChartDrawPicturePoint=function(){var t=this.CurrentChartDrawPicture;return!!t&&(t.PointCount==t.Point.length&&(t.Status=10,t.PointToValue(),this.ChartDrawPicture.push(t),this.CurrentChartDrawPicture=null,!0))},this.FinishMoveChartDrawPicture=function(){var t=this.CurrentChartDrawPicture;return!!t&&(t.PointCount==t.Point.length&&(t.Status=10,t.PointToValue(),this.CurrentChartDrawPicture=null,!0))},this.ClearChartDrawPicture=function(t){if(t)for(var e in this.ChartDrawPicture)this.ChartDrawPicture[e]==t&&(this.ChartDrawPicture.splice(e,1),this.Draw());else this.ChartDrawPicture=[],this.Draw()},this.UpdataChartInfo=function(){var t=new Map;if(0==this.Period)for(var e in this.ChartInfo){var a=this.ChartInfo[e].Data;for(var i in a){var r=a[i];t.has(r.Date.toString())?t.get(r.Date.toString()).Data.push(r):t.set(r.Date.toString(),{Data:new Array(r)})}}else if(s.ChartData.IsDayPeriod(this.Period,!1)){t=new Map;var n=this.ChartPaint[0].Data;if(n&&n.Data&&n.Data.length>0){var o=n.Data[0],h=[];for(var e in this.ChartInfo){var l=this.ChartInfo[e];for(var i in l.Data){r=l.Data[i];r.Date>=o.Date&&h.push(r)}}h.sort((function(t,e){return t.Date-e.Date}));for(e=0;e<n.Data.length;){var u=n.Data[e];if(h.length<=0)break;l=h[0];u.Date<l.Date?++e:(t.has(u.Date.toString())?t.get(u.Date.toString()).Data.push(l):t.set(u.Date.toString(),{Data:new Array(l)}),h.shift())}}}var C=this.ChartPaint[0];C.InfoData=t;var D=this.TitlePaint[0];D&&(D.InfoData=t)},this.UpdateWindowIndex=function(t){var e=new s.ChartData;if(e.Data=this.SourceData.Data,e.Period=this.Period,e.Right=this.Right,this.IsApiPeriod);else{if(e.Right>0){var a=e.GetRightData(e.Right,{AlgorithmType:this.RightFormula});e.Data=a}if(s.ChartData.IsDayPeriod(e.Period,!1)||s.ChartData.IsMinutePeriod(e.Period,!1)){var i=e.GetPeriodData(e.Period);e.Data=i}}this.WindowIndex[t].BindData(this,t,e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeWindowIndexParam=function(t){this.WindowIndex[t].Index[0].Param+=1,this.WindowIndex[t].Index[1].Param+=1,this.UpdateWindowIndex(t)},this.OnDoubleClick=function(t,e,a){var i=new O;for(var r in this.ChartPaint){var n=this.ChartPaint[r];if(n.GetTooltipData(t,e,i))break}i.Data&&(a.data={Chart:this,Tooltip:i})},this.CancelAutoUpdate=function(){this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=null)},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol&&!this.IsDestroy){var e=this,a=h.MARKET_SUFFIX_NAME.GetMarketStatus(this.Symbol);if(0!=a&&3!=a){var i=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),i):2==a&&(this.AutoUpdateTimer=setTimeout((function(){s.ChartData.IsDayPeriod(e.Period,!0)?e.RequestRealtimeData():(s.ChartData.IsMinutePeriod(e.Period,!0)||s.ChartData.IsSecondPeriod(e.Period))&&e.RequestMinuteRealtimeData()}),i))}}},this.GetMaxPageSize=function(){var t=this.Frame.ChartBorder.GetWidth(),e=C.ZOOM_SEED[C.ZOOM_SEED.length-1][0]+C.ZOOM_SEED[C.ZOOM_SEED.length-1][1],a=parseInt(t/e)-8;return i.JSConsole.Chart.Log("[KLineChartContainer::GetMaxPageSize] width=".concat(t," barWidth=").concat(e," pageSize=").concat(a)),a},this.DragDownloadData=function(){var t=null;if(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!t)return!1;if(!(t.DataOffset>0))if(s.ChartData.IsMinutePeriod(this.Period,!0)||s.ChartData.IsSecondPeriod(this.Period)){if(i.JSConsole.Chart.Log("[KLineChartContainer.DragDownloadData] Minute:[Enable=".concat(this.DragDownload.Minute.Enable,", IsEnd=").concat(this.DragDownload.Minute.IsEnd,", Status=").concat(this.DragDownload.Minute.Status,", Period=").concat(this.Period,"]")),!this.DragDownload.Minute.Enable)return;if(this.DragDownload.Minute.IsEnd)return;if(0!=this.DragDownload.Minute.Status)return;this.RequestDragMinuteData()}else if(s.ChartData.IsDayPeriod(this.Period,!0)){if(i.JSConsole.Chart.Log("[KLineChartContainer.DragDownloadData] Day:[Enable=".concat(this.DragDownload.Minute.Enable,", IsEnd=").concat(this.DragDownload.Minute.IsEnd,", Status=").concat(this.DragDownload.Minute.Status,"]")),!this.DragDownload.Day.Enable)return;if(this.DragDownload.Day.IsEnd)return;if(0!=this.DragDownload.Day.Status)return;this.RequestDragDayData()}},this.RequestDragMinuteData=function(){var t=this;this.AutoUpdateEvent(!1,"KLineChartContainer::RequestDragMinuteData"),this.CancelAutoUpdate();var e=this.DragDownload.Minute;e.Status=1;var a=this.SourceData.Data[0],i={field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,enddate:a.Date,endtime:a.Time,count:t.MaxRequestMinuteDayCount,first:{date:a.Date,time:a.Time}};if(this.NetworkFilter){var n={Name:"KLineChartContainer::RequestDragMinuteData",Explain:"拖拽分钟|秒K线数据下载",Request:{Url:this.DragMinuteKLineApiUrl,Type:"POST",Data:i,Period:this.Period,Right:this.Right},DragDownload:e,Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(a){t.RecvDragMinuteData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragMinuteData"),t.AutoUpdate()})),1==n.PreventDefault)return}r.JSNetwork.HttpRequest({url:this.DragMinuteKLineApiUrl,data:i,method:"POST",dataType:"json",async:!0,success:function(a){t.RecvDragMinuteData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragMinuteData"),t.AutoUpdate()}})},this.RecvDragMinuteData=function(t){var e=t.data,a=y.JsonDataToMinuteHistoryData(e),i=this.GetHistoryDataCount();for(var r in a){var n=a[r];this.SourceData.Data.splice(r,0,n)}var o=new s.ChartData;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,!this.IsApiPeriod&&(s.ChartData.IsDayPeriod(o.Period,!1)||s.ChartData.IsMinutePeriod(o.Period,!1))){var h=o.GetPeriodData(o.Period);o.Data=h}this.UpdateMainData(o,i),this.BindInstructionIndexData(o);for(r=0;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.BindAllOverlayIndexData(o)},this.RequestDragDayData=function(){var t=this;this.AutoUpdateEvent(!1,"KLineChartContainer::RequestDragDayData"),this.CancelAutoUpdate();var e=this.DragDownload.Day;e.Status=1;var a=this.SourceData.Data[0],i={field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,enddate:a.Date,count:t.MaxRequestDataCount,first:{date:a.Date}};if(f.IFrameSplitOperator.IsNonEmptyArray(this.OverlayChartPaint)){i.overlay=[];for(var n=0;n<this.OverlayChartPaint.length;++n){var s=this.OverlayChartPaint[n];s.Symbol&&i.overlay.push({symbol:s.Symbol})}}if(this.NetworkFilter){var o={Name:"KLineChartContainer::RequestDragDayData",Explain:"拖拽日K数据下载",Request:{Url:this.DragKLineApiUrl,Type:"POST",Data:i,Period:this.Period,Right:this.Right},DragDownload:e,Self:this,PreventDefault:!1};if(this.NetworkFilter(o,(function(a){t.RecvDragDayData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragDayData"),t.AutoUpdate()})),1==o.PreventDefault)return}r.JSNetwork.HttpRequest({url:this.DragKLineApiUrl,data:i,method:"POST",dataType:"json",async:!0,success:function(a){t.RecvDragDayData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragDayData"),t.AutoUpdate()}})},this.RecvDragDayData=function(t){var e=t.data,a=y.JsonDataToHistoryData(e);if(!a||a.length<=0)this.DragDownload.Day.IsEnd=!0;else{var i=this.GetHistoryDataCount(),r=this.SourceData.Data[0];for(var n in a){var o=a[n];this.SourceData.Data.splice(n,0,o)}var h=new s.ChartData;if(h.Data=this.SourceData.Data,h.Period=this.Period,h.Right=this.Right,h.DataType=this.SourceData.DataType,h.Symbol=this.Symbol,!this.IsApiPeriod&&(s.ChartData.IsDayPeriod(h.Period,!1)||s.ChartData.IsMinutePeriod(h.Period,!1))){var l=h.GetPeriodData(h.Period);h.Data=l}this.UpdateMainData(h,i),this.UpdateOverlayDragDayData(e),this.BindInstructionIndexData(h);for(n=0;n<this.Frame.SubFrame.length;++n)this.BindIndexData(n,h);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.ReqeustKLineInfoData({FunctionName:"RecvDragDayData",StartDate:r.Date}),this.BindAllOverlayIndexData(h)}},this.UpdateOverlayDragDayData=function(t){if(f.IFrameSplitOperator.IsNonEmptyArray(this.OverlayChartPaint)){var e=t.overlay;if(f.IFrameSplitOperator.IsNonEmptyArray(e))for(var a=0;a<this.OverlayChartPaint.length;++a){var i=this.OverlayChartPaint[a];if(i.Symbol&&(i.MainData&&i.Status==s.OVERLAY_STATUS_ID.STATUS_FINISHED_ID)){for(var r=null,n=0;n<e.length;++n){var o=e[n];if(o.symbol==i.Symbol){r=o;break}}if(r){var l=y.JsonDataToHistoryData(r),u=i.SourceData,C=u.Data[0],D=null;for(n=l.length-1;n>=0;--n){var m=l[n];if(C.Date>m.Date){D=n;break}if(C.Date==m.Date){C.YClose=m.YClose,D=n-1;break}}if(!(null==D&&D<0)){for(n=0;n<l.length&&n<=D;++n){m=l[n];u.Data.splice(n,0,m)}var c=new s.ChartData;if(c.Data=u.Data,c.Period=this.Period,c.Right=this.Right,c.DataType=0,c.Right>0&&h.MARKET_SUFFIX_NAME.IsSHSZStockA(r.symbol)&&!this.IsApiPeriod){var S=c.GetRightData(c.Right,{AlgorithmType:this.RightFormula});c.Data=S}var I=this.SourceData.GetOverlayData(c.Data,this.IsApiPeriod);if(c.Data=I,s.ChartData.IsDayPeriod(c.Period,!1)&&!this.IsApiPeriod){var d=c.GetPeriodData(c.Period);c.Data=d}i.Data=c}}}}}},this.SetCustomVerical=function(t,e){if(this.Frame&&!(t>=this.Frame.SubFrame.length)){var a=this.Frame.SubFrame[t];a.Frame&&(a.Frame.CustomVerticalInfo=e)}},this.OnSize=function(){if(this.Frame&&this.Frame.OnSize){var t=this.Frame.OnSize();this.Frame.SetSizeChage(!0),t.Changed&&(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin()),this.Draw()}},this.AddOverlayIndex=function(t){var e=this.CreateOverlayWindowsIndex(t);if(e){var a=this.ChartPaint[0].Data;this.BindOverlayIndexData(e,t.WindowIndex,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateOverlayWindowsIndex=function(t){var e=this,a=t.IndexName,i=t.WindowIndex,r=null,n=null,s=null;if(t.API)r=t.API;else if(t.Script)n={Script:t.Script,ID:t.indexName,Name:t.indexName},t.Name&&(n.Name=t.Name);else{var o=new u.JSCommonIndexScript.JSIndexScript;if(n=o.Get(a),!n&&(s=R.Get(a),!s))return console.warn("[KLineChartContainer::CreateOverlayIndex] can not find index[".concat(a,"]")),null}var h=this.Frame.SubFrame[i];h.Interval=this.OverlayIndexFrameWidth;var l=new M;t.Identify&&(l.Identify=t.Identify);var C=this.CreateOverlayFrame();if(C.Canvas=this.Canvas,C.MainFrame=h.Frame,C.ChartBorder=h.Frame.ChartBorder,f.IFrameSplitOperator.IsBool(t.IsShareY)&&(C.IsShareY=t.IsShareY),f.IFrameSplitOperator.IsBool(t.IsCalculateYMaxMin)&&(C.IsCalculateYMaxMin=t.IsCalculateYMaxMin),C.YSplitOperator=new f.FrameSplitY,C.YSplitOperator.LanguageID=this.LanguageID,C.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),C.YSplitOperator.Frame=C,C.YSplitOperator.ChartBorder=C.ChartBorder,C.YSplitOperator.SplitCount=h.Frame.YSplitOperator.SplitCount,C.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},C.YSplitOperator.OverlayIdentify=l.Identify,l.Frame=C,r){var D=new c.APIScriptIndex(r.Name,r.Script,r.Args,t,!0);D.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},l.Script=D}else if(n){var m=n.Args;t.Args&&(m=t.Args);var S={Name:n.Name,Script:n.Script,Args:m,ID:a,KLineType:n.KLineType,YSpecificMaxMin:n.YSpecificMaxMin,YSplitScale:n.YSplitScale,FloatPrecision:n.FloatPrecision,Condition:n.Condition,OutName:n.OutName},I=new c.OverlayScriptIndex(S.Name,S.Script,S.Args,S);I.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},l.Script=I}else{I=s.Create();I.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},I.Create(this,i),l.Script=I}return h.OverlayIndex.push(l),l},this.DeleteOverlayWindowsIndex=function(t){this.DeleteOverlayIndex(t,null)&&(this.Frame.ResetXYSplit(!0),this.Draw())}}function w(t){this.newMethod=p,this.newMethod(t),delete this.newMethod,this.ClassName="MinuteChartContainer",this.WindowIndex=new Array,this.Symbol,this.Name,this.SourceData,this.OverlaySourceData,this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer=null,this.TradeDate=0,this.LoadDataSplashTitle="下载分钟数据",this.UpdateUICallback,this.DayCount=1,this.DayData,this.MinuteApiUrl=S.g_JSChartResource.Domain+"/API/Stock",this.HistoryMinuteApiUrl=S.g_JSChartResource.Domain+"/API/StockMinuteData",this.ontouchstart=function(t){var e=this;if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsOnTouch=!0;var a=this;if(0!=a.DragMode&&this.IsPhoneDragging(t)){if(this.TryClickLock||this.TryClickIndexTitle){var r=this.GetToucheData(t,this.IsForceLandscape),n=r[0].clientX,o=r[0].clientY;if(this.TryClickLock&&this.TryClickLock(n,o))return;if(this.TryClickIndexTitle&&this.TryClickIndexTitle(n,o))return}this.ClearTouchTimer();var h={Click:{},LastMove:{}};r=this.GetToucheData(t,a.IsForceLandscape);h.Click.X=r[0].clientX,h.Click.Y=r[0].clientY,h.LastMove.X=r[0].clientX,h.LastMove.Y=r[0].clientY;var l=function(){if(!0===e.ChartCorssCursor.IsShow){var i=h.Click.X,r=h.Click.Y;a.IsForceLandscape&&(r=a.UIElement.Height-h.Click.Y),a.OnMouseMove(i,r,t)}};this.EnableZoomIndexWindow&&(this.PhoneDBClick.AddTouchStart(r[0].clientX,r[0].clientY,Date.now()),i.JSConsole.Chart.Log("[MinuteChartContainer::OnTouchStart] PhoneDBClick ",this.PhoneDBClick)),1==this.EnableScrollUpDown&&(this.TouchTimer=setTimeout((function(){e.MouseDrag=null,l()}),this.PressTime)),this.MouseDrag=h,this.PhoneTouchInfo={Start:{X:r[0].clientX,Y:r[0].clientY},End:{X:r[0].clientX,Y:r[0].clientY}},0==this.EnableScrollUpDown&&l(),this.TouchEvent({EventID:s.JSCHART_EVENT_ID.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},t)}}},this.ontouchmove=function(t){var e=this;if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=this.MouseDrag,i=this.GetToucheData(t,this.IsForceLandscape);if(!0===this.ChartCorssCursor.IsShow&&this.IsPhoneDragging(t)&&null==a){var r=i[0].clientX,n=i[0].clientY;if(this.LastMovePoint={X:r,Y:n},this.DrawMoveTimer)return;this.DrawMoveTimer=setTimeout((function(){e.LastMovePoint&&(e.OnMouseMove(e.LastMovePoint.X,e.LastMovePoint.Y,t),e.DrawMoveTimer=null)}),this.DrawMoveWaitTime)}if(null!=a){this.ClearTouchTimer(),this.MouseDrag=null;r=i[0].clientX,n=i[0].clientY;this.OnMouseMove(r,n,t)}this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=i[0].clientX,this.PhoneTouchInfo.End.Y=i[0].clientY)}},this.Create=function(t){var e=this;for(var a in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new f.HQMinuteTimeStringFormat,this.ChartCorssCursor.StringFormatX.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartCorssCursor.StringFormatY=f.g_DivTooltipDataForamt.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartSplashPaint=new D.ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SplashTitle=this.LoadDataSplashTitle,this.ChartSplashPaint.HQChart=this,this.Frame=new L,this.Frame.ChartBorder=new E,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.Frame.ZoomStartWindowIndex=2,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var i=new I.DynamicChartTitlePainting;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.LanguageID=this.LanguageID,i.GetEventCallback=function(t){return e.GetEventCallback(t)},this.TitlePaint.push(i)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame,this.ChartCorssCursor.StringFormatY.Frame=this.Frame},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new E;i.UIElement=this.UIElement;var r=new C.MinuteFrame;r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,a<2&&(r.ChartBorder.TitleHeight=0),r.XPointCount=243;var n=[9,8,7,6,5,4,3,2,1];for(var s in r.HorizontalMax=n[0],r.HorizontalMin=n[n.length-1],0==a?(r.YSplitOperator=new f.FrameSplitMinutePriceY,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)}):(r.YSplitOperator=new f.FrameSplitY,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)}),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new f.FrameSplitMinuteX,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,a!=t-1&&(r.XSplitOperator.ShowText=!1),r.XSplitOperator.Operator(),n)r.HorizontalInfo[s]=new f.CoordinateInfo,r.HorizontalInfo[s].Value=n[s],0==a&&s==r.HorizontalMin||(r.HorizontalInfo[s].Message[1]=n[s].toString(),r.HorizontalInfo[s].Font="14px 微软雅黑");var o=new N;o.Frame=r,o.Height=0==a?20:10,this.Frame.SubFrame[a]=o}},this.CreateSubFrameItem=function(t){var e=this,a=new E;a.UIElement=this.UIElement;var i=new C.MinuteFrame;i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=t,i.XPointCount=243,t>=2&&(this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal));var r=[9,8,7,6,5,4,3,2,1];i.HorizontalMax=r[0],i.HorizontalMin=r[r.length-1],i.YSplitOperator=new f.FrameSplitY,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new f.FrameSplitMinuteX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,i.XSplitOperator.ShowText=!1,i.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},i.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)};var n=this.Frame.SubFrame[0].Frame.XPointCount;for(var s in i.XPointCount=n,i.Data=this.ChartPaint[0].Data,r)i.HorizontalInfo[s]=new f.CoordinateInfo,i.HorizontalInfo[s].Value=r[s],i.HorizontalInfo[s].Message[1]=r[s].toString(),i.HorizontalInfo[s].Font="14px 微软雅黑";var o=new N;return o.Frame=i,o.Height=10,o},this.UpdateXShowText=function(){for(var t=!0,e=this.Frame.SubFrame.length-1;e>=0;--e){var a=this.Frame.SubFrame[e].Frame,i=this.Frame.SubFrame[e];t?(a.XSplitOperator.ShowText=!0,i.Height>0&&(t=!1)):a.XSplitOperator.ShowText=!1}},this.DeleteIndexPaint=function(t,e){for(var a=new Array,i=0;i<this.ChartPaint.length;++i){var r=this.ChartPaint[i];0==i||r.ChartFrame!=this.Frame.SubFrame[t].Frame?a.push(r):!0===e&&r&&r.OnDestroy&&r.OnDestroy()}var n=this.Frame.SubFrame[t].Frame;n.YSpecificMaxMin=null,n.IsLocked=!1,n.YSplitOperator.SplitType=n.YSplitOperator.DefaultSplitType,this.ChartPaint=a;var s=t+1;this.TitlePaint[s].Data=[],this.TitlePaint[s].Title=null},this.CreateStockInfo=function(){this.ExtendChartPaint[0]=new StockInfoExtendChartPaint,this.ExtendChartPaint[0].Canvas=this.Canvas,this.ExtendChartPaint[0].ChartBorder=this.Frame.ChartBorder,this.ExtendChartPaint[0].ChartFrame=this.Frame,this.Frame.ChartBorder.Right=300},this.CreateMainKLine=function(){var t=new D.ChartMinutePriceLine;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="Minute-Line",t.Color=S.g_JSChartResource.Minute.PriceColor,t.AreaColor=S.g_JSChartResource.Minute.AreaPriceColor,this.ChartPaint[0]=t;var e=new D.ChartMinutePriceLine;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Minute-Average-Line",e.Color=S.g_JSChartResource.Minute.AvPriceColor,e.IsDrawArea=!1,this.ChartPaint[1]=e;var a=new D.ChartMinuteVolumBar;a.Color=S.g_JSChartResource.Minute.VolBarColor,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,a.ChartFrame=this.Frame.SubFrame[1].Frame,a.Name="Minute-Vol-Bar",this.ChartPaint[2]=a;var i=new D.ChartSubLine;i.Color=S.g_JSChartResource.Minute.PriceColor,i.Canvas=this.Canvas,i.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,i.ChartFrame=this.Frame.SubFrame[1].Frame,i.Name="Minute-Position-Line",this.ChartPaint[3]=i,this.TitlePaint[0]=new I.DynamicMinuteTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].LanguageID=this.LanguageID;var r=new D.ChartOverlayMinutePriceLine;r.Canvas=this.Canvas,r.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,r.ChartFrame=this.Frame.SubFrame[0].Frame,r.Name="Overlay-Minute",this.OverlayChartPaint[0]=r},this.ChangeScriptIndex=function(t,e){this.DeleteIndexPaint(t,!0),this.WindowIndex[t]=new c.ScriptIndex(e.Name,e.Script,e.Args,e);var a=this.SourceData;this.BindIndexData(t,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeAPIIndex=function(t,e){this.DeleteIndexPaint(t,!0);var a=e.API;this.WindowIndex[t]=new c.APIScriptIndex(a.Name,a.Script,a.Args,e);var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(!(this.Frame.SubFrame.length<3)){if(a&&a.API)return this.ChangeAPIIndex(t,a);var i=new u.JSCommonIndexScript.JSIndexScript,r=i.Get(e);if(r){t<2&&(t=2),t>=this.Frame.SubFrame.length&&(t=2);var n={Name:r.Name,Script:r.Script,Args:r.Args,ID:e,KLineType:r.KLineType,YSpecificMaxMin:r.YSpecificMaxMin,YSplitScale:r.YSplitScale,FloatPrecision:r.FloatPrecision,Condition:r.Condition,StringFormat:r.StringFormat};return a&&(a.FloatPrecision>=0&&(n.FloatPrecision=a.FloatPrecision),a.StringFormat>0&&(n.StringFormat=a.StringFormat),a.Args&&(n.Args=a.Args),f.IFrameSplitOperator.IsNumber(a.YSplitType)&&(n.YSplitType=a.YSplitType)),this.ChangeScriptIndex(t,n)}}},this.ChangeIndexTemplate=function(t){var e=this;if(Array.isArray(t.Windows)){var a=t.Windows.length,i=this.Frame.SubFrame.length;a+=2;var r=null;f.IFrameSplitOperator.IsNumber(t.DayCount)&&t.DayCount!=this.DayCount&&(r=t.DayCount);for(var n=null!=r,s=2;s<i;++s){this.DeleteIndexPaint(s);var o=this.Frame.SubFrame[s];o.YSpecificMaxMin=null,o.IsLocked=!1,o.YSplitScale=null}if(i>a)this.Frame.SubFrame.splice(a,i-a),this.WindowIndex.splice(a,i-a);else for(s=i;s<a;++s){var h=this.CreateSubFrameItem(s);this.Frame.SubFrame[s]=h;var l=new I.DynamicChartTitlePainting;l.Frame=this.Frame.SubFrame[s].Frame,l.Canvas=this.Canvas,l.LanguageID=this.LanguageID,l.GetEventCallback=function(t){return e.GetEventCallback(t)},l.SelectedChart=this.SelectedChart,this.TitlePaint[s+1]=l}var C=new u.JSCommonIndexScript.JSIndexScript;for(s=0;s<a;++s){var D=s,m=null,S=null;t.Frame&&t.Frame.length>s&&(S=t.Frame[D]),D>=2&&(m=t.Windows[D-2]);var d=D+1;if(this.TitlePaint[d].Data=[],this.TitlePaint[d].Title=null,m)if(m.Script)this.WindowIndex[D]=new c.ScriptIndex(m.Name,m.Script,m.Args,m);else if(m.API){var T=m.API;this.WindowIndex[D]=new c.APIScriptIndex(T.Name,T.Script,T.Args,m)}else{var p=m.Index,v=R.Get(p);if(v)this.WindowIndex[D]=v.Create(),this.CreateWindowIndex(D);else{var F=C.Get(p);if(F){var g=F.Args;m.Args&&(g=m.Args);var A={Name:F.Name,Script:F.Script,Args:g,ID:p,KLineType:F.KLineType,YSpecificMaxMin:F.YSpecificMaxMin,YSplitScale:F.YSplitScale,FloatPrecision:F.FloatPrecision,Condition:F.Condition,OutName:F.OutName};m.TitleFont&&(A.TitleFont=m.TitleFont),this.WindowIndex[D]=new c.ScriptIndex(A.Name,A.Script,A.Args,A)}}}this.SetSubFrameAttribute(this.Frame.SubFrame[D],m,S)}for(s=0;s<this.Frame.SubFrame.length;++s){m=this.Frame.SubFrame[s].Frame;s==this.Frame.SubFrame.length-1?m.XSplitOperator.ShowText=!0:m.XSplitOperator.ShowText=!1}if(n)this.Frame.SetSizeChage(!0),null!=r&&this.ChangeDayCount(r);else{var E=this.SourceData;for(s=0;s<a;++s)this.BindIndexData(s,E);this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}}},this.RemoveIndexWindow=function(t){if(i.JSConsole.Chart.Log("[MinuteChartContainer::RemoveIndexWindow] remove id",t),!(t<2)&&this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t,!0),this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e].Frame;e==this.Frame.SubFrame.length-1?a.XSplitOperator.ShowText=!0:a.XSplitOperator.ShowText=!1,a.Identify=e}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}},this.ClearIndexPaint=function(){if(this.Frame&&this.Frame.SubFrame)for(var t=2;t<this.Frame.SubFrame.length;++t)t>=2&&this.DeleteIndexPaint(t,!0)},this.ChangeSymbol=function(t){this.Symbol=t,this.CancelAutoUpdate(),this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.ClearIndexPaint(),this.RequestData()},this.ChangeDayCount=function(t){t<0||t>10||(this.DayCount=t,this.CancelAutoUpdate(),this.ClearIndexPaint(),this.RequestData())},this.OverlaySymbol=function(t,e){var a=this.OverlayChartPaint[0];return!!a.MainData&&(a.Symbol=t,e&&e.Color&&(a.Color=e.Color),this.DayCount<=1?this.RequestOverlayMinuteData():this.RequestOverlayHistoryMinuteData(),!0)},this.TryClickLock=function(t,e){for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a];if(i.Frame.IsLocked&&i.Frame.LockPaint){var r=new O;if(i.Frame.LockPaint.GetTooltipData(t,e,r))return r.HQChart=this,r.Data.Callback&&r.Data.Callback(r),!0}}return!1},this.RequestData=function(){this.DayCount<=1?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.RecvMinuteDataEvent=function(){if(this.mapEvent.has(s.JSCHART_EVENT_ID.RECV_MINUTE_DATA)){var t=this.mapEvent.get(s.JSCHART_EVENT_ID.RECV_MINUTE_DATA),e={MinuteData:this.SourceData,Stock:{Symbol:this.Symbol,Name:this.Name}};t.Callback(t,e,this)}},this.RequestHistoryMinuteData=function(){var t=this;if(this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.NetworkFilter){var e={Name:"MinuteChartContainer::RequestHistoryMinuteData",Explain:"多日分时数据",Request:{Url:t.HistoryMinuteApiUrl,Data:{daycount:t.DayCount,symbol:t.Symbol},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)})),1==e.PreventDefault)return}r.JSNetwork.HttpRequest({url:t.HistoryMinuteApiUrl,data:{symbol:t.Symbol,daycount:t.DayCount},method:"post",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)}})},this.RecvHistoryMinuteData=function(t){var e=t.data;0==e.code?(this.DayData=w.JsonDataToMinuteDataArray(e),this.Symbol=e.symbol,this.Name=e.name,f.IFrameSplitOperator.IsNonEmptyArray(this.DayData)&&this.CaclutateLimitPrice(this.DayData[0].YClose,e.data[0].limitprice),this.UpdateHistoryMinuteUI(),this.RecvMinuteDataEvent(),this.RequestOverlayHistoryMinuteData(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvHistoryMinuteData",this),this.AutoUpdate()):i.JSConsole.Chart.Log("[MinuteChartContainer::RecvHistoryMinuteData] failed.",e)},this.CaclutateLimitPrice=function(t,e){if(this.LimitPrice=null,e&&e.max>0&&e.min>0)this.LimitPrice={Max:e.max,Min:e.min};else{var a=h.MARKET_SUFFIX_NAME.GetLimitPriceRange(this.Symbol,this.Name);a?t<=0||(this.LimitPrice={Max:t*(1+a.Max),Min:t*(1+a.Min)},i.JSConsole.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] ".concat(this.Symbol," yClose:").concat(t," max:").concat(this.LimitPrice.Max," min:").concat(this.LimitPrice.Min)),this.LimitPrice.Max=parseFloat(this.LimitPrice.Max.toFixed(2)),this.LimitPrice.Min=parseFloat(this.LimitPrice.Min.toFixed(2)),i.JSConsole.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] ".concat(this.Symbol," tofixed(2) max:").concat(this.LimitPrice.Max," min:").concat(this.LimitPrice.Min))):i.JSConsole.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] ".concat(this.Symbol," no limit price."))}},this.UpdateHistoryMinuteUI=function(){var t=this.HistoryMinuteDataToArray(this.DayData),e=new s.ChartData;e.Data=t,this.SourceData=e,this.TradeDate=this.DayData[0].Date;var a=this.Symbol.toUpperCase(),i=this.DayData[0].YClose,r=h.MARKET_SUFFIX_NAME.IsFutures(a);if(f.IFrameSplitOperator.IsNumber(this.DayData[0].YClearing)&&r&&(i=this.DayData[0].YClearing),this.BindMainData(e,i),this.Frame.SubFrame.length>2){var n=new s.ChartData;n.Data=t;for(var o=2;o<this.Frame.SubFrame.length;++o)this.BindIndexData(o,n)}for(var l in this.Frame.SubFrame){var u=this.Frame.SubFrame[l];u.Frame.XSplitOperator.Symbol=this.Symbol,u.Frame.XSplitOperator.DayCount=this.DayData.length,u.Frame.XSplitOperator.DayData=this.DayData,u.Frame.XSplitOperator.Operator(),u.Frame.YSplitOperator.Symbol=this.Symbol}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol,this.TitlePaint[0].IsShowDate=!0,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.HistoryMinuteDataToArray=function(t){for(var e=[],a=t.length-1;a>=0;--a){var i=t[a];for(var r in i.Data)e.push(i.Data[r])}return e},this.UpdateLatestMinuteData=function(t,e){for(var a in this.DayData){var i=this.DayData[a];if(i.Date===e){i.Data=t;break}}},this.RequestMinuteData=function(){var t=this,e=["name","symbol","yclose","open","price","high","low","vol","amount","date","time","minute","minutecount"],a=this.Symbol.toUpperCase();if(h.MARKET_SUFFIX_NAME.IsChinaFutures(a)&&(e.push("clearing"),e.push("yclearing")),this.NetworkFilter){var i={Name:"MinuteChartContainer::RequestMinuteData",Explain:"最新分时数据",Request:{Url:t.MinuteApiUrl,Data:{field:e,symbol:[t.Symbol]},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteData(e)})),1==i.PreventDefault)return}r.JSNetwork.HttpRequest({url:this.MinuteApiUrl,data:{field:e,symbol:[this.Symbol],start:-1},method:"post",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteData(e)}})},this.RecvMinuteData=function(t){var e=w.JsonDataToMinuteData(t.data);if(this.DayCount>1)return this.UpdateLatestMinuteData(e,t.data.stock[0].date),this.UpdateHistoryMinuteUI(),this.RecvMinuteDataEvent(),this.RequestOverlayMinuteData(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvMinuteData",this),void this.AutoUpdate();var a=new s.ChartData;a.Data=e,this.TradeDate=t.data.stock[0].date,this.SourceData=a,this.Symbol=t.data.stock[0].symbol,this.Name=t.data.stock[0].name;var i=t.data.stock[0].yclose,r=this.Symbol.toUpperCase(),n=h.MARKET_SUFFIX_NAME.IsFutures(r);t.data.stock[0].yclearing&&n&&(i=t.data.stock[0].yclearing),this.CaclutateLimitPrice(i,t.data.stock[0].limitprice);var o={High:t.data.stock[0].high,Low:t.data.stock[0].low};for(var l in this.BindMainData(a,i,o),this.Frame.SubFrame){var u=this.Frame.SubFrame[l];u.Frame.XSplitOperator.Symbol=this.Symbol,u.Frame.XSplitOperator.DayCount=1,u.Frame.XSplitOperator.Operator(),u.Frame.YSplitOperator.Symbol=this.Symbol}if(this.Frame.SubFrame.length>2){var C=new s.ChartData;C.Data=e;for(var D=2;D<this.Frame.SubFrame.length;++D)this.BindIndexData(D,C)}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol;var m=this.GetChartMinuteInfo();m&&(m.SourceData=this.SourceData),this.RecvMinuteDataEvent(),this.RequestMinuteInfoData(),this.RequestOverlayMinuteData(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvMinuteData",this),this.AutoUpdate()},this.RequestOverlayMinuteData=function(){if(this.OverlayChartPaint.length){var t=this.OverlayChartPaint[0].Symbol;if(t){var e=this,a=this.TradeDate;if(this.NetworkFilter){var i={Name:"MinuteChartContainer::RequestOverlayMinuteData",Explain:"叠加股票最新分时数据",Request:{Url:e.HistoryMinuteApiUrl,Data:{days:[a],symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvOverlayMinuteData(t)})),1==i.PreventDefault)return}r.JSNetwork.HttpRequest({url:e.HistoryMinuteApiUrl,data:{symbol:t,days:[a]},method:"post",dataType:"json",success:function(t){e.RecvOverlayMinuteData(t)}})}}},this.RecvOverlayMinuteData=function(t){var e,a=t.data,i=w.JsonDataToMinuteDataArray(a),r=null;if(this.DayCount>1){if(i.length<=0)return;var n=i[0];for(var o in this.OverlaySourceData){var h=this.OverlaySourceData[o];if(h.Date==n.Date){this.OverlaySourceData[o]=n;var l=this.HistoryMinuteDataToArray(this.OverlaySourceData);r=new s.ChartData;r.Data=l,e=n.YClose;break}}if(null==r)return}else r=i.length>0?i[0]:new s.ChartData,e=r.YClose;this.OverlayChartPaint[0].Data=r,this.OverlayChartPaint[0].Title=a.name,this.OverlayChartPaint[0].Symbol=a.symbol,this.OverlayChartPaint[0].YClose=e,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvOverlayMinuteData",this)},this.RequestOverlayHistoryMinuteData=function(){if(this.OverlayChartPaint.length){var t=this.OverlayChartPaint[0].Symbol;if(t){var e=this,a=[];for(var i in this.DayData){var n=this.DayData[i];a.push(n.Date)}if(!(a.length<=0)){if(this.NetworkFilter){var s={Name:"MinuteChartContainer::RequestOverlayHistoryMinuteData",Explain:"叠加股票多日分时数据",Request:{Url:e.HistoryMinuteApiUrl,Data:{days:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(t){e.RecvOverlayHistoryMinuteData(t)})),1==s.PreventDefault)return}r.JSNetwork.HttpRequest({url:e.HistoryMinuteApiUrl,data:{symbol:t,days:a},method:"post",dataType:"json",async:!0,success:function(t){e.RecvOverlayHistoryMinuteData(t)}})}}}},this.RecvOverlayHistoryMinuteData=function(t){var e=t.data,a=w.JsonDataToMinuteDataArray(e),i=[];for(var r in this.DayData){var n=this.DayData[r],o=!1;for(var h in a)if(n.Date==a[h].Date){i.push(a[r]),o=!0;break}if(!o){var l=new s.ChartData;l.Date=n.Date}}this.OverlaySourceData=i;var u=this.HistoryMinuteDataToArray(i),C=new s.ChartData;C.Data=u;var D=i[0].YClose;this.OverlayChartPaint[0].Data=C,this.OverlayChartPaint[0].Title=e.name,this.OverlayChartPaint[0].Symbol=e.symbol,this.OverlayChartPaint[0].YClose=D,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvOverlayHistoryMinuteData",this)},this.CancelAutoUpdate=function(){this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=null)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol&&!this.IsDestroy){var t=this,e=h.MARKET_SUFFIX_NAME.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),a):2==e&&(this.AutoUpdateTimer=setTimeout((function(){t.RequestMinuteData()}),a))}}},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate=!1},this.BindIndexData=function(t,e){this.WindowIndex[t]&&("function"!=typeof this.WindowIndex[t].RequestData?"function"!=typeof this.WindowIndex[t].ExecuteScript?this.WindowIndex[t].BindData(this,t,e):this.WindowIndex[t].ExecuteScript(this,t,e):this.WindowIndex[t].RequestData(this,t,e))},this.BindMainData=function(t,e,a){var i=new s.ChartData;i.Data=t.GetClose(),this.ChartPaint[0].Data=i,this.ChartPaint[0].YClose=e,this.ChartPaint[0].NotSupportMessage=null,this.Frame.SubFrame[0].Frame.YSplitOperator.YClose=e,this.Frame.SubFrame[0].Frame.YSplitOperator.Data=i,i=new s.ChartData,i.Data=t.GetMinuteAvPrice(),this.ChartPaint[1].Data=i;var r=this.Symbol.toUpperCase();(h.MARKET_SUFFIX_NAME.IsForeignExchange(r)||h.MARKET_SUFFIX_NAME.IsShowAvPrice&&!h.MARKET_SUFFIX_NAME.IsShowAvPrice(r))&&(this.ChartPaint[1].Data=null),this.Frame.SubFrame[0].Frame.YSplitOperator.AverageData=i,this.Frame.SubFrame[0].Frame.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,this.Frame.SubFrame[0].Frame.YSplitOperator.LimitPrice=this.LimitPrice,a&&(this.Frame.SubFrame[0].Frame.YSplitOperator.High=a.High,this.Frame.SubFrame[0].Frame.YSplitOperator.Low=a.Low),this.ChartPaint[2].Data=t,this.ChartPaint[2].YClose=e;r=this.Symbol.toUpperCase();var n=h.MARKET_SUFFIX_NAME.IsChinaFutures(r),o=h.MARKET_SUFFIX_NAME.IsSHO(r),l=h.MARKET_SUFFIX_NAME.IsSZO(r);this.ChartPaint[3].Data.Data=n||o||l?t.GetPosition():null,this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].YClose=e,this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.YClose=e,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data),this.ExtendChartPaint[0]&&(this.ExtendChartPaint[0].Symbol=this.Symbol,this.ExtendChartPaint[0].Name=this.Name),this.OverlayChartPaint[0].MainData=this.ChartPaint[0].Data,this.OverlayChartPaint[0].MainYClose=e},this.GetChartPaint=function(t){var e=new Array;for(var a in this.ChartPaint)if(!(a<3)){var i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return e},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.CreateExtendChart=function(t,e){var a;switch(t){case"MinuteTooltip":return a=new m.MinuteTooltipPaint,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return null}},this.SetMinuteInfo=function(t,e){for(var a in this.ChartInfo=[],t){var i=o.JSMinuteInfoMap.Get(t[a]);if(i){var r=i.Create();this.ChartInfo.push(r)}}1==e&&this.RequestMinuteInfoData()},this.GetChartMinuteInfo=function(){return this.ChartInfoPaint},this.CreateMinuteInfo=function(t){var e=new D.ChartMinuteInfo;return e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.ChartMinutePrice=this.ChartPaint[0],t&&e.SetOption&&e.SetOption(t),this.ChartInfoPaint=e,e},this.RequestMinuteInfoData=function(){if(!(this.ChartInfo.length<=0)){var t=this.GetChartMinuteInfo();for(var e in t||(t=this.CreateMinuteInfo(null)),t.SourceData=this.SourceData,this.ChartInfo)this.ChartInfo[e].RequestData(this)}},this.UpdataChartInfo=function(){var t=this.GetChartMinuteInfo();if(t){var e=new Map;for(var a in this.ChartInfo){var i=this.ChartInfo[a].Data;for(var r in i){var n=i[r],s="".concat(n.Date," ").concat(n.Time);e.has(s)?e.get(s).Data.push(n):e.set(s,{Data:new Array(n)})}}t.Data=e}},this.TryClickIndexTitle=function(t,e){for(var a=0;a<this.TitlePaint.length;++a){var r=this.TitlePaint[a];if(r.IsClickTitle&&r.IsClickTitle(t,e)){var n={Point:{X:t,Y:e},Title:r.Title,FrameID:r.Frame.Identify};i.JSConsole.Chart.Log("[MinuteChartContainer::TryClickIndexTitle] click title ",n);var o=this.GetEvent(s.JSCHART_EVENT_ID.ON_CLICK_INDEXTITLE);return o&&o.Callback&&o.Callback(o,n,this),!0}}return!1}}function b(t){this.newMethod=w,this.newMethod(t),delete this.newMethod,this.HistoryMinuteApiUrl="https://opensourcecache.zealink.com/cache/minuteday/day/",this.CreateMainKLine=function(){var t=new D.ChartMinutePriceLine;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="Minute-Line",t.Color=S.g_JSChartResource.Minute.PriceColor,this.ChartPaint[0]=t;var e=new D.ChartLine;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Minute-Average-Line",e.Color=S.g_JSChartResource.Minute.AvPriceColor,this.ChartPaint[1]=e;e=new D.ChartMinuteVolumBar;e.Color=S.g_JSChartResource.Minute.VolBarColor,e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[1].Frame,e.Name="Minute-Vol-Bar",this.ChartPaint[2]=e,this.TitlePaint[0]=new I.DynamicMinuteTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].IsShowDate=!0},this.ChangeTradeDate=function(t){t&&(this.TradeDate=t,this.RequestData())},this.RequestData=function(){var t=new Date,e=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate();e==this.TradeDate?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.RequestHistoryMinuteData=function(){var t=this,e=this.HistoryMinuteApiUrl+this.TradeDate.toString()+"/"+this.Symbol+".json";r.JSNetwork.HttpRequest({url:e,method:"get",dataType:"json",success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)},error:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteError(e)}})},this.RecvHistoryMinuteError=function(t){if(404==t.status){var e=new s.ChartData;for(var a in this.SourceData=e,this.ChartPaint)this.ChartPaint[a].Data=e,0==a&&(this.ChartPaint[a].NotSupportMessage="没有权限访问!");this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=null,this.Draw()}},this.RecvHistoryMinuteData=function(t){if(200!=t.statusCode){var e=new s.ChartData;for(var a in this.SourceData=e,this.ChartPaint)this.ChartPaint[a].Data=e,0==a&&(this.ChartPaint[a].NotSupportMessage="没有权限访问!");return this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=null,void this.Draw()}var i=t.data,r=b.JsonDataToMinuteData(i);e=new s.ChartData;if(e.Data=r,this.TradeDate=i.date,this.SourceData=e,this.Symbol=i.symbol,this.Name=i.name,this.BindMainData(e,i.day.yclose),this.Frame.SubFrame.length>2){var n=new s.ChartData;n.Data=r;for(a=2;a<this.Frame.SubFrame.length;++a)this.BindIndexData(a,n)}this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function B(t){this.newMethod=y,this.newMethod(t),delete this.newMethod,this.ClassName="CustomKLineChartContainer",this.ChangeRight=null,this.LoadDataSplashTitle="计算指数数据",this.CustomKLineApiUrl=S.g_JSChartResource.Domain+"/API/IndexCalculate",this.CustomStock,this.QueryDate={Start:20180101,End:20180627},this.RequestHistoryData=function(){var t=this;this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),r.JSNetwork.HttpRequest({url:this.CustomKLineApiUrl,data:{stock:t.CustomStock,Name:t.Symbol,date:{startdate:t.QueryDate.Start,enddate:t.QueryDate.End}},method:"POST",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e)}})},this.RecvHistoryData=function(t){var e=t.data,a=y.JsonDataToHistoryData(e),i=new s.ChartData;i.Data=a,i.DataType=0,i.Symbol=e.symbol;var r=new s.ChartData;if(r.Data=a,r.Right=0,r.Period=this.Period,r.DataType=0,r.Symbol=e.symbol,s.ChartData.IsDayPeriod(this.Period,!1)){var n=i.GetPeriodData(r.Period);r.Data=n}this.SourceData=i,this.Name=e.name,this.BindMainData(r,this.PageSize);for(var o=0;o<this.Frame.SubFrame.length;++o)this.BindIndexData(o,r);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback("RecvHistoryData",this)}}function P(t){this.newMethod=y,this.newMethod(t),delete this.newMethod,this.ClassName="KLineChartHScreenContainer",this.OnMouseMove=function(t,e,a){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e),this.DrawDynamicInfo()},this.ontouchstart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this;if(0!=e.DragMode)if(e.IsOnTouch=!0,e.PhonePinch=null,this.IsPhoneDragging(t)){if(e.TryClickLock||this.TryClickIndexTitle){var a=this.GetToucheData(t),i=a[0].clientX,r=a[0].clientY;if(e.TryClickLock&&e.TryClickLock(i,r))return;if(e.TryClickIndexTitle&&e.TryClickIndexTitle(i,r))return}null!=this.TouchTimer&&clearTimeout(this.TouchTimer),1==this.ChartCorssCursor.IsShow&&(this.TouchTimer=setTimeout((function(){if(n.Click.X==n.LastMove.X&&n.Click.Y==n.LastMove.Y){e.MouseDrag;e.MouseDrag=null;var a=n.Click.X,i=n.Click.Y;e.OnMouseMove(a,i,t)}}),e.PressTime));var n={Click:{},LastMove:{}};a=this.GetToucheData(t);n.Click.X=a[0].clientX,n.Click.Y=a[0].clientY,n.LastMove.X=a[0].clientX,n.LastMove.Y=a[0].clientY,e.MouseDrag=n,this.PhoneTouchInfo={Start:{X:a[0].clientX,Y:a[0].clientY},End:{X:a[0].clientX,Y:a[0].clientY}},this.TouchEvent({EventID:s.JSCHART_EVENT_ID.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},t)}else if(this.IsPhonePinching(t)){var o={Start:{},Last:{}};a=this.GetToucheData(t);o.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},o.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},e.PhonePinch=o}}},this.ontouchmove=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this.GetToucheData(t);if(this.IsPhoneDragging(t)){var a=this.MouseDrag;if(null==a){var i=e[0].clientX,r=e[0].clientY;this.OnMouseMove(i,r,t)}else{var n=Math.abs(a.LastMove.Y-e[0].clientY);if(n=parseInt(n),1==this.DragMode){if(n<5)return;var s=!0;a.LastMove.Y<e[0].clientY&&(s=!1),this.DataMove(n,s)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):this.DragDownloadData&&this.DragDownloadData(),a.LastMove.X=e[0].clientX,a.LastMove.Y=e[0].clientY}}this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=e[0].clientX,this.PhoneTouchInfo.End.Y=e[0].clientY)}else if(this.IsPhonePinching(t)){var o=this.PhonePinch;if(!o)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var h=Math.abs(e[0].pageX-e[1].pageX),l=Math.abs(o.Last.X-o.Last.X2),u=h-l;if(Math.abs(u)<5)return;if(u>0){var C={};if(C.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(C))return;this.CursorIndex=C.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}else{C={};if(C.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(C))return;this.CursorIndex=C.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}o.Last={X:e[0].pageX,Y:e[0].pageY,X2:e[1].pageX,Y2:e[1].pageY}}}},t.onmousedown=function(e){if(this.JSChartContainer&&0!=this.JSChartContainer.DragMode){if(this.JSChartContainer.TryClickLock){var a=e.clientX-this.getBoundingClientRect().left,i=e.clientY-this.getBoundingClientRect().top;if(this.JSChartContainer.TryClickLock(a,i))return}var r={Click:{},LastMove:{}};r.Click.X=e.clientX,r.Click.Y=e.clientY,r.LastMove.X=e.clientX,r.LastMove.Y=e.clientY,this.JSChartContainer.MouseDrag=r,document.JSChartContainer=this.JSChartContainer,this.JSChartContainer.SelectChartDrawPicture=null,t.ondblclick=function(t){var e=t.clientX-this.getBoundingClientRect().left,a=t.clientY-this.getBoundingClientRect().top;this.JSChartContainer&&this.JSChartContainer.OnDoubleClick(e,a,t)},document.onmousemove=function(t){if(this.JSChartContainer&&(!this.JSChartContainer.ChartSplashPaint||1!=this.JSChartContainer.ChartSplashPaint.IsEnableSplash)){var e=this.JSChartContainer.MouseDrag;if(e){var a=Math.abs(e.LastMove.Y-t.clientY);if(1==this.JSChartContainer.DragMode){if(a<5)return;var i=!0;e.LastMove.Y<t.clientY&&(i=!1),this.JSChartContainer.DataMove(a,i)&&(this.JSChartContainer.UpdataDataoffset(),this.JSChartContainer.UpdatePointByCursorIndex(),this.JSChartContainer.UpdateFrameMaxMin(),this.JSChartContainer.ResetFrameXYSplit(),this.JSChartContainer.Draw()),e.LastMove.X=t.clientX,e.LastMove.Y=t.clientY}}}},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,this.JSChartContainer.MouseDrag=null,this.JSChartContainer.CurrentChartDrawPicture=null,this.JSChartContainer=null}}},this.Create=function(t){var e=this;for(var a in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=f.g_DivTooltipDataForamt.Create("CorssCursor_XStringFormat"),this.ChartCorssCursor.StringFormatX.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY=f.g_DivTooltipDataForamt.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartSplashPaint=new D.ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new x,this.Frame.ChartBorder=new E,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var i=new I.DynamicChartTitlePainting;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.GetEventCallback=function(t){return e.GetEventCallback(t)},this.TitlePaint.push(i)}},this.CreateChildWindow=function(t){for(var e=0;e<t;++e){var a=new E;a.UIElement=this.UIElement;var i=new C.KLineHScreenFrame;i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=e,i.RightSpaceCount=this.RightSpaceCount,this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),i.HorizontalMax=20,i.HorizontalMin=10,0==e?(i.YSplitOperator=new f.FrameSplitKLinePriceY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),i.YSplitOperator.FrameSplitData2=this.FrameSplitData.get("double"),a.TopSpace=12,a.BottomSpace=12):(i.YSplitOperator=new f.FrameSplitY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double")),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new f.FrameSplitKLineX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,e!=t-1&&(i.XSplitOperator.ShowText=!1);for(var r=i.HorizontalMin;r<=i.HorizontalMax;r+=1)i.HorizontalInfo[r]=new f.CoordinateInfo,i.HorizontalInfo[r].Value=r,0==e&&r==i.HorizontalMin||(i.HorizontalInfo[r].Message[1]=r.toString(),i.HorizontalInfo[r].Font="14px 微软雅黑");var n=new N;n.Frame=i,n.Height=0==e?20:10,this.Frame.SubFrame[e]=n}}}function V(t){this.newMethod=w,this.newMethod(t),delete this.newMethod,this.ClassName="MinuteChartHScreenContainer",this.OnMouseMove=function(t,e,a){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e),this.DrawDynamicInfo()},this.Create=function(t){var e=this;for(var a in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new f.HQMinuteTimeStringFormat,this.ChartCorssCursor.StringFormatY=new f.HQPriceStringFormat,this.ChartSplashPaint=new D.ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SplashTitle=this.LoadDataSplashTitle,this.Frame=new x,this.Frame.ChartBorder=new E,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var i=new I.DynamicChartTitlePainting;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.GetEventCallback=function(t){return e.GetEventCallback(t)},this.TitlePaint.push(i)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame},this.CreateChildWindow=function(t){for(var e=0;e<t;++e){var a=new E;a.UIElement=this.UIElement;var i=new C.MinuteHScreenFrame;i.Canvas=this.Canvas,i.ChartBorder=a,e<2&&(i.ChartBorder.TitleHeight=0),i.XPointCount=243;var r=[9,8,7,6,5,4,3,2,1];for(var n in i.HorizontalMax=r[0],i.HorizontalMin=r[r.length-1],0==e?(i.YSplitOperator=new f.FrameSplitMinutePriceY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price")):(i.YSplitOperator=new f.FrameSplitY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double")),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new f.FrameSplitMinuteX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,e!=t-1&&(i.XSplitOperator.ShowText=!1),i.XSplitOperator.Operator(),r)i.HorizontalInfo[n]=new f.CoordinateInfo,i.HorizontalInfo[n].Value=r[n],0==e&&n==i.HorizontalMin||(i.HorizontalInfo[n].Message[1]=r[n].toString(),i.HorizontalInfo[n].Font="14px 微软雅黑");var s=new N;s.Frame=i,s.Height=0==e?20:10,this.Frame.SubFrame[e]=s}}}function G(t,e){!0===e?(this.newMethod=P,this.newMethod(t),delete this.newMethod):(this.newMethod=y,this.newMethod(t),delete this.newMethod),this.ClassName2="KLineTrainChartContainer",this.BuySellPaint,this.TrainDataCount=300,this.AutoRunTimer=null,this.BuySellData=[],this.TrainDataIndex,this.TrainCallback,this.DragMode=1,this.TrainStartEnd={},this.KLineSourceData,this.TrainInfo={Start:{},End:{}},this.CreateBuySellPaint=function(){var t=new D.ChartBuySell;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="KLine-Train-BuySell",this.ChartPaintEx[0]=t},this.GetKDataIndexByDateTime=function(t,e){if(!e||!t)return-1;for(var a=0;a<t.length;++a){var i=t[a];if(s.ChartData.IsMinutePeriod(this.Period,!0)){if(f.IFrameSplitOperator.IsNumber(this.TrainStartDate.Time)){if(i.Date>=this.TrainStartDate.Date&&i.Time>=this.TrainStartDate.Time)return a}else if(i.Date>=this.TrainStartDate.Date)return a}else if((s.ChartData.IsDayPeriod(this.Period,!0)||s.ChartData.IsTickPeriod(this.Period))&&i.Date>=this.TrainStartDate.Date)return a}return-1},this.AfterBindMainData=function(t){this.ChartPaintEx[0]||this.CreateBuySellPaint();var e=this.ChartPaint[0].Data;this.ChartPaintEx[0].Data=e;var a=e.Data[e.Data.length-1];this.TrainInfo.LastShowData=a,this.TrainInfo.LastData=this.SourceData.Data[this.SourceData.Data.length-1],"Update"!=t&&this.UpdateTrainUICallback("开始")},this.BeforeBindMainData=function(t){if("Update"!=t){this.KLineSourceData=new s.ChartData,this.KLineSourceData.Data=this.SourceData.Data.slice(0);var e=this.SourceData.Data.length,a=e-this.TrainDataCount-20,i=this.GetKDataIndexByDateTime(this.SourceData.Data,this.TrainStartDate);i>=0&&(a=i+1,e-a<this.TrainDataCount&&(this.TrainDataCount=e-a));var r=a-1,n=this.SourceData.Data[r];this.TrainInfo.Start.Index=r,this.TrainInfo.Start.Date=n.Date,this.TrainInfo.Start.Time=n.Time,this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,this.TrainInfo.LastData=n,this.SourceData.Data.length=a}},this.Run=function(t){if(!this.AutoRunTimer&&!(this.TrainDataCount<=0)){var e=this;this.AutoRunTimer=setInterval((function(){e.MoveNextKLineData(t)||clearInterval(e.AutoRunTimer)}),1e3)}},this.MoveNextKLineData=function(t){if(this.TrainDataCount<=0)return!1;var e=1,a=0;t&&t.Step>1&&(e=t.Step);for(var i=0;i<e;++i){var r=this.TrainInfo.End.Index+1;if(r>=this.KLineSourceData.Data.length)break;var n=this.KLineSourceData.Data[r];if(this.SourceData.Data.push(n),this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,--this.TrainDataCount,++a,this.TrainDataCount<=0)break}if(0==a)return!1;var s=this.Frame.GetCurrentPageSize();return f.IFrameSplitOperator.IsNumber(s)&&(this.PageSize=s-this.RightSpaceCount),this.Update(),this.TrainDataCount<=0?(this.FinishTrainData(),this.UpdateTrainUICallback("结束"),!1):(this.UpdateTrainUICallback("训练中"),!0)},this.UpdateTrainUICallback=function(t){if(this.mapEvent.has(s.JSCHART_EVENT_ID.RECV_TRAIN_MOVE_STEP)){var e=this.mapEvent.get(s.JSCHART_EVENT_ID.RECV_TRAIN_MOVE_STEP);if(e.Callback){var a={TrainDataCount:this.TrainDataCount,BuySellData:this.BuySellData,KLine:{Start:{Index:this.TrainInfo.Start.Index,Date:this.TrainInfo.Start.Date},End:{Index:this.TrainInfo.End.Index,Date:this.TrainInfo.End.Date}},LastData:this.TrainInfo.LastData,LastShowData:this.TrainInfo.LastShowData};f.IFrameSplitOperator.IsNumber(this.TrainInfo.Start.Time)&&(a.KLine.Start.Time=this.TrainInfo.Start.Time),f.IFrameSplitOperator.IsNumber(this.TrainInfo.End.Time)&&(a.KLine.End.Time=this.TrainInfo.End.Time),t&&(a.Description=t),this.TrainDataCount<=0&&(a.Symbol=this.Symbol,a.Name=this.Name),e.Callback(e,a,this)}}},this.FinishTrainData=function(){},this.Stop=function(){null!=this.AutoRunTimer&&clearInterval(this.AutoRunTimer),this.AutoRunTimer=null},this.BuyOrSell=function(t,e){var a=this.TrainInfo.LastShowData;if(!a)return!1;var i=this.ChartPaintEx[0];if(!i)return!1;var r=this.ChartPaint[0].Data;if(!r||r.Data.length<=0)return!1;var n=r.Data.length-1,s={Date:this.TrainInfo.End.Date,Time:this.TrainInfo.End.Time,Price:t.Price,Vol:t.Vol,Op:0,ID:t.ID};1==t.Op&&(s.Op=1);var o=n;s.Key=o,this.BuySellData.push(s),i.AddTradeItem(s),1==e&&this.Draw()},this.RestartTrain=function(t){i.JSConsole.Chart.Log("[KLineTrainChartContainer::RestartTrain] option ",t),this.TrainInfo={Start:{},End:{}},this.BuySellData=[],this.KLineSourceData=null;var e=this.ChartPaintEx[0];e&&(e.Data=null,e.ClearTradeData()),t.Symbol&&(this.Symbol=t.Symbol),f.IFrameSplitOperator.IsNumber(t.Period)&&(this.Period=t.Period),f.IFrameSplitOperator.IsNumber(t.Right)&&(this.Right=t.Right),t.Train&&(t.Train.DataCount>1&&(this.TrainDataCount=t.Train.DataCount),t.Train.DateTime&&(this.TrainStartDate=t.Train.DateTime));var a=this.Symbol;this.ChangeSymbol(a)}}function H(t,e){this.newMethod=G,this.newMethod(t,e),delete this.newMethod,this.IsHScreen=e,this.IsZoomLockRight=!0,this.RightSpaceCount=0,this.RecvFlowCapitalData=function(t){this.Super_RecvFlowCapitalData(t)},this.BeforeBindMainData=function(t){},this.UpdateLastDataIcon=function(){if(this.ChartPaintEx[0]){var t=this.ChartPaintEx[0];t.LastDataIndex=this.TrainInfo.End.Index}},this.AfterBindMainData=function(t){if(this.ChartPaintEx[0]||(this.CreateBuySellPaint(),this.ChartPaintEx[0].LastDataDrawType=1),"Update"!=t){var e=this.ChartOperator_Temp_GetHistroyData();if(!e)return!1;var a=e.Data.length,i=a-this.TrainDataCount-20,r=this.Frame.SubFrame[0].Frame.XPointCount,n=this.GetKDataIndexByDateTime(e.Data,this.TrainStartDate);n>=0&&(i=n+1,a-i<this.TrainDataCount&&(this.TrainDataCount=a-i));var s=i-r;e.DataOffset=s;var o=i-1,h=e.Data[o];this.TrainInfo.LastShowData=h,this.TrainInfo.LastData=h,this.TrainInfo.Start.Index=o,this.TrainInfo.Start.Date=h.Date,this.TrainInfo.Start.Time=h.Time,this.TrainInfo.End.Index=o,this.TrainInfo.End.Date=h.Date,this.TrainInfo.End.Time=h.Time,this.UpdateLastDataIcon(),this.UpdateTrainUICallback("开始")}},this.Super_UpdataDataoffset=this.UpdataDataoffset,this.UpdataDataoffset=function(){this.Super_UpdataDataoffset();var t=this.ChartPaint[0].Data;this.ChartPaintEx[0].Data=t},this.MoveNextKLineData=function(t){if(this.TrainDataCount<=0)return!1;var e=this.ChartOperator_Temp_GetHistroyData();if(!e)return!1;var a=1;t&&t.Step>1&&(a=t.Step);for(var i=e.Data.length,r=0,n=0;n<a;++n){var s=this.TrainInfo.End.Index+1;if(s>=i)break;var o=e.Data[s];if(this.TrainInfo.End.Index=s,this.TrainInfo.End.Date=o.Date,this.TrainInfo.End.Time=o.Time,--this.TrainDataCount,++r,this.TrainDataCount<=0)break}if(0==r)return!1;this.TrainInfo.LastShowData=o,this.TrainInfo.LastData=o;var h=this.TrainInfo.End.Index,l=this.Frame.SubFrame[0].Frame.XPointCount,u=h-l+1;return e.DataOffset=u,this.UpdateLastDataIcon(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.TrainDataCount<=0?(this.FinishTrainData(),this.UpdateTrainUICallback("结束"),!1):(this.UpdateTrainUICallback("训练中"),!0)},this.BuyOrSell=function(t,e){var a=this.TrainInfo.LastShowData;if(!a)return!1;var i=this.ChartPaintEx[0];if(!i)return!1;var r=this.ChartPaint[0].Data;if(!r||r.Data.length<=0)return!1;var n=this.TrainInfo.End.Index,s={Date:this.TrainInfo.End.Date,Time:this.TrainInfo.End.Time,Price:t.Price,Vol:t.Vol,Op:0,ID:t.ID};1==t.Op&&(s.Op=1);var o=n;s.Key=o,this.BuySellData.push(s),i.AddTradeItem(s),1==e&&this.Draw()},this.DataMove=function(t,e){if(t=parseInt(t/this.StepPixel),t<=0)return!1;var a=this.ChartOperator_Temp_GetHistroyData();if(!a)return!1;var i=0;if(i=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!i)return!1;if(e){if(this.RightSpaceCount>0){if(i+a.DataOffset>=a.Data.length+this.RightSpaceCount-1)return!1;a.DataOffset+=t,a.DataOffset+i>=a.Data.length+this.RightSpaceCount&&(a.DataOffset=a.Data.length-(i-this.RightSpaceCount))}else{var r=this.TrainInfo.End.Index+1;if(i+a.DataOffset>=r)return!1;a.DataOffset+=t,a.DataOffset+i>=r&&(a.DataOffset=r-i)}return!0}return!(a.DataOffset<=0)&&(a.DataOffset-=t,a.DataOffset<0&&(a.DataOffset=0),!0)},this.GetLastDataIndex=function(){if(!this.ChartPaint[0]||!this.ChartPaint[0].Data||!this.ChartPaint[0].Data.Data)return null;var t=this.ChartPaint[0].Data,e=this.TrainInfo.End.Index+1;return e>0?e-1-t.DataOffset:null}}function _(t){this.newMethod=p,this.newMethod(t),delete this.newMethod,this.ClassName="DepthChartContainer",this.Symbol,this.MapAsk=new Map,this.MapBid=new Map,this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer=null,this.DefaultZoom=.8,this.MaxVolRate=1.1,this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new D.DepthChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.HQChart=this,this.ChartSplashPaint=new D.ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SplashTitle=this.LoadDataSplashTitle,this.Frame=new C.DepthChartFrame,this.Frame.ChartBorder=new E,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.ChartBorder.TitleHeight=0,this.Frame.Canvas=this.Canvas,this.Frame.Identify=0;var a=new f.FrameSplitY;a.FrameSplitData=this.FrameSplitData.get("double"),a.LanguageID=this.LanguageID,a.Frame=this.Frame,a.SplitCount=5,a.IgnoreYValue=[0],a.LineType=3,a.ChartBorder=this.Frame.ChartBorder,a.GetEventCallback=function(t){return e.GetEventCallback(t)},this.Frame.YSplitOperator=a;var i=new f.FrameSplitXDepth;i.Frame=this.Frame,i.ChartBorder=this.Frame.ChartBorder,i.LanguageID=this.LanguageID,i.LineType=3,i.GetEventCallback=function(t){return e.GetEventCallback(t)},this.Frame.XSplitOperator=i,this.ChartCorssCursor&&(this.ChartCorssCursor.Frame=this.Frame),this.ChartSplashPaint.Frame=this.Frame;var r=new D.ChartOrderbookDepth;r.Canvas=this.Canvas,r.ChartBorder=this.Frame.ChartBorder,r.ChartFrame=this.Frame,r.Name="深度图",this.ChartPaint.push(r)},this.ontouchstart=function(t){this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null;this.IsSingleTouch(t);if(this.EnableScrollUpDown,this.IsPhoneDragging(t)){var e={Click:{},LastMove:{}},a=this.GetToucheData(t,this.IsForceLandscape);e.Click.X=a[0].clientX,e.Click.Y=a[0].clientY,e.LastMove.X=a[0].clientX,e.LastMove.Y=a[0].clientY,this.MouseDrag=e;var i=e.Click.X,r=e.Click.Y;this.OnMouseMove(i,r,t)}else if(this.IsPhonePinching(t)){var n={Start:{},Last:{}};a=this.GetToucheData(t,this.IsForceLandscape);n.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},n.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},this.PhonePinch=n}},this.ontouchmove=function(t){var e=this.GetToucheData(t,!1);if(this.IsPhoneDragging(t)){var a=this.MouseDrag;if(null==a){var i=e[0].clientX,r=e[0].clientY;this.OnMouseMove(i,r,t)}else{this.MouseDrag=null;i=e[0].clientX,r=e[0].clientY;this.OnMouseMove(i,r,t)}}else if(this.IsPhonePinching(t)){var n=this.PhonePinch;if(!n)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var s=Math.abs(e[0].pageY-e[1].pageY),o=Math.abs(n.Last.Y-n.Last.Y2),h=s-o,l=Math.abs(e[0].pageX-e[1].pageX),u=Math.abs(n.Last.X-n.Last.X2),C=l-u,D=this.ZoomStepPixel;if(Math.abs(h)<D&&Math.abs(C)<D)return;var m=h;if(Math.abs(h)<D&&(m=C),m>0){if(!this.Frame.ZoomUp())return;this.UpdateFrameMaxMin(),this.Draw()}else{if(!this.Frame.ZoomDown())return;this.UpdateFrameMaxMin(),this.Draw()}n.Last={X:e[0].pageX,Y:e[0].pageY,X2:e[1].pageX,Y2:e[1].pageY}}},this.ontouchend=function(t){i.JSConsole.Chart.Log("[DepthChartContainer::OnTouchEnd]",t),this.IsOnTouch=!1,this.Draw(),this.TouchDrawCount=0},this.OnMouseMove=function(t,e,a,i){this.LastPoint.Y;this.LastPoint.X=t,this.LastPoint.Y=e,this.FullDraw()},this.ChangeSymbol=function(t){this.CancelAutoUpdate(),this.Symbol=t,this.MapBid=new Map,this.MapAsk=new Map,this.Frame.VerticalRange.Differ=null,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.RequestDepthData()},this.RequestDepthData=function(){var t=this;if(this.NetworkFilter){var e={Name:"DepthChartContainer::RequestDepthData",Explain:"深度图数据",Request:{Data:{symbol:t.Symbol}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvDepthData(e),t.AutoUpdate()})),1==e.PreventDefault)return}},this.RecvDepthData=function(t){this.UpdateAskAndBid(t);var e=Array.from(this.MapAsk.values());e.sort((function(t,e){return t.Price-e.Price}));var a=0;for(var i in e){var r=e[i];a+=r.Vol,e[i]={Price:r.Price,Vol:a}}var n=Array.from(this.MapBid.values());n.sort((function(t,e){return e.Price-t.Price}));a=0;for(var i in n){r=n[i];a+=r.Vol,n[i]={Price:r.Price,Vol:a}}var s={Asks:e,Bids:n},o=this.ChartPaint[0];o.Data=s,this.Frame.XSplitOperator.Symbol=this.Symbol,this.ChartCorssCursor.Data=s,this.ChartCorssCursor.Symbol=this.Symbol,this.UpdateFramePriceList(),this.UpdateFrameMaxMin(),this.Draw()},this.UpdateAskAndBid=function(t){for(var e in"snapshot"==t.datatype&&(this.MapBid=new Map,this.MapAsk=new Map),t.asks){var a=t.asks[e],i=parseFloat(a[0]),r=parseFloat(a[1]);if(this.MapAsk.has(i)){var n=this.MapAsk.get(i);r<=0?this.MapAsk.delete(i):n.Vol=r}else r>0&&this.MapAsk.set(i,{Price:i,Vol:r})}for(var e in t.bids){a=t.bids[e],i=parseFloat(a[0]),r=parseFloat(a[1]);if(this.MapBid.has(i)){n=this.MapBid.get(i);r<=0?this.MapBid.delete(i):n.Vol=r}else r>0&&this.MapBid.set(i,{Price:i,Vol:r})}},this.UpdateFramePriceList=function(){var t=Array.from(this.MapAsk.keys()),e=Array.from(this.MapBid.keys());if(t.sort((function(t,e){return t-e})),e.sort((function(t,e){return t-e})),t.length>1&&e.length>1)var a=t[0],i=t[t.length-1],r=e[0],n=e[e.length-1],s=i-a,o=n-r,h=Math.max(s,o),l={Min:a,Max:a+h},u={Max:n,Min:n-h},C={Max:l.Max,Min:u.Min};this.Frame.SetPriceList(t,e);var D=this.Frame.VerticalRange;D.Max=C.Max,D.Center=C.Min+(C.Max-C.Min)/2,D.Min=C.Min,D.MaxDiffer=h,D.Ask=l,D.Bid=u,f.IFrameSplitOperator.IsNumber(D.Differ)||(D.Differ=h*this.DefaultZoom),D.Min=D.Center-D.Differ,D.Max=D.Center+D.Differ},this.UpdateFrameMaxMin=function(){var t=this.ChartPaint[0].GetMaxMin();this.Frame.HorizontalMax=t.Max*this.MaxVolRate,this.Frame.HorizontalMin=0,this.Frame.XYSplit=!0},this.CancelAutoUpdate=function(){this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=null)},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol&&!this.IsDestroy){var t=this,e=h.MARKET_SUFFIX_NAME.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),a):2==e&&(this.AutoUpdateTimer=setTimeout((function(){t.RequestDepthData()}),a))}}}}function k(t){var e=t.toUpperCase();if(e.indexOf(".SH")>0){if(e=e.replace(".SH",""),"0"==e.charAt(0)&&parseInt(e)<=3e3)return!0}else if(e.indexOf(".SZ")>0){if(e=e.replace(".SZ",""),"3"==e.charAt(0)&&"9"==e.charAt(1))return!0}else if(e.indexOf(".CI")>0)return!0;return!1}Number.prototype.toFixed2=Number.prototype.toFixed,Number.prototype.toFixed=function(t){return function(t,e){var a=1;if(isNaN(t))return t;t<0&&(a=-1);var i=Math.pow(10,e),r=Math.round(Math.abs(t)*i)/i*a;if(/^(\d+(?:\.\d+)?)(e)([\-]?\d+)$/.test(r))var n=r.toFixed2(e);else n=r.toString();var s=n.indexOf(".");s<0&&e>0&&(s=n.length,n+=".");while(n.length<=s+e)n+="0";return n}(this,t)},R.Get=function(t){var e=new Map([["市场多空",{IsMainIndex:!1,Create:function(){return new c.MarketLongShortIndex}}],["市场择时",{IsMainIndex:!1,Create:function(){return new c.MarketTimingIndex}}],["市场关注度",{IsMainIndex:!1,Create:function(){return new c.MarketAttentionIndex}}],["指数热度",{IsMainIndex:!1,Create:function(){return new c.MarketHeatIndex}}],["自定义指数热度",{IsMainIndex:!1,Create:function(){return new c.CustonIndexHeatIndex},Name:"自定义指数热度"}],["财务粉饰",{IsMainIndex:!1,Create:function(){return new c.BenfordIndex}}]]);return e.get(t)},y.JsonDataToHistoryData=function(t){var e=t.data,a=new Array;if(!e)return a;var i=null;t.symbol&&(i=t.symbol.toUpperCase());h.MARKET_SUFFIX_NAME.IsChinaFutures(i);for(var r=s.JSCHART_DATA_FIELD_ID.KLINE_COLOR_DATA,n=s.JSCHART_DATA_FIELD_ID.KLINE_DAY_EXTENDDATA,o=0;o<e.length;++o){var l=new s.HistoryData,u=e[o];l.Date=u[0],l.Open=u[2],l.YClose=u[1],l.Close=u[5],l.High=u[3],l.Low=u[4],l.Vol=u[6],l.Amount=u[7],f.IFrameSplitOperator.IsNumber(u[8])&&(l.Position=u[8]),f.IFrameSplitOperator.IsNumber(u[9])&&(l.FClose=u[9]),f.IFrameSplitOperator.IsNumber(u[10])&&(l.YFClose=u[10]),f.IFrameSplitOperator.IsNumber(u[11])&&(l.BFactor=u[11]),f.IFrameSplitOperator.IsNumber(u[12])&&(l.AFactor=u[12]),f.IFrameSplitOperator.IsNumber(l.Open)&&(u[r]&&(l.ColorData=u[r]),u[n]&&(l.ExtendData=u[n]),a.push(l))}return a},y.JsonDataToRealtimeData=function(t,e){if(!t)return null;if(!f.IFrameSplitOperator.IsNonEmptyArray(t.stock))return null;for(var a=null,i=0;i<t.stock.length;++i){var r=t.stock[i];if(r&&r.symbol==e){a=r;break}}if(!a)return null;var n=e.toUpperCase();h.MARKET_SUFFIX_NAME.IsSHSZ(n),r=new s.HistoryData;return r.Date=a.date,r.Open=a.open,r.YClose=a.yclose,r.High=a.high,r.Low=a.low,r.Vol=a.vol,r.Amount=a.amount,r.Close=a.price,f.IFrameSplitOperator.IsNumber(a.position)&&(r.Position=a.position),f.IFrameSplitOperator.IsNumber(a.bfactor)&&(r.BFactor=a.bfactor),f.IFrameSplitOperator.IsNumber(a.afactor)&&(r.AFactor=a.afactor),a.colordata&&(r.ColorData=a.colordata),a.extendData&&(r.ExtendData=a.extendData),r},y.JsonDataToMinuteRealtimeData=function(t){var e=t.stock[0].symbol,a=e.toUpperCase(),i=(h.MARKET_SUFFIX_NAME.IsSHSZ(a),h.MARKET_SUFFIX_NAME.IsChinaFutures(a)),r=new Array,n=t.stock[0].yclose,o=t.stock[0].date;i&&t.stock[0].yclearing&&(n=t.stock[0].yclearing);for(var l=0;l<t.stock[0].minute.length;++l){var u=t.stock[0].minute[l],C=new s.HistoryData;C.Close=u.price,C.Open=u.open,C.High=u.high,C.Low=u.low,C.Vol=u.vol,C.Amount=u.amount,u.date>0?C.Date=u.date:C.Date=o,C.Time=u.time,C.YClose=n,f.IFrameSplitOperator.IsNumber(u.position)&&(C.Position=u.position),f.IFrameSplitOperator.IsNumber(C.Close)||(C.Close=n,C.Open=C.High=C.Low=C.Close),f.IFrameSplitOperator.IsNumber(C.Open)||(C.Open=null),f.IFrameSplitOperator.IsNumber(C.Close)||(C.Close=null),f.IFrameSplitOperator.IsNumber(C.High)||(C.High=null),f.IFrameSplitOperator.IsNumber(C.Low)||(C.Low=null),f.IFrameSplitOperator.IsNumber(u.price)&&(n=u.price),r[l]=C}return r},y.JsonDataToMinuteHistoryData=function(t){var e=null;t.symbol&&(e=t.symbol.toUpperCase());e&&h.MARKET_SUFFIX_NAME.IsSHSZ(e);e&&h.MARKET_SUFFIX_NAME.IsChinaFutures(e);for(var a=t.data,i=new Array,r=s.JSCHART_DATA_FIELD_ID.KLINE_COLOR_DATA,n=s.JSCHART_DATA_FIELD_ID.KLINE_MINUTE_EXTENDDATA,o=0;o<a.length;++o){var l=new s.HistoryData,u=a[o];l.Date=u[0],l.Open=u[2],l.YClose=u[1],l.Close=u[5],l.High=u[3],l.Low=u[4],l.Vol=u[6],l.Amount=u[7],l.Time=u[8],f.IFrameSplitOperator.IsNumber(u[9])&&(l.Position=u[9]),f.IFrameSplitOperator.IsNumber(u[10])&&(l.FClose=u[10]),f.IFrameSplitOperator.IsNumber(u[11])&&(l.YFClose=u[11]),f.IFrameSplitOperator.IsNumber(u[12])&&(l.BFactor=u[12]),f.IFrameSplitOperator.IsNumber(u[13])&&(l.AFactor=u[13]),u[r]&&(l.ColorData=u[r]),u[n]&&(l.ExtendData=u[n]),i.push(l)}return i},w.JsonDataToMinuteData=function(t){var e=t.stock[0].symbol.toUpperCase(),a=h.MARKET_SUFFIX_NAME.IsSHSZ(e),i=h.MARKET_SUFFIX_NAME.IsChinaFutures(e)||h.MARKET_SUFFIX_NAME.IsNYMEX(e),r=h.MARKET_SUFFIX_NAME.IsSHO(e),n=h.MARKET_SUFFIX_NAME.IsSZO(e),o=t.stock[0].yclose,l=t.stock[0].yclose,u=t.stock[0].yclose;i&&t.stock[0].yclearing&&(u=o=l=t.stock[0].yclearing);var C=t.stock[0].date,D=new Array;for(var m in t.stock[0].minute){var c=t.stock[0].minute[m],S=new s.MinuteData;c.price&&(o=c.price),c.avprice&&(l=c.avprice),S.Close=c.price,S.Open=c.open,S.High=c.high,S.Low=c.low,S.Vol=a?c.vol/100:c.vol,S.Amount=c.amount,S.Increase=c.increase,S.Risefall=c.risefall,S.AvPrice=c.avprice,S.Close||(S.Close=o,S.Open=S.High=S.Low=S.Close),S.AvPrice||(S.AvPrice=l),c.date>0&&(C=c.date),S.DateTime=C.toString()+" "+c.time.toString(),S.Date=t.stock[0].date,S.Time=c.time,8<c.length&&c[8]>0&&(S.Date=c[8],S.DateTime=S.Date.toString()+" "+c[0].toString()),(i||r||n)&&(S.Position=c.position),S.Open<=0&&(S.Open=null),S.Close<=0&&(S.Close=null),S.AvPrice<=0&&(S.AvPrice=null),S.High<=0&&(S.High=null),S.Low<=0&&(S.Low=null),u&&S.Close&&(S.Increase=(S.Close-u)/u*100),c.ExtendData&&(S.ExtendData=c.ExtendData),D[m]=S}return D},w.JsonDataToMinuteDataArray=function(t){for(var e=t.symbol.toUpperCase(),a=h.MARKET_SUFFIX_NAME.IsSHSZ(e),i=h.MARKET_SUFFIX_NAME.IsChinaFutures(e)||h.MARKET_SUFFIX_NAME.IsNYMEX(e),r=h.MARKET_SUFFIX_NAME.IsSHO(e),n=h.MARKET_SUFFIX_NAME.IsSZO(e),o=[],l=s.JSCHART_DATA_FIELD_ID.MINUTE_MULTI_DAY_EXTENDDATA,u=0;u<t.data.length;++u){for(var C=[],D=t.data[u],m=D.date,c=D.yclose,S=c,I=D.yclearing,d=null,T=0;T<D.minute.length;++T){var p=D.minute[T];p[2]&&(S=p[2]);var v=new s.MinuteData;v.Close=p[2],v.Open=p[1],v.High=p[3],v.Low=p[4],v.Vol=a?p[5]/100:p[5],v.Amount=p[6],7<p.length&&p[7]>0&&(v.AvPrice=p[7],d=p[7]),v.Close||(v.Close=S,v.Open=v.High=v.Low=v.Close),!v.AvPrice&&d&&(v.AvPrice=d),v.Close&&c?v.Increase=(v.Close-c)/c*100:v.Increase=null,v.DateTime=m.toString()+" "+p[0].toString(),v.Date=m,v.Time=p[0],8<p.length&&p[8]>0&&(v.Date=p[8],v.DateTime=v.Date.toString()+" "+p[0].toString()),(i||r||n)&&9<p.length&&(v.Position=p[9]),0==T&&(v.IsFristData=!0),v.Open<=0&&(v.Open=null),v.Close<=0&&(v.Close=null),v.AvPrice<=0&&(v.AvPrice=null),v.High<=0&&(v.High=null),v.Low<=0&&(v.Low=null),v.AvPrice<=0&&(v.AvPrice=null),p[l]&&(v.ExtendData=p[l]),C[T]=v}var F=new s.ChartData;F.Data=C,F.YClose=c,F.Close=D.close,F.Date=m,f.IFrameSplitOperator.IsNumber(I)&&(F.YClearing=I),o.push(F)}return o},b.JsonDataToMinuteData=function(t){var e=new Array;for(var a in t.minute.time){var i=new s.MinuteData;t.minute.price[a]<=0&&a>0?(i.Close=e[a-1].Close,i.Open=e[a-1].Close,i.High=i.Close,i.Low=i.Close,i.Vol=t.minute.vol[a]/100,i.Amount=t.minute.amount[a],i.DateTime=t.date.toString()+" "+t.minute.time[a].toString(),i.Date=t.date,i.Time=t.minute.time[a],i.AvPrice=e[a-1].AvPrice):(i.Close=t.minute.price[a],i.Open=t.minute.open[a],i.High=t.minute.high[a],i.Low=t.minute.low[a],i.Vol=t.minute.vol[a]/100,i.Amount=t.minute.amount[a],i.DateTime=t.date.toString()+" "+t.minute.time[a].toString(),i.Date=t.date,i.Time=t.minute.time[a],i.AvPrice=t.minute.avprice[a]),i.Open<=0&&(i.Open=null),i.Close<=0&&(i.Close=null),i.AvPrice<=0&&(i.AvPrice=null),i.High<=0&&(i.High=null),i.Low<=0&&(i.Low=null),e[a]=i}return e};var U={JSCanvasElement:n.JSCanvasElement,JSNetwork:r.JSNetwork,JSChart:d,Guid:v,IFrameSplitOperator:f.IFrameSplitOperator,ChartData:s.ChartData,DataPlus:s.DataPlus,KLineTooltipPaint:m.KLineTooltipPaint,MARKET_SUFFIX_NAME:h.MARKET_SUFFIX_NAME,JSCommonCoordinateData:h.JSCommonCoordinateData,FrameSplitKLineX:f.FrameSplitKLineX,FrameSplitKLinePriceY:f.FrameSplitKLinePriceY,JSCHART_EVENT_ID:s.JSCHART_EVENT_ID,JSCHART_DATA_FIELD_ID:s.JSCHART_DATA_FIELD_ID,JSCHART_OPERATOR_ID:T};e.JSCommon=U},a3a2:function(t,e,a){"use strict";var i=a("23e7"),r=a("e330"),n=a("5926"),s=a("408a"),o=a("1148"),h=a("867a"),l=a("d039"),u=RangeError,C=String,D=isFinite,m=Math.abs,c=Math.floor,S=Math.pow,f=Math.round,I=r(1..toExponential),d=r(o),T=r("".slice),p="-6.9000e-11"===I(-69e-12,4)&&"1.25e+0"===I(1.255,2)&&"1.235e+4"===I(12345,3)&&"3e+1"===I(25,0),v=l((function(){I(1,1/0)}))&&l((function(){I(1,-1/0)})),F=!l((function(){I(1/0,1/0)}))&&!l((function(){I(NaN,1/0)})),g=!p||!v||!F;i({target:"Number",proto:!0,forced:g},{toExponential:function(t){var e=s(this);if(void 0===t)return I(e);var a=n(t);if(!D(e))return String(e);if(a<0||a>20)throw u("Incorrect fraction digits");if(p)return I(e,a);var i="",r="",o=0,l="",v="";if(e<0&&(i="-",e=-e),0===e)o=0,r=d("0",a+1);else{var F=h(e);o=c(F);var g=0,A=S(10,o-a);g=f(e/A),2*e>=(2*g+1)*A&&(g+=1),g>=S(10,a+1)&&(g/=10,o+=1),r=C(g)}return 0!==a&&(r=T(r,0,1)+"."+T(r,1)),0===o?(l="+",v="0"):(l=o>0?"+":"-",v=C(m(o))),r+="e"+l+v,i+r}})},b0e7:function(t,e,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.DynamicChartTitlePainting=function(){this.newMethod=m,this.newMethod(),delete this.newMethod,this.IsDynamic=!0,this.Data=new Array,this.Explain,this.TitleBG,this.TitleBGHeight=20,this.TitleAlign="middle",this.TitleBottomDistance=1,this.Text=new Array,this.EraseRect,this.EraseColor=n.g_JSChartResource.BGColor,this.TitleRect,this.IsDrawTitleBG=!1,this.BGColor=n.g_JSChartResource.IndexTitleBGColor,this.BGBorderColor=n.g_JSChartResource.IndexTitleBorderColor,this.TitleColor=n.g_JSChartResource.IndexTitleColor,this.ArgumentsText,this.IsShowIndexName=!0,this.IsShowNameArrow=!1,this.ParamSpace=2,this.TitleSpace=2,this.OutName=null,this.IsFullDraw=!0,this.OverlayIndex=new Map,this.IsShowOverlayIndexName=!0,this.OverlayIndexType={LineSpace:1,BGColor:n.g_JSChartResource.OverlayIndexTitleBGColor},this.DynamicTitle={OutName:null,OutValue:null},this.OverlayDynamicTitle=new Map,this.SetDynamicTitleData=function(t,e,a){a.OutName?a.OutName.clear():a.OutName=new Map,a.OutValue?a.OutValue.clear():a.OutValue=new Map;var i=new Map;for(var r in e){var n=e[r];i.set("{".concat(n.Name,"}"),n)}for(var r in t){n=t[r];if(n.DynamicName){var s=n.DynamicName.match(/{\w*}/i);if(!s||s.length<=0)a.OutName.set(n.Name,n.DynamicName);else{for(var o=n.DynamicName,h=!0,l=0;l<s.length;++l){var u=s[l];if(!i.has(u)){h=!1;break}var C=i.get(u).Value;o=o.replace(u,C.toString())}h&&a.OutName.set(n.Name,o)}}n.DynamicValue&&a.OutValue.set(n.Name,n.DynamicValue)}},this.SetDynamicTitle=function(t,e,a){if(l.IFrameSplitOperator.IsString(a)){var i=null;this.OverlayDynamicTitle.has(a)?i=this.OverlayDynamicTitle.get(a):(i={OutName:null,OutValue:null},this.OverlayDynamicTitle.set(a,i)),this.SetDynamicTitleData(t,e,i)}else this.SetDynamicTitleData(t,e,this.DynamicTitle)},this.GetDynamicOutName=function(t,e){if(l.IFrameSplitOperator.IsString(e)){if(!this.OverlayDynamicTitle.has(e))return null;var a=this.OverlayDynamicTitle.get(e),i=a.OutName}else i=this.DynamicTitle.OutName;return!i||i.size<=0?null:i.has(t)?i.get(t):null},this.IsClickTitle=function(t,e){return!!this.TitleRect&&(t>this.TitleRect.Left&&t<this.TitleRect.Left+this.TitleRect.Width&&e>this.TitleRect.Top&&e<this.TitleRect.Top+this.TitleRect.Height)},this.FormatValue=function(t,e){return e.StringFormat==f.DEFAULT?l.IFrameSplitOperator.FormatValueString(t,e.FloatPrecision,this.LanguageID):(e.StringFormat=f.THOUSANDS)?l.IFrameSplitOperator.FormatValueThousandsString(t,e.FloatPrecision):e.StringFormat==f.ORIGINAL?t.toFixed(e.FloatPrecision).toString():void 0},this.FormatMultiReport=function(t,e){var a="";for(var i in t){var r=t[i],n=r.Quarter,s=r.Year,o=r.Value;switch(a.length>0&&(a+=","),a+=s.toString(),n){case 1:a+="一季报 ";break;case 2:a+="半年报 ";break;case 3:a+="三季报 ";break;case 4:a+="年报 ";break}a+=this.FormatValue(o,e)}return a},this.FromatStackedBarTitle=function(t,e){if(!l.IFrameSplitOperator.IsNonEmptyArray(t))return null;if(!l.IFrameSplitOperator.IsNonEmptyArray(e.Color))return null;for(var a=[],i=0;i<t.length;++i){var r=t[i];if(l.IFrameSplitOperator.IsNumber(r)){var n={Text:r.toFixed(2)};e.Name&&e.Name[i]&&(n.Name=e.Name[i]),n.Color=e.Color[i],a.push(n)}}return a.length<=0?null:a},this.SendUpdateUIMessage=function(t){if(this.UpdateUICallback){var e={TitleName:"指标标题",CallFunction:t,TitleData:{Title:this.Title,Identify:this.Frame.Identify,Data:[]},Rect:{Top:this.Frame.ChartBorder.GetTop(),Left:this.Frame.ChartBorder.GetLeft(),Right:this.Frame.ChartBorder.GetRight(),Bottom:this.Frame.ChartBorder.GetBottom()}};for(var a in this.Data){var i=this.Data[a];if(i&&i.Data&&i.Data.Data&&!(i.Data.Data.length<=0)){var r={Name:i.Name,Color:i.Color};if(i.DataType&&(r.DataType=i.DataType),"StraightLine"==i.DataType)r.Value=i.Data.Data[0];else{var n=i.Data.Data.length-1;if(null!=this.CursorIndex){var s=Math.abs(this.CursorIndex-.5);s=parseInt(s.toFixed(0)),n=i.Data.DataOffset+s}n>=i.Data.Data.length&&(n=i.Data.Data.length-1),r.Value=i.Data.Data[n]}e.TitleData.Data.push(r)}}this.UpdateUICallback(e)}},this.FullDraw=function(){if(this.EraseRect=null,this.TitleRect=null,!this.Frame.IsMinSize&&(this.OnDrawTitleEvent(),!(this.Frame.ChartBorder.TitleHeight<5)&&0!=this.Frame.IsShowTitle)){if(this.IsDrawTitleBG=this.Frame.IsDrawTitleBG,this.IsShowIndexName=this.Frame.IsShowIndexName,this.IsShowNameArrow=this.Frame.IsShowNameArrow,this.ParamSpace=this.Frame.IndexParamSpace,this.TitleSpace=this.Frame.IndexTitleSpace,!0===this.Frame.IsHScreen)return this.Canvas.save(),this.DrawItem(!0,!0),this.DrawOverlayIndexSingleLine(),void this.Canvas.restore();this.DrawItem(!0,!0),this.DrawOverlayIndexSingleLine()}},this.DrawTitle=function(){if(this.IsDrawTitleBG=this.Frame.IsDrawTitleBG,this.EraseRect=null,this.TitleRect=null,this.SendUpdateUIMessage("DrawTitle"),!(this.Frame.ChartBorder.TitleHeight<5)&&0!=this.Frame.IsShowTitle){if(this.IsShowIndexName=this.Frame.IsShowIndexName,this.ParamSpace=this.Frame.IndexParamSpace,!0===this.Frame.IsHScreen)return this.Canvas.save(),this.DrawItem(!0,!1),void this.Canvas.restore();this.DrawItem(!0,!1)}},this.EraseTitle=function(){this.EraseRect&&(this.Canvas.fillStyle=this.EraseColor,this.Canvas.fillRect(this.EraseRect.Left,this.EraseRect.Top,this.EraseRect.Width,this.EraseRect.Height))},this.Draw=function(){if(this.TitleRect=null,this.SendUpdateUIMessage("Draw"),null!=this.CursorIndex&&this.Data&&!(this.Frame.ChartBorder.TitleHeight<5)&&0!=this.Frame.IsShowTitle){if(this.IsShowIndexName=this.Frame.IsShowIndexName,this.IsShowNameArrow=this.Frame.IsShowNameArrow,this.ParamSpace=this.Frame.IndexParamSpace,this.TitleSpace=this.Frame.IndexTitleSpace,!0===this.Frame.IsHScreen)return this.Canvas.save(),this.DrawItem(!1,!0),void this.Canvas.restore();this.DrawItem(!1,!0)}},this.GetTitleItem=function(t,e){if(!t||!t.Data||!t.Data.Data)return null;if(t.Data.Data.length<=0)return null;if(0==t.IsShow)return null;var a=null,i=null,r=null;if("StraightLine"==t.DataType)r=t.Data.Data[0],a=this.FormatValue(r,t);else{var n=this.CursorIndex-.5;if(n<0&&(n=0),n=parseInt(n.toFixed(0)),t.Data.DataOffset+n>=t.Data.Data.length)return null;if(r=t.Data.Data[t.Data.DataOffset+n],null==r)return null;if("HistoryData-Vol"==t.DataType)r=r.Vol,a=this.FormatValue(r,t);else if("MultiReport"==t.DataType)a=this.FormatMultiReport(r,t);else if("ChartStackedBar"==t.DataType){if(i=this.FromatStackedBarTitle(r,t),!i)return null}else a=t.GetTextCallback?t.GetTextCallback(r,t):this.FormatValue(r,t)}return a||i?{Text:a,ArrayText:i}:null},this.DrawItem=function(t,e){var a=!0===this.Frame.IsHScreen,i=this.Frame.ChartBorder.GetLeft()+15,r=this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.TitleHeight/2;"bottom"==this.TitleAlign&&(r=this.Frame.ChartBorder.GetTopEx()-this.TitleBottomDistance);var n=this.Frame.ChartBorder.GetRight();if(a){var s=this.Frame.ChartBorder.GetRightTitle(),o=this.Frame.ChartBorder.GetTop();this.Canvas.translate(s,o),this.Canvas.rotate(90*Math.PI/180),i=1,r=-this.Frame.ChartBorder.TitleHeight/2,"bottom"==this.TitleAlign&&(r=-this.TitleBottomDistance),n=this.Frame.ChartBorder.GetHeight()}if(this.EraseTitle(),this.Canvas.textAlign="left",this.Canvas.textBaseline=this.TitleAlign,this.Canvas.font=this.Font,this.TitleBG&&this.Title){c=this.Canvas.measureText(this.Title).width+2;var h=this.Frame.ChartBorder.TitleHeight,l=this.Frame.ChartBorder.GetTop();h>20&&(l+=(h-20)/2+(h-45)/2,h=20),"bottom"==this.TitleAlign&&(l=this.Frame.ChartBorder.GetTopEx()-20,l<0&&(l=0)),t&&(this.Canvas.fillStyle=this.TitleBG,this.Canvas.fillRect(i,l,c,h))}if(this.Title&&this.IsShowIndexName){var u=this.Canvas.measureText(this.Title);if(c=u.width+2,t)if(this.IsDrawTitleBG){var m=this.Title;this.IsShowNameArrow&&(m+="▼");var c=this.Canvas.measureText(m).width,S=this.Canvas.measureText("擎").width+2,f=c+4;if(this.Canvas.fillStyle=this.BGColor,a){this.TitleRect={Top:this.Frame.ChartBorder.GetTop(),Left:this.Frame.ChartBorder.GetRightTitle()+this.Frame.ChartBorder.TitleHeight/2-S/2,Width:S,Height:f};var I={Left:i,Top:-S-2,Width:f,Height:S};this.Canvas.fillRect(I.Left,I.Top,I.Width,I.Height),this.BGBorderColor&&(this.Canvas.strokeStyle=this.BGBorderColor,this.Canvas.strokeRect(C(I.Left),C(I.Top),D(I.Width),D(I.Height)))}else this.TitleRect={Left:i,Top:r-S/2-1,Width:f,Height:S},this.Canvas.fillRect(this.TitleRect.Left,this.TitleRect.Top,this.TitleRect.Width,this.TitleRect.Height),this.BGBorderColor&&(this.Canvas.strokeStyle=this.BGBorderColor,this.Canvas.strokeRect(C(this.TitleRect.Left),C(this.TitleRect.Top),D(this.TitleRect.Width),D(this.TitleRect.Height)));this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(m,i+1,r,c),c=f+2}else this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.Title,i,r,c);i+=c,i+=this.TitleSpace}if(this.ArgumentsText&&this.IsShowIndexName){c=this.Canvas.measureText(this.ArgumentsText).width+2;this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.ArgumentsText,i,r,c),i+=c,i+=this.TitleSpace}if(this.Text&&this.Text.length>0)for(var d in this.Text){var T=this.Text[d];this.Canvas.fillStyle=T.Color,c=this.Canvas.measureText(T.Text).width+2,this.Canvas.fillText(T.Text,i,r,c),i+=c}if(e)for(var p in this.Data){var v=this.Data[p],F=this.GetTitleItem(v,!1);if(F){var g=F.Text,A=F.ArrayText;if(A)for(var E=0;E<A.length;++E){var N=A[E];M=N.Name?N.Name+":"+N.Text:N.Text;c=this.Canvas.measureText(M).width+this.ParamSpace;if(i+c>n)break;this.Canvas.fillStyle=N.Color,this.Canvas.fillText(M,i,r,c),i+=c}else{var M=g;if(v.Name){var L=this.GetDynamicOutName(v.Name);M=L?L+":"+g:v.Name+":"+g}if(c=this.Canvas.measureText(M).width+this.ParamSpace,c+i>n)break;this.Canvas.fillStyle=v.Color,this.Canvas.fillText(M,i,r,c),i+=c}}}else{i+=4;var x=i,O=i;for(var p in this.Data){v=this.Data[p];if(v&&v.Data&&v.Data.Data&&!(v.Data.Data.length<=0)){var R="●"+v.Name;if(this.Canvas.fillStyle=v.Color,c=this.Canvas.measureText(R).width+this.ParamSpace,i+c>=n)break;this.Canvas.fillText(R,i,r,c),i+=c,x=i}}x>O&&(this.EraseRect=a?{Left:O,Right:x,Top:-(this.Frame.ChartBorder.TitleHeight-1),Width:x-O,Height:this.Frame.ChartBorder.TitleHeight-2}:{Left:O,Right:x,Top:this.Frame.ChartBorder.GetTop()+1,Width:x-O,Height:this.Frame.ChartBorder.TitleHeight-2})}},this.OnDrawTitleEvent=function(){var t=this.GetEventCallback(s.JSCHART_EVENT_ID.ON_INDEXTITLE_DRAW);if(t){var e={Index:null,Data:this.Data,Title:this.Title,FrameID:this.Frame.Identify};if(l.IFrameSplitOperator.IsNumber(this.CursorIndex)){var a=Math.abs(this.CursorIndex);a=parseInt(a.toFixed(0)),e.Index=a}var i=this.Frame.GetBorder();e.Left=i.LeftEx,e.Top=i.Top,e.Right=i.RightEx,t.Callback(t,e,this)}},this.DrawOverlayIndexSingleLine=function(){if(!(this.OverlayIndex.size<=0)){var t=!0===this.Frame.IsHScreen,e=this.Frame.GetBorder(),a=this.OverlayIndexType.LineSpace;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var i=this.Canvas.measureText("擎").width;if(t)var n=1,s=a,o=this.Frame.ChartBorder.GetHeight();else s=e.TopTitle+2,n=e.Left+1,o=e.Right,e.Bottom;var h=n,l=s;l=s+i/2;var u,C=(0,r.default)(this.OverlayIndex);try{for(C.s();!(u=C.n()).done;){var D=u.value,m=D[1];D[0];if(h=n,m.Title&&this.IsShowOverlayIndexName){var c=this.Canvas.measureText(m.Title).width+2;if(h+c<o){if(this.OverlayIndexType.BGColor){this.Canvas.fillStyle=this.OverlayIndexType.BGColor;var S={Left:h,Top:l-i/2,Width:c,Height:i+a};this.Canvas.fillRect(S.Left,S.Top,S.Width,S.Height)}this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(m.Title,h,l,c)}h+=c}for(var f=0;f<m.Data.length;++f){D=m.Data[f];var I=this.GetTitleItem(D,!1);if(I){var d=I.Text,T=I.ArrayText;if(T)for(var p=0;p<T.length;++p){var v=T[p];F=v.Name?v.Name+":"+v.Text:v.Text;c=this.Canvas.measureText(F).width+this.ParamSpace;if(n+c>o)break;this.Canvas.fillStyle=v.Color,this.Canvas.fillText(F,h,l,c),h+=c}else{var F=d;if(D.Name){var g=this.GetDynamicOutName(D.Name);F=g?g+":"+d:D.Name+":"+d}if(c=this.Canvas.measureText(F).width+this.ParamSpace,c+n>o)break;if(this.OverlayIndexType.BGColor){this.Canvas.fillStyle=this.OverlayIndexType.BGColor;S={Left:h,Top:l-i/2,Width:c,Height:i+a};this.Canvas.fillRect(S.Left,S.Top,S.Width,S.Height)}this.Canvas.fillStyle=D.Color,this.Canvas.fillText(F,h,l,c),h+=c}}}l+=i+a}}catch(A){C.e(A)}finally{C.f()}}}},e.DynamicKLineTitlePainting=S,e.DynamicMinuteTitlePainting=function(){this.newMethod=S,this.newMethod(),delete this.newMethod,this.YClose,this.IsShowDate=!1,this.IsShowName=!0,this.Symbol,this.UpperSymbol,this.LastShowData,this.ClassName="DynamicMinuteTitlePainting",this.SpaceWidth=2,this.IsShowAveragePrice=!0,this.GetCurrentKLineData=function(){if(this.LastShowData)return this.LastShowData;if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=Math.abs(this.CursorIndex);t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)return null;var a=this.Data.Data[e];return a},this.SendUpdateUIMessage=function(t){if(this.UpdateUICallback){var e={TitleName:"分钟标题",CallFunction:t,Stock:{Name:this.Name,Symbol:this.Symbol},Rect:{Left:this.Frame.ChartBorder.GetLeft(),Right:this.Frame.ChartBorder.GetRight(),Top:0,Bottom:this.Frame.ChartBorder.GetTop()}};if(this.Data&&this.Data.Data&&this.Data.Data.length>0){var a=this.Data.Data.length-1;if(this.CursorIndex){var i=Math.abs(this.CursorIndex-.5);i=parseInt(i.toFixed(0)),a=this.Data.DataOffset+i,a>=this.Data.Data.length&&(a=this.Data.Data.length-1)}if(a>=0){var r=this.Data.Data[a];this.LastShowData=r,e.Stock.Data={Time:r.Time,Close:r.Close,AvPrice:r.AvPrice,Vol:r.Vol,Amount:r.Amount},r.Time&&(e.Stock.Time=r.Time)}}this.UpdateUICallback(e)}},this.DrawTitle=function(){this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",this.SendUpdateUIMessage("DrawTitle"),this.OnDrawEventCallback(null,"DynamicMinuteTitlePainting::DrawTitle")},this.GetDecimal=function(t){return o.JSCommonCoordinateData.GetfloatPrecision(t)},this.DrawMulitLine=function(t){var e=this.Frame.ChartBorder.GetLeft()+5,a=(this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetWidth()),i=this.Frame.ChartBorder.GetTop(),r=this.GetDecimal(this.Symbol),s=(i-2)/this.LineCount,o=s;this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font,this.Canvas.fillStyle=this.UnchagneColor,this.Canvas.fillStyle=this.UnchagneColor;var h=l.IFrameSplitOperator.FormatDateTimeString(t.DateTime,this.IsShowDate?"YYYY-MM-DD":"HH-MM"),u=this.Canvas.measureText(h).width+5;if(this.Canvas.fillText(h,e,o,u),this.IsShowDate){h=l.IFrameSplitOperator.FormatDateTimeString(t.DateTime,"HH-MM");this.Canvas.fillText(h,e,o+s,u)}var C=(a-5-u)/2;if(e+=u,null!=t.Close){this.Canvas.fillStyle=this.GetColor(t.Close,this.YClose);h=n.g_JSChartLocalization.GetText("Tooltip-Price",this.LanguageID)+t.Close.toFixed(r);this.Canvas.fillText(h,e,o,C),e+=C}if(null!=t.Increase){this.Canvas.fillStyle=this.GetColor(t.Increase,0);h=n.g_JSChartLocalization.GetText("Tooltip-Increase",this.LanguageID)+t.Increase.toFixed(2)+"%";this.Canvas.fillText(h,e,o,C),e+=C}o+=s;e=this.Frame.ChartBorder.GetLeft()+5+u;this.Canvas.fillStyle=this.VolColor;h=n.g_JSChartLocalization.GetText("Tooltip-Vol",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(t.Vol,2,this.LanguageID);this.Canvas.fillText(h,e,o,C),e+=C,this.Canvas.fillStyle=this.AmountColor;h=n.g_JSChartLocalization.GetText("Tooltip-Amount",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(t.Amount,2,this.LanguageID);this.Canvas.fillText(h,e,o,C),e+=C},this.GetFormatTitle=function(t){if(!t||!t.Data)return null;var e=t.Data,a=this.GetDecimal(this.Symbol),i=[];this.IsShowName&&i.push({Text:this.Name,Color:this.NameColor});var r=l.IFrameSplitOperator.FormatDateTimeString(e.DateTime,this.IsShowDate?"YYYY-MM-DD HH-MM":"HH-MM");if(i.push({Text:r,Color:this.DateTimeColor}),l.IFrameSplitOperator.IsNumber(e.Close)){var s=this.GetColor(e.Close,this.YClose);r=n.g_JSChartLocalization.GetText("MTitle-Close",this.LanguageID)+e.Close.toFixed(a);i.push({Text:r,Color:s})}if(l.IFrameSplitOperator.IsNumber(e.Increase)){s=this.GetColor(e.Increase,0),r=n.g_JSChartLocalization.GetText("MTitle-Increase",this.LanguageID)+e.Increase.toFixed(2)+"%";i.push({Text:r,Color:s})}if(l.IFrameSplitOperator.IsNumber(e.AvPrice)&&1==this.IsShowAveragePrice){s=this.GetColor(e.AvPrice,this.YClose),r=n.g_JSChartLocalization.GetText("MTitle-AvPrice",this.LanguageID)+e.AvPrice.toFixed(a);i.push({Text:r,Color:s})}if(l.IFrameSplitOperator.IsNumber(e.Vol)){r=n.g_JSChartLocalization.GetText("MTitle-Vol",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(e.Vol,2,this.LanguageID);i.push({Text:r,Color:this.VolColor})}if(l.IFrameSplitOperator.IsNumber(e.Amount)){r=n.g_JSChartLocalization.GetText("MTitle-Amount",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(e.Amount,2,this.LanguageID);i.push({Text:r,Color:this.AmountColor})}if(u.IsChinaFutures(this.UpperSymbol)&&l.IFrameSplitOperator.IsNumber(e.Position)){r=n.g_JSChartLocalization.GetText("MTitle-Position",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(e.Position,2,this.LanguageID);i.push({Text:r,Color:this.VolColor})}return{AryText:i}},this.DrawItem=function(t){var e=!0===this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetTop()-this.Frame.ChartBorder.Top/2;this.Frame.ChartBorder.GetRight(),this.GetDecimal(this.Symbol);if(e){if(this.Frame.ChartBorder.Right<5)return;a=2,i=this.Frame.ChartBorder.Right/2,this.Frame.ChartBorder.GetHeight();var r=this.Frame.ChartBorder.GetChartWidth(),n=this.Frame.ChartBorder.GetTop();this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180)}else if(i<5)return;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var s={Left:a,Bottom:i,IsHScreen:e},o=this.GetFormatTitle({Data:t});if(o&&l.IFrameSplitOperator.IsNonEmptyArray(o.AryText))for(var h=0;h<o.AryText.length;++h){t=o.AryText[h];if(!this.DrawMinuteText(t.Text,t.Color,s,!0))break;l.IFrameSplitOperator.IsNumber(t.LeftSpace)&&(s.Left+=t.LeftSpace)}},this.FullDraw=function(){this.Draw()},this.Draw=function(){if(this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",this.LastShowData=null,this.SendUpdateUIMessage("Draw"),this.IsShow)if(null==this.CursorIndex||!this.Data||!this.Data.Data||this.Data.Data.length<=0)this.OnDrawEventCallback(null,"DynamicMinuteTitlePainting::Draw");else{this.TextSpace>=0?this.SpaceWidth=this.TextSpace:(this.Canvas.font=this.Font,this.SpaceWidth=this.Canvas.measureText(" ").width);var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=t+this.Data.DataOffset;e>=this.Data.Data.length&&(e=this.Data.Data.length-1);var a=this.Data.Data[e];this.LastShowData=a,this.OnDrawEventCallback(a,"DynamicMinuteTitlePainting::Draw"),this.LineCount>1&&!0!==this.Frame.IsHScreen?this.DrawMulitLine(a):(this.Canvas.save(),this.DrawItem(a),this.Canvas.restore())}},this.DrawMinuteText=function(t,e,a,i){if(!t)return!0;var r=!0===this.Frame.IsHScreen,n=this.Frame.ChartBorder.GetRight();r&&(n=this.Frame.ChartBorder.GetHeight()),this.Canvas.fillStyle=e;var s=this.Canvas.measureText(t).width;return!(a.Left+s>n)&&(!1!==i&&this.Canvas.fillText(t,a.Left,a.Bottom,s),a.Left+=s+this.SpaceWidth,!0)}},e.DynamicTitleData=function(t,e,a){this.Data=t,this.Name=e,this.Color=a,this.DataType,this.ChartClassName,this.StringFormat=f.DEFAULT,this.FloatPrecision=2,this.GetTextCallback,this.IsShow=!0},e.IChartTitlePainting=m,e.STRING_FORMAT_TYPE=void 0;var r=i(a("b85c"));a("e25e"),a("14d9"),a("99af"),a("d401"),a("d3b7"),a("25f0"),a("4ec9"),a("3ca3"),a("ddb0"),a("ac1f"),a("466d"),a("5319");var n=a("ee32"),s=a("8709"),o=a("966c"),h=a("52e0"),l=a("deed"),u=o.JSCommonCoordinateData.MARKET_SUFFIX_NAME;function C(t){return parseInt(t)+.5}function D(t){return.5+t<<0}function m(){this.Frame,this.Data=new Array,this.Canvas,this.IsDynamic=!1,this.Position=0,this.CursorIndex,this.Font=n.g_JSChartResource.DynamicTitleFont,this.Title,this.TitleColor=n.g_JSChartResource.DefaultTextColor,this.LanguageID=n.JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.UpdateUICallback,this.OnDrawEvent,this.GetEventCallback}var c=["不复权","前复权","后复权"];function S(){this.newMethod=m,this.newMethod(),delete this.newMethod,this.ClassName="DynamicKLineTitlePainting",this.IsDynamic=!0,this.IsShow=!0,this.LineCount=1,this.SpaceWidth=1,this.TextSpace=-1,this.DateTimeSpace=2,this.PeriodSpace=1,this.NameSpace=1,this.Period,this.UpColor=n.g_JSChartResource.UpTextColor,this.DownColor=n.g_JSChartResource.DownTextColor,this.UnchagneColor=n.g_JSChartResource.UnchagneTextColor,this.VolColor=n.g_JSChartResource.Title.VolColor,this.AmountColor=n.g_JSChartResource.Title.AmountColor,this.DateTimeColor=n.g_JSChartResource.Title.DateTimeColor,this.NameColor=n.g_JSChartResource.Title.NameColor,this.SettingColor=n.g_JSChartResource.Title.SettingColor,this.PositionColor=n.g_JSChartResource.Title.PositionColor,this.Symbol,this.UpperSymbol,this.Name,this.InfoData,this.InfoTextHeight=15,this.InfoTextColor=n.g_JSChartResource.KLine.Info.TextColor,this.InfoTextBGColor=n.g_JSChartResource.KLine.Info.TextBGColor,this.IsShowName=!0,this.IsShowSettingInfo=!0,this.HQChart,this.GetCurrentKLineData=function(){if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)return null;var a=this.Data.Data[e];return a},this.GetDataIndex=function(){if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;return e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0?null:e},this.SendUpdateUIMessage=function(t){if(this.UpdateUICallback){var e={TitleName:"K线标题",CallFunction:t,Stock:{Name:this.Name,Symbol:this.Symbol},Rect:{Left:this.Frame.ChartBorder.GetLeft(),Right:this.Frame.ChartBorder.GetRight(),Top:0,Bottom:this.Frame.ChartBorder.GetTop()}};if(this.Data&&this.Data.Data&&this.Data.Data.length>0){var a=this.Data.Data.length-1;if(this.CursorIndex){var i=Math.abs(this.CursorIndex-.5);i=parseInt(i.toFixed(0)),a=this.Data.DataOffset+i,a>=this.Data.Data.length&&(a=this.Data.Data.length-1)}if(a>=0){var r=this.Data.Data[a];e.Stock.Data={Date:r.Date,YClose:r.YClose,Open:r.Open,High:r.High,Low:r.Low,Close:r.Close,Vol:r.Vol,Amount:r.Amount},r.Time&&(e.Stock.Time=r.Time)}null!=this.Data.Period&&(e.Stock.PeriodName=this.GetPeriodName(this.Data.Period)),null!=this.Data.Right&&(e.Stock.RightName=c[this.Data.Right])}this.UpdateUICallback(e)}},this.GetPeriodName=function(t){var e="";return e=t>s.CUSTOM_MINUTE_PERIOD_START&&t<=s.CUSTOM_MINUTE_PERIOD_END?t-s.CUSTOM_MINUTE_PERIOD_START+n.g_JSChartLocalization.GetText("自定义分钟",this.LanguageID):t>s.CUSTOM_DAY_PERIOD_START&&t<=s.CUSTOM_DAY_PERIOD_END?t-s.CUSTOM_DAY_PERIOD_START+n.g_JSChartLocalization.GetText("自定义日线",this.LanguageID):t>s.CUSTOM_SECOND_PERIOD_START&&t<=s.CUSTOM_SECOND_PERIOD_END?t-s.CUSTOM_SECOND_PERIOD_START+n.g_JSChartLocalization.GetText("自定义秒",this.LanguageID):n.g_JSChartLocalization.GetText(s.ChartData.GetPeriodName(t),this.LanguageID),e},this.GetRightName=function(t,e){if(!u.IsEnableRight(e,this.Symbol,this.HQChart.RightFormula))return null;var a=c[t];return a},this.FullDraw=function(){if(this.IsShow)if(this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",null==this.CursorIndex||!this.Data||this.Data.length<=0)this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::FullDraw");else{this.TextSpace>=0?this.SpaceWidth=this.TextSpace:(this.Canvas.font=this.Font,this.SpaceWidth=this.Canvas.measureText(" ").width);var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=-1),e<0)this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::FullDraw");else{var a=this.Data.Data[e];this.OnDrawEventCallback(a,"DynamicKLineTitlePainting::FullDraw"),!0===this.Frame.IsHScreen?(this.Canvas.save(),this.LineCount>1?this.DrawMulitLine(a):this.DrawSingleLine(a,!0),this.Canvas.restore(),!a.Time&&a.Date&&this.InfoData&&this.HSCreenKLineInfoDraw(a.Date)):(this.LineCount>1?this.DrawMulitLine(a):this.DrawSingleLine(a,!0),!a.Time&&a.Date&&this.InfoData&&this.KLineInfoDraw(a.Date))}}},this.DrawTitle=function(){if(this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",this.SendUpdateUIMessage("DrawTitle"),this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::DrawTitle"),this.IsShow&&(this.IsShowName||this.IsShowSettingInfo)&&!(this.LineCount>1)){if(!0===this.Frame.IsHScreen)return this.Canvas.save(),this.HScreenDrawTitle(),void this.Canvas.restore();var t=this.Frame.ChartBorder.GetLeft(),e=this.Frame.ChartBorder.GetTop();this.Frame.ChartBorder.GetRight();if(!(e<5)){this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var a={Left:t,Bottom:e,IsHScreen:!1};if((!this.IsShowName||!this.Name||this.DrawKLineText(this.Name,this.NameColor,a))&&this.IsShowSettingInfo&&null!=this.Data.Period&&null!=this.Data.Right){var i=this.GetPeriodName(this.Data.Period),r=this.GetRightName(this.Data.Right,this.Data.Period),n="("+i+")";if(r&&(n="("+i+" "+r+")"),!this.DrawKLineText(n,this.SettingColor,a))return}}}},this.HScreenDrawTitle=function(){var t=this.Frame.ChartBorder.GetRight(),e=this.Frame.ChartBorder.GetTop();this.Frame.ChartBorder.GetHeight();if(!(this.Frame.ChartBorder.Right<10)){this.Canvas.translate(t,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var a={Left:2,Bottom:-2,IsHScreen:!1};if((!this.IsShowName||!this.Name||this.DrawKLineText(this.Name,this.NameColor,a))&&this.IsShowSettingInfo&&null!=this.Data.Period&&null!=this.Data.Right){var i=this.GetPeriodName(this.Data.Period),r=this.GetRightName(this.Data.Right,this.Data.Period),n="("+i+")";if(r&&(n="("+i+" "+r+")"),!this.DrawKLineText(n,this.SettingColor,a))return}}},this.DrawMulitLine=function(t){var e=!0===this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft()+1,i=this.Frame.ChartBorder.GetWidth(),r=this.Frame.ChartBorder.GetTop(),h=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);if(e){a=1,i=this.Frame.ChartBorder.GetHeight(),r=this.Frame.ChartBorder.Right;var u=this.Frame.ChartBorder.GetChartWidth(),C=this.Frame.ChartBorder.GetTop();this.Canvas.translate(u,C),this.Canvas.rotate(90*Math.PI/180)}var D=(r-1)/this.LineCount,m=(i-1)/4,c=D;this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var S=l.IFrameSplitOperator.FormatDateString(t.Date);this.Canvas.fillStyle=this.DateTimeColor,this.Canvas.fillText(S,a,c,m),a+=m,this.Canvas.textAlign="left",this.Canvas.fillStyle=this.GetColor(t.Open,t.YClose);S=n.g_JSChartLocalization.GetText("Tooltip-Open",this.LanguageID)+t.Open.toFixed(h);this.Canvas.fillText(S,a,c,m),a+=m,this.Canvas.fillStyle=this.GetColor(t.High,t.YClose);S=n.g_JSChartLocalization.GetText("Tooltip-High",this.LanguageID)+t.High.toFixed(h);this.Canvas.fillText(S,a,c,m),a+=m;var f=(t.Close-t.YClose)/t.YClose*100;this.Canvas.fillStyle=this.GetColor(f,0);S=n.g_JSChartLocalization.GetText("Tooltip-Increase",this.LanguageID)+f.toFixed(2)+"%";this.Canvas.fillText(S,a,c,m),a+=m,c+=D;a=this.Frame.ChartBorder.GetLeft()+1;if(e&&(a=1),s.ChartData.IsMinutePeriod(this.Period,!0)&&t.Time){this.Canvas.fillStyle=this.DateTimeColor;S=l.IFrameSplitOperator.FormatTimeString(t.Time);this.Canvas.fillText(S,a,c,m)}else if(s.ChartData.IsSecondPeriod(this.Period)&&t.Time){this.Canvas.fillStyle=this.SettingColor;S=l.IFrameSplitOperator.FormatTimeString(t.Time,"HH:MM:SS");this.Canvas.fillText(S,a,c,m)}a+=m,this.Canvas.fillStyle=this.GetColor(t.Close,t.YClose);S=n.g_JSChartLocalization.GetText("Tooltip-Close",this.LanguageID)+t.Close.toFixed(h);this.Canvas.fillText(S,a,c,m),a+=m,this.Canvas.fillStyle=this.GetColor(t.Low,t.YClose);S=n.g_JSChartLocalization.GetText("Tooltip-Low",this.LanguageID)+t.Low.toFixed(h);this.Canvas.fillText(S,a,c,m),a+=m,this.Canvas.fillStyle=this.AmountColor;S=n.g_JSChartLocalization.GetText("Tooltip-Amount",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(t.Amount,2,this.LanguageID);this.Canvas.fillText(S,a,c,m),a+=m},this.GetFormatTitle=function(t){if(!t||!t.Data)return null;var e=[],a=t.Data,i=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);if(this.IsShowName&&e.push({Text:this.Name,Color:this.NameColor,LeftSpace:this.NameSpace}),this.IsShowSettingInfo){var r=this.GetPeriodName(this.Data.Period),h=this.GetRightName(this.Data.Right,this.Data.Period),C="("+r+")";h&&(C="("+r+" "+h+")"),e.push({Text:C,Color:this.SettingColor,LeftSpace:this.PeriodSpace})}C=l.IFrameSplitOperator.FormatDateString(a.Date);if(s.ChartData.IsDayPeriod(this.Period,!0))e.push({Text:C,Color:this.DateTimeColor,LeftSpace:this.DateTimeSpace});else if(s.ChartData.IsMinutePeriod(this.Period,!0)){if(l.IFrameSplitOperator.IsNumber(a.Time)){var D=l.IFrameSplitOperator.FormatTimeString(a.Time,"HH:MM");C="".concat(C," ").concat(D)}e.push({Text:C,Color:this.DateTimeColor,LeftSpace:this.DateTimeSpace})}else if(s.ChartData.IsSecondPeriod(this.Period)){if(l.IFrameSplitOperator.IsNumber(a.Time)){D=l.IFrameSplitOperator.FormatTimeString(a.Time,"HH:MM:SS");C="".concat(C," ").concat(D)}e.push({Text:C,Color:this.DateTimeColor,LeftSpace:this.DateTimeSpace})}if(l.IFrameSplitOperator.IsNumber(a.Open)){var m=this.GetColor(a.Open,a.YClose);C=n.g_JSChartLocalization.GetText("KTitle-Open",this.LanguageID)+a.Open.toFixed(i);e.push({Text:C,Color:m})}if(l.IFrameSplitOperator.IsNumber(a.High)){m=this.GetColor(a.High,a.YClose),C=n.g_JSChartLocalization.GetText("KTitle-High",this.LanguageID)+a.High.toFixed(i);e.push({Text:C,Color:m})}if(l.IFrameSplitOperator.IsNumber(a.Low)){m=this.GetColor(a.Low,a.YClose),C=n.g_JSChartLocalization.GetText("KTitle-Low",this.LanguageID)+a.Low.toFixed(i);e.push({Text:C,Color:m})}if(l.IFrameSplitOperator.IsNumber(a.Close)){m=this.GetColor(a.Close,a.YClose),C=n.g_JSChartLocalization.GetText("KTitle-Close",this.LanguageID)+a.Close.toFixed(i);e.push({Text:C,Color:m})}if(l.IFrameSplitOperator.IsNumber(a.Vol)){C=n.g_JSChartLocalization.GetText("KTitle-Vol",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(a.Vol,2,this.LanguageID);e.push({Text:C,Color:this.VolColor})}if(l.IFrameSplitOperator.IsNumber(a.Amount)){C=n.g_JSChartLocalization.GetText("KTitle-Amount",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(a.Amount,2,this.LanguageID);e.push({Text:C,Color:this.AmountColor})}if(u.IsChinaFutures(this.UpperSymbol)&&l.IFrameSplitOperator.IsNumber(a.Position)){C=n.g_JSChartLocalization.GetText("KTitle-Position",this.LanguageID)+l.IFrameSplitOperator.FormatValueString(a.Position,2,this.LanguageID);e.push({Text:C,Color:this.PositionColor})}return{AryText:e}},this.DrawSingleLine=function(t,e){var a=!0===this.Frame.IsHScreen,i=this.Frame.ChartBorder.GetLeft(),r=this.Frame.ChartBorder.GetTop();this.Frame.ChartBorder.GetRight(),o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);if(a){if(this.Frame.ChartBorder.GetHeight(),this.Frame.ChartBorder.Right<5)return;i=2,r=-2;var n=this.Frame.ChartBorder.GetRight(),s=this.Frame.ChartBorder.GetTop();this.Canvas.translate(n,s),this.Canvas.rotate(90*Math.PI/180)}else if(r<5)return;this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var h={Left:i,Bottom:r,IsHScreen:a},u=this.GetFormatTitle({Data:t});if(u&&l.IFrameSplitOperator.IsNonEmptyArray(u.AryText))for(var C=0;C<u.AryText.length;++C){t=u.AryText[C];if(!this.DrawKLineText(t.Text,t.Color,h,1==e))break;l.IFrameSplitOperator.IsNumber(t.LeftSpace)&&(h.Left+=t.LeftSpace)}},this.OnDrawEventCallback=function(t,e){if(this.OnDrawEvent&&this.OnDrawEvent.Callback){var a={Draw:t,Name:this.ClassName,Explain:e};if(this.Data&&this.Data.Data){if(l.IFrameSplitOperator.IsNumber(this.CursorIndex)){var i=this.CursorIndex;i=parseInt(i.toFixed(0));var r=this.Data.DataOffset+i}else r=this.Data.Data.length-1;var n=this.Data.Data.length;a.DataIndex=r,a.DataCount=n}this.OnDrawEvent.Callback(this.OnDrawEvent,a,this)}},this.Draw=function(){if(this.UpperSymbol=this.Symbol?this.Symbol.toUpperCase():"",this.SendUpdateUIMessage("Draw"),this.IsShow)if(null==this.CursorIndex||!this.Data||this.Data.length<=0)this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::Draw");else{this.SpaceWidth=this.Canvas.measureText(" ").width;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)this.OnDrawEventCallback(null,"DynamicKLineTitlePainting::Draw");else{var a=this.Data.Data[e];this.OnDrawEventCallback(a,"DynamicKLineTitlePainting::Draw"),!0===this.Frame.IsHScreen?(this.Canvas.save(),this.LineCount>1?this.DrawMulitLine(a):this.DrawSingleLine(a),this.Canvas.restore(),!a.Time&&a.Date&&this.InfoData&&this.HSCreenKLineInfoDraw(a.Date)):(this.LineCount>1?this.DrawMulitLine(a):this.DrawSingleLine(a),!a.Time&&a.Date&&this.InfoData&&this.KLineInfoDraw(a.Date))}}},this.KLineInfoDraw=function(t){var e=this.InfoData.get(t.toString());if(e){var a=0,i=0,r=0,n=0,s=0,o=null,u=null,C=null;for(var D in e.Data){var m=e.Data[D];switch(m.InfoType){case h.KLINE_INFO_TYPE.INVESTOR:++a;break;case h.KLINE_INFO_TYPE.PFORECAST:C=m.Title;break;case h.KLINE_INFO_TYPE.ANNOUNCEMENT:++r;break;case h.KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_1:case h.KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_2:case h.KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_3:case h.KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_4:u=m.Title;break;case h.KLINE_INFO_TYPE.RESEARCH:++i;break;case h.KLINE_INFO_TYPE.BLOCKTRADING:++n;break;case h.KLINE_INFO_TYPE.TRADEDETAIL:++s;break;case h.KLINE_INFO_TYPE.POLICY:o=m;break}}var c=!0===this.Frame.IsHScreen,S=this.Frame.ChartBorder.GetRight()-4,f=this.Frame.ChartBorder.GetTopEx();c&&(S=this.Frame.ChartBorder.GetBottom()-4,f=this.Frame.ChartBorder.GetRightEx(),this.Canvas.translate(f,S),this.Canvas.rotate(90*Math.PI/180),S=0,f=0),this.Canvas.font=this.Font;var I=[],d={Top:f,Right:S,IsHScreen:c};if(I.push(l.IFrameSplitOperator.FormatDateString(t)),u&&I.push(u),C&&I.push(C),r>0&&I.push("公告数量:"+r),i>0&&I.push("机构调研次数:"+i),s>0&&I.push("龙虎榜上榜次数:"+s),a>0&&I.push("互动易数量:"+a),n>0&&I.push("大宗交易次数:"+n),o)for(var T in o.ExtendData)I.push(o.ExtendData[T].Name);var p=0,v=0;for(var F in I){m=I[F];var g=this.Canvas.measureText(m).width+2;p<g&&(p=g),v+=this.InfoTextHeight}for(var A in this.Canvas.fillStyle=this.InfoTextBGColor,this.Canvas.fillRect(d.Right-p,d.Top,p+2,v+2),I){m=I[A];this.DrawInfoText(m,d)}}},this.HSCreenKLineInfoDraw=function(t){this.Canvas.save(),this.KLineInfoDraw(t),this.Canvas.restore()},this.GetColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.DrawInfoText=function(t,e){return!t||(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.InfoTextColor,this.Canvas.fillText(t,e.Right,e.Top),e.Top+=this.InfoTextHeight,!0)},this.DrawKLineText=function(t,e,a,i){if(!t)return!0;var r=!0===this.Frame.IsHScreen,n=this.Frame.ChartBorder.GetRight();r&&(n=this.Frame.ChartBorder.GetHeight()),this.Canvas.fillStyle=e;var s=this.Canvas.measureText(t).width;return!(a.Left+s>n)&&(!1!==i&&this.Canvas.fillText(t,a.Left,a.Bottom,s),a.Left+=s+this.SpaceWidth,!0)}}var f={DEFAULT:1,ORIGINAL:2,THOUSANDS:21};e.STRING_FORMAT_TYPE=f},b1ef:function(t,e,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.APIScriptIndex=function(t,e,a,i,r){this.newMethod=r?d:f;this.newMethod(t,e,a,i),delete this.newMethod,this.ApiUrl,this.HQDataType,i.API&&(i.API.Url&&(this.ApiUrl=i.API.Url),i.API.Name&&(this.Name=this.ID=i.API.Name),i.API.ID&&(this.ID=i.API.ID));this.ExecuteScript=function(t,e,a){o.JSConsole.Chart.Log("[APIScriptIndex::ExecuteScript] name, Arguments ",this.Name,this.Arguments);var i=I.KLINE_ID,r=null;"MinuteChartContainer"===t.ClassName||"MinuteChartHScreenContainer"===t.ClassName?(i=t.DayCount>1?I.MULTIDAY_MINUTE_ID:I.MINUTE_ID,r=a.GetDateRange()):"HistoryMinuteChartContainer"===t.ClassName?i=I.HISTORY_MINUTE_ID:r=a.GetDateRange();var n,s=[];if(this.Arguments)for(var h in this.Arguments){var l=this.Arguments[h];s.push({name:l.Name,value:l.Value})}t.GetRequestDataCount&&(n=t.GetRequestDataCount());var u=this,C={indexname:this.ID,symbol:t.Symbol,script:this.Script,args:s,period:t.Period,right:t.Right,hqdatatype:i};if(r&&(C.DateRange=r),n&&(C.maxdatacount=n.MaxRequestDataCount,C.maxminutedaycount=n.MaxRequestMinuteDayCount),i!=I.MULTIDAY_MINUTE_ID&&i!=I.MINUTE_ID||(C.daycount=t.DayCount),this.HQDataType=i,t.NetworkFilter){var D={Name:"APIScriptIndex::ExecuteScript",Explain:"指标计算",Request:{Url:u.ApiUrl,Type:"POST",Data:C},Self:this,HQChart:t,PreventDefault:!1};if(t.NetworkFilter(D,(function(i){u.RecvAPIData(i,t,e,a)})),1==D.PreventDefault)return}wx.request({url:u.ApiUrl,data:C,method:"POST",dataType:"json",async:!0,success:function(i){u.RecvAPIData(i,t,e,a)},error:function(t){u.RecvError(t)}})},this.RecvAPIData=function(t,e,a,i){var r=t.data;if(o.JSConsole.Chart.Log("[APIScriptIndex::RecvAPIData] recv data ",this.Name,r),0==r.code){if(r.outdata&&r.outdata.name&&(this.Name=r.outdata.name),r.outdata.args)for(var n in this.Arguments=[],r.outdata.args){var s=r.outdata.args[n];this.Arguments.push({Name:s.name,Value:s.value})}if(this.HQDataType==I.KLINE_ID?(this.OutVar=this.FittingData(r.outdata,e),o.JSConsole.Chart.Log("[APIScriptIndex::RecvAPIData] conver to OutVar ",this.OutVar)):this.OutVar=this.FittingMinuteData(r.outdata,e),this.BindData(e,a,i),0==this.IsLocked)e.Frame.SubFrame[a].Frame.SetLock(null);else{var h={IsLocked:!0,Callback:this.LockCallback,IndexName:this.Name,ID:this.LockID,BG:this.LockBG,Text:this.LockText,TextColor:this.LockTextColor,Font:this.LockFont,Count:this.LockCount,MinWidth:this.LockMinWidth};e.Frame.SubFrame[a].Frame.SetLock(h)}if(e.UpdataDataoffset(),e.UpdateFrameMaxMin(),e.Draw(),e.GetIndexEvent){var l=e.GetIndexEvent();if(l){r={OutVar:this.OutVar,WindowIndex:a,Name:this.Name,Arguments:this.Arguments,HistoryData:i,Stock:{Symbol:e.Symbol,Name:e.Name}};l.Callback(l,r,this)}}}},this.FittingData=function(t,e){var a=t.outvar,i=t.date,r=t.time,n=(e.ChartPaint[0].Data,[]);for(var o in a){var h=a[o],l={Name:h.name,Type:h.type};if(h.color&&(l.Color=h.color),h.data)l.Data=this.FittingArray(h.data,i,r,e),h.color&&(l.Color=h.color),h.linewidth>=1&&(l.LineWidth=h.linewidth),0==h.isshow&&(l.IsShow=!1),1==h.isexdata&&(l.IsExData=!0),n.push(l);else if(h.Draw){var C=h.Draw,D={};if("DRAWICON"==C.DrawType)D.Icon=C.Icon,u.IFrameSplitOperator.IsNumber(C.IconType)&&(D.Icon=s.JSCommonComplier.g_JSComplierResource.GetDrawTextIcon(C.IconType)),D.Name=C.Name,D.DrawType=C.DrawType,D.DrawData=this.FittingArray(C.DrawData,i,r,e),l.Draw=D,n.push(l);else if("DRAWTEXT"==C.DrawType)D.Text=C.Text,D.Name=C.Name,D.DrawType=C.DrawType,D.DrawData=this.FittingArray(C.DrawData,i,r,e),l.Draw=D,n.push(l);else if("STICKLINE"==C.DrawType)D.Name=C.Name,D.Type=C.Type,D.Width=C.Width,D.DrawType=C.DrawType,D.DrawData=this.FittingArray(C.DrawData,i,r,e,1),l.Draw=D,n.push(l);else if("DRAWBAND"==C.DrawType)D.Name=C.Name,D.Type=C.Type,D.DrawType=C.DrawType,D.DrawData=this.FittingArray(C.DrawData,i,r,e,1),D.Color=C.Color,l.Draw=D,n.push(l);else if("MULTI_LINE"==C.DrawType){if(D.Text=C.Text,D.Name=C.Name,D.DrawType=C.DrawType,D.DrawData=this.FittingMultiLine(C.DrawData,i,r,e),l.Draw=D,u.IFrameSplitOperator.IsNonEmptyArray(D.DrawData))for(var m=0;m<D.DrawData.length;++m)this.GetKLineData(D.DrawData[m].Point,e);C.LineDash&&(D.LineDash=C.LineDash),C.Arrow&&(D.Arrow=C.Arrow),u.IFrameSplitOperator.IsNumber(C.LineWidth)&&(D.LineWidth=C.LineWidth),n.push(l)}else if("MULTI_POINT"==C.DrawType){if(D.Text=C.Text,D.Name=C.Name,D.DrawType=C.DrawType,D.DrawData=this.FittingMultiLine(C.DrawData,i,r,e),l.Draw=D,u.IFrameSplitOperator.IsNonEmptyArray(D.DrawData))for(m=0;m<D.DrawData.length;++m)this.GetKLineData(D.DrawData[m].Point,e);n.push(l)}else"MULTI_BAR"==C.DrawType?(D.Text=C.Text,D.Name=C.Name,D.DrawType=C.DrawType,D.DrawData=this.FittingMultiLine(C.DrawData,i,r,e),l.Draw=D,n.push(l)):C.DrawType==S.OVERLAY_BARS?(D.Name=C.Name,D.Type=C.Type,D.DrawType=C.DrawType,D.BarName=C.BarName,D.BarColor=C.BarColor,D.LineWidth=C.LineWidth,D.BarType=C.BarType,D.DrawData=this.FittingArray(C.DrawData,i,r,e,1),l.Draw=D,n.push(l)):"MULTI_TEXT"==C.DrawType?(D.Text=C.Text,D.Name=C.Name,D.DrawType=C.DrawType,D.DrawData=this.FittingMultiText(C.DrawData,i,r,e),this.GetKLineData(D.DrawData,e),l.Draw=D,n.push(l)):"MULTI_HTMLDOM"==C.DrawType?(D.Text=C.Text,D.Name=C.Name,D.DrawType=C.DrawType,D.Callback=C.Callback,D.DrawData=this.FittingMultiText(C.DrawData,i,r,e),this.GetKLineData(D.DrawData,e),l.Draw=D,n.push(l)):"KLINE_BG"==C.DrawType&&(D.Name=C.Name,D.DrawType=C.DrawType,D.DrawData={Color:C.Color,Angle:C.Angle},D.DrawData.Data=this.FittingKLineBG(C.DrawData,e),l.Draw=D,l.Name=C.DrawType,n.push(l))}}return n},this.GetKLineData=function(t,e){if(t&&Array.isArray(t)){var a=e.ChartPaint[0].Data;for(var i in t){var r=t[i];if(u.IFrameSplitOperator.IsString(r.Value)&&(u.IFrameSplitOperator.IsNumber(r.Index)&&!(r.Index<0||r.Index>=a.Data.length))){var n=r.Value.toUpperCase(),s=a.Data[r.Index];switch(n){case"HIGH":case"H":r.Value=s.High;break;case"L":case"LOW":r.Value=s.Low;break}}}}},this.FittingKLineBG=function(t,e){var a=e.ChartPaint[0].Data,i=[];if(h.ChartData.IsDayPeriod(e.Period,!0)){for(var r=!1,n=0,s=0;n<a.Data.length;){i[n]=0;var o=a.Data[n];if(s>=t.length)++n;else{var l=t[s];l.Date<o.Date?++s:(l.Date>o.Date||(r=!0,i[n]=1,++s),++n)}}if(r)return i}else if(h.ChartData.IsMinutePeriod(e.Period,!0)){for(r=!1,n=0,s=0;n<a.Data.length;){i[n]=0;o=a.Data[n];if(s>=t.length)++n;else{l=t[s];l.Date<o.Date||l.Date==o.Date&&l.Time<o.Time?++s:(l.Date>o.Date||l.Date==o.Date&&l.Time>o.Time||(r=!0,i[n]=1,++s),++n)}}if(r)return i}return null},this.FittingArray=function(t,e,a,i,r){var n,s=i.ChartPaint[0].Data,o=[];for(var l in t){var u=t[l],C=new h.SingleData;C.Date=e[l],a&&l<a.length&&(C.Time=a[l]),C.Value=u,o.push(C)}n=h.ChartData.IsDayPeriod(i.Period,!0)?s.GetFittingData(o):s.GetMinuteFittingData(o);var D,m=new h.ChartData;return m.Data=n,D=1==r?m.GetObject():m.GetValue(),D},this.FittingMultiLine=function(t,e,a,i){var r=i.ChartPaint[0].Data;if(h.ChartData.IsDayPeriod(i.Period,!0)){var n=[];for(var s in t){var o=t[s];for(var l in o.Point){var u=o.Point[l];n.push(u)}}return n.sort((function(t,e){return t.Date-e.Date})),r.GetDateIndex(n),t}if(h.ChartData.IsMinutePeriod(i.Period,!0)){n=[];for(var s in t){o=t[s];for(var l in o.Point){u=o.Point[l];n.push(u)}}return n.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),r.GetDateTimeIndex(n),t}return null},this.FittingMultiText=function(t,e,a,i){var r=i.ChartPaint[0].Data;return h.ChartData.IsDayPeriod(i.Period,!0)?(t.sort((function(t,e){return t.Date-e.Date})),r.GetDateIndex(t),t):h.ChartData.IsMinutePeriod(i.Period,!0)?(t.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),r.GetDateTimeIndex(t),t):null},this.FittingMinuteData=function(t,e){var a=t.outvar,i=t.date,r=t.time,n=[];for(var s in a){var o=a[s],h={Name:o.name,Type:o.type};if(o.data)h.Data=this.FittingMinuteArray(o.data,i,r,e),o.color&&(h.Color=o.color),o.linewidth>=1&&(h.LineWidth=o.linewidth),0==o.isshow&&(h.IsShow=!1),1==o.isexdata&&(h.IsExData=!0),n.push(h);else if(o.Draw){var l=o.Draw,C={};if("DRAWICON"==l.DrawType)C.Icon=l.Icon,C.Name=l.Name,C.DrawType=l.DrawType,C.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e),h.Draw=C,n.push(h);else if("DRAWTEXT"==l.DrawType)C.Text=l.Text,C.Name=l.Name,C.DrawType=l.DrawType,C.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e),h.Draw=C,n.push(h);else if("STICKLINE"==l.DrawType)C.Name=l.Name,C.Type=l.Type,C.Width=l.Width,C.DrawType=l.DrawType,C.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e,1),h.Draw=C,n.push(h);else if(l.DrawType==S.OVERLAY_BARS)C.Name=l.Name,C.Type=l.Type,C.DrawType=l.DrawType,C.BarName=l.BarName,C.BarColor=l.BarColor,C.LineWidth=l.LineWidth,C.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e,1),h.Draw=C,n.push(h);else if("MULTI_LINE"==l.DrawType){for(var D in C.Text=l.Text,C.Name=l.Name,C.DrawType=l.DrawType,C.DrawData=this.FittingMultiLine(l.DrawData,i,r,e),C.DrawData)this.GetKLineData(C.DrawData[D].Point,e);h.Draw=C,l.LineDash&&(C.LineDash=l.LineDash),l.Arrow&&(C.Arrow=l.Arrow),u.IFrameSplitOperator.IsNumber(l.LineWidth)&&(C.LineWidth=l.LineWidth),n.push(h)}else if("MULTI_POINT"==l.DrawType){for(var D in C.Text=l.Text,C.Name=l.Name,C.DrawType=l.DrawType,C.DrawData=this.FittingMultiLine(l.DrawData,i,r,e),C.DrawData)this.GetKLineData(C.DrawData[D].Point,e);h.Draw=C,n.push(h)}else"MULTI_TEXT"==l.DrawType?(C.Text=l.Text,C.Name=l.Name,C.DrawType=l.DrawType,C.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(C.DrawData,e),h.Draw=C,n.push(h)):"MULTI_SVGICON"==l.DrawType?(C.Text=l.Text,C.Name=l.Name,C.DrawType=l.DrawType,C.DrawData={Icon:this.FittingMultiText(l.DrawData.Icon,i,r,e),Family:l.DrawData.Family},this.GetKLineData(C.DrawData.Icon,e),h.Draw=C,n.push(h)):"MULTI_HTMLDOM"==l.DrawType&&(C.Text=l.Text,C.Name=l.Name,C.DrawType=l.DrawType,C.Callback=l.Callback,C.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(C.DrawData,e),h.Draw=C,n.push(h))}}return n},this.FittingMinuteArray=function(t,e,a,i){var r=i.SourceData,n=[];for(var s in t){var o=t[s],l=new h.SingleData;l.Date=e[s],a&&s<a.length&&(l.Time=a[s]),l.Value=o,n.push(l)}var u=r.GetMinuteFittingData(n),C=new h.ChartData;C.Data=u;var D=C.GetValue();return D}},e.BaseIndex=c,e.BenfordIndex=function(){this.newMethod=c,this.newMethod("财务风险"),delete this.newMethod,this.Index=new Array(new m("区域",null),new m("系数",null)),this.Data,this.ApiUrl=n.g_JSChartResource.Index.StockHistoryDayApiUrl,this.Index[0].LineColor=n.g_JSChartResource.Index.LineColor[0],this.Index[1].LineColor="rgb(105,105,105)",this.Create=function(t,e){for(var a in this.Index){var i=null;0==a?i=new ChartStraightArea:1==a&&(i=new l.ChartLineMultiData),i&&(i.Color=this.Index[a].LineColor,i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i))}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};if(this.Data=[],2!=r.HQChart.Period)return this.NotSupport(r.HQChart,r.WindowIndex,"只支持月线"),r.HQChart.Draw(),!1;return JSNetwork.HttpRequest({url:this.ApiUrl,data:{symbol:[r.HQChart.Symbol],field:["finance.benford","announcement2.quarter","announcement1.quarter","announcement3.quarter","announcement4.quarter"],condition:[{item:["date","int32","gte","20130101"]},{item:["announcement1.year","int32","gte",0,"announcement2.year","int32","gte",0,"announcement3.year","int32","gte",0,"announcement4.year","int32","gte",0,"or"]}]},method:"POST",dataType:"json",success:function(t){i.RecvData(t,r)}}),!0},this.JsonDataToMapSingleData=function(t){var e=t.stock[0].stockday,a=new Map;for(var i in e){var n=e[i],s=new h.SingleData;if(s.Date=n.date,s.Value=new Array,null!=n.finance1&&null!=n.announcement1){var o=n.announcement1.year,l=n.announcement1.quarter,u=n.finance1.benford;s.Value.push({Year:o,Quarter:l,Value:u})}if(null!=n.finance2&&null!=n.announcement2){var C=n.announcement2.year,D=n.announcement2.quarter,m=n.finance2.benford;s.Value.push({Year:C,Quarter:D,Value:m})}if(null!=n.finance3&&null!=n.announcement3){var c=n.announcement3.year,S=n.announcement3.quarter,f=n.finance3.benford;s.Value.push({Year:c,Quarter:S,Value:f})}if(null!=n.finance4&&null!=n.announcement4){var I=n.announcement4.year,d=n.announcement4.quarter,T=n.finance4.benford;s.Value.push({Year:I,Quarter:d,Value:T})}a.set(s.Date,s)}var p,v=new Array,F=(0,r.default)(a);try{for(F.s();!(p=F.n()).done;){n=p.value;v.push(n[1])}}catch(g){F.e(g)}finally{F.f()}return v},this.RecvData=function(t,e){if(o.JSConsole.Chart.Log(t),!(null==t.data.stock||t.data.stock.length<=0)){var a=this.JsonDataToMapSingleData(t.data),i=e.HistoryData.GetFittingMonthData(a),r=new h.ChartData;r.Data=i,r.Period=e.HQChart.Period,r.Right=e.HQChart.Right,this.Data=r.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].NotSupportMessage=null,i[0].Data.Data=[{Value:0,Value2:.2,Color:"rgb(219,255,193)",Title:"安全区",TitleColor:"rgb(66,192,99)"},{Value:.2,Value2:.4,Color:"rgb(255,228,170)",Title:"预警区",TitleColor:"rgb(255,124,3)"},{Value:.4,Value2:1,Color:"rgb(254,219,212)",Title:"警示区",TitleColor:"rgb(255,0,0)"}],i[1].Data.Data=this.Data,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:1,Min:0,Count:3},t.Frame.SubFrame[e].Frame.YSplitScale=[.2,.4];var r=e+1;return t.TitlePaint[r].Data[1]=new C.DynamicTitleData(i[1].Data,this.Index[1].Name,this.Index[1].LineColor),t.TitlePaint[r].Data[1].DataType="MultiReport",t.TitlePaint[r].Title=this.FormatIndexTitle(),!0}},e.CustonIndexHeatIndex=function(){this.newMethod=c,this.newMethod("Market-Heat"),delete this.newMethod,this.Index=new Array(new m("区域",3),new m("热度指数",10),new m("MA",5),new m("MA",10)),this.Data,this.ApiUrl=n.g_JSChartResource.Index.CustomIndexHeatApiUrl,this.Index[1].LineColor=n.g_JSChartResource.Index.LineColor[1],this.Index[2].LineColor=n.g_JSChartResource.Index.LineColor[2],this.Index[3].LineColor=n.g_JSChartResource.Index.LineColor[3],this.Create=function(t,e){for(var a in this.Index){var i=null;0==a?i=new ChartStraightArea:(i=new l.ChartLine,i.Color=this.Index[a].LineColor),i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(JSNetwork.HttpRequest({url:this.ApiUrl,data:{stock:r.HQChart.CustomStock,date:{startdate:r.HQChart.QueryDate.Start,enddate:r.HQChart.QueryDate.End},day:[this.Index[0].Param,this.Index[1].Param]},method:"POST",dataType:"json",success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){var a=t.data;if(!(null==a.data||a.data.length<0)){var i=new Array;for(var r in a.data){var n=a.data[r],s=new h.SingleData;s.Date=n[0],s.Value=n[1],i.push(s)}var o=e.HistoryData.GetFittingData(i),l=new h.ChartData;l.Data=o,l.Period=e.HQChart.Period,l.Right=e.HQChart.Right,this.Data=l.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].NotSupportMessage=null,i[0].Data.Data=[{Value:0,Value2:.2,Color:"rgb(46,139,87)",Title:"较差区",TitleColor:"rgb(245,255 ,250)"},{Value:.19,Value2:.4,Color:"rgb(255,140,0)",Title:"变热区",TitleColor:"rgb(245,255 ,250)"},{Value:.39,Value2:.8,Color:"rgb(255,106,106)",Title:"较好区",TitleColor:"rgb(245,255 ,250)"},{Value:.79,Value2:1,Color:"rgb(255,69,0)",Title:"过热区",TitleColor:"rgb(245,255 ,250)"}],i[1].Data.Data=this.Data;var r=D.HQIndexFormula.MA(this.Data,this.Index[2].Param);i[2].Data.Data=r;var n=D.HQIndexFormula.MA(this.Data,this.Index[3].Param);i[3].Data.Data=n,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:1,Min:0,Count:3};for(var s=e+1,o=1;o<i.length;++o){var h=this.Index[o].Name;"MA"==h&&(h="MA"+this.Index[o].Param),t.TitlePaint[s].Data[o]=new C.DynamicTitleData(i[o].Data,h,this.Index[o].LineColor),t.TitlePaint[s].Data[o].StringFormat=C.STRING_FORMAT_TYPE.DEFAULT,t.TitlePaint[s].Data[o].FloatPrecision=2}return t.TitlePaint[s].Title="热度("+this.Index[0].Param+","+this.Index[1].Param+","+this.Index[2].Param+","+this.Index[3].Param+")",!0}},e.IndexInfo=m,e.MarketAttentionIndex=function(){this.newMethod=c,this.newMethod("市场关注度"),delete this.newMethod,this.Index=new Array(new m("市场关注度指数",null)),this.Data,this.TitleColor=n.g_JSChartResource.FrameSplitTextColor,this.ApiUrl=n.g_JSChartResource.Index.MarketAttentionApiUrl,this.Create=function(t,e){for(var a in this.Index){var i=new ChartBar;i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,i.UpBarColor=i.DownBarColor="rgb(243,152,0)",t.ChartPaint.push(i)}},this.SetFrame=function(t,e,a){t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:6,Min:0,Count:3}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(JSNetwork.HttpRequest({url:this.ApiUrl,data:{symbol:r.HQChart.Symbol,startdate:20100101},method:"POST",dataType:"json",success:function(t){i.RecvData(t.data,r)}}),!0)},this.RecvData=function(t,e){if(!(t.date.length<0)){var a=new Array;for(var i in t.date){var r=new h.SingleData;r.Date=t.date[i],r.Value=t.value[i],a.push(r)}var n=e.HistoryData.GetFittingData(a),s=new h.ChartData;s.Data=n,s.Period=e.HQChart.Period,s.Right=e.HQChart.Right,this.Data=s.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),this.SetFrame(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.Data,i[0].NotSupportMessage=null;var r=e+1;for(var n in i)t.TitlePaint[r].Data[n]=new C.DynamicTitleData(i[n].Data,this.Index[n].Name,this.TitleColor),t.TitlePaint[r].Data[n].StringFormat=C.STRING_FORMAT_TYPE.THOUSANDS,t.TitlePaint[r].Data[n].FloatPrecision=0;return t.TitlePaint[r].Title=this.FormatIndexTitle(),!0}},e.MarketHeatIndex=function(){this.newMethod=c,this.newMethod("指数/行业热度"),delete this.newMethod,this.Index=new Array(new m("热度指数",5),new m("MA",10),new m("MA",null)),this.Data,this.ApiUrl=n.g_JSChartResource.Index.MarketHeatApiUrl,this.Index[0].LineColor=n.g_JSChartResource.FrameSplitTextColor,this.Index[1].LineColor=n.g_JSChartResource.Index.LineColor[0],this.Index[2].LineColor=n.g_JSChartResource.Index.LineColor[1],this.Create=function(t,e){for(var a in this.Index){var i=null;0==a?i=new l.ChartMACD:(i=new l.ChartLine,i.Color=this.Index[a].LineColor),i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(JSNetwork.HttpRequest({url:this.ApiUrl,data:{symbol:r.HQChart.Symbol,startdate:20100101},method:"POST",dataType:"json",success:function(t){i.RecvData(t.data,r)}}),!0)},this.RecvData=function(t,e){if(!(t.date.length<0)){var a=new Array;for(var i in t.date){var r=new h.SingleData;r.Date=t.date[i],r.Value=t.value[i],a.push(r)}var n=e.HistoryData.GetFittingData(a),s=new h.ChartData;s.Data=n,s.Period=e.HQChart.Period,s.Right=e.HQChart.Right,this.Data=s.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.Data,i[0].NotSupportMessage=null;var r=D.HQIndexFormula.MA(this.Data,this.Index[0].Param);i[1].Data.Data=r;var n=D.HQIndexFormula.MA(this.Data,this.Index[1].Param);i[2].Data.Data=n;var s=e+1;for(var o in i){var h="";h=0==o?t.Name+this.Index[o].Name:"MA"+this.Index[o-1].Param,t.TitlePaint[s].Data[o]=new C.DynamicTitleData(i[o].Data,h,this.Index[o].LineColor),t.TitlePaint[s].Data[o].StringFormat=C.STRING_FORMAT_TYPE.DEFAULT,t.TitlePaint[s].Data[o].FloatPrecision=2}return t.TitlePaint[s].Title=this.FormatIndexTitle(),!0}},e.MarketLongShortIndex=function(){this.newMethod=c,this.newMethod("市场多空"),delete this.newMethod,this.Index=new Array(new m("多空指标",null),new m("多头区域",null),new m("空头区域",null)),this.Index[0].LineColor=n.g_JSChartResource.Index.LineColor[0],this.Index[1].LineColor=n.g_JSChartResource.UpBarColor,this.Index[2].LineColor=n.g_JSChartResource.DownBarColor,this.LongShortData,this.Create=function(t,e){for(var a in this.Index){var i=null;i=0==a?new l.ChartLine:new l.ChartStraightLine,i.Color=this.Index[a].LineColor,i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.LongShortData=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(wx.request({url:n.g_JSChartResource.Index.MarketLongShortApiUrl,data:{},method:"POST",dataType:"json",async:!0,success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){if(!(t.data.data.length<=0)){var a=new Array;for(var i in t.data.data){var r=t.data.data[i],n=new h.SingleData;n.Date=r[0],n.Value=r[1],a.push(n)}var s=e.HistoryData.GetFittingData(a),o=new h.ChartData;o.Data=s,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.LongShortData=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.LongShortData,i[0].NotSupportMessage=null,i[1].Data.Data[0]=8,i[2].Data.Data[0]=1,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:9,Min:0,Count:3};var r=e+1;for(var n in i)t.TitlePaint[r].Data[n]=new C.DynamicTitleData(i[n].Data,this.Index[n].Name,this.Index[n].LineColor),n>0&&(t.TitlePaint[r].Data[n].DataType="StraightLine");return t.TitlePaint[r].Title=this.FormatIndexTitle(),t.UpdateUICallback&&t.UpdateUICallback("MarketLongShortIndex",i,{WindowIndex:e,HistoryData:a}),!0}},e.MarketTimingIndex=function(){this.newMethod=c,this.newMethod("市场择时"),delete this.newMethod,this.Index=new Array(new m("因子择时",null)),this.TimingData,this.TitleColor=n.g_JSChartResource.FrameSplitTextColor,this.Create=function(t,e){for(var a in this.Index){var i=new l.ChartMACD;i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.LongShortData=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"不支持周期切换"),r.HQChart.Draw(),!1):(JSNetwork.HttpRequest({url:n.g_JSChartResource.Index.MarketLongShortApiUrl,data:{},method:"POST",dataType:"json",async:!0,success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){if(!(t.data.data.length<=0)){var a=new Array;for(var i in t.data.data){var r=t.data.data[i],n=new h.SingleData;n.Date=r[0],n.Value=r[2],a.push(n)}var s=e.HistoryData.GetFittingData(a),o=new h.ChartData;o.Data=s,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.TimingData=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.TimingData,i[0].NotSupportMessage=null;var r=e+1;for(var n in i)t.TitlePaint[r].Data[n]=new C.DynamicTitleData(i[n].Data,this.Index[n].Name,this.TitleColor),t.TitlePaint[r].Data[n].StringFormat=C.STRING_FORMAT_TYPE.THOUSANDS,t.TitlePaint[r].Data[n].FloatPrecision=0;return t.TitlePaint[r].Title=this.FormatIndexTitle(),t.UpdateUICallback&&t.UpdateUICallback("MarketTimingIndex",i,{WindowIndex:e,HistoryData:a}),!0}},e.OverlayScriptIndex=d,e.ScriptIndex=f;var r=i(a("b85c"));a("d401"),a("d3b7"),a("25f0"),a("14d9"),a("e25e"),a("ac1f"),a("5319"),a("c975"),a("4e82"),a("4ec9"),a("3ca3"),a("ddb0");var n=a("ee32"),s=a("698c"),o=a("c534"),h=a("8709"),l=a("d552"),u=a("deed"),C=a("b0e7"),D=a("85bb");function m(t,e){this.Name=t,this.Param=e,this.LineColor,this.ReqeustData=null}function c(t){this.Index,this.Name=t,this.UpdateUICallback,this.Create=function(t,e){for(var a in this.Index)if(this.Index[a].Name){var i=new l.ChartLine;i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,i.Color=this.Index[a].LineColor,t.ChartPaint.push(i)}},this.NotSupport=function(t,e,a){var i=t.GetChartPaint(e);for(var r in i)i[r].Data.Data=[],0==r&&(i[r].NotSupportMessage=a)},this.FormatIndexTitle=function(){var t=this.Name,e=null;for(var a in this.Index){var i=this.Index[a];null!=i.Param&&(e?e+=","+i.Param.toString():e=i.Param.toString())}return e&&(t+="("+e+")"),t},this.InvokeUpdateUICallback=function(t){if("function"==typeof this.UpdateUICallback){var e=new Array;for(var a in t)e.push({Name:this.Index[a].Name,Data:t[a].Data});this.UpdateUICallback(e)}}}var S={OVERLAY_BARS:"OVERLAY_BARS"};function f(t,e,a,i){this.newMethod=c,this.newMethod(t),delete this.newMethod,this.Script=e,this.Arguments=[],this.OutVar=[],this.ID,this.FloatPrecision=2,this.StringFormat,this.KLineType=null,this.InstructionType,this.YSpecificMaxMin=null,this.YSplitScale=null,this.OutName=null,this.YSplitType,this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=10,this.TitleFont=n.g_JSChartResource.DynamicTitleFont,this.IsShortTitle=!1,i&&(i.FloatPrecision>=0&&(this.FloatPrecision=i.FloatPrecision),i.StringFormat>0&&(this.StringFormat=i.StringFormat),i.ID&&(this.ID=i.ID),i.KLineType&&(this.KLineType=i.KLineType),i.InstructionType&&(this.InstructionType=i.InstructionType),i.YSpecificMaxMin&&(this.YSpecificMaxMin=i.YSpecificMaxMin),i.YSplitScale&&(this.YSplitScale=i.YSplitScale),i.TitleFont&&(this.TitleFont=i.TitleFont),u.IFrameSplitOperator.IsNumber(i.IsShortTitle)&&(this.IsShortTitle=i.IsShortTitle),i.OutName&&(this.OutName=i.OutName),u.IFrameSplitOperator.IsNumber(i.YSplitType)&&(this.YSplitType=i.YSplitType)),i&&i.Lock&&(1==i.Lock.IsLocked&&(this.IsLocked=!0),i.Lock.Callback&&(this.LockCallback=i.Lock.Callback),i.Lock.ID&&(this.LockID=i.Lock.ID),i.Lock.BG&&(this.LockBG=i.Lock.BG),i.Lock.TextColor&&(this.LockTextColor=i.Lock.TextColor),i.Lock.Text&&(this.LockText=i.Lock.Text),i.Lock.Font&&(this.LockFont=i.Lock.Font),i.Lock.Count&&(this.LockCount=i.Lock.Count)),a&&(this.Arguments=a),this.SetLock=function(t){1==t.IsLocked?(this.IsLocked=!0,t.Callback&&(this.LockCallback=t.Callback),t.ID&&(this.LockID=t.ID),t.BG&&(this.LockBG=t.BG),t.TextColor&&(this.LockTextColor=t.TextColor),t.Text&&(this.LockText=t.Text),t.Font&&(this.LockFont=t.Font),t.Count&&(this.LockCount=t.Count)):(this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=10)},this.ExecuteScript=function(t,e,a){this.OutVar=[];var i={HQChart:t,WindowIndex:e,HistoryData:a,Self:this},r=0;"MinuteChartContainer"===t.ClassName||"MinuteChartHScreenContainer"===t.ClassName?r=t.DayCount>1?I.MULTIDAY_MINUTE_ID:I.MINUTE_ID:"HistoryMinuteChartContainer"===t.ClassName&&(r=I.HISTORY_MINUTE_ID);var n={HQDataType:r,Symbol:t.Symbol,Data:a,SourceData:t.SourceData,Callback:this.RecvResultData,CallbackParam:i,Async:!0,MaxRequestDataCount:t.MaxRequestDataCount,MaxRequestMinuteDayCount:t.MaxRequestMinuteDayCount,Arguments:this.Arguments};r===I.HISTORY_MINUTE_ID&&(n.TrateDate=t.TradeDate),r===I.MULTIDAY_MINUTE_ID&&(n.DayCount=t.DayCount),t.NetworkFilter&&(n.NetworkFilter=t.NetworkFilter);var o=this.Script;s.JSCommonComplier.JSComplier.Execute(o,n,t.ScriptErrorCallback)},this.RecvResultData=function(t,e){var a=e.HQChart,i=e.WindowIndex,r=e.HistoryData;if(e.Self.OutVar=t,e.Self.BindData(a,i,r),0==e.Self.IsLocked)e.HQChart.Frame.SubFrame[i].Frame.SetLock(null);else{var n={IsLocked:!0,Callback:e.Self.LockCallback,IndexName:e.Self.Name,ID:e.Self.LockID,BG:e.Self.LockBG,Text:e.Self.LockText,TextColor:e.Self.LockTextColor,Font:e.Self.LockFont,Count:e.Self.LockCount};e.HQChart.Frame.SubFrame[i].Frame.SetLock(n)}e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw();var s=a.GetIndexEvent();if(s){var o=e.Self,h={OutVar:o.OutVar,WindowIndex:i,Name:o.Name,Arguments:o.Arguments,HistoryData:r,Stock:{Symbol:a.Symbol,Name:a.Name}};s.Callback(s,h,o)}},this.CreateLine=function(t,e,a,i,r){if(7==r)var n=new l.ChartStepLine;else n=new l.ChartLine;if(n.Canvas=t.Canvas,n.DrawType=1,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),0==a.IsShow&&(n.IsShow=!1),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(n.LineWidth=s)}a.IsDotLine&&(n.IsDotLine=!0),0==a.IsShow&&(n.IsShow=!1);var o=e+1;n.Data.Data=a.Data,!1===a.IsShowTitle||u.IFrameSplitOperator.IsString(a.Name)&&0==a.Name.indexOf("NOTEXT")||(t.TitlePaint[o].Data[i]=new C.DynamicTitleData(n.Data,1==a.NoneName?null:a.Name,n.Color),t.TitlePaint[o].Data[i].ChartClassName=n.ClassName),t.ChartPaint.push(n)},this.CreateArea=function(t,e,a,i){var r=new l.ChartArea;if(r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Identify=this.Guid,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.DownColor?r.AreaColor=a.DownColor:a.UpColor&&(r.AreaColor=a.UpColor,r.AreaDirection=1),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}u.IFrameSplitOperator.IsNonEmptyArray(a.LineDash)&&(r.LineDash=a.LineDash),0==a.IsShow&&(r.IsShow=!1);var s=e+1;r.Data.Data=a.Data,!1===a.IsShowTitle||u.IFrameSplitOperator.IsString(a.Name)&&0==a.Name.indexOf("NOTEXT")||(a.NoneName?t.TitlePaint[s].Data[i]=new C.DynamicTitleData(r.Data,null,r.Color):t.TitlePaint[s].Data[i]=new C.DynamicTitleData(r.Data,a.Name,r.Color),t.TitlePaint[s].Data[i].ChartClassName=r.ClassName),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateOverlayLine=function(t,e,a,i){var r=new l.ChartSubLine;if(r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}a.IsDotLine&&(r.IsDotLine=!0),0==a.IsShow&&(r.IsShow=!1);var s=e+1;r.Data.Data=a.Data,t.TitlePaint[s].Data[i]=new C.DynamicTitleData(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateBar=function(t,e,a,i){var r=new l.ChartStickLine;r.Canvas=t.Canvas,a.Draw.Width>0?r.LineWidth=a.Draw.Width:r.LineWidth=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i);r.Data.Data=a.Draw.DrawData,r.BarType=a.Draw.Type,t.ChartPaint.push(r)},this.CreateDrawTextV2=function(t,e,a,i){var r=new l.ChartDrawText;r.Canvas=t.Canvas,r.TextAlign="left",r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.Draw.DrawData&&(r.Data.Data=a.Draw.DrawData),r.Text=a.Draw.Text,a.Draw.YOffset>0&&(r.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(r.TextAlign=a.Draw.TextAlign),"TOP"===a.Draw.FixedPosition?r.FixedPosition=1:"BOTTOM"===a.Draw.FixedPosition&&(r.FixedPosition=2),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.TextBaseline="top":1==a.DrawVAlign?r.TextBaseline="middle":2==a.DrawVAlign&&(r.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right")),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),a.Background&&(r.TextBG=a.Background),a.VerticalLine&&(r.VerticalLine=a.VerticalLine),u.IFrameSplitOperator.IsNumber(a.YOffset)&&(r.ShowOffset.Y=a.YOffset),u.IFrameSplitOperator.IsNumber(a.XOffset)&&(r.ShowOffset.X=a.XOffset),t.ChartPaint.push(r)},this.CreateDrawNumber=function(t,e,a,i){var r=new l.ChartDrawNumber;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(r.TextAlign="center"),!0===a.IsDrawAbove&&(r.TextBaseline="bottom"),!0===a.IsDrawBelow&&(r.TextBaseline="top"),r.Data.Data=a.Draw.DrawData.Value,r.Text=a.Draw.DrawData.Text,a.Draw.Direction>0&&(r.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(r.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(r.TextAlign=a.Draw.TextAlign),"TOP"===a.Draw.FixedPosition?r.FixedPosition=1:"BOTTOM"===a.Draw.FixedPosition&&(r.FixedPosition=2),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.TextBaseline="top":1==a.DrawVAlign?r.TextBaseline="middle":2==a.DrawVAlign&&(r.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right")),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),a.Background&&(r.TextBG=a.Background),a.VerticalLine&&(r.VerticalLine=a.VerticalLine),t.ChartPaint.push(r)},this.CreateText=function(t,e,a,i){var r=new l.ChartSingleText;r.Canvas=t.Canvas,r.TextAlign="left",r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i);a.Draw.Position&&(r.Position=a.Draw.Position),a.Draw.DrawData&&(r.Data.Data=a.Draw.DrawData),r.Text=a.Draw.Text,a.Draw.Direction>0&&(r.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(r.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(r.TextAlign=a.Draw.TextAlign),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.Direction=1:1==a.DrawVAlign?r.Direction=0:2==a.DrawVAlign&&(r.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right")),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),a.Background&&(r.TextBG=a.Background),t.ChartPaint.push(r)},this.CreateMACD=function(t,e,a,i){var r=new l.ChartMACD;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Data;var o=this.GetDefaultColor(i);a.Color&&(o=this.GetColor(a.Color)),a.UpColor&&(r.UpColor=a.UpColor),a.DownColor&&(r.DownColor=a.DownColor),t.TitlePaint[s].Data[i]=new C.DynamicTitleData(r.Data,a.Name,o),t.ChartPaint.push(r)},this.CreatePointDot=function(t,e,a,i,r){var n=new l.ChartPointDot;if(n.Canvas=t.Canvas,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),a.Radius&&(n.Radius=a.Radius),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(n.Radius=s)}u.IFrameSplitOperator.IsBool(a.UpDownDot)&&(n.EnableUpDownColor=a.UpDownDot,n.HistoryData=r);var o=e+1;n.Data.Data=a.Data,t.TitlePaint[o].Data[i]=new C.DynamicTitleData(n.Data,a.Name,n.Color),t.ChartPaint.push(n)},this.CreateStick=function(t,e,a,i){var r=new l.ChartStick;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Data,t.TitlePaint[s].Data[i]=new C.DynamicTitleData(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateLineStick=function(t,e,a,i){var r=new l.ChartLineStick;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Data,t.TitlePaint[s].Data[i]=new C.DynamicTitleData(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateStraightLine=function(t,e,a,i){var r=new l.ChartLine;if(r.DrawType=1,r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateVolStick=function(t,e,a,i,r){var n=new l.ChartVolStick;n.Canvas=t.Canvas,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.KLineDrawType=t.KLineDrawType,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),a.UpColor&&(n.UpColor=a.UpColor),a.DownColor&&(n.DownColor=a.DownColor);var s=e+1;n.Data.Data=a.Data,n.HistoryData=r,t.TitlePaint[s].Data[i]=new C.DynamicTitleData(n.Data,a.Name,n.Color),t.ChartPaint.push(n)},this.CreateBand=function(t,e,a,i){var r=new l.ChartBand;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.FirstColor=a.Draw.Color[0],r.SecondColor=a.Draw.Color[1],r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreatePolyLine=function(t,e,a,i){var r=new l.ChartLine;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateKLine=function(t,e,a,i){var r=new l.ChartKLine;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,r.IsShowMaxMinPrice=!1,a.Color&&(r.UnchagneColor=r.DownColor=r.UpColor=this.GetColor(a.Color)),t.ChartPaint.push(r)},this.CreateDrawColorKLine=function(t,e,a,i){var r=new l.ChartColorKline;r.Canvas=t.Canvas,r.Name=a.Name,r.DrawName="DRAWCOLORKLINE",r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,u.IFrameSplitOperator.IsBool(a.Draw.IsEmptyBar)&&(r.IsEmptyBar=a.Draw.IsEmptyBar),a.Draw.Color&&(r.Color=a.Draw.Color),t.ChartPaint.push(r)},this.CreateNumberText=function(t,e,a,i){var r=new l.ChartSingleText;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),r.TextAlign="center",a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDrawAbove?r.Direction=1:r.Direction=2;r.Data.Data=a.Draw.DrawData.Value,r.Text=a.Draw.DrawData.Text,t.ChartPaint.push(r)},this.CreateDrawIcon=function(t,e,a,i,r){var n=new l.ChartDrawIcon;n.Canvas=t.Canvas,n.TextAlign="center",n.Identify=i,n.DrawCallback=r,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.Data.Data=a.Draw.DrawData,n.IconID=a.Draw.IconID,a.Color?n.Color=this.GetColor(a.Color):n.Color="rgb(0,0,0)",a.DrawVAlign>=0&&(0==a.DrawVAlign?n.TextBaseline="top":1==a.DrawVAlign?n.TextBaseline="middle":2==a.DrawVAlign&&(n.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?n.TextAlign="left":1==a.DrawAlign?n.TextAlign="center":2==a.DrawAlign&&(n.TextAlign="right")),a.DrawFontSize>0&&(n.FixedIconSize=a.DrawFontSize),t.ChartPaint.push(n)},this.CreateIcon=function(t,e,a,i){var r=t.GetEventCallback(h.JSCHART_EVENT_ID.ON_BIND_DRAWICON);if(r&&r.Callback){var n={FrameID:e,ID:i,Data:a,Callback:null};if(r.Callback(r,n,this),n.Callback)return void this.CreateDrawIcon(t,e,a,i,n.Callback)}var s=new l.ChartSingleText;s.Canvas=t.Canvas,s.TextAlign="center",s.Name=a.Name,s.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,s.ChartFrame=t.Frame.SubFrame[e].Frame;s.Data.Data=a.Draw.DrawData,s.Text=a.Draw.Icon.Symbol,a.Color?s.Color=this.GetColor(a.Color):a.Draw.Icon.Color?s.Color=a.Draw.Icon.Color:s.Color="rgb(0,0,0)",a.DrawVAlign>=0&&(0==a.DrawVAlign?s.Direction=1:1==a.DrawVAlign?s.Direction=0:2==a.DrawVAlign&&(s.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?s.TextAlign="left":1==a.DrawAlign?s.TextAlign="center":2==a.DrawAlign&&(s.TextAlign="right")),a.DrawFontSize>0&&(s.FixedFontSize=a.DrawFontSize),t.ChartPaint.push(s)},this.CreateRectangle=function(t,e,a,i){var r=new l.ChartRectangle;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Color=[a.Draw.DrawData.Color],r.Rect=a.Draw.DrawData.Rect,a.Color&&(r.BorderColor=this.GetColor(a.Color)),t.ChartPaint.push(r)},this.CreateDrawText=function(t,e,a,i){var r=new l.ChartSingleText;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDrawAbove?r.Direction=1:r.Direction=0,a.DrawFontSize>0&&(r.TextFont="".concat(a.DrawFontSize,"px 微软雅黑"));r.DrawData=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateBackgroud=function(t,e,a,i){var r=new l.ChartBackground;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.Color=n.Color,r.ColorAngle=n.Angle,n.Data&&(r.Data.Data=n.Data)}t.ChartPaint.push(r)},this.CreateBackgroundDiv=function(t,e,a,i){var r=new l.ChartBackgroundDiv;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.AryColor=n.AryColor,r.ColorType=n.ColorType,n.Data&&(r.Data.Data=n.Data)}t.ChartPaint.push(r)},this.CreateMultiText=function(t,e,a,i){var r=new l.ChartMultiText;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Texts=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateMulitHtmlDom=function(t,e,a,i){var r=new l.ChartMultiHtmlDom;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Texts=a.Draw.DrawData,r.DrawCallback=a.Draw.Callback,t.ChartPaint.push(r)},this.CreateStackedBar=function(t,e,a,i){var r=new l.ChartStackedBar;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Data.Data=a.Draw.DrawData,u.IFrameSplitOperator.IsNonEmptyArray(a.Draw.BarColor)&&(r.BarColor=a.Draw.BarColor),u.IFrameSplitOperator.IsNonEmptyArray(a.Draw.BarName)&&(r.BarName=a.Draw.BarName),u.IFrameSplitOperator.IsNumber(a.Draw.LineWidth)&&(r.LineWidth=a.Draw.LineWidth),u.IFrameSplitOperator.IsNumber(a.Draw.BarType)&&(r.BarType=a.Draw.BarType),t.ChartPaint.push(r);var n=e+1,s=new C.DynamicTitleData(r.Data,r.BarName,r.BarColor);s.DataType="ChartStackedBar",t.TitlePaint[n].Data[i]=s},this.CreateMultiLine=function(t,e,a,i){var r=new l.ChartMultiLine;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Lines=a.Draw.DrawData,a.Draw.Name&&(r.Name=a.Draw.Name),a.Draw.LineDash&&(r.LineDash=a.Draw.LineDash),u.IFrameSplitOperator.IsNumber(a.Draw.LineWidth)&&(r.LineWidth=a.Draw.LineWidth),a.Draw.Arrow){var n=a.Draw.Arrow;1==n.Start&&(r.Arrow.Start=!0),1==n.End&&(r.Arrow.End=!0),u.IFrameSplitOperator.IsNumber(n.Angle)&&(r.ArrawAngle=n.Angle),u.IFrameSplitOperator.IsNumber(n.Length)&&(r.ArrawLength=n.Length),u.IFrameSplitOperator.IsNumber(n.LineWidth)&&(r.ArrawLineWidth=n.LineWidth)}t.ChartPaint.push(r)},this.CreateMultiPoint=function(t,e,a,i){var r=new l.ChartMultiPoint;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.PointGroup=a.Draw.DrawData,a.Draw.Name&&(r.Name=a.Draw.Name),t.ChartPaint.push(r)},this.CreateMultiBar=function(t,e,a,i){var r=new l.ChartMultiBar;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Bars=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateSelfKLine=function(t,e,a){var i=new l.ChartKLine;i.Canvas=t.Canvas,i.Name="Self Kline",i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,i.Data=a,i.IsShowMaxMinPrice=!1,i.IsShowKTooltip=!1,i.DrawType=this.KLineType,t.ChartPaint.push(i)},this.BindInstructionData=function(t,e,a){if(!(null==this.OutVar||this.OutVar.length<0)){if(2==this.InstructionType){var i=this.OutVar[this.OutVar.length-1];return t.SetInstructionData(this.InstructionType,{Data:i.Data}),!0}if(1==this.InstructionType){var r,n;for(var s in this.OutVar){var o=this.OutVar[s];"ENTERLONG"==o.Name?r=o.Data:"EXITLONG"==o.Name&&(n=o.Data)}return t.SetInstructionData(this.InstructionType,{Buy:r,Sell:n}),!0}}},this.BindData=function(t,e,a){if(0==e&&this.InstructionType)this.BindInstructionData(t,e,a);else if(t.DeleteIndexPaint(e),0==e&&t.ShowKLine(!0),!(null==this.OutVar||this.OutVar.length<0)){null!=this.KLineType&&(0===this.KLineType||1===this.KLineType||2===this.KLineType?this.CreateSelfKLine(t,e,a):-1===this.KLineType&&0==e&&t.ShowKLine(!1)),e>=1&&t.Frame&&(t.Frame.SubFrame[e].Frame.YSplitOperator.FloatPrecision=this.FloatPrecision,this.YSpecificMaxMin&&(t.Frame.SubFrame[e].Frame.YSpecificMaxMin=this.YSpecificMaxMin),this.YSplitScale&&(t.Frame.SubFrame[e].Frame.YSplitScale=this.YSplitScale)),u.IFrameSplitOperator.IsNumber(this.YSplitType)&&(t.Frame.SubFrame[e].Frame.YSplitOperator.SplitType=this.YSplitType);for(var i=0;i<this.OutVar.length;++i){var r=this.OutVar[i];if(!0!==r.IsExData&&(1e3!=r.Type&&1001!=r.Type)){if(0==r.Type)r.IsOverlayLine?this.CreateOverlayLine(t,e,r,i):this.CreateLine(t,e,r,i);else if(1==r.Type)switch(r.Draw.DrawType){case"STICKLINE":this.CreateBar(t,e,r,i);break;case"DRAWTEXT":this.CreateDrawTextV2(t,e,r,i);break;case"SUPERDRAWTEXT":case"DRAWTEXT_FIX":this.CreateText(t,e,r,i);break;case"DRAWLINE":this.CreateStraightLine(t,e,r,i);break;case"DRAWBAND":this.CreateBand(t,e,r,i);break;case"DRAWKLINE":case"DRAWKLINE1":this.CreateKLine(t,e,r,i);break;case"DRAWCOLORKLINE":this.CreateDrawColorKLine(t,e,r,i);break;case"DRAWKLINE_IF":this.CreateKLine(t,e,r,i);break;case"POLYLINE":this.CreatePolyLine(t,e,r,i);break;case"DRAWNUMBER":this.CreateDrawNumber(t,e,r,i);break;case"DRAWICON":this.CreateIcon(t,e,r,i);break;case"ICON":this.CreateIcon(t,e,r,i);break;case"DRAWRECTREL":this.CreateRectangle(t,e,r,i);break;case"DRAWTEXTABS":case"DRAWTEXTREL":this.CreateDrawText(t,e,r,i);break;case"DRAWGBK":case"DRAWGBK2":this.CreateBackgroud(t,e,r,i);break;case"DRAWGBK_DIV":this.CreateBackgroundDiv(t,e,r,i);break;case"MULTI_TEXT":this.CreateMultiText(t,e,r,i);break;case"MULTI_HTMLDOM":this.CreateMulitHtmlDom(t,e,r,i);break;case"MULTI_LINE":this.CreateMultiLine(t,e,r,i);break;case"MULTI_POINT":this.CreateMultiPoint(t,e,r,i);break;case"MULTI_BAR":this.CreateMultiBar(t,e,r,i);break;case"KLINE_BG":this.CreateBackgroud(t,e,r,i);break;case S.OVERLAY_BARS:this.CreateStackedBar(t,e,r,i);break}else 2==r.Type?this.CreateMACD(t,e,r,i):3==r.Type?this.CreatePointDot(t,e,r,i,a):4==r.Type?this.CreateLineStick(t,e,r,i):5==r.Type?this.CreateStick(t,e,r,i):6==r.Type?this.CreateVolStick(t,e,r,i,a):7==r.Type?this.CreateLine(t,e,r,i,7):9==r.Type&&this.CreateArea(t,e,r,i);var n=t.TitlePaint[e+1];n&&n.Data&&i<n.Data.length&&(this.StringFormat>0&&(n.Data[i].StringFormat=this.StringFormat),this.FloatPrecision>=0&&(n.Data[i].FloatPrecision=this.FloatPrecision),this.OutName&&this.OutName.length>0&&this.Arguments&&this.Arguments.length>0&&n.SetDynamicTitle(this.OutName,this.Arguments))}}var s=e+1;if(t.TitlePaint[s].Title=this.Name,t.TitlePaint[s].ArgumentsText=null,!this.IsShortTitle){for(var o="",h=0;h<this.Arguments.length;++h){var l=this.Arguments[h];o.length>0&&(o+=","),o+=l.Value.toString()}o.length>0&&(t.TitlePaint[s].ArgumentsText="(".concat(o,")"))}return this.TitleFont&&(t.TitlePaint[s].Font=this.TitleFont),t.UpdateUICallback&&t.UpdateUICallback("ScriptIndex",this.OutVar,{WindowIndex:e,Name:this.Name,Arguments:this.Arguments,HistoryData:a}),!0}},this.GetDefaultColor=function(t){var e=n.g_JSChartResource.ColorArray,a=parseInt(t);return e[a%(e.length-1)]},this.GetColor=function(t){if(0==t.indexOf("RGB("))return t.toLowerCase();if(0==t.indexOf("rgb("))return t;if(0==t.indexOf("RGBA("))return t.toLowerCase();if(0==t.indexOf("rgba("))return t;var e=s.JSCommonComplier.JSComplier.ColorVarToRGB(t);return e||"rgb(30,144,255)"},this.SetChartIndexName=function(t){this.Name?t.IndexName=this.Name:this.ID&&(t.IndexName,this.ID)}}var I={KLINE_ID:0,MINUTE_ID:2,HISTORY_MINUTE_ID:3,MULTIDAY_MINUTE_ID:4};function d(t,e,a,i){this.newMethod=f,this.newMethod(t,e,a,i),delete this.newMethod,this.ClassName="OverlayScriptIndex",this.OverlayIndex=null,this.ShowConditionError=function(t,e){var a=t.HQChart,i=(t.WindowIndex,"指标不支持当前品种或周期");e&&(i=e);var r=this.OverlayIndex,n=r.Frame;n.ChartPaint=[];var s=new l.ChartLine;s.Canvas=a.Canvas,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.NotSupportMessage=i,n.ChartPaint.push(s),a.Draw()},this.BindData=function(t,e,a){if(this.OverlayIndex&&1==this.OverlayIndex.IsOverlay&&(this.OverlayIndex.Frame.ChartPaint=[],u.IFrameSplitOperator.IsNonEmptyArray(this.OutVar))){u.IFrameSplitOperator.IsNumber(this.YSplitType)&&(this.OverlayIndex.Frame.Frame.YSplitOperator.SplitType=this.YSplitType);var i={Data:[],Title:this.Name},r="";for(var n in this.Arguments){var s=this.Arguments[n];r.length>0&&(r+=","),r+=s.Value.toString()}r.length>0&&(i.Title=this.Name+"("+r+")");var o=e+1,h=t.TitlePaint[o];for(var n in h.OverlayIndex.set(this.OverlayIndex.Identify,i),this.OverlayIndex.Frame.Frame.Title=i.Title,this.OutName&&this.OutName.length>0&&this.Arguments&&this.Arguments.length>0&&h.SetDynamicTitle(this.OutName,this.Arguments,this.OverlayIndex.Identify),this.OutVar){var l=this.OutVar[n];if(!0!==l.IsExData)if(0==l.Type)this.CreateLine(t,e,l,n,l.Type);else if(1==l.Type)switch(l.Draw.DrawType){case"STICKLINE":this.CreateBar(t,e,l,n);break;case"DRAWTEXT":this.CreateDrawTextV2(t,e,l,n);break;case"SUPERDRAWTEXT":this.CreateText(t,e,l,n);break;case"DRAWLINE":this.CreateStraightLine(t,e,l,n);break;case"DRAWBAND":this.CreateBand(t,e,l,n);break;case"DRAWKLINE":this.CreateKLine(t,e,l,n);break;case"DRAWKLINE_IF":this.CreateKLine(t,e,l,n);break;case"POLYLINE":this.CreatePolyLine(t,e,l,n);break;case"DRAWNUMBER":case"DRAWNUMBER_FIX":case"DRAWTEXT_FIX":this.CreateNumberText(t,e,l,n);break;case"DRAWICON":this.CreateIcon(t,e,l,n);break;case"DRAWCHANNEL":this.CreateChannel(t,e,l,n);break;case"DRAWTEXT_LINE":this.CreateTextLine(t,e,l,n);break;case"VERTLINE":this.CreateChartVericaltLine(t,e,l,n);break;case"HORLINE":this.CreateChartHorizontalLine(t,e,l,n);break;case"MULTI_LINE":this.CreateMultiLine(t,e,l,n);break;case"MULTI_POINT":this.CreateMultiPoint(t,e,l,n);break;case"MULTI_BAR":this.CreateMultiBar(t,e,l,n);break;case"MULTI_TEXT":this.CreateMultiText(t,e,l,n);break;case"MULTI_SVGICON":this.CreateMultiSVGIcon(t,e,l,n);break;case"DRAWSVG":this.CreateChartDrawSVG(t,e,l,n);break;case"MULTI_HTMLDOM":this.CreateMulitHtmlDom(t,e,l,n);break;case"KLINE_BG":this.CreateBackgroud(t,e,l,n);break;case"PARTLINE":this.CreatePartLine(t,e,l,n);break;case S.OVERLAY_BARS:this.CreateStackedBar(t,e,l,n);break;default:var C=g_ScriptIndexChartFactory.Get(l.Draw.DrawType);C&&C.CreateChartCallback&&C.CreateChartCallback(t,e,l,n,this);break}else 2==l.Type?this.CreateMACD(t,e,l,n):3==l.Type?this.CreatePointDot(t,e,l,n,a):4==l.Type?this.CreateLineStick(t,e,l,n):5==l.Type?this.CreateStick(t,e,l,n):6==l.Type?this.CreateVolStick(t,e,l,n,a):7==l.Type||8==l.Type?this.CreateLine(t,e,l,n,l.Type):9==l.Type&&this.CreateArea(t,e,l,n)}return!0}},this.RecvResultData=function(t,e){var a=e.HQChart,i=e.WindowIndex,r=e.HistoryData;e.Self.OutVar=t,e.Self.BindData(a,i,r),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw();var n=a.GetOverlayIndexEvent();if(n){var s=e.Self,o={OutVar:s.OutVar,WindowIndex:i,Name:s.Name,Arguments:s.Arguments,HistoryData:r,Identify:s.OverlayIndex.Identify,Stock:{Symbol:a.Symbol,Name:a.Name}};n.Callback(n,o,s)}},this.CreateLine=function(t,e,a,i,r){var n=this.OverlayIndex,s=n.Frame;if(7==r)var o=new l.ChartStepLine;else o=new l.ChartLine;if(o.Canvas=t.Canvas,o.DrawType=1,o.Name=a.Name,o.ChartBorder=s.Frame.ChartBorder,o.ChartFrame=s.Frame,o.Identify=n.Identify,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),8==r&&(o.DrawType=2,o.BreakPoint=a.BreakPoint),a.LineWidth){var h=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(h)&&h>0&&(o.LineWidth=h)}0==a.IsShow&&(o.IsShow=!1);var u=e+1;o.Data.Data=a.Data;var D=t.TitlePaint[u],m=new C.DynamicTitleData(o.Data,a.Name,o.Color);m.ChartClassName=o.ClassName,D.OverlayIndex.get(n.Identify).Data[i]=m,this.SetChartIndexName(o),s.ChartPaint.push(o)},this.CreateBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartStickLine;s.Canvas=t.Canvas,a.Draw.Width>0?s.Width=a.Draw.Width:s.Width=1,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),s.Data.Data=a.Draw.DrawData,this.SetChartIndexName(s),n.ChartPaint.push(s)},this.CreateDrawTextV2=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartDrawText;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.ReloadResource(),a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(s.TextAlign="center"),!0===a.IsDrawAbove&&(s.TextBaseline="bottom"),!0===a.IsDrawBelow&&(s.TextBaseline="top"),a.Draw.DrawData&&(s.Data.Data=a.Draw.DrawData),s.Text=a.Draw.Text,a.Draw.Direction>0&&(s.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(s.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(s.TextAlign=a.Draw.TextAlign),"TOP"===a.Draw.FixedPosition?s.FixedPosition=1:"BOTTOM"===a.Draw.FixedPosition&&(s.FixedPosition=2),a.DrawVAlign>=0&&(0==a.DrawVAlign?s.TextBaseline="top":1==a.DrawVAlign?s.TextBaseline="middle":2==a.DrawVAlign&&(s.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?s.TextAlign="left":1==a.DrawAlign?s.TextAlign="center":2==a.DrawAlign&&(s.TextAlign="right")),a.DrawFontSize>0&&(s.FixedFontSize=a.DrawFontSize),a.Background&&(s.TextBG=a.Background),a.VerticalLine&&(s.VerticalLine=a.VerticalLine),u.IFrameSplitOperator.IsNumber(a.XOffset)&&(s.ShowOffset.X=a.XOffset),u.IFrameSplitOperator.IsNumber(a.YOffset)&&(s.ShowOffset.Y=a.YOffset),n.ChartPaint.push(s)},this.CreateText=function(t,e,a,i,r){var n=this.OverlayIndex,s=n.Frame,o=new l.ChartSingleText;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=s.Frame.ChartBorder,o.ChartFrame=s.Frame,o.Identify=n.Identify,o.ReloadResource(),a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i);a.Draw.Position&&(o.Position=a.Draw.Position),a.Draw.DrawData&&(o.Data.Data=a.Draw.DrawData),o.Text=a.Draw.Text,a.Draw.Direction>0&&(o.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(o.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(o.TextAlign=a.Draw.TextAlign),s.ChartPaint.push(o)},this.CreateMACD=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartMACD;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify;var o=e+1;s.Data.Data=a.Data;var h=t.TitlePaint[o],u=this.GetDefaultColor(i);a.Color&&(u=this.GetColor(a.Color)),a.UpColor&&(s.UpColor=a.UpColor),a.DownColor&&(s.DownColor=a.DownColor),h.OverlayIndex.get(r.Identify).Data[i]=new C.DynamicTitleData(s.Data,a.Name,u),n.ChartPaint.push(s)},this.CreatePointDot=function(t,e,a,i,r){var n=this.OverlayIndex,s=n.Frame,o=new l.ChartPointDot;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=s.Frame.ChartBorder,o.ChartFrame=s.Frame,o.Identify=n.Identify,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.Radius&&(o.Radius=a.Radius),a.LineWidth){var h=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(h)&&h>0&&(o.Radius=h)}u.IFrameSplitOperator.IsBool(a.UpDownDot)&&(o.EnableUpDownColor=a.UpDownDot,o.HistoryData=r);var D=e+1;o.Data.Data=a.Data;var m=t.TitlePaint[D];m.OverlayIndex.get(n.Identify).Data[i]=new C.DynamicTitleData(o.Data,a.Name,o.Color),s.ChartPaint.push(o)},this.CreateStick=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartStick;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}var h=e+1;s.Data.Data=a.Data;var u=t.TitlePaint[h];u.OverlayIndex.get(r.Identify).Data[i]=new C.DynamicTitleData(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateLineStick=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartLineStick;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}var h=e+1;s.Data.Data=a.Data;var u=t.TitlePaint[h];u.OverlayIndex.get(r.Identify).Data[i]=new C.DynamicTitleData(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateStraightLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartLine;if(s.DrawType=1,s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateVolStick=function(t,e,a,i,r){var n=this.OverlayIndex,s=n.Frame,o=new l.ChartVolStick;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=s.Frame.ChartBorder,o.ChartFrame=s.Frame,o.Identify=n.Identify,o.KLineDrawType=t.KLineDrawType,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.UpColor&&(o.UpColor=a.UpColor),a.DownColor&&(o.DownColor=a.DownColor);var h=e+1;o.Data.Data=a.Data,o.HistoryData=r;var u=t.TitlePaint[h];u.OverlayIndex.get(n.Identify).Data[i]=new C.DynamicTitleData(o.Data,a.Name,o.Color),this.SetChartIndexName(o),s.ChartPaint.push(o)},this.CreateBand=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartBand;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.FirstColor=a.Draw.Color[0],s.SecondColor=a.Draw.Color[1],s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateKLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartKLine;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data.Data=a.Draw.DrawData,s.IsShowMaxMinPrice=!1,s.IsShowKTooltip=!1,a.Color&&(s.UnchagneColor=s.DownColor=s.UpColor=this.GetColor(a.Color)),n.ChartPaint.push(s)},this.CreatePolyLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartLine;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}var h=e+1;s.Data.Data=a.Draw.DrawData;var u=t.TitlePaint[h];u.OverlayIndex.get(r.Identify).Data[i]=new C.DynamicTitleData(line.Data," ",line.Color),n.ChartPaint.push(s)},this.CreateNumberText=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartSingleText;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.ReloadResource(),s.TextAlign="center",a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.IsDrawAbove?s.Direction=1:s.Direction=2,a.Draw.Position&&(s.Position=a.Draw.Position);s.Data.Data=a.Draw.DrawData.Value,s.Text=a.Draw.DrawData.Text,n.ChartPaint.push(s)},this.CreateTextLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new ChartTextLine;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,a.Draw&&a.Draw.DrawData){var o=a.Draw.DrawData;s.Text=o.Text,s.Line=o.Line,s.Price=o.Price}n.ChartPaint.push(s)},this.CreateStackedBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartStackedBar;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,u.IFrameSplitOperator.IsNonEmptyArray(a.Draw.BarColor)&&(s.BarColor=a.Draw.BarColor),u.IFrameSplitOperator.IsNonEmptyArray(a.Draw.BarName)&&(s.BarName=a.Draw.BarName),u.IFrameSplitOperator.IsNumber(a.Draw.LineWidth)&&(s.LineWidth=a.Draw.LineWidth),u.IFrameSplitOperator.IsNumber(a.Draw.BarType)&&(s.BarType=a.Draw.BarType),s.Data.Data=a.Draw.DrawData;var o=e+1,h=t.TitlePaint[o],D=new C.DynamicTitleData(s.Data,s.BarName,s.BarColor);D.DataType="ChartStackedBar",h.OverlayIndex.get(r.Identify).Data[i]=D,n.ChartPaint.push(s)},this.CreateIcon=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartSingleText;s.Canvas=t.Canvas,s.TextAlign="center",s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.DrawVAlign>=0&&(0==a.DrawVAlign?s.Direction=1:1==a.DrawVAlign?s.Direction=0:2==a.DrawVAlign&&(s.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?s.TextAlign="left":1==a.DrawAlign?s.TextAlign="center":2==a.DrawAlign&&(s.TextAlign="right")),u.IFrameSplitOperator.IsNumber(a.XOffset)&&(s.ShowOffset.X=a.XOffset),u.IFrameSplitOperator.IsNumber(a.YOffset)&&(s.ShowOffset.Y=a.YOffset),s.Data.Data=a.Draw.DrawData;var o=a.Draw.Icon;1==o.IconFont?s.IconFont={Family:o.Family,Text:o.Symbol,Color:o.Color}:(s.Text=o.Symbol,a.Color?s.Color=this.GetColor(a.Color):o.Color?s.Color=o.Color:s.Color="rgb(0,0,0)"),n.ChartPaint.push(s)},this.CreateMultiLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartMultiLine;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data=t.ChartPaint[0].Data,s.Lines=a.Draw.DrawData,a.Draw.LineDash&&(s.LineDash=a.Draw.LineDash),u.IFrameSplitOperator.IsNumber(a.Draw.LineWidth)&&(s.LineWidth=a.Draw.LineWidth),a.Draw.Arrow){var o=a.Draw.Arrow;1==o.Start&&(s.Arrow.Start=!0),1==o.End&&(s.Arrow.End=!0),u.IFrameSplitOperator.IsNumber(o.Angle)&&(s.ArrawAngle=o.Angle),u.IFrameSplitOperator.IsNumber(o.Length)&&(s.ArrawLength=o.Length),u.IFrameSplitOperator.IsNumber(o.LineWidth)&&(s.ArrawLineWidth=o.LineWidth)}n.ChartPaint.push(s)},this.CreateMultiPoint=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartMultiLine;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data=t.ChartPaint[0].Data,s.PointGroup=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateBackgroud=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartBackground;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Draw&&a.Draw.DrawData){var o=a.Draw.DrawData;s.Color=o.Color,s.ColorAngle=o.Angle,o.Data&&(s.Data.Data=o.Data)}n.ChartPaint.push(s)},this.CreateMultiBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartMultiBar;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data=t.ChartPaint[0].Data,s.Bars=a.Draw.DrawData;var o=e+1,h=t.TitlePaint[o],u=new C.DynamicTitleData({KData:s.Data,BarData:s.Bars},a.Name,null);u.IsShow=!1,u.DataType="MULTI_BAR",h.OverlayIndex.get(r.Identify).Data[i]=u,n.ChartPaint.push(s)},this.CreateMultiText=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartMultiText;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data=t.ChartPaint[0].Data,s.Texts=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateMulitHtmlDom=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new l.ChartMultiHtmlDom;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.HQChart=t,s.Data=t.ChartPaint[0].Data,s.Texts=a.Draw.DrawData,s.DrawCallback=a.Draw.Callback,n.ChartPaint.push(s)},this.GetDefaultColor=function(t){var e=["rgb(24,71,178)","rgb(42,230,215)","rgb(252,96,154)","rgb(0,128,255)","rgb(229,0,79)","rgb(68,114,196)","rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)"],a=parseInt(t);return e[a%(e.length-1)]}}},bb2f:function(t,e,a){var i=a("d039");t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},c534:function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSConsole=void 0;var i={Chart:{Log:function(){},Warn:console.warn},Complier:{Log:function(){},Warn:console.warn}};e.JSConsole=i},ca79:function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.AverageWidthFrame=h,e.DepthChartFrame=function(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ScreenImageData,this.Position,this.ClassName="DepthChartFrame",this.VerticalRange={Max:null,Min:null,Center:null,MaxDiffer:null,Differ:null,Step:.05},this.AskPrice,this.BidPrice,this.MinZoom=.05,this.SetPriceList=function(t,e){this.AskPrice=t,this.BidPrice=e},this.SetDrawOtherChart=function(t){},this.DrawFrame=function(){this.SplitXYCoordinate(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetWidth()),i=a*(t-this.VerticalRange.Min)/(this.VerticalRange.Max-this.VerticalRange.Min);return e+i},this.GetXData=function(t){var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetWidth());return(t-e)/a*(this.VerticalRange.Max-this.VerticalRange.Min)+this.VerticalRange.Min},this.GetXFromPrice=function(t){var e=!1,a=this.GetPrice(this.BidPrice,t);if(null==a&&(a=this.GetPrice(this.AskPrice,t),e=!0),null==a&&this.BidPrice&&Array.isArray(this.BidPrice)&&this.BidPrice.length>0){var i=this.BidPrice[0];t<i&&(e=!1,a=i)}if(null==a&&this.AskPrice&&Array.isArray(this.AskPrice)&&this.AskPrice.length>0){var r=this.AskPrice[this.AskPrice.length-1];t>r&&(e=!0,a=r)}if(null==a)return null;var n=this.GetXFromIndex(a);return{X:n,Price:a,IsAsk:e}},this.GetPrice=function(t,e){if(!t||!Array.isArray(t)||t.length<=0)return null;if(e<t[0]||e>t[t.length-1])return null;var a=null;for(var i in t){var r=t[i];if(e==r)return r;if(e<r)return a;a=r}},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}},this.ZoomUp=function(){var t=this.VerticalRange,e=t.Differ,a=t.MaxDiffer*this.MinZoom;if(e<a)return!1;var i=t.Differ*t.Step;return e-=i,t.Differ=e,t.Min=t.Center-t.Differ,t.Max=t.Center+t.Differ,!0},this.ZoomDown=function(){var t=this.VerticalRange,e=t.Differ;if(e==t.MaxDiffer)return!1;var a=t.Differ*t.Step;return e+=a,e>t.MaxDiffer&&(e=t.MaxDiffer),t.Differ=e,t.Min=t.Center-t.Differ,t.Max=t.Center+t.Differ,!0}},e.IChartFramePainting=o,e.KLineFrame=D,e.KLineHScreenFrame=m,e.MinuteFrame=l,e.MinuteHScreenFrame=u,e.OverlayKLineFrame=function(){this.newMethod=D,this.newMethod(),delete this.newMethod,this.ClassName="OverlayKLineFrame",this.MainFrame=null,this.IsShareY=!1,this.IsCalculateYMaxMin=!0,this.RightOffset=50,this.PenBorder=r.g_JSChartResource.OverlayFrame.BolderPen,this.IsShow=!1,this.IsShowToolbar=!0,this.Title=null,this.TitleColor=r.g_JSChartResource.OverlayFrame.TitleColor,this.TitleFont=r.g_JSChartResource.OverlayFrame.TitleFont,this.KLineFrame_ReloadResource=this.ReloadResource,this.ReloadResource=function(t){this.KLineFrame_ReloadResource(t),t||(this.PenBorder=r.g_JSChartResource.OverlayFrame.BolderPen,this.TitleColor=r.g_JSChartResource.OverlayFrame.TitleColor,this.TitleFont=r.g_JSChartResource.OverlayFrame.TitleFont)},this.Draw=function(){this.Buttons=[],this.ChartBorder.IsShowTitleOnly||(this.SplitXYCoordinate(),this.IsShow&&(this.DrawVertical(),this.DrawHorizontal()),this.SizeChange=!1,this.XYSplit=!1)},this.GetScaleTextWidth=function(){return{TextWidth:0}},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY){for(var t in this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[],this.MainFrame.HorizontalInfo){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}this.CoordinateType=this.MainFrame.CoordinateType}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()},this.DrawHorizontal=function(){var t=this.ChartBorder.GetBorder(),e=(t.Left,t.Right),a=t.Bottom,i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.Right;e+=this.RightOffset;for(var s=null,o=this.HorizontalInfo.length-1;o>=0;--o){var h=this.HorizontalInfo[o],l=this.GetYFromData(h.Value);if(!(null!=l&&Math.abs(l-s)<this.MinYDistance)){if(this.Canvas.textBaseline=l>=a-2?"bottom":l<=i+2?"top":"middle",this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(e-2,(0,n.ToFixedPoint)(l)),this.Canvas.lineTo(e,(0,n.ToFixedPoint)(l)),this.Canvas.stroke(),null!=h.Message[1]&&r>10){null!=h.Font&&(this.Canvas.font=h.Font);var u=h.Message[1];Array.isArray(h.Message[1])&&(u=h.Message[1][0]),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign="left",this.Canvas.fillText(u,e+2,l)}s=l}}},this.DrawVertical=function(){var t=this.ChartBorder.GetBorder(),e=t.TopEx,a=t.Right,i=t.BottomEx;a+=this.RightOffset,this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo((0,n.ToFixedPoint)(a),(0,n.ToFixedPoint)(e)),this.Canvas.lineTo((0,n.ToFixedPoint)(a),(0,n.ToFixedPoint)(i)),this.Canvas.stroke()}},e.OverlayKLineHScreenFrame=function(){this.newMethod=m,this.newMethod(),delete this.newMethod,this.ClassName="OverlayKLineHScreenFrame",this.MainFrame=null,this.IsShareY=!1,this.IsCalculateYMaxMin=!0,this.RightOffset=50,this.PenBorder=r.g_JSChartResource.OverlayFrame.BolderPen,this.IsShow=!0,this.Title=null,this.TitleColor=r.g_JSChartResource.OverlayFrame.TitleColor,this.TitleFont=r.g_JSChartResource.OverlayFrame.TitleFont,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow&&(this.DrawVertical(),this.DrawHorizontal()),this.SizeChange=!1,this.XYSplit=!1},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY){this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[];for(var t=0;t<this.MainFrame.HorizontalInfo.length;++t){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()},this.DrawHorizontal=function(){},this.DrawVertical=function(){},this.GetScaleTextWidth=function(){return{TextWidth:0}}},e.OverlayMinuteFrame=function(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="OverlayMinuteFrame",this.IsShow=!0,this.IsShareY=!1,this.IsCalculateYMaxMin=!0,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow,this.SizeChange=!1,this.XYSplit=!1},this.GetScaleTextWidth=function(){return{TextWidth:0}},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY){this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[];for(var t=0;t<this.MainFrame.HorizontalInfo.length;++t){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()}},e.OverlayMinuteHScreenFrame=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="OverlayMinuteHScreenFrame",this.IsShow=!0,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow,this.SizeChange=!1,this.XYSplit=!1},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY){this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[];for(var t=0;t<this.MainFrame.HorizontalInfo.length;++t){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()}},e.ZOOM_SEED=void 0,a("99af"),a("c975"),a("baa5"),a("ac1f"),a("00b4"),a("5319"),a("a9e3"),a("14d9"),a("e25e");var i=a("c534"),r=a("ee32"),n=a("8709"),s=a("deed");function o(){this.HorizontalInfo=new Array,this.VerticalInfo=new Array,this.ClassName="IChartFramePainting",this.Canvas,this.Identify,this.ChartBorder,this.PenBorder=r.g_JSChartResource.FrameBorderPen,this.TitleBGColor=r.g_JSChartResource.FrameTitleBGColor,this.IsShow=!0,this.SizeChange=!0,this.XYSplit=!0,this.HorizontalMax,this.HorizontalMin,this.XPointCount=10,this.YSplitOperator,this.XSplitOperator,this.Data,this.YSpecificMaxMin=null,this.YSplitScale=null,this.IsShowBorder=!0,this.IsShowIndexName=!0,this.IndexParamSpace=2,this.IndexTitleSpace=0,this.IsLocked=!1,this.LockPaint=null,this.BorderLine=null,this.IsMinSize=!1,this.LogoTextColor=r.g_JSChartResource.FrameLogo.TextColor,this.LogoTextFont=r.g_JSChartResource.FrameLogo.Font,this.Draw=function(){this.DrawFrame(),this.DrawBorder(),this.SizeChange=!1,this.XYSplit=!1},this.DrawFrame=function(){},this.GetBorder=function(){return this.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder()},this.ClearCoordinateText=function(t){if(s.IFrameSplitOperator.IsNonEmptyArray(this.HorizontalInfo))for(var e=0;e<this.HorizontalInfo.length;++e){var a=this.HorizontalInfo[e];a.Message[0]=a.Message[1]=null}if(s.IFrameSplitOperator.IsNonEmptyArray(this.VerticalInfo))for(e=0;e<this.VerticalInfo.length;++e){a=this.VerticalInfo[e];a.Message[0]=a.Message[1]=null}},this.DrawBorder=function(){if(this.IsShowBorder&&!this.IsMinSize){var t=(0,n.ToFixedPoint)(this.ChartBorder.GetLeft()),e=(0,n.ToFixedPoint)(this.ChartBorder.GetTop()),a=(0,n.ToFixedPoint)(this.ChartBorder.GetRight()),i=(0,n.ToFixedPoint)(this.ChartBorder.GetBottom()),r=a-t,o=i-e;null==this.BorderLine?(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.strokeRect(t,e,r,o)):s.IFrameSplitOperator.IsNumber(this.BorderLine)&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(a,e)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(t,i),this.Canvas.lineTo(a,i)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(t,i)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(a,e),this.Canvas.lineTo(a,i)),this.Canvas.stroke())}},this.GetScaleTextWidth=function(){},this.DrawTitleBG=function(){},this.DrawLock=function(){this.IsLocked&&(null==this.LockPaint&&(this.LockPaint=new ChartLock),this.LockPaint.Canvas=this.Canvas,this.LockPaint.ChartBorder=this.ChartBorder,this.LockPaint.ChartFrame=this,this.LockPaint.Draw())},this.DrawLogo=function(){var t=this.GetBorder(),e=r.g_JSChartResource.FrameLogo.Text;if(e)if(this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.IsHScreen){var a=t.Left+5,i=t.Top+5;this.Canvas.save(),this.Canvas.translate(a,i),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e,0,0),this.Canvas.restore()}else{a=t.Left+5,i=t.Bottom-5;this.Canvas.fillText(e,a,i)}},this.SetLock=function(t){t?(this.IsLocked=!0,this.LockPaint||(this.LockPaint=new ChartLock),t.Callback&&(this.LockPaint.Callback=t.Callback),t.IndexName&&(this.LockPaint.IndexName=t.IndexName),t.ID&&(this.LockPaint.LockID=t.ID),t.BG&&(this.LockPaint.BGColor=t.BG),t.Text&&(this.LockPaint.Title=t.Text),t.TextColor&&(this.LockPaint.TextColor=t.TextColor),t.Font&&(this.LockPaint.Font=t.Font),t.Count&&(this.LockPaint.LockCount=t.Count)):this.IsLocked=!1},this.GetLockRect=function(){return this.IsLocked&&this.LockPaint?this.LockPaint.LockRect:null}}function h(){this.newMethod=o,this.newMethod(),delete this.newMethod,this.ClassName="AverageWidthFrame",this.DataWidth=50,this.DistanceWidth=10,this.MinXDistance=30,this.MinYDistance=10,this.XMessageAlign="top",this.IsShowTitle=!0,this.IsShowYText=[!0,!0],this.XBottomOffset=r.g_JSChartResource.Frame.XBottomOffset,this.YTextTopOffset=r.g_JSChartResource.Frame.YTopOffset,this.YTextPosition=[0,0],this.YTextPadding=[r.g_JSChartResource.Frame.YTextPadding[0],r.g_JSChartResource.Frame.YTextPadding[1]],this.IsShowXLine=!0,this.IsShowYLine=!0,this.YTextBaseline=0,this.ShortYLineLength=5,this.ShortXLineLength=5,this.DrawOtherChart,this.GetEventCallback,this.DrawFrame=function(){this.XPointCount>0&&(this.DistanceWidth=this.ChartBorder.GetWidth()/(4*this.XPointCount),this.DataWidth=2*this.DistanceWidth),this.DrawHorizontal(),this.DrawVertical()},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetTopEx();var e=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetBottomEx()-e},this.DrawInsideHorizontal=function(){if(!0!==this.IsHScreen&&!this.IsMinSize&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.Right,n=this.ChartBorder.Left;this.ChartBorder.TitleHeight;if(!(n>=10)&&(n<10&&!0===this.IsShowYText[0]||r<10&&!0===this.IsShowYText[1]))for(var s=null,o=this.HorizontalInfo.length-1;o>=0;--o){var h=this.HorizontalInfo[o];if(h){var l=this.GetYFromData(h.Value);if(!(null!=l&&null!=s&&Math.abs(l-s)<this.MinYDistance)){if(null!=h.Message[0]&&n<10&&!0===this.IsShowYText[0]){null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign="left";var u=l;l>=a-2?this.Canvas.textBaseline="bottom":l<=i+2?(this.Canvas.textBaseline="top",u+=this.YTextTopOffset):1==this.YTextBaseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle";var C={X:t,Y:u,Text:{BaseLine:this.Canvas.textBaseline,Font:this.Canvas.font,Value:h.Message[0]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(C)||this.Canvas.fillText(h.Message[0],t+1,u)}if(null!=h.Message[1]&&r<10&&!0===this.IsShowYText[1]){null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign="right";u=l;l>=a-2?this.Canvas.textBaseline="bottom":l<=i+2?(this.Canvas.textBaseline="top",u+=this.YTextTopOffset):1==this.YTextBaseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle";var D=this.Canvas.measureText(h.Message[1]).width;C={X:e-D,Y:u,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:h.Message[1]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(C)||this.Canvas.fillText(h.Message[1],e-1,u)}s=l}}}}},this.DrawHorizontal=function(){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetTopTitle(),s=this.ChartBorder.Right,o=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.Canvas.save();for(var h=null,l=this.HorizontalInfo.length-1;l>=0;--l){var u=this.HorizontalInfo[l],C=this.GetYFromData(u.Value);if(!(null!=C&&null!=h&&Math.abs(C-h)<this.MinYDistance)){var D=(0,n.ToFixedPoint)(C);a!=C&&this.IsShowYLine&&(2==u.LineType?(this.Canvas.strokeStyle=u.LineColor,u.LineDash?this.Canvas.setLineDash(u.LineDash):this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo(t,D),this.Canvas.lineTo(e,D),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==u.LineType||u.LineType>0&&(this.Canvas.strokeStyle=u.LineColor,r.g_JSChartResource.FrameYLineDash?(this.Canvas.setLineDash(r.g_JSChartResource.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(t,D),this.Canvas.lineTo(e,D),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(t,D),this.Canvas.lineTo(e,D),this.Canvas.stroke())));var m=C;if(C>=a-2?this.Canvas.textBaseline="bottom":C<=i+2?(this.Canvas.textBaseline="top",m+=this.YTextTopOffset):this.Canvas.textBaseline="middle",this.Canvas.fillStyle=u.TextColor,this.Canvas.strokeStyle=u.TextColor,null!=u.Message[0]&&o>10&&!0===this.IsShowYText[0]&&(null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.textAlign="right",this.Canvas.fillText(u.Message[0],t-this.YTextPadding[0],m)),null!=u.Message[1]&&s>10&&!0===this.IsShowYText[1]){null!=u.Font&&(this.Canvas.font=u.Font);var c=e;if(3==u.LineType){var S=this.ShortYLineLength;this.Canvas.beginPath(),this.Canvas.moveTo(c,D),this.Canvas.lineTo(c+S,D),this.Canvas.stroke(),c+=S}this.Canvas.textAlign="left",this.Canvas.fillText(u.Message[1],c+this.YTextPadding[1],m)}h=C}}this.Canvas.restore()},this.GetXFromIndex=function(t){var e=this.XPointCount;if(1==e)return 0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight();if(e<=0)return this.ChartBorder.GetLeft();if(t>=e)return this.ChartBorder.GetRight();var a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e;return a},this.DrawVertical=function(){var t=this.ChartBorder.GetTopTitle(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetRight();if(!(this.ChartBorder.Bottom<=5)){var i=e;"bottom"==this.XMessageAlign?i=this.ChartBorder.GetChartHeight():this.XMessageAlign="top";var s=null,o=null;for(var h in this.VerticalInfo){var l=this.GetXFromIndex(this.VerticalInfo[h].Value);if(l>a)break;if(!(null!=s&&Math.abs(l-s)<this.MinXDistance)){var u=this.VerticalInfo[h],C=(0,n.ToFixedPoint)(l);if(this.IsShowXLine&&u.LineType>0&&(2==u.LineType?(this.Canvas.strokeStyle=u.LineColor,u.LineDash?this.Canvas.setLineDash(u.LineDash):this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo(C,t),this.Canvas.lineTo(C,e),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==u.LineType||u.LineType>0&&(r.g_JSChartResource.FrameXLineDash?(this.Canvas.strokeStyle=u.LineColor,this.Canvas.beginPath(),this.Canvas.setLineDash(r.g_JSChartResource.FrameXLineDash),this.Canvas.moveTo(C,t),this.Canvas.lineTo(C,e),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.strokeStyle=u.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(C,t),this.Canvas.lineTo(C,e),this.Canvas.stroke()))),null!=this.VerticalInfo[h].Message[0]&&this.ChartBorder.Bottom>5){var D=null,m=null;null!=this.VerticalInfo[h].Font&&(this.Canvas.font=this.VerticalInfo[h].Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.strokeStyle=u.TextColor;var c=this.Canvas.measureText(this.VerticalInfo[h].Message[0]).width;if(l<c/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline=this.XMessageAlign,D=l+c,m=l):l+c/2>=this.ChartBorder.GetChartWidth()?(this.Canvas.textAlign="right",this.Canvas.textBaseline=this.XMessageAlign,D=l+c,m=l):(this.Canvas.textAlign="center",this.Canvas.textBaseline=this.XMessageAlign,D=l+c/2,m=l-c/2),null!=o&&o>m)continue;i=e;if(3==u.LineType){var S=this.ShortXLineLength;this.Canvas.beginPath(),this.Canvas.moveTo(C,i),this.Canvas.lineTo(C,i+S),this.Canvas.stroke(),i+=S+2}this.Canvas.fillText(this.VerticalInfo[h].Message[0],l,i+this.XBottomOffset),o=D}s=l}}}},this.GetYData=function(t){return t<this.ChartBorder.GetTopEx()?this.HorizontalMax:t>this.ChartBorder.GetBottomEx()?this.HorizontalMin:(this.ChartBorder.GetBottomEx()-t)/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){return t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?this.XPointCount:(t-this.ChartBorder.GetLeft())*(1*this.XPointCount/this.ChartBorder.GetWidth())},this.DrawCustomItem=function(t){if(t.Message[1]||t.Message[0])if(t.Value>this.HorizontalMax||t.Value<this.HorizontalMin)!0===t.CountDown&&this.SendDrawCountDownEvent({IsShow:!1});else{var e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetBottom(),n=this.ChartBorder.GetTopTitle(),o=this.ChartBorder.Right,h=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.IsHScreen&&(h=this.ChartBorder.Top,o=this.ChartBorder.Bottom,n=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom());var l=this.GetYFromData(t.Value),u=0;if(t.ExtendData&&t.ExtendData.Custom){var C=t.ExtendData.Custom;s.IFrameSplitOperator.IsNumber(C.Position)&&(u=C.Position)}if(t.Message[0])if(h<10||1==u){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var D=this.Canvas.measureText(t.Message[0]).width+2,m=t.LineColor,c=this.RGBToStruct(t.LineColor);if(c&&(m="rgba(".concat(c.R,", ").concat(c.G,", ").concat(c.B,", ").concat(r.g_JSChartResource.FrameLatestPrice.BGAlpha,")")),this.Canvas.fillStyle="rgba(255,255,255,0.1)",this.IsHScreen){var S=n,f=l-9-1;this.Canvas.fillRect(f,S,18,D),this.DrawHScreenText({X:l,Y:S},{Text:t.Message[0],Color:t.TextColor,XOffset:1,YOffset:2}),this.DrawLine(S+D,i,l,t.LineColor,t.LineType)}else{S=l-9-1,f=e+1;this.Canvas.fillRect(f,S,D,18),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[0],f+1,l-8),this.DrawLine(f,a,l,t.LineColor,t.LineType)}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";D=this.Canvas.measureText(t.Message[0]).width+2;if(this.Canvas.fillStyle=t.LineColor,this.IsHScreen){S=n-D,f=l-9-1;this.Canvas.fillRect(f,S,18,D),this.DrawHScreenText({X:l,Y:S},{Text:t.Message[0],Color:t.TextColor,XOffset:1,YOffset:2}),this.DrawLine(S+D,i,l,t.LineColor,t.LineType)}else{S=l-9-1;this.Canvas.fillRect(e-D,S,D,18),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[0],e-1,l),this.DrawLine(e,a,l,t.LineColor,t.LineType)}}else if(t.Message[1])if(o<10||1==u){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";D=this.Canvas.measureText(t.Message[1]).width+2,m=t.LineColor,c=this.RGBToStruct(t.LineColor);if(c&&(m="rgba(".concat(c.R,", ").concat(c.G,", ").concat(c.B,", ").concat(r.g_JSChartResource.FrameLatestPrice.BGAlpha,")")),this.Canvas.fillStyle=m,this.IsHScreen){S=i-D,f=l-9-1;this.Canvas.fillRect(f,S,18,D),this.DrawHScreenText({X:l,Y:S},{Text:t.Message[1],Color:t.TextColor,XOffset:1,YOffset:2}),this.DrawLine(n,S,l,t.LineColor,t.LineType)}else{S=l-9-1,f=a-D;if(this.Canvas.fillRect(f,S,D,18),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[1],f+1,l),this.DrawLine(e,f,l,t.LineColor,t.LineType),!0===t.CountDown&&this.GetEventCallback){S=l+9+1;var I={Top:S,Right:a,Height:null,IsShow:!0,BGColor:m,TextColor:t.TextColor,Position:"Right",IsInside:!0};this.SendDrawCountDownEvent(I)}}if((3==t.Type||4==t.Type)&&t.Title){var d=this.Canvas.measureText(t.Title).width+2;if(this.IsHScreen){S=i-itemText.Width-d,f=l-9-1;this.Canvas.fillStyle=m,this.Canvas.fillRect(f,S,18,d),this.DrawHScreenText({X:l,Y:S},{Text:t.Title,Color:t.TextColor,XOffset:1,YOffset:2})}else{S=l-9-1,f=a-D-d-1;this.Canvas.fillStyle=m,this.Canvas.fillRect(f,S,d,18),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Title,f+1,l)}}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";D=this.Canvas.measureText(t.Message[1]).width+2;if(this.Canvas.fillStyle=t.LineColor,this.IsHScreen){S=i,f=l-9-1;this.Canvas.fillRect(f,S,18,D),this.DrawHScreenText({X:l,Y:S},{Text:t.Message[1],Color:t.TextColor,XOffset:1,YOffset:2}),this.DrawLine(n,S,l,t.LineColor,t.LineType)}else{S=l-9-1;if(this.Canvas.fillRect(a,S,D,18),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[1],a+1,l),this.DrawLine(e,a,l,t.LineColor,t.LineType),!0===t.CountDown&&this.GetEventCallback){S=l+9+1,I={Top:S,Left:a,Right:this.ChartBorder.GetChartWidth(),Height:null,IsShow:!0,BGColor:t.LineColor,TextColor:t.TextColor,Position:"Right",IsInside:!1};this.SendDrawCountDownEvent(I)}}if((3==t.Type||4==t.Type)&&t.Title){m=t.LineColor,c=this.RGBToStruct(t.LineColor);c&&(m="rgba(".concat(c.R,", ").concat(c.G,", ").concat(c.B,", ").concat(r.g_JSChartResource.FrameLatestPrice.BGAlpha,")"));d=this.Canvas.measureText(t.Title).width+2;if(this.IsHScreen){S=i-d,f=l-9-1;this.Canvas.fillStyle=m,this.Canvas.fillRect(f,S,18,d),this.DrawHScreenText({X:l,Y:S},{Text:t.Title,Color:t.TextColor,XOffset:1,YOffset:2})}else{S=l-9-1,f=a-d-1;this.Canvas.fillStyle=m,this.Canvas.fillRect(f,S,d,18),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Title,f+1,l)}}}}},this.SendDrawCountDownEvent=function(t){if(!this.GetEventCallback)return!1;var e=this.GetEventCallback(n.JSCHART_EVENT_ID.ON_DRAW_COUNTDOWN);return!(!e||!e.Callback)&&(e.Callback(e,t,this),!0)},this.DrawLine=function(t,e,a,i,r){-1!=r&&(0==r?(this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo((0,n.ToFixedPoint)(a),t),this.Canvas.lineTo((0,n.ToFixedPoint)(a),e)):(this.Canvas.moveTo(t,(0,n.ToFixedPoint)(a)),this.Canvas.lineTo(e,(0,n.ToFixedPoint)(a))),this.Canvas.stroke()):this.DrawDotLine(t,e,a,i))},this.DrawDotLine=function(t,e,a,i){if(this.Canvas.save(),i.indexOf("rgba")>-1){var r=i.substring(i.indexOf("(")+1,i.lastIndexOf(","));i="rgb("+r+")"}this.Canvas.strokeStyle=i,this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo((0,n.ToFixedPoint)(a),t),this.Canvas.lineTo((0,n.ToFixedPoint)(a),e)):(this.Canvas.moveTo(t,(0,n.ToFixedPoint)(a)),this.Canvas.lineTo(e,(0,n.ToFixedPoint)(a))),this.Canvas.stroke(),this.Canvas.restore()},this.RGBToStruct=function(t){if(/^(rgb|RGB)/.test(t)){var e=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),a={};return 3!=e.length?null:(a.R=Number(e[0]),a.G=Number(e[1]),a.B=Number(e[2]),a)}return null},this.DrawHScreenText=function(t,e){this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e.Color,this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e.Text,e.XOffset,e.YOffset),this.Canvas.restore()},this.GetScaleTextWidth=function(){this.ChartBorder.GetBorder();if(this.IsHScreen)var t=this.ChartBorder.Top,e=this.ChartBorder.Bottom,a=t>10&&!0===this.IsShowYText[0],i=e>10&&!0===this.IsShowYText[1];else{var r=this.ChartBorder.Right,n=this.ChartBorder.Left;a=n>10&&!0===this.IsShowYText[0],i=r>10&&!0===this.IsShowYText[1]}var o={Left:null,Right:null};if(!i&&!a)return o;for(var h=0;h<this.HorizontalInfo.length;++h){var l=null,u=this.HorizontalInfo[h];u&&(null!=u.Font&&(this.Canvas.font=u.Font),null!=u.Message[0]&&a&&(l=this.Canvas.measureText(u.Message[0]).width,(null==o.Left||o.Left<l)&&(o.Left=l)),null!=u.Message[1]&&i&&(l=this.Canvas.measureText(u.Message[1]).width,(null==o.Right||o.Right<l)&&(o.Right=l)))}return s.IFrameSplitOperator.IsNumber(o.Left)&&(o.Left+=this.YTextPadding[0]),s.IFrameSplitOperator.IsNumber(o.Right)&&(o.Right+=this.YTextPadding[1]),{TextWidth:o}}}function l(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="MinuteFrame",this.DataWidth=1,this.DistanceWidth=1,this.MinXDistance=10,this.CustomHorizontalInfo=[],this.DrawFrame=function(){this.IsMinSize||(this.SplitXYCoordinate(),this.DrawTitleBG(),this.DrawHorizontal(),this.DrawVertical())},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.GetXFromIndex=function(t){var e=this.XPointCount-1;if(1==e)return 0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight();if(e<=0)return this.ChartBorder.GetLeft();if(t>=e)return this.ChartBorder.GetRight();var a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e;return a},this.GetXData=function(t){return t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?this.XPointCount:(t-this.ChartBorder.GetLeft())*(1*this.XPointCount/this.ChartBorder.GetWidth())},this.DrawCustomHorizontal=function(){if(!this.IsMinSize)for(var t in this.CustomHorizontalInfo){var e=this.CustomHorizontalInfo[t];switch(e.Type){case 0:case 1:this.DrawCustomItem(e);break}}}}function u(){this.newMethod=l,this.newMethod(),delete this.newMethod,this.ClassName="MinuteHScreenFrame",this.IsHScreen=!0,this.DrawTitleBG=function(){},this.DrawInsideHorizontal=function(){if(!this.IsMinSize&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom,s=(this.ChartBorder.TitleHeight,(r<10||2==this.YTextPosition[0])&&!0===this.IsShowYText[0]),o=(n<10||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(s||o)for(var h=null,l=this.HorizontalInfo.length-1;l>=0;--l){var u=this.HorizontalInfo[l],C=this.GetYFromData(u.Value);if(!(null!=C&&null!=h&&Math.abs(C-h)<this.MinYDistance)){if(null!=u.Message[0]&&s){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline=C>=e-2?"top":C<=t+2?"bottom":"middle";this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,u.Message[0];var D=C,m=a;this.Canvas.save(),this.Canvas.translate(D,m),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(u.Message[0],2,0),this.Canvas.restore()}if(null!=u.Message[1]&&o){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline=C>=e-2?"top":C<=t+2?"bottom":"middle";var c=this.Canvas.measureText(u.Message[1]).width;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,u.Message[1],D=C,m=i;this.Canvas.save(),this.Canvas.translate(D,m),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(u.Message[1],-2,0),this.Canvas.restore()}h=C}}}},this.GetYData=function(t){return t<this.ChartBorder.GetLeftEx()?this.HorizontalMin:t>this.ChartBorder.GetRightEx()?this.HorizontalMax:(t-this.ChartBorder.GetLeftEx())/this.ChartBorder.GetWidthEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){if(t<=this.ChartBorder.GetTop())return 0;if(t>=this.ChartBorder.GetBottom())return this.XPointCount;var e=this.XPointCount-1;return(t-this.ChartBorder.GetTop())*(1*e/this.ChartBorder.GetHeight())},this.GetXFromIndex=function(t){var e=this.XPointCount-1;if(1==e)return 0==t?this.ChartBorder.GetTop():this.ChartBorder.GetBottom();if(e<=0)return this.ChartBorder.GetTop();if(t>=e)return this.ChartBorder.GetBottom();var a=this.ChartBorder.GetTop()+this.ChartBorder.GetHeight()*t/e;return a},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return this.ChartBorder.GetLeft();if(t>=this.HorizontalMax)return this.ChartBorder.GetRightEx();var e=this.ChartBorder.GetWidthEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetLeft()+e},this.DrawHorizontal=function(){for(var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight(),r=this.ChartBorder.Top,s=this.ChartBorder.Bottom,o=null,h=this.HorizontalInfo.length-1;h>=0;--h){var l=this.HorizontalInfo[h],u=this.GetYFromData(l.Value);if(!(null!=u&&Math.abs(u-o)<this.MinYDistance)){if(this.Canvas.strokeStyle=l.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo((0,n.ToFixedPoint)(u),t),this.Canvas.lineTo((0,n.ToFixedPoint)(u),e),this.Canvas.stroke(),u>=i-2)this.Canvas.textBaseline="top",u=i;else if(u<=a+2){if(this.Canvas.textBaseline="bottom",u=a,null!=u&&Math.abs(u-o)<2*this.MinYDistance)continue}else this.Canvas.textBaseline="middle";if(null!=l.Message[0]&&r>10){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign="right";var C=u,D=t;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[0],-2,0),this.Canvas.restore()}if(null!=l.Message[1]&&s>10){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign="left";C=u,D=e;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[1],2,0),this.Canvas.restore()}o=u}}},this.DrawVertical=function(){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetBottom(),i=null;for(var r in this.VerticalInfo){var s=this.GetXFromIndex(this.VerticalInfo[r].Value);if(s>a)break;if(!(null!=i&&Math.abs(s-i)<this.MinXDistance)){if(this.Canvas.strokeStyle=this.VerticalInfo[r].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,(0,n.ToFixedPoint)(s)),this.Canvas.lineTo(e,(0,n.ToFixedPoint)(s)),this.Canvas.stroke(),null!=this.VerticalInfo[r].Message[0]){null!=this.VerticalInfo[r].Font&&(this.Canvas.font=this.VerticalInfo[r].Font),this.Canvas.fillStyle=this.VerticalInfo[r].TextColor;var o=this.Canvas.measureText(this.VerticalInfo[r].Message[0]).width;s<o/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):s+o/2>=this.ChartBorder.GetChartHeight()?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top");var h=t,l=s;this.Canvas.save(),this.Canvas.translate(h,l),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[r].Message[0],0,0),this.Canvas.restore()}i=s}}}}var C=[[48,10],[44,10],[40,9],[36,9],[32,8],[28,8],[24,7],[20,7],[18,6],[17,6],[15,5],[13,5],[9,4],[5,4],[3,3],[3,1],[2,1],[1,1],[1,0]];function D(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="KLineFrame",this.ToolbarID=(0,n.Guid)(),this.ModifyIndex=!0,this.ChangeIndex=!0,this.CustomHorizontalInfo=[],this.LastCalculateStatus={Width:0,XPointCount:0},this.CustomVerticalInfo=[],this.DrawCustomVerticalEvent,this.RightSpaceCount=0,this.DrawFrame=function(){this.IsMinSize||(this.SplitXYCoordinate(),1==this.SizeChange&&this.CalculateDataWidth(),this.DrawOtherChart&&this.DrawOtherChart(),this.DrawTitleBG(),this.DrawHorizontal(),this.DrawVertical())},this.GetXFromIndex=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var e=this.ChartBorder.GetLeft()+r.g_JSChartResource.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,a=1;a<=t;++a)e+=this.DistanceWidth+this.DataWidth;return e},this.GetXData=function(t){if(t<=this.ChartBorder.GetLeft())return 0;if(t>=this.ChartBorder.GetRight())return this.XPointCount-1;var e=this.ChartBorder.GetLeft()+r.g_JSChartResource.FrameLeftMargin,a=this.ChartBorder.GetRight()-r.g_JSChartResource.FrameRightMargin,i=this.DistanceWidth,n=this.DataWidth,s=0,o=e+i/2+n+i;while(o<a&&s<1e4&&s+1<this.XPointCount){if(o>t)break;o+=n+i,++s}return s},this.DrawCustomHorizontal=function(){if(!this.IsMinSize)for(var t=0;t<this.CustomHorizontalInfo.length;++t){var e=this.CustomHorizontalInfo[t];switch(e.Type){case 0:case 1:this.DrawCustomItem(e);break;case 2:case 3:case 4:this.DrawCustomItem(e)}}},this.DrawCustomVerticalItem=function(t){this.Canvas.save(),1==t.Data.Line.Type&&this.Canvas.setLineDash([5,5]),this.Canvas.strokeStyle=t.Data.Line.Color,this.Canvas.beginPath(),t.IsHScreen?(this.Canvas.moveTo(t.Top,(0,n.ToFixedPoint)(t.X)),this.Canvas.lineTo(t.Bottom,(0,n.ToFixedPoint)(t.X))):(this.Canvas.moveTo((0,n.ToFixedPoint)(t.X),t.Top),this.Canvas.lineTo((0,n.ToFixedPoint)(t.X),t.Bottom)),this.Canvas.stroke(),this.Canvas.restore()},this.DrawCustomVertical=function(){if(this.CustomVerticalInfo&&!(this.CustomVerticalInfo.length<=0)&&this.Data){var t=this.IsHScreen,e=this.ChartBorder.GetTopEx(),a=this.ChartBorder.GetBottomEx(),i=this.DataWidth,r=this.DistanceWidth,n=this.ChartBorder.GetLeft()+r/2+2;t&&(n=this.ChartBorder.GetTop()+r/2+2,e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx());for(var o=0,h=this.Data.DataOffset;h<this.Data.Data.length&&o<this.XPointCount;++h,++o,n+=i+r){var l=this.Data.Data[h];for(var u in this.CustomVerticalInfo){var C=this.CustomVerticalInfo[u];if(0==C.Type){if(s.IFrameSplitOperator.IsNumber(C.Time)){if(l.Date!=C.Date||l.Time!=C.Time)continue}else if(l.Date!=C.Date)continue;var D=n,m=n+i,c=D+(m-D)/2,S={X:c,Top:e,Bottom:a,Data:C,IsHScreen:t};this.DrawCustomVerticalItem(S),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,S,this);break}}}for(h=1;o<this.XPointCount;++h,++o,n+=i+r)for(var u in this.CustomVerticalInfo){C=this.CustomVerticalInfo[u];if(1==C.Type&&C.Space==h){D=n,m=n+i,c=D+(m-D)/2,S={X:c,Top:e,Bottom:a,Data:C,IsHScreen:t};this.DrawCustomVerticalItem(S),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,S,this);break}}}},this.CalculateDataWidth=function(){if(!(this.XPointCount<2)){var t=this.GetFrameWidth()-r.g_JSChartResource.FrameMargin;if(this.ZoomIndex>=0&&this.LastCalculateStatus.Width==t&&this.LastCalculateStatus.XPointCount==this.XPointCount){var e=this.DistanceWidth/2+r.g_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth)*(this.XPointCount-1);this.DataWidth,this.DistanceWidth,this.XPointCount;if(e<=t)return}this.LastCalculateStatus.Width=t,this.LastCalculateStatus.XPointCount=this.XPointCount;for(var a=0;a<C.length;++a){C[a][0],C[a][1];if((C[a][0]+C[a][1])*this.XPointCount<t)return this.ZoomIndex=a,this.DataWidth=C[a][0],this.DistanceWidth=C[a][1],this.TrimKLineDataWidth(t),void i.JSConsole.Chart.Log("[KLineFrame::CalculateDataWidth] ZoomIndex=".concat(this.ZoomIndex," DataWidth=").concat(this.DataWidth," DistanceWidth=").concat(this.DistanceWidth))}this.ZoomIndex=C.length-1,this.DataWidth=t/this.XPointCount,this.DistanceWidth=0}},this.OnSize=function(t){for(var e=this.GetFrameWidth()-r.g_JSChartResource.FrameMargin,a=0,i=this.DistanceWidth/2+r.g_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);i<e;i+=this.DataWidth+this.DistanceWidth,++a);return t.CurCount=this.XPointCount,t.CalcCount=a,t.DataWidth=this.DataWidth,t.DistanceWidth=this.DistanceWidth,t.Changed=!1,this.LastCalculateStatus.Width=e,t.CurCount==t.CalcCount||(this.XPointCount=a,this.LastCalculateStatus.XPointCount=this.XPointCount,this.Data&&(this.Data.DataOffset+=t.CurCount-t.CalcCount,this.Data.DataOffset<0&&(this.Data.DataOffset=0),t.Changed=!0)),t},this.SetDataWidth=function(t){var e=C.length-1;for(var a in C){var i=C[a];if(i[0]<=t){e=parseInt(a);break}}this.ZoomIndex=e,this.DataWidth=C[this.ZoomIndex][0],this.DistanceWidth=C[this.ZoomIndex][1];for(var n=this.GetFrameWidth()-r.g_JSChartResource.FrameMargin,s=0,o=this.DistanceWidth/2+r.g_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);o<=n;o+=this.DataWidth+this.DistanceWidth,++s);this.XPointCount=s,this.LastCalculateStatus.XPointCount=this.XPointCount,this.LastCalculateStatus.Width=n;var h={XPointCount:this.XPointCount,DataWidth:this.DataWidth,DistanceWidth:this.DistanceWidth};return h},this.TrimKLineDataWidth=function(t){this.ZoomIndex;var e=C[this.ZoomIndex][0],a=C[this.ZoomIndex][1];if(1!=e||0!=a)while(1){if((this.DistanceWidth+this.DataWidth)*this.XPointCount+this.DistanceWidth>t){this.DistanceWidth-=.01;break}this.DistanceWidth+=.01}else this.DataWidth=t/this.XPointCount},this.IsOverlayMaxMin=function(t){if(!this.ChartKLine)return!1;if(!this.ChartKLine.Max||!this.ChartKLine.Min)return!1;var e=this.Canvas.measureText(t.Text.Value).width+4,a=this.ChartKLine.Max,i=this.ChartKLine.Min,r=!1,n=!1;if(a.X>=t.X&&a.X<=t.X+e){var s=a.Y+20,o=a.Y-20;(s>=t.Y-20&&s<=t.Y+20||o>=t.Y-20&&o<=t.Y+20)&&(r=!0)}if(1==r)return!0;if(i.X>=t.X&&i.X<=t.X+e){s=i.Y+20,o=i.Y-20;(s>=t.Y-20&&s<=t.Y+20||o>=t.Y-20&&o<=t.Y+20)&&(n=!0)}return r||n},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.CalculateCount=function(t){var e=this.GetFrameWidth()-r.g_JSChartResource.FrameMargin;return parseInt(e/(C[t][0]+C[t][1]))},this.ZoomUp=function(t){if(this.ZoomIndex<=0)return!1;if(this.Data.DataOffset<0)return!1;var e=this.Data.Data.length,a=e+this.RightSpaceCount,n=0,s=this.Data.DataOffset+this.XPointCount-1,o=this.Data.DataOffset+t.Index;s>=e&&(n=s-(this.Data.Data.length-1),s=this.Data.Data.length-1,n>this.RightSpaceCount&&(n=this.RightSpaceCount));var h=this.CalculateCount(this.ZoomIndex-1);if(--this.ZoomIndex,this.XPointCount=h,1==t.IsLockRight){var l=this.Data.DataOffset+this.XPointCount;if(h>l)h=l,this.XPointCount=h,this.Data.DataOffset=0;else{var u=s-(h-n)+1;this.XPointCount=h,this.Data.DataOffset=u,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}}else h>=a?(h=a,this.XPointCount=h,this.Data.DataOffset=0):(this.XPointCount=h,this.Data.DataOffset=s-(this.XPointCount-n)+1,this.Data.DataOffset<0&&(i.JSConsole.Chart.Log("[KLineFrame::ZoomDown] this.Data.DataOffset=".concat(this.Data.DataOffset,", reset this.Data.DataOffset=0")),this.Data.DataOffset=0));this.DataWidth=C[this.ZoomIndex][0],this.DistanceWidth=C[this.ZoomIndex][1];var D=this.GetFrameWidth()-r.g_JSChartResource.FrameMargin;return this.TrimKLineDataWidth(D),this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=o-this.Data.DataOffset,!0},this.ZoomDown=function(t){if(this.ZoomIndex+1>=C.length)return!1;if(this.Data.DataOffset<0)return!1;if(this.Data.DataOffset<=0&&1==t.IsLockRight)return!1;var e=this.Data.Data.length,a=e+this.RightSpaceCount,n=0,s=this.Data.DataOffset+this.XPointCount-1;s>=this.Data.Data.length&&(n=s-(this.Data.Data.length-1),s=this.Data.Data.length-1,n>this.RightSpaceCount&&(n=this.RightSpaceCount));var o=this.CalculateCount(this.ZoomIndex+1),h=this.Data.DataOffset+t.Index;if(++this.ZoomIndex,1==t.IsLockRight){var l=this.Data.DataOffset+this.XPointCount;if(o>l)o=l,this.XPointCount=o,this.Data.DataOffset=0;else{var u=s-(o-n)+1;this.XPointCount=o,this.Data.DataOffset=u,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}}else o>=a?(this.XPointCount=o,this.Data.DataOffset=0):(this.XPointCount=o,this.Data.DataOffset=s-(this.XPointCount-n)+1,this.Data.DataOffset<0&&(i.JSConsole.Chart.Log("[KLineFrame::ZoomDown] this.Data.DataOffset=".concat(this.Data.DataOffset,", reset this.Data.DataOffset=0")),this.Data.DataOffset=0));this.DataWidth=C[this.ZoomIndex][0],this.DistanceWidth=C[this.ZoomIndex][1];var D=this.GetFrameWidth()-r.g_JSChartResource.FrameMargin;return this.TrimKLineDataWidth(D),this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=h-this.Data.DataOffset,!0},this.GetFrameWidth=function(){return this.IsHScreen?this.ChartBorder.GetHeight():this.ChartBorder.GetWidth()},this.SetXShowCount=function(t){for(var e=-1,a=this.GetFrameWidth()-r.g_JSChartResource.FrameMargin,i=0;i<C.length;++i){var n=C[i],s=n[0],o=n[1],h=(a=this.GetFrameWidth()-r.g_JSChartResource.FrameMargin-o/2,parseInt((a-o/2)/(s+o)));if(h>=t)return e=i,this.XPointCount=t,this.ZoomIndex=e,this.DataWidth=s,this.DistanceWidth=o,1==s&&0==o&&(this.DataWidth=a/this.XPointCount),this.LastCalculateStatus.XPointCount=this.XPointCount,void(this.LastCalculateStatus.Width=a)}this.XPointCount=t,this.ZoomIndex=C.length-1,this.DataWidth=a/this.XPointCount,this.DistanceWidth=0,this.LastCalculateStatus.XPointCount=this.XPointCount,this.LastCalculateStatus.Width=a}}function m(){this.newMethod=D,this.newMethod(),delete this.newMethod,this.ClassName="KLineHScreenFrame",this.IsHScreen=!0,this.DrawInsideHorizontal=function(){if(!this.IsMinSize&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom,s=(this.ChartBorder.TitleHeight,(r<10||2==this.YTextPosition[0])&&!0===this.IsShowYText[0]),o=(n<10||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(s||o)for(var h=null,l=this.HorizontalInfo.length-1;l>=0;--l){var u=this.HorizontalInfo[l],C=this.GetYFromData(u.Value);if(!(null!=C&&null!=h&&Math.abs(C-h)<this.MinYDistance)){if(null!=u.Message[0]&&s){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline=C>=e-2?"top":C<=t+2?"bottom":"middle";this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,u.Message[0];var D=C,m=a;this.Canvas.save(),this.Canvas.translate(D,m),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(u.Message[0],2,0),this.Canvas.restore()}if(null!=u.Message[1]&&o){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline=C>=e-2?"top":C<=t+2?"bottom":"middle";var c=this.Canvas.measureText(u.Message[1]).width;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,u.Message[1],D=C,m=i;this.Canvas.save(),this.Canvas.translate(D,m),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(u.Message[1],-2,0),this.Canvas.restore()}h=C}}}},this.DrawTitleBG=function(){},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return this.ChartBorder.GetLeftEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetRightEx();var e=this.ChartBorder.GetWidthEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetLeftEx()+e},this.DrawHorizontal=function(){for(var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.Top,i=this.ChartBorder.Bottom,s=this.ChartBorder.GetLeft(),o=null,h=this.HorizontalInfo.length-1;h>=0;--h){var l=this.HorizontalInfo[h],u=this.GetYFromData(l.Value);if(!(null!=u&&Math.abs(u-o)<15)){if(u!=s&&(2==l.LineType?(this.Canvas.strokeStyle=l.LineColor,this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo((0,n.ToFixedPoint)(u),t),this.Canvas.lineTo((0,n.ToFixedPoint)(u),e),this.Canvas.stroke(),this.Canvas.setLineDash([])):l.LineType>0&&(this.Canvas.strokeStyle=l.LineColor,r.g_JSChartResource.FrameYLineDash?(this.Canvas.setLineDash(r.g_JSChartResource.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo((0,n.ToFixedPoint)(u),t),this.Canvas.lineTo((0,n.ToFixedPoint)(u),e),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo((0,n.ToFixedPoint)(u),t),this.Canvas.lineTo((0,n.ToFixedPoint)(u),e),this.Canvas.stroke()))),null!=l.Message[0]&&a>10&&!0===this.IsShowYText[0]){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";var C=u,D=t;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[0],-2,0),this.Canvas.restore()}if(null!=l.Message[1]&&i>10&&!0===this.IsShowYText[1]){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";C=u,D=e;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[1],2,0),this.Canvas.restore()}o=u}}},this.GetXFromIndex=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var e=this.ChartBorder.GetTop()+r.g_JSChartResource.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,a=1;a<=t;++a)e+=this.DistanceWidth+this.DataWidth;return e},this.DrawVertical=function(){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightTitle(),a=this.ChartBorder.GetBottom(),i=null;for(var s in this.VerticalInfo){var o=this.GetXFromIndex(this.VerticalInfo[s].Value);if(o>=a)break;if(!(null!=i&&Math.abs(o-i)<80)){var h=this.VerticalInfo[s];if(2==h.LineType?(this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo(t,(0,n.ToFixedPoint)(o)),this.Canvas.lineTo(e,(0,n.ToFixedPoint)(o)),this.Canvas.stroke(),this.Canvas.setLineDash([])):h.LineType>0&&(this.Canvas.strokeStyle=h.LineColor,r.g_JSChartResource.FrameXLineDash?(this.Canvas.setLineDash(r.g_JSChartResource.FrameXLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(t,(0,n.ToFixedPoint)(o)),this.Canvas.lineTo(e,(0,n.ToFixedPoint)(o)),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(t,(0,n.ToFixedPoint)(o)),this.Canvas.lineTo(e,(0,n.ToFixedPoint)(o)),this.Canvas.stroke())),null!=this.VerticalInfo[s].Message[0]){null!=this.VerticalInfo[s].Font&&(this.Canvas.font=this.VerticalInfo[s].Font),this.Canvas.fillStyle=this.VerticalInfo[s].TextColor;var l=this.Canvas.measureText(this.VerticalInfo[s].Message[0]).width;o<l/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top");var u=t,C=o;this.Canvas.save(),this.Canvas.translate(u,C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[s].Message[0],0,this.XBottomOffset),this.Canvas.restore()}i=o}}},this.GetYData=function(t){return t<this.ChartBorder.GetLeftEx()?this.HorizontalMin:t>this.ChartBorder.GetRightEx()?this.HorizontalMax:(t-this.ChartBorder.GetLeftEx())/this.ChartBorder.GetWidthEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){if(t<=this.ChartBorder.GetTop())return 0;if(t>=this.ChartBorder.GetBottom())return this.XPointCount-1;var e=this.DistanceWidth,a=this.DataWidth,i=this.ChartBorder.GetTop()+r.g_JSChartResource.FrameLeftMargin,n=this.ChartBorder.GetBottom()-r.g_JSChartResource.FrameRightMargin,s=0,o=i+e/2+a+e;while(o<n&&s<1e4&&s+1<this.XPointCount){if(o>=t)break;o+=a+e,++s}return s}}e.ZOOM_SEED=C},cb29:function(t,e,a){var i=a("23e7"),r=a("81d5"),n=a("44d2");i({target:"Array",proto:!0},{fill:r}),n("fill")},d552:function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.ChartArea=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartArea",this.Color="rgb(255,193,37)",this.AreaColor,this.LineWidth,this.LineDash,this.AreaDirection=0,this.DrawSelectedStatus=this.DrawLinePoint,this.PtInChart=this.PtInLine,this.ExportData=this.ExportArrayData,this.GetItemData=this.GetArrayItemData,this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawArea())},this.DrawArea=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,s=this.ChartFrame.XPointCount;if(t)var o=this.ChartBorder.GetHScreenBorder(),h=o.BottomEx,u=o.TopEx+i/2+r.g_JSChartResource.FrameLeftMargin;else o=this.ChartBorder.GetBorder(),u=o.LeftEx+i/2+r.g_JSChartResource.FrameLeftMargin,h=o.RightEx;var C=this.GetLockRect();C&&(h=t?C.Top:C.Left),this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth),this.Canvas.strokeStyle=this.Color,this.AreaColor?this.Canvas.fillStyle=this.AreaColor:this.Canvas.fillStyle=l(this.Color,.6),n.IFrameSplitOperator.IsNonEmptyArray(this.LineDash)&&this.Canvas.setLineDash(this.LineDas);for(var D=!0,m=null,c=null,S=0,f=this.Data.DataOffset,I=0;f<this.Data.Data.length&&I<s;++f,++I,u+=a+i){var d=this.Data.Data[f];if(n.IFrameSplitOperator.IsNumber(d)){if(e)var T=this.ChartFrame.GetXFromIndex(I);else{var p=u,v=u+a;if(v>h)break;T=p+(v-p)/2}var F=this.GetYFromData(d,!1);if(T>h)break;D?(this.Canvas.beginPath(),t?this.Canvas.moveTo(F,T):this.Canvas.moveTo(T,F),D=!1,m={X:T,Y:F}):(t?this.Canvas.lineTo(F,T):this.Canvas.lineTo(T,F),c={X:T,Y:F}),++S}else S>0&&this.Canvas.stroke(),m&&c&&(t?(1==this.AreaDirection?(this.Canvas.lineTo(o.RightEx,c.X),this.Canvas.lineTo(o.RightEx,m.X)):(this.Canvas.lineTo(o.LeftEx,c.X),this.Canvas.lineTo(o.LeftEx,m.X)),this.Canvas.closePath(),this.Canvas.fill()):(1==this.AreaDirection?(this.Canvas.lineTo(c.X,o.TopEx),this.Canvas.lineTo(m.X,o.TopEx)):(this.Canvas.lineTo(c.X,o.BottomEx),this.Canvas.lineTo(m.X,o.BottomEx)),this.Canvas.closePath(),this.Canvas.fill())),D=!0,S=0,m=null,c=null}S>0&&(1==S&&m&&(t?this.Canvas.lineTo(m.Y,m.X+1*GetDevicePixelRatio()):this.Canvas.lineTo(m.X+1*GetDevicePixelRatio(),m.Y)),this.Canvas.stroke(),m&&c&&(t?(1==this.AreaDirection?(this.Canvas.lineTo(o.RightEx,c.X),this.Canvas.lineTo(o.RightEx,m.X)):(this.Canvas.lineTo(o.LeftEx,c.X),this.Canvas.lineTo(o.LeftEx,m.X)),this.Canvas.closePath(),this.Canvas.fill()):(1==this.AreaDirection?(this.Canvas.lineTo(c.X,o.TopEx),this.Canvas.lineTo(m.X,o.TopEx)):(this.Canvas.lineTo(c.X,o.BottomEx),this.Canvas.lineTo(m.X,o.BottomEx)),this.Canvas.closePath(),this.Canvas.fill()))),this.Canvas.restore()}},e.ChartBackground=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartBackground",this.Color=null,this.ColorAngle=0,this.IsDrawFirst=!0,this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Color&&!(this.Color.length<=0)){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,2==this.Color.length){if(this.IsHScreen)if(0==this.ColorAngle)var t={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()};else t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else if(0==this.ColorAngle)t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()};var a=this.Canvas.createLinearGradient(t.X,t.Y,e.X,e.Y);a.addColorStop(0,this.Color[0]),a.addColorStop(1,this.Color[1]),this.Canvas.fillStyle=a}else{if(1!=this.Color.length)return;this.Canvas.fillStyle=this.Color[0]}if("DRAWGBK2"!=this.Name&&"KLINE_BG"!=this.Name){if(this.IsHScreen)var i=this.ChartBorder.GetLeftEx(),r=this.ChartBorder.GetTop(),n=this.ChartBorder.GetWidthEx(),s=this.ChartBorder.GetHeight();else i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetWidth(),s=this.ChartBorder.GetHeightEx();this.Canvas.fillRect(i,r,n,s)}else this.DrawRegion()}},this.DrawRegion=function(){var t=this.ChartFrame.XPointCount,e=this.ChartBorder.GetLeft()+i/2+r.g_JSChartResource.FrameLeftMargin,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,s=this.ChartBorder.GetTopEx(),o=this.ChartBorder.GetBottomEx();this.IsHScreen&&(s=this.ChartBorder.GetRightEx(),o=this.ChartBorder.GetLeftEx());for(var h=[],l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<t;++l,++u,e+=a+i){var C=this.Data.Data[l];if(h[l]=null,n.IFrameSplitOperator.IsNumber(C)&&!(C<=0)){var D=this.ChartFrame.GetXFromIndex(u);this.ChartFrame.GetYFromData(C.Value);this.IsHScreen?h[l]={Line:{X:o,Y:D},Line2:{X:s,Y:D}}:h[l]={Line:{X:D,Y:s},Line2:{X:D,Y:o}}}}this.DrawBG(h)},this.DrawBG=function(t){var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=(a+e)/2,r=!0,n=0,s=[],o=null;for(var h in t){var l=t[h];if(!l||o&&l.Color!=o){if(n>0){for(var u=s.length-1;u>=0;--u){var C=s[u];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+i),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-i)):(this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}r=!0,n=0,s=[],o=null}l&&(r?(this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(l.Line.X,l.Line.Y-i),this.Canvas.lineTo(l.Line.X,l.Line.Y+i)):(this.Canvas.moveTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),r=!1,o=l.Color):this.IsHScreen?(this.Canvas.lineTo(l.Line.X,l.Line.Y-i),this.Canvas.lineTo(l.Line.X,l.Line.Y+i)):(this.Canvas.lineTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),s.push(l),++n)}if(n>0){for(u=s.length-1;u>=0;--u){C=s[u];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+i),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-i)):(this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}},this.GetMaxMin=function(){return{Min:null,Max:null}}},e.ChartBackgroundDiv=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartBackgroundDiv",this.AryColor,this.ColorType=0,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&n.IFrameSplitOperator.IsNonEmptyArray(this.AryColor)&&this.Data&&this.Data.Data){var t,e,a,i,s,o=!0===this.ChartFrame.IsHScreen,h=this.ChartFrame.DataWidth,l=this.ChartFrame.DistanceWidth,u=this.ChartFrame.XPointCount;o?(t=this.ChartBorder.GetHScreenBorder(),e=t.TopEx+l/2+r.g_JSChartResource.FrameLeftMargin,a=t.BottomEx,i=t.LeftEx,s=t.RightEx):(t=this.ChartBorder.GetBorder(),e=t.LeftEx+l/2+r.g_JSChartResource.FrameLeftMargin,a=t.RightEx,i=t.TopEx,s=t.BottomEx);for(var C=null,D=this.Data.DataOffset,m=0;D<this.Data.Data.length&&m<u;++D,++m,e+=h+l){var c=this.Data.Data[D],S=e,f=e+h;if(f>a)break;if(c){var I=i,d=s;if(n.IFrameSplitOperator.IsNonEmptyArray(c.AryValue)){var T=this.ChartFrame.GetYFromData(c.AryValue[0]),p=this.ChartFrame.GetYFromData(c.AryValue[1]);I=Math.min(T,p),d=Math.max(T,p)}o?C?(C.Bottom=f,C.Left>I&&(C.Left=I),C.Right<d&&(C.Right=d)):C={Left:I,Right:d,Top:S,Bottom:f}:C?(C.Right=f,C.Top>I&&(C.Top=I),C.Bottom<d&&(C.Bottom=d)):C={Left:S,Right:f,Top:I,Bottom:d}}else C&&this.DrawDiv(C,o),C=null}}},this.DrawDiv=function(t,e){if(2==this.ColorType)this.Canvas.strokeStyle=this.AryColor[0],this.Canvas.strokeRect(S(t.Left),S(t.Top),f(t.Right-t.Left),f(t.Bottom-t.Top));else if(3==this.ColorType)this.Canvas.fillStyle=this.AryColor[1],this.Canvas.fillRect(f(t.Left),f(t.Top),f(t.Right-t.Left),f(t.Bottom-t.Top)),this.Canvas.strokeStyle=this.AryColor[0],this.Canvas.strokeRect(S(t.Left),S(t.Top),f(t.Right-t.Left),f(t.Bottom-t.Top));else{if(0!=this.ColorType&&1!=this.ColorType)return;var a=null;a=e?0==this.ColorType?this.Canvas.createLinearGradient(t.Left,t.Top,t.Right,t.Top):this.Canvas.createLinearGradient(t.Left,t.Top,t.Left,t.Bottom):0==this.ColorType?this.Canvas.createLinearGradient(t.Left,t.Top,t.Left,t.Bottom):this.Canvas.createLinearGradient(t.Left,t.Top,t.Right,t.Top),a.addColorStop(.5,this.AryColor[0]),a.addColorStop(1,this.AryColor[1]),this.Canvas.fillStyle=a,this.Canvas.fillRect(f(t.Left),f(t.Top),f(t.Right-t.Left),f(t.Bottom-t.Top))}}},e.ChartBand=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.ClassName="ChartBand",this.FirstColor=r.g_JSChartResource.Index.LineColor[0],this.SecondColor=r.g_JSChartResource.Index.LineColor[1],this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else{for(var t=this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount,r=this.ChartBorder.GetLeft()+a/2+2,n=0,s=0,o=0,h=[],l=[],u=0,C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<i;++C,++D,r+=e+a){var m=this.Data.Data[C];null!=m&&null!=m.Value&&null!=m.Value2&&(n=this.ChartFrame.GetXFromIndex(D),s=this.ChartFrame.GetYFromData(m.Value),o=this.ChartFrame.GetYFromData(m.Value2),t?(h[u]={x:s,y:n},l[u]={x:o,y:n}):(h[u]={x:n,y:s},l[u]={x:n,y:o}),u++)}h.length>1&&l.length>1&&this.DrawBand(h,l)}},this.ClipTop=function(t){var e=this.ChartFrame.IsHScreen;this.Canvas.beginPath();for(var a=0;a<t.length;++a)0==a?this.Canvas.moveTo(t[a].x,t[a].y):this.Canvas.lineTo(t[a].x,t[a].y);var i=t[0],r=t[t.length-1];if(e){var n=this.ChartBorder.GetRightEx();this.Canvas.lineTo(n,r.y),this.Canvas.lineTo(n,i.y)}else{var s=this.ChartBorder.GetTopEx();this.Canvas.lineTo(r.x,s),this.Canvas.lineTo(i.x,s)}this.Canvas.closePath(),this.Canvas.clip()},this.ClipBottom=function(t){var e=this.ChartFrame.IsHScreen;this.Canvas.beginPath();for(var a=0;a<t.length;++a)0==a?this.Canvas.moveTo(t[a].x,t[a].y):this.Canvas.lineTo(t[a].x,t[a].y);var i=t[0],r=t[t.length-1];if(e){var n=this.ChartBorder.GetLeftEx();this.Canvas.lineTo(n,r.y),this.Canvas.lineTo(n,i.y)}else{var s=this.ChartBorder.GetBottomEx();this.Canvas.lineTo(r.x,s),this.Canvas.lineTo(i.x,s)}this.Canvas.closePath(),this.Canvas.clip()},this.DrawArea=function(t,e,a){this.Canvas.beginPath();for(var i=0;i<t.length;++i)0==i?this.Canvas.moveTo(t[i].x,t[i].y):this.Canvas.lineTo(t[i].x,t[i].y);for(i=e.length-1;i>=0;--i)this.Canvas.lineTo(e[i].x,e[i].y);this.Canvas.closePath(),this.Canvas.fillStyle=a,this.Canvas.fill()},this.DrawBand=function(t,e){this.FirstColor&&(this.Canvas.save(),this.ClipTop(t),this.DrawArea(t,e,this.FirstColor),this.Canvas.restore()),this.SecondColor&&(this.Canvas.save(),this.ClipBottom(t),this.DrawArea(t,e,this.SecondColor),this.Canvas.restore())},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r&&null!=r.Value&&null!=r.Value2){var n=r.Value>r.Value2?r.Value:r.Value2,s=r.Value<r.Value2?r.Value:r.Value2;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>s)&&(e.Min=s)}}return e}},e.ChartBuySell=function(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.ClassName="ChartBuySell",this.TextFont=r.g_JSChartResource.KLineTrain.Font,this.LastDataIcon=r.g_JSChartResource.KLineTrain.LastDataIcon,this.BuyIcon=r.g_JSChartResource.KLineTrain.BuyIcon,this.SellIcon=r.g_JSChartResource.KLineTrain.SellIcon,this.BuySellData=new Map,this.LastDataDrawType=0,this.LastDataIndex=-1,this.AddTradeItem=function(t){if(this.BuySellData.has(t.Key)){var e=this.BuySellData.get(t.Key);e.Data.push(t)}else this.BuySellData.set(t.Key,{Data:[t]})},this.ClearTradeData=function(){this.BuySellData=new Map},this.Draw=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=(this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(a=this.ChartBorder.GetBottom());var i=this.ChartFrame.XPointCount,r=this.ChartBorder.GetBottomEx(),n=this.ChartBorder.GetTopEx(),s=this.ChartBorder.GetHeightEx();t&&(n=this.ChartBorder.GetRightEx(),r=this.ChartBorder.GetLeftEx(),s=this.ChartBorder.GetWidthEx()),this.Canvas.font=this.TextFont;for(var o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<i;++o,++h){var l=this.Data.Data[o];if(null!=l){if(C>a)break;var u=!1;if(1==this.LastDataDrawType?o==this.LastDataIndex&&(u=!0):o==this.Data.Data.length-1&&(u=!0),u){var C=this.ChartFrame.GetXFromIndex(h),D=this.ChartFrame.GetYFromData(l.High);if(this.LastDataIcon.Text)this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.LastDataIcon.Color,this.Canvas.font=this.TextFont,this.DrawText(this.LastDataIcon.Text,C,D,t);else{var m={X:C,Top:n,Bottom:r,Height:s,DataWidth:e,Color:this.LastDataIcon.Color,IsHScreen:t};this.DrawLastData(m)}}var c=o;if(this.BuySellData.has(c)){var S=this.BuySellData.get(c),f=(C=this.ChartFrame.GetXFromIndex(h),D=this.ChartFrame.GetYFromData(l.High),this.ChartFrame.GetYFromData(l.Low)),I=[!1,!1];for(var d in S.Data){if(1==I[0]&&1==I[1])break;var T=S.Data[d];0==T.Op&&0==I[0]?(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.BuyIcon.Color,this.DrawText(this.BuyIcon.Text,C,f,t),I[0]=!0):1==T.Op&&0==I[1]&&(this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.SellIcon.Color,this.DrawText(this.SellIcon.Text,C,D,t),I[1]=!0)}}}}}},this.DrawLastData=function(t){this.Canvas.fillStyle=t.Color;var e=t.DataWidth;this.LastDataIcon.Width>=2&&this.LastDataIcon.Width<t.DataWidth&&(e=this.LastDataIcon.Width);var a=t.X-e/2;if(t.IsHScreen)this.Canvas.fillRect(f(t.Bottom),f(a),f(t.Height),f(e));else{a=t.X-e/2;this.Canvas.fillRect(f(a),f(t.Top),f(e),f(t.Height))}}},e.ChartChinaMap=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ImageData=null,this.Left,this.Top,this.Width,this.Height,this.ImageWidth,this.ImageHeight,this.DefaultColor=[217,222,239],this.Color=[{Name:"海南",Color:"rgb(217,222,223)"},{Name:"内蒙古",Color:"rgb(217,222,225)"},{Name:"新疆",Color:"rgb(217,222,226)"},{Name:"青海",Color:"rgb(217,222,227)"},{Name:"西藏",Color:"rgb(217,222,228)"},{Name:"云南",Color:"rgb(217,222,229)"},{Name:"黑龙江",Color:"rgb(217,222,230)"},{Name:"吉林",Color:"rgb(217,222,231)"},{Name:"辽宁",Color:"rgb(217,222,232)"},{Name:"河北",Color:"rgb(217,222,233)"},{Name:"山东",Color:"rgb(217,222,234)"},{Name:"江苏",Color:"rgb(217,222,235)"},{Name:"浙江",Color:"rgb(217,222,236)"},{Name:"福建",Color:"rgb(217,222,237)"},{Name:"广东",Color:"rgb(217,222,238)"},{Name:"广西",Color:"rgb(217,222,239)"},{Name:"贵州",Color:"rgb(217,222,240)"},{Name:"湖南",Color:"rgb(217,222,241)"},{Name:"江西",Color:"rgb(217,222,242)"},{Name:"安徽",Color:"rgb(217,222,243)"},{Name:"湖北",Color:"rgb(217,222,244)"},{Name:"重庆",Color:"rgb(217,222,245)"},{Name:"四川",Color:"rgb(217,222,246)"},{Name:"甘肃",Color:"rgb(217,222,247)"},{Name:"陕西",Color:"rgb(217,222,248)"},{Name:"山西",Color:"rgb(217,222,249)"},{Name:"河南",Color:"rgb(217,222,250)"}],this.Draw=function(){var t=this.ChartBorder.GetLeft()+1,e=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()+1),a=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()-2),i=this.ChartBorder.GetHeight()-2,r=CHINA_MAP_IMAGE.width,n=CHINA_MAP_IMAGE.height,s=r,o=n;if(i<o||a<s)this.ImageData=null;else if(this.Left==t&&this.Top==e&&this.Width==a&&this.Height==i&&this.ImageWidth==r&&this.ImageHeight==n||(this.ImageData=null,this.ImageWidth=r,this.ImageHeight=n,this.Left=t,this.Top=e,this.Width=a,this.Height=i,console.log(r,n)),null==this.ImageData){this.Canvas.drawImage(CHINA_MAP_IMAGE,0,0,r,n,t,e,s,o),this.ImageData=this.Canvas.getImageData(t,e,s,o);var h,l=new Set,u=new Map,C=new Map;if(this.Data.length>0)for(var D in this.Data){var m=this.Data[D];C.set(m.Name,m.Color)}for(var c in console.log(this.Data),this.Color){var S=this.Color[c];C.has(S.Name)?u.set(S.Color,C.get(S.Name)):l.add(S.Color)}for(var f=0;f<this.ImageData.data.length;f+=4)if(h="rgb("+this.ImageData.data[f]+","+this.ImageData.data[f+1]+","+this.ImageData.data[f+2]+")",l.has(h))this.ImageData.data[f]=this.DefaultColor[0],this.ImageData.data[f+1]=this.DefaultColor[1],this.ImageData.data[f+2]=this.DefaultColor[2];else if(u.has(h)){var I=u.get(h);this.ImageData.data[f]=I[0],this.ImageData.data[f+1]=I[1],this.ImageData.data[f+2]=I[2]}this.Canvas.clearRect(t,e,s,o),this.Canvas.putImageData(this.ImageData,t,e,0,0,s,o)}else this.Canvas.putImageData(this.ImageData,t,e,0,0,s,o)}},e.ChartCircle=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.BGColor="white",this.TextHeight=25,this.DrawEmptyData=function(){console.log("[ChartCircle::DrawEmptyData]")},this.Draw=function(){if(!this.Data||!this.Data.Data||!(this.Data.Data.length>0))return this.DrawEmptyData();var t=this.ChartBorder.GetLeft(),e=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetWidth(),r=this.ChartBorder.GetHeight(),n=this.TextHeight,s=i-n;s>r-n&&(s=r-n);var o=(s-n)/2;this.Canvas.save(),this.Canvas.translate(t+i/2,e+r/2-n/2);var h=0;for(var l in this.Data.Data)h+=this.Data.Data[l].Value;var u=1.5*Math.PI,C=u,D=u;for(var m in this.Data.Data){var c=this.Data.Data[m],S=c.Value/h;this.Canvas.beginPath(),this.Canvas.moveTo(0,0),D+=2*S*Math.PI,this.Canvas.strokeStyle="white",this.Canvas.fillStyle=c.Color,this.Canvas.arc(0,0,o,C,D),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),C+=2*S*Math.PI}this.Canvas.beginPath(),this.Canvas.fillStyle=this.BGColor,this.Canvas.arc(0,0,.5*o,0,2*Math.PI),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.restore();var f=t,I=e+r/2-n/2+o+5+20;this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.font="14px 微软雅黑";for(var d=0,T=0,p=0;T<this.Data.Data.length;++T){var v=this.Data.Data[T];if(v.Text){if(this.Canvas.fillStyle=v.Color,p%2==0?(f=t+i/2-10,d=this.Canvas.measureText(v.Text).width,f=f-d-16,this.Canvas.fillRect(f,I-15,13,13),this.Canvas.fillStyle="rgb(102,102,102)",this.Canvas.fillText(v.Text,f+16,I)):(f=t+i/2+10+10,this.Canvas.fillRect(f,I-15,13,13),this.Canvas.fillStyle="rgb(102,102,102)",this.Canvas.fillText(v.Text,f+16,I),I+=20),I>a)break;++p}}}},e.ChartColorKline=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartColorKline",this.Symbol,this.Color="rgb(0,255,44)",this.IsEmptyBar=!1,this.DrawType=0,this.KLineColor,this.DrawName,this.Draw=function(){if(this.IsShow)if("DRAWCOLORKLINE"==this.DrawName)this.DrawColorBar();else{if(!this.KLineColor)return;this.DrawBar()}},this.DrawUpBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,s=e+a,o=n+(s-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=this.ChartFrame.GetYFromData(t.Close),D=l;a>=4?(t.High>t.Close?(this.Canvas.beginPath(),r?(this.Canvas.moveTo(S(D),S(o)),this.Canvas.lineTo(S(3==this.DrawType?Math.max(C,u):C),S(o))):(this.Canvas.moveTo(S(o),S(D)),this.Canvas.lineTo(S(o),S(3==this.DrawType?Math.min(C,u):C))),this.Canvas.stroke(),D=C):D=C,r?Math.abs(u-D)<1?this.Canvas.fillRect(f(D),f(n),1,f(a)):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(S(D),S(n),f(u-D),f(a)),this.Canvas.stroke()):this.Canvas.fillRect(f(D),f(n),f(u-D),f(a)):Math.abs(u-D)<1?this.Canvas.fillRect(f(n),f(D),f(a),1):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(S(n),S(D),f(a),f(u-D)),this.Canvas.stroke()):this.Canvas.fillRect(f(n),f(Math.min(D,u)),f(a),f(Math.abs(u-D))),t.Open>t.Low&&(this.Canvas.beginPath(),r?(this.Canvas.moveTo(S(3==this.DrawType?Math.min(C,u):D),S(o)),this.Canvas.lineTo(S(h),S(o))):(this.Canvas.moveTo(S(o),S(3==this.DrawType?Math.max(C,u):D)),this.Canvas.lineTo(S(o),S(h))),this.Canvas.stroke())):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,S(o)),this.Canvas.lineTo(h,S(o))):(this.Canvas.moveTo(S(o),l),this.Canvas.lineTo(S(o),h)),this.Canvas.stroke())},this.DrawDownBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,s=e+a,o=n+(s-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=this.ChartFrame.GetYFromData(t.Close),D=l;a>=4?(t.High>t.Close?(this.Canvas.beginPath(),r?(this.Canvas.moveTo(S(D),S(o)),this.Canvas.lineTo(S(u),S(o))):(this.Canvas.moveTo(S(o),S(D)),this.Canvas.lineTo(S(o),S(u))),this.Canvas.stroke(),D=u):D=u,r?Math.abs(C-D)<1?this.Canvas.fillRect(f(D),f(n),1,f(a)):this.Canvas.fillRect(f(D),f(n),f(C-D),f(a)):Math.abs(C-D)<1?this.Canvas.fillRect(f(n),f(D),f(a),1):this.Canvas.fillRect(f(n),f(Math.min(D,C)),f(a),f(Math.abs(C-D))),t.Open>t.Low&&(this.Canvas.beginPath(),r?(this.Canvas.moveTo(S(D),S(o)),this.Canvas.lineTo(S(h),S(o))):(this.Canvas.moveTo(S(o),S(D)),this.Canvas.lineTo(S(o),S(h))),this.Canvas.stroke())):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,S(o)),this.Canvas.lineTo(h,S(o))):(this.Canvas.moveTo(S(o),l),this.Canvas.lineTo(S(o),h)),this.Canvas.stroke())},this.DrawUnChangeBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,s=e+a,o=n+(s-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=(this.ChartFrame.GetYFromData(t.Close),l);a>=4?(this.Canvas.beginPath(),t.High>t.Close?(r?(this.Canvas.moveTo(C,S(o)),this.Canvas.lineTo(u,S(o))):(this.Canvas.moveTo(S(o),C),this.Canvas.lineTo(S(o),u)),C=u):C=u,r?(this.Canvas.moveTo(S(C),S(n)),this.Canvas.lineTo(S(C),S(s))):(this.Canvas.moveTo(S(n),S(C)),this.Canvas.lineTo(S(s),S(C))),t.Open>t.Low&&(r?(this.Canvas.moveTo(S(C),S(o)),this.Canvas.lineTo(S(h),S(o))):(this.Canvas.moveTo(S(o),S(C)),this.Canvas.lineTo(S(o),S(h)))),this.Canvas.stroke()):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,S(o)),this.Canvas.lineTo(h,S(o))):(this.Canvas.moveTo(S(o),l),this.Canvas.lineTo(S(o),h)),this.Canvas.stroke())},this.DrawBar=function(){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetLeft()+e/2+2,i=this.ChartBorder.GetRight(),r=this.ChartFrame.XPointCount;this.IsHScreen&&(a=this.ChartBorder.GetTop()+e/2+2,i=this.ChartBorder.GetBottom());for(var n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<r;++n,++s,a+=t+e){var o=this.Data.Data[n];if(null!=o.Open&&null!=o.High&&null!=o.Low&&null!=o.Close&&this.KLineColor.has(n)){var h=this.KLineColor.get(n),l=a+t;if(l>i)break;h.Color?(this.Canvas.strokeStyle=h.Color,this.Canvas.fillStyle=h.Color):(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color),o.Open<o.Close?this.DrawUpBarItem(o,a,t,h):o.Open>o.Close?this.DrawDownBarItem(o,a,t,h):this.DrawUnChangeBarItem(o,a,t,h)}}},this.DrawColorBar=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),s=i.LeftEx+a/2+r.g_JSChartResource.FrameLeftMargin,o=i.RightEx,h=this.ChartFrame.XPointCount;if(t){i=this.ChartBorder.GetHScreenBorder();s=i.TopEx+a/2+r.g_JSChartResource.FrameLeftMargin,o=i.BottomEx}for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<h;++l,++u,s+=e+a){var C=this.Data.Data[l];if(C&&(n.IFrameSplitOperator.IsNumber(C.Open)&&n.IFrameSplitOperator.IsNumber(C.High)&&n.IFrameSplitOperator.IsNumber(C.Low)&&n.IFrameSplitOperator.IsNumber(C.Close))){var D=s,m=s+e;if(m>o)break;var c=D+(m-D)/2,S=this.GetYFromData(C.Low,!1),f=this.GetYFromData(C.High,!1),I=this.GetYFromData(C.Open,!1),d=this.GetYFromData(C.Close,!1),T=f;C.Open==C.Close?this.DrawKBar_Unchagne(C,e,this.Color,this.IsEmptyBar,c,T,D,m,S,f,I,d,t):this.DrawKBar_Custom(C,e,this.Color,this.IsEmptyBar,c,T,D,m,S,f,I,d,t)}}},this.DrawKBar_Unchagne=function(t,e,a,i,r,n,s,o,h,l,u,C,D){if(e>=4){if(e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,this.Canvas.beginPath(),t.High>t.Close){if(D)this.Canvas.moveTo(n,S(r)),this.Canvas.lineTo(u,S(r));else{var m=S(s+e/2);this.Canvas.moveTo(m,n),this.Canvas.lineTo(m,u)}n=u}else n=u;if(D?(this.Canvas.moveTo(S(n),S(s)),this.Canvas.lineTo(S(n),S(o))):(this.Canvas.moveTo(S(s),S(n)),this.Canvas.lineTo(S(s+e),S(n))),t.Open>t.Low)if(D)this.Canvas.moveTo(S(n),S(r)),this.Canvas.lineTo(S(h),S(r));else{m=S(s+e/2);this.Canvas.moveTo(m,S(n)),this.Canvas.lineTo(m,S(h))}this.Canvas.stroke()}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,S(r)),this.Canvas.lineTo(h,S(r))):t.High==t.Low?(this.Canvas.moveTo(S(r),l),this.Canvas.lineTo(S(r),h+1)):(this.Canvas.moveTo(S(r),l),this.Canvas.lineTo(S(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Custom=function(t,e,a,i,r,n,s,o,h,l,u,C,D){if(i&&e%2!=0&&(e-=1),e>=4){if(this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(S(n),S(r)),this.Canvas.lineTo(S(i?Math.max(C,u):C),S(r));else if(i){var m=s+e/2;this.Canvas.moveTo(S(m),S(n)),this.Canvas.lineTo(S(m),S(Math.min(C,u)))}else this.Canvas.moveTo(S(r),S(n)),this.Canvas.lineTo(S(r),S(C));this.Canvas.stroke(),n=C}else n=C;if(this.Canvas.fillStyle=a,D?Math.abs(u-n)<1?this.Canvas.fillRect(f(n),f(s),1,f(e)):i?(this.Canvas.beginPath(),this.Canvas.rect(S(n),S(s),f(u-n),f(e)),this.Canvas.stroke()):this.Canvas.fillRect(f(n),f(s),f(u-n),f(e)):Math.abs(u-n)<1?this.Canvas.fillRect(f(s),f(n),f(e),1):i?(this.Canvas.beginPath(),this.Canvas.rect(S(s),S(n),f(e),f(u-n)),this.Canvas.stroke()):this.Canvas.fillRect(f(s),f(Math.min(n,u)),f(e),f(Math.abs(u-n))),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(S(i?Math.min(C,u):n),S(r)),this.Canvas.lineTo(S(h),S(r));else if(i){m=s+e/2;this.Canvas.moveTo(S(m),S(Math.max(C,u))),this.Canvas.lineTo(S(m),S(h))}else this.Canvas.moveTo(S(r),S(n)),this.Canvas.lineTo(S(r),S(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,S(r)),this.Canvas.lineTo(h,S(r))):(this.Canvas.moveTo(S(r),l),this.Canvas.lineTo(S(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.GetMaxMin=function(){var t={Max:null,Min:null};if("DRAWCOLORKLINE"==this.DrawName)for(var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<e;++a,++i){var r=this.Data.Data[a];r&&(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close&&(null==t.Max&&(t.Max=r.High),null==t.Min&&(t.Min=r.Low),t.Max<r.High&&(t.Max=r.High),t.Min>r.Low&&(t.Min=r.Low)))}return t}},e.ChartCorssCursor=function(){this.Frame,this.Canvas,this.HPenColor=r.g_JSChartResource.CorssCursorHPenColor,this.HPenType=0,this.VPenColor=r.g_JSChartResource.CorssCursorVPenColor,this.VPenType=0,this.Font=r.g_JSChartResource.CorssCursorTextFont,this.TextColor=r.g_JSChartResource.CorssCursorTextColor,this.TextBGColor=r.g_JSChartResource.CorssCursorBGColor,this.TextHeight=15,this.LastPoint,this.CursorIndex,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.IsShow=!0,this.ShowTextMode={Left:1,Right:1,Bottom:1},this.IsShowCorss=!0,this.IsShowClose=!1,this.IsFixXLastTime=!1,this.Close=null,this.GetCloseYPoint=function(t){if(this.Close=null,!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a>=e.Data.length&&(a=e.Data.length-1),a<0)return null;var i=e.Data[a];if(!i)return null;this.Close=i.Close;var r=this.Frame.GetYFromData(this.Close);return r},this.FixMinuteLastTimeXPoint=function(t){if(!n.IFrameSplitOperator.IsNumber(t))return null;if(t=parseInt(t),!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a<e.Data.length)return null;a=e.Data.length-1,a-=e.DataOffset;var i=this.Frame.GetXFromIndex(a);return{X:i,Index:a}},this.Draw=function(){if(this.LastPoint){var t,e=this.LastPoint.X,a=this.LastPoint.Y,r=new i.Rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight());if(t=r.IsPointIn(e,a),this.PointY=null,this.PointY,t)if(!0!==this.Frame.IsHScreen){var s=this.Frame.ChartBorder.GetLeft(),o=this.Frame.ChartBorder.GetRight(),h=this.Frame.ChartBorder.GetTopTitle(),l=this.Frame.ChartBorder.GetBottom(),u=this.Frame.ChartBorder.Right,C=this.Frame.ChartBorder.GetChartWidth();if(e=this.Frame.GetXFromIndex(this.CursorIndex),this.IsShowClose){var D=this.GetCloseYPoint(this.CursorIndex);null!=D&&(a=D)}if(this.IsFixXLastTime){var m=this.FixMinuteLastTimeXPoint(this.CursorIndex);m&&(e=m.X,this.CursorIndex=m.Index)}if(this.PointY=[[s,a],[o,a]],this.PointX=[[e,h],[e,l]],this.IsShowCorss){if(1!=this.HPenType&&0!=this.HPenType||(this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash([3,2]),this.Canvas.beginPath(),this.Canvas.moveTo(s,S(a)),this.Canvas.lineTo(o,S(a)),this.Canvas.stroke(),this.Canvas.setLineDash([])),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash([3,2]);else if(2==this.VPenType){var c=this.Frame.SubFrame[0].Frame.DataWidth;c>2&&(this.Canvas.lineWidth=c)}if(this.Canvas.beginPath(),this.Frame.SubFrame.length>0)for(var f in this.Frame.SubFrame){var I=this.Frame.SubFrame[f].Frame;h=I.ChartBorder.GetTopTitle(),l=I.ChartBorder.GetBottom(),this.Canvas.moveTo(S(e),h),this.Canvas.lineTo(S(e),l)}else this.Canvas.moveTo(S(e),h),this.Canvas.lineTo(S(e),l);this.Canvas.stroke(),this.Canvas.restore()}this.Frame.GetXData(e);var d={},T=this.Frame.GetYData(a,d);if(this.StringFormatY.RValue=d.RightYValue,this.IsShowClose&&null!=this.Close&&(T=this.Close),this.StringFormatX.Value=this.CursorIndex,this.StringFormatY.Value=T,this.StringFormatY.FrameID=d.FrameID,(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Left>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Right>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var p=this.StringFormatY.Text;this.Canvas.font=this.Font;var v=this.Canvas.measureText(p).width+4;if(this.Frame.ChartBorder.Left>=30&&1==this.ShowTextMode.Left?(this.Canvas.fillStyle=this.TextBGColor,s<v?(this.Canvas.fillRect(2,a-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,4,a,v)):(this.Canvas.fillRect(s-2,a-this.TextHeight/2,-v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,s-4,a,v))):2==this.ShowTextMode.Left&&(this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(s,a-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,s+2,a,v)),this.StringFormatY.RText){p=this.StringFormatY.RText;v=this.Canvas.measureText(p).width+4}var F=null;if(this.StringFormatY.RComplexText&&n.IFrameSplitOperator.IsNonEmptyArray(this.StringFormatY.RComplexText.Text)){v=0;F=this.StringFormatY.RComplexText;for(f=0;f<F.Text.length;++f){var g=F.Text[f],A=this.Canvas.measureText(g.Text).width+4;f>0&&n.IFrameSplitOperator.IsNumber(F.Space)&&(v+=F.Space),v+=A}}if(this.Frame.ChartBorder.Right>=30&&1==this.ShowTextMode.Right)if(this.Canvas.fillStyle=this.TextBGColor,u>v){var E=o+2;this.Canvas.fillRect(E,a-this.TextHeight/2,v,this.TextHeight),F?this.DrawComplexText(E,a,F):(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,o+4,a,v))}else{E=C-2-v;this.Canvas.fillRect(E,a-this.TextHeight/2,v,this.TextHeight),F?this.DrawComplexText(E,a,F):(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,C-4,a,v))}else if(2==this.ShowTextMode.Right){this.Canvas.fillStyle=this.TextBGColor;var N=o-v;this.Canvas.fillRect(N,a-this.TextHeight/2,v,this.TextHeight),F?this.DrawComplexText(N,a,F):(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,N+2,a,v))}}if(1==this.ShowTextMode.Bottom&&this.StringFormatX.Operator()){p=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;v=this.Canvas.measureText(p).width+10;e-v/2<3?(this.Canvas.fillRect(e-1,l+2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,e+1,l+2,v)):o-s-e<v?(this.Canvas.fillRect(e-v,l+2,v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,e-1,l+2,v)):(this.Canvas.fillRect(e-v/2,l+2,v,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(p,e,l+2,v))}}else this.HScreenDraw()}},this.DrawComplexText=function(t,e,a){this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";for(var i=t+2,r=0;r<a.Text.length;++r){var s=a.Text[r],o=this.Canvas.measureText(s.Text).width+4;s.Color?this.Canvas.fillStyle=s.Color:is.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(s.Text,i,e,o),r>0&&n.IFrameSplitOperator.IsNumber(a.Space)&&(i+=a.Space),i+=o}},this.HScreenDraw=function(){var t=this.LastPoint.X,e=this.LastPoint.Y;e=this.Frame.GetXFromIndex(this.CursorIndex);var a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetRightEx(),r=this.Frame.ChartBorder.GetTop(),n=this.Frame.ChartBorder.GetBottom(),s=this.Frame.ChartBorder.Bottom;if(this.PointY=[[a,e],[i,e]],this.PointX=[[t,r],[t,n]],this.IsShowCorss){if(this.Canvas.save(),this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash([3,2]),this.Canvas.beginPath(),this.Canvas.moveTo(S(t),r),this.Canvas.lineTo(S(t),n),this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash([3,2]);else if(2==this.VPenType){var o=this.Frame.SubFrame[0].Frame.DataWidth;o>2&&(this.Canvas.lineWidth=o)}if(this.Canvas.beginPath(),this.Frame.SubFrame.length>0)for(var h in this.Frame.SubFrame){var l=this.Frame.SubFrame[h].Frame;this.Canvas.moveTo(l.ChartBorder.GetLeft(),S(e)),this.Canvas.lineTo(l.ChartBorder.GetRightTitle(),S(e))}else this.Canvas.moveTo(a,S(e)),this.Canvas.lineTo(i,S(e));this.Canvas.stroke(),this.Canvas.restore()}var u=this.Frame.GetXData(e),C={},D=this.Frame.GetYData(t,C);if(this.StringFormatX.Value=u,this.StringFormatY.Value=D,this.StringFormatY.FrameID=C.FrameID,(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Top>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Bottom>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var m=this.StringFormatY.Text;this.Canvas.font=this.Font;var c=this.Canvas.measureText(m).width+4;if(this.Frame.ChartBorder.Top>=30&&1==this.ShowTextMode.Left){var f=t,I=r;this.Canvas.save(),this.Canvas.translate(f,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,r>=c?(this.Canvas.fillRect(-c,-this.TextHeight/2,c,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,-2,0,c)):(this.Canvas.fillRect(c-r,-this.TextHeight/2,-c,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,c-r-2,0,c)),this.Canvas.restore()}else if(2==this.ShowTextMode.Left){f=t,I=r;this.Canvas.save(),this.Canvas.translate(f,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,c,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,2,0,c),this.Canvas.restore()}if(this.Frame.ChartBorder.Bottom>=30&&1==this.ShowTextMode.Right){f=t,I=n;this.Canvas.save(),this.Canvas.translate(f,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,s>c?(this.Canvas.fillRect(0,-this.TextHeight/2,c,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,2,0,c)):(this.Canvas.fillRect(s-c,-this.TextHeight/2,c,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,s-c+2,0,c)),this.Canvas.restore()}else if(2==this.ShowTextMode.Right){f=t,I=n;this.Canvas.save(),this.Canvas.translate(f,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,-c,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,-2,0,c),this.Canvas.restore()}}if(1===this.ShowTextMode.Bottom&&this.StringFormatX.Operator()){m=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;c=this.Canvas.measureText(m).width+4;if(e-c/2<3){f=a,I=e;this.Canvas.save(),this.Canvas.translate(f,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(0,0,c,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,0,0,c),this.Canvas.restore()}else{f=a,I=e;this.Canvas.save(),this.Canvas.translate(f,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(-c/2,0,c,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,0,0,c),this.Canvas.restore()}}}},e.ChartDrawIcon=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawIcon",this.IsHScreen=!1,this.DrawCallback,this.IsDestroy=!1,this.TextAlign="left",this.TextBaseline="middle",this.IconID,this.Color,this.FixedIconSize,this.DrawItem=[],this.Identify,this.Draw=function(){this.DrawItem=[],this.DrawCallback&&this.DrawCallback(1,{Self:this}),this.DrawAllText(),this.DrawCallback&&this.DrawCallback(2,{Self:this,Draw:this.DrawItem})},this.DrawAllText=function(){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());this.ChartBorder.GetTopEx(),this.ChartBorder.GetBottomEx();t&&(e=this.ChartBorder.GetBottom(),this.ChartBorder.GetRightEx(),this.ChartBorder.GetLeftEx());for(var a=this.ChartFrame.XPointCount,i=(Array.isArray(this.Text),this.Data.DataOffset),r=0;i<this.Data.Data.length&&r<a;++i,++r){var n=this.Data.Data[i];if(null!=n){var s=this.ChartFrame.GetXFromIndex(r),o=this.ChartFrame.GetYFromData(n);if(s>e)break;var h={Text:{Color:this.Color,Align:this.TextAlign,Baseline:this.TextBaseline},X:s,Y:o,IconID:this.IconID};this.DrawItem.push(h)}}},this.OnDestroy=function(){this.IsDestroy=!0,this.DrawCallback&&this.DrawCallback(4,{Self:this})}},e.ChartDrawNumber=function(){this.newMethod=D,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawNumber",this.ReloadResource=function(t){this.TextSize={Max:r.g_JSChartResource.DRAWNUMBER.MaxSize,Min:r.g_JSChartResource.DRAWNUMBER.MinSize,Zoom:{Type:r.g_JSChartResource.DRAWNUMBER.Zoom.Type,Value:r.g_JSChartResource.DRAWNUMBER.Zoom.Value},FontName:r.g_JSChartResource.DRAWNUMBER.FontName}}},e.ChartDrawText=D,e.ChartKLine=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartKLine",this.Symbol,this.DrawType=0,this.CloseLineColor=r.g_JSChartResource.CloseLineColor,this.CloseLineAreaColor=r.g_JSChartResource.CloseLineAreaColor,this.UpColor=r.g_JSChartResource.UpBarColor,this.DownColor=r.g_JSChartResource.DownBarColor,this.UnchagneColor=r.g_JSChartResource.UnchagneBarColor,this.ColorData,this.TradeData,this.IsShowMaxMinPrice=!0,this.TextFont=r.g_JSChartResource.KLine.MaxMin.Font,this.TextColor=r.g_JSChartResource.KLine.MaxMin.Color,this.InfoPointColor=r.g_JSChartResource.KLine.Info.Color,this.InfoPointColor2=r.g_JSChartResource.KLine.Info.Color2,this.InfoDrawType=0,this.PtMax,this.PtMin,this.MinBarWidth=r.g_JSChartResource.MinKLineBarWidth,this.CustomKLine,this.ShowRange={},this.DrawKRange={Start:null,End:null},this.DrawAKLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,n=this.ChartBorder.GetLeft()+a/2+r.g_JSChartResource.FrameLeftMargin;t&&(n=this.ChartBorder.GetTop()+a/2+r.g_JSChartResource.FrameLeftMargin);var s=this.ChartBorder.GetRight();t&&(s=this.ChartBorder.GetBottom());var o=this.ChartFrame.XPointCount;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.DrawKRange.Start=this.Data.DataOffset;var h=null;this.GetEventCallback&&(h=this.GetEventCallback(i.JSCHART_EVENT_ID.ON_CUSTOM_UNCHANGE_KLINE_COLOR));for(var l=this.UpColor,u=this.DownColor,C=this.UnchagneColor,D={X:null,Y:null,Value:null,Align:"left"},m={X:null,Y:null,Value:null,Align:"left"},c=this.Data.DataOffset,f=0;c<this.Data.Data.length&&f<o;++c,++f,n+=e+a,++this.ShowRange.DataCount){var I=this.Data.Data[c];if(null!=I.Open&&null!=I.High&&null!=I.Low&&null!=I.Close){var d=n,T=n+e;if(T>s)break;var p=d+(T-d)/2,v=this.ChartFrame.GetYFromData(I.Low),F=this.ChartFrame.GetYFromData(I.High),g=this.ChartFrame.GetYFromData(I.Open),A=this.ChartFrame.GetYFromData(I.Close);if(this.DrawKRange.End=c,(null==D.Value||D.Value<I.High)&&(D.X=p,D.Y=F,D.Value=I.High,D.Align=f<o/2?"left":"right"),(null==m.Value||m.Value>I.Low)&&(m.X=p,m.Y=v,m.Value=I.Low,m.Align=f<o/2?"left":"right"),I.Open<I.Close)this.Canvas.strokeStyle=l;else if(I.Open>I.Close)this.Canvas.strokeStyle=u;else{if(h&&h.Callback){var E={KItem:I,DataIndex:c,DefaultColor:C,BarColor:null};h.Callback(h,E,this),E.BarColor&&(C=E.BarColor)}this.Canvas.strokeStyle=C}if(this.Canvas.beginPath(),t?I.High==I.Low&&e<this.MinBarWidth?(this.Canvas.moveTo(F,S(p)),this.Canvas.lineTo(v-1,S(p))):(this.Canvas.moveTo(F,S(p)),this.Canvas.lineTo(v,S(p))):I.High==I.Low&&e<this.MinBarWidth?(this.Canvas.moveTo(S(p),F),this.Canvas.lineTo(S(p),v+1)):(this.Canvas.moveTo(S(p),F),this.Canvas.lineTo(S(p),v)),this.Canvas.stroke(),e>=this.MinBarWidth&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(S(g),d),this.Canvas.lineTo(S(g),p)):(this.Canvas.moveTo(d,S(g)),this.Canvas.lineTo(p,S(g))),this.Canvas.stroke(),this.Canvas.beginPath(),t?(this.Canvas.moveTo(S(A),T),this.Canvas.lineTo(S(A),p)):(this.Canvas.moveTo(T,S(A)),this.Canvas.lineTo(p,S(A))),this.Canvas.stroke()),0==this.Data.DataType&&i.ChartData.IsDayPeriod(this.Data.Period,!0)){var N={X:p,Xleft:d,XRight:T,YMax:F,YMin:v,DayData:I,Index:f};this.DrawInfoDiv(N)}}}this.PtMax=D,this.PtMin=m},this.DrawCloseLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());var n=this.ChartFrame.XPointCount;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=n,this.DrawKRange.Start=this.Data.DataOffset;var s=!0;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor;for(var o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<n;++o,++h,i+=e+a,++this.ShowRange.DataCount){var l=this.Data.Data[o];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var u=i,C=i+e;if(C>r)break;var D=u+(C-u)/2,m=this.ChartFrame.GetYFromData(l.Close);this.DrawKRange.End=o,s?(t?this.Canvas.moveTo(m,D):this.Canvas.moveTo(D,m),s=!1):t?this.Canvas.lineTo(m,D):this.Canvas.lineTo(D,m)}}0==s&&this.Canvas.stroke()},this.DrawCloseArea=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var s=this.ChartBorder.GetHScreenBorder(),o=s.TopEx+a/2+r.g_JSChartResource.FrameLeftMargin,h=s.BottomEx,l=s.TopEx;else s=this.ChartBorder.GetBorder(),o=s.LeftEx+a/2+r.g_JSChartResource.FrameLeftMargin,h=s.RightEx,l=s.LeftEx;var u=!0,C=null;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor;var D=null;if(this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset,this.Data.DataOffset>0){var m=this.Data.Data[this.Data.DataOffset-1];if(m&&n.IFrameSplitOperator.IsNumber(m.Close)){var c=l,S=this.GetYFromData(m.Close,!1);t?(this.Canvas.moveTo(S,c),C={X:S,Y:c}):(this.Canvas.moveTo(c,S),C={X:c,Y:S}),u=!1}}for(var f=this.Data.DataOffset,I=0;f<this.Data.Data.length&&I<i;++f,++I,o+=e+a,++this.ShowRange.DataCount){m=this.Data.Data[f];if(null!=m.Open&&null!=m.High&&null!=m.Low&&null!=m.Close){var d=o,T=o+e;if(T>h)break;c=d+(T-d)/2,S=this.ChartFrame.GetYFromData(m.Close);this.DrawKRange.End=f,u?(t?(this.Canvas.moveTo(S,c),C={X:S,Y:c}):(this.Canvas.moveTo(c,S),C={X:c,Y:S}),u=!1):t?this.Canvas.lineTo(S,c):this.Canvas.lineTo(c,S),f==this.Data.Data.length-1&&(D={X:c,Y:S,XLeft:d,XRight:T,KItem:m,ChartRight:h})}}if(this.DrawLastPointEvent(D),!u){if(this.Canvas.stroke(),t?(this.Canvas.lineTo(this.ChartBorder.GetLeft(),c),this.Canvas.lineTo(this.ChartBorder.GetLeft(),C.Y)):(this.Canvas.lineTo(c,this.ChartBorder.GetBottom()),this.Canvas.lineTo(C.X,this.ChartBorder.GetBottom())),this.Canvas.closePath(),Array.isArray(this.CloseLineAreaColor))if(t){var p=this.Canvas.createLinearGradient(this.ChartBorder.GetRightEx(),this.ChartBorder.GetTop(),this.ChartBorder.GetLeft(),this.ChartBorder.GetTop());p.addColorStop(0,this.CloseLineAreaColor[0]),p.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=p}else{var v=this.Canvas.createLinearGradient(C.X,this.ChartBorder.GetTopEx(),C.X,this.ChartBorder.GetBottom());v.addColorStop(0,this.CloseLineAreaColor[0]),v.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=v}else this.Canvas.fillStyle=this.CloseLineAreaColor;this.Canvas.fill()}},this.DrawKBar=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+a/2+2,s=this.ChartBorder.GetRight(),o=this.ChartFrame.XPointCount,h=this.ChartBorder.GetBorder();t&&(r=this.ChartBorder.GetTop()+a/2+2,s=this.ChartBorder.GetBottom());var l={X:null,Y:null,Value:null,Align:"left"},u={X:null,Y:null,Value:null,Align:"left"},C=this.UpColor,D=this.DownColor,m=this.UnchagneColor,c=null;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.DrawKRange.Start=this.Data.DataOffset;var S=null;this.GetEventCallback&&(S=this.GetEventCallback(i.JSCHART_EVENT_ID.ON_CUSTOM_UNCHANGE_KLINE_COLOR));for(var f=this.Data.DataOffset,I=0;f<this.Data.Data.length&&I<o;++f,++I,r+=e+a,++this.ShowRange.DataCount){var d=this.Data.Data[f];if(null!=d.Open&&null!=d.High&&null!=d.Low&&null!=d.Close){var T=r,p=r+e;if(p>s)break;this.DrawKRange.End=f;var v=T+(p-T)/2,F=this.ChartFrame.GetYFromData(d.Low),g=this.ChartFrame.GetYFromData(d.High),A=this.ChartFrame.GetYFromData(d.Open),E=this.ChartFrame.GetYFromData(d.Close),N=g;(null==l.Value||l.Value<d.High)&&(l.X=v,l.Y=g,l.Value=d.High,l.Align=I<o/2?"left":"right"),(null==u.Value||u.Value>d.Low)&&(u.X=v,u.Y=F,u.Value=d.Low,u.Align=I<o/2?"left":"right"),this.ColorData&&(C=D=m=f<this.ColorData.length&&this.ColorData[f]>0?this.UpColor:this.DownColor);var M=this.GetCustomKLine(d);if(M){var L=M.Color;L||(L=d.Open<d.Close?C:d.Open>d.Close?D:m);var x=this.DrawType;n.IFrameSplitOperator.IsNumber(M.DrawType)&&(x=M.DrawType),this.DrawKBar_Custom(d,e,L,x,M,v,N,T,p,F,g,A,E,h,t)}else if(9==this.DrawType&&d.ColorData)this.DrawKBarV2(d,d.ColorData,e,v,N,T,p,F,g,A,E,t);else if(d.Open<d.Close)this.DrawKBar_Up(d,e,C,this.DrawType,v,N,T,p,F,g,A,E,t);else if(d.Open>d.Close)this.DrawKBar_Down(d,e,D,this.DrawType,v,N,T,p,F,g,A,E,t);else{L=m;if(S&&S.Callback){var O={KItem:d,DataIndex:f,DefaultColor:L,BarColor:null};S.Callback(S,O,this),O.BarColor&&(L=O.BarColor)}this.DrawKBar_Unchagne(d,e,L,this.DrawType,v,N,T,p,F,g,A,E,t)}if(0==this.Data.DataType&&i.ChartData.IsDayPeriod(this.Data.Period,!0)){var R={X:v,Xleft:T,XRight:p,YMax:g,YMin:F,DayData:d,Index:I};this.DrawInfoDiv(R)}f==this.Data.Data.length-1&&(c={X:v,Y:E,XLeft:T,XRight:p,KItem:d,ChartRight:s})}}this.DrawLastPointEvent(c),this.PtMax=l,this.PtMin=u},this.DrawKBar_Up=function(t,e,a,i,r,n,s,o,h,l,u,C,D){var m=3==i||6==i;if(e>=this.MinBarWidth){if(m&&e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(S(n),S(r)),this.Canvas.lineTo(S(3==this.DrawType?Math.max(C,u):C),S(r));else if(m){var c=s+e/2;this.Canvas.moveTo(S(c),S(n)),this.Canvas.lineTo(S(c),S(Math.min(C,u)))}else this.Canvas.moveTo(S(r),S(n)),this.Canvas.lineTo(S(r),S(C));this.Canvas.stroke(),n=C}else n=C;if(this.Canvas.fillStyle=a,D?Math.abs(u-n)<1?this.Canvas.fillRect(f(n),f(s),1,f(e)):m?(this.Canvas.beginPath(),this.Canvas.rect(S(n),S(s),f(u-n),f(e)),this.Canvas.stroke()):this.Canvas.fillRect(f(Math.min(u,n)),f(s),f(Math.abs(u-n)),f(e)):Math.abs(u-n)<1?this.Canvas.fillRect(f(s),f(n),f(e),1):m?(this.Canvas.beginPath(),this.Canvas.rect(S(s),S(n),f(e),f(u-n)),this.Canvas.stroke()):this.Canvas.fillRect(f(s),f(n),f(e),f(u-n)),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(S(3==this.DrawType?Math.min(C,u):n),S(r)),this.Canvas.lineTo(S(h),S(r));else if(m){c=s+e/2;this.Canvas.moveTo(S(c),S(Math.max(C,u))),this.Canvas.lineTo(S(c),S(h))}else this.Canvas.moveTo(S(r),S(n)),this.Canvas.lineTo(S(r),S(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,S(r)),this.Canvas.lineTo(h,S(r))):(this.Canvas.moveTo(S(r),l),this.Canvas.lineTo(S(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Down=function(t,e,a,i,r,n,s,o,h,l,u,C,D){var m=6==i;if(e>=this.MinBarWidth){if(m&&e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(S(n),S(r)),this.Canvas.lineTo(S(u),S(r));else if(m){var c=s+e/2;this.Canvas.moveTo(S(c),S(n)),this.Canvas.lineTo(S(c),S(Math.min(C,u)))}else this.Canvas.moveTo(S(r),S(n)),this.Canvas.lineTo(S(r),S(u));this.Canvas.stroke(),n=u}else n=u;if(this.Canvas.fillStyle=a,D?Math.abs(C-n)<1?this.Canvas.fillRect(f(n),f(s),1,f(e)):this.Canvas.fillRect(f(Math.min(C,n)),f(s),f(Math.abs(C-n)),f(e)):Math.abs(C-n)<1?this.Canvas.fillRect(f(s),f(n),f(e),1):m?(this.Canvas.beginPath(),this.Canvas.rect(S(s),S(n),f(e),f(C-n)),this.Canvas.stroke()):this.Canvas.fillRect(f(s),f(n),f(e),f(C-n)),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(S(n),S(r)),this.Canvas.lineTo(S(h),S(r));else if(m){c=s+e/2;this.Canvas.moveTo(S(c),S(Math.max(C,u))),this.Canvas.lineTo(S(c),S(h))}else this.Canvas.moveTo(S(r),S(n)),this.Canvas.lineTo(S(r),S(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,S(r)),this.Canvas.lineTo(h,S(r))):(this.Canvas.moveTo(S(r),l),this.Canvas.lineTo(S(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Unchagne=function(t,e,a,i,r,n,s,o,h,l,u,C,D){if(e>=this.MinBarWidth){if(e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,this.Canvas.beginPath(),t.High>t.Close){if(D)this.Canvas.moveTo(n,S(r)),this.Canvas.lineTo(u,S(r));else{var m=s+e/2;this.Canvas.moveTo(S(m),n),this.Canvas.lineTo(S(m),u)}n=u}else n=u;if(D?(this.Canvas.moveTo(S(n),S(s)),this.Canvas.lineTo(S(n),S(o))):(this.Canvas.moveTo(S(s),S(n)),this.Canvas.lineTo(S(s+e),S(n))),t.Open>t.Low)if(D)this.Canvas.moveTo(S(n),S(r)),this.Canvas.lineTo(S(h),S(r));else{m=s+e/2;this.Canvas.moveTo(S(m),S(n)),this.Canvas.lineTo(S(m),S(h))}this.Canvas.stroke()}else this.Canvas.beginPath(),D?t.High==t.Low?(this.Canvas.moveTo(l,S(r)),this.Canvas.lineTo(h-1,S(r))):(this.Canvas.moveTo(l,S(r)),this.Canvas.lineTo(h,S(r))):t.High==t.Low?(this.Canvas.moveTo(S(r),l),this.Canvas.lineTo(S(r),h+1)):(this.Canvas.moveTo(S(r),l),this.Canvas.lineTo(S(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Custom=function(t,e,a,i,r,n,s,o,h,l,u,C,D,m,c){if(r.BGColor){this.Canvas.fillStyle=r.BGColor;var I=this.ChartFrame.DistanceWidth;if(c){var d=o-I/2,T=h+I/2,p=m.RightEx,v=m.LeftEx;this.Canvas.fillRect(f(v),f(d),f(p-v),f(T-d))}else{var F=o-I/2,g=h+I/2,A=m.TopEx,E=m.BottomEx;this.Canvas.fillRect(f(F),f(A),f(g-F),f(E-A))}}e>=4?(this.Canvas.strokeStyle=a,t.High>t.Close?(this.Canvas.beginPath(),c?(this.Canvas.moveTo(S(s),S(n)),this.Canvas.lineTo(S(3==i?Math.max(D,C):D),S(n))):(this.Canvas.moveTo(S(n),S(s)),this.Canvas.lineTo(S(n),S(3==i?Math.min(D,C):D))),this.Canvas.stroke(),s=D):s=D,this.Canvas.fillStyle=a,c?Math.abs(C-s)<1?this.Canvas.fillRect(f(s),f(o),1,f(e)):3==i?(this.Canvas.beginPath(),this.Canvas.rect(S(s),S(o),f(C-s),f(e)),this.Canvas.stroke()):this.Canvas.fillRect(f(s),f(o),f(C-s),f(e)):Math.abs(C-s)<1?this.Canvas.fillRect(f(o),f(s),f(e),1):3==i?(this.Canvas.beginPath(),this.Canvas.rect(S(o),S(s),f(e),f(C-s)),this.Canvas.stroke()):this.Canvas.fillRect(f(o),f(Math.min(s,C)),f(e),f(Math.abs(C-s))),t.Open>t.Low&&(this.Canvas.beginPath(),c?(this.Canvas.moveTo(S(3==i?Math.min(D,C):s),S(n)),this.Canvas.lineTo(S(l),S(n))):(this.Canvas.moveTo(S(n),S(3==i?Math.max(D,C):s)),this.Canvas.lineTo(S(n),S(l))),this.Canvas.stroke())):(this.Canvas.beginPath(),c?(this.Canvas.moveTo(u,S(n)),this.Canvas.lineTo(l,S(n))):(this.Canvas.moveTo(S(n),u),this.Canvas.lineTo(S(n),l)),this.Canvas.strokeStyle=a,this.Canvas.stroke())},this.DrawKBarV2=function(t,e,a,i,r,n,s,o,h,l,u,C){var D=!1,m=!1;if(e.border&&(D=!0),0===e.Type&&(m=!0),a>=4){if(D&&a%2!=0&&(a-=1),t.High>t.Close){if(e.Line){if(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C)this.Canvas.moveTo(S(r),S(i)),this.Canvas.lineTo(S(Math.max(u,l)),S(i));else if(D){var c=n+a/2;this.Canvas.moveTo(S(c),S(r)),this.Canvas.lineTo(S(c),S(Math.min(u,l)))}else this.Canvas.moveTo(S(i),S(r)),this.Canvas.lineTo(S(i),S(Math.min(u,l)));this.Canvas.stroke()}r=u}else r=u;if(C?(!m&&e.BarColor&&(this.Canvas.fillStyle=e.BarColor,Math.abs(l-r)<1?this.Canvas.fillRect(f(r),f(n),1,f(a)):this.Canvas.fillRect(f(r),f(n),f(l-r),f(a))),e.Border&&(Math.abs(l-r)<1?(this.Canvas.fillStyle=e.Border.Color,this.Canvas.fillRect(f(r),f(n),1,f(a))):(this.Canvas.strokeStyle=e.Border.Color,this.Canvas.beginPath(),this.Canvas.rect(S(r),S(n),f(l-r),f(a)),this.Canvas.stroke()))):(!m&&e.BarColor&&(this.Canvas.fillStyle=e.BarColor,Math.abs(l-r)<1?this.Canvas.fillRect(f(n),f(r),f(a),1):this.Canvas.fillRect(f(n),f(Math.min(r,l)),f(a),f(Math.abs(l-r)))),e.Border&&(Math.abs(l-r)<1?(this.Canvas.fillStyle=e.Border.Color,this.Canvas.fillRect(f(n),f(r),f(a),1)):(this.Canvas.strokeStyle=e.Border.Color,this.Canvas.beginPath(),this.Canvas.rect(S(n),S(r),f(a),f(l-r)),this.Canvas.stroke()))),t.Open>t.Low&&e.Line){if(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C)this.Canvas.moveTo(S(Math.min(u,l)),S(i)),this.Canvas.lineTo(S(o),S(i));else if(D){c=n+a/2;this.Canvas.moveTo(S(c),S(Math.max(u,l))),this.Canvas.lineTo(S(c),S(o))}else this.Canvas.moveTo(S(i),S(Math.max(u,l))),this.Canvas.lineTo(S(i),S(o));this.Canvas.stroke()}}else{var I;m&&e.Border?I=e.Border.Color:!m&&e.BarColor&&(I=e.BarColor),I&&(this.Canvas.strokeStyle=I,this.Canvas.beginPath(),C?t.High==t.Low?(this.Canvas.moveTo(h,S(i)),this.Canvas.lineTo(o-1,S(i))):(this.Canvas.moveTo(h,S(i)),this.Canvas.lineTo(o,S(i))):t.High==t.Low?(this.Canvas.moveTo(S(i),h),this.Canvas.lineTo(S(i),o+1)):(this.Canvas.moveTo(S(i),h),this.Canvas.lineTo(S(i),o)),this.Canvas.stroke())}},this.ClearCustomKLine=function(){this.CustomKLine=null},this.GetCustomKLine=function(t){if(!this.CustomKLine)return null;if(!t)return null;var e=1e6*t.Date;if(n.IFrameSplitOperator.IsNumber(t.Time)&&(e+=t.Time),!this.CustomKLine.has(e))return null;var a=this.CustomKLine.get(e);return a},this.DrawTrade=function(){if(this.TradeData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var s=this.TradeData.Sell,o=this.TradeData.Buy,h=e;h>10&&(h=10);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=e+a){var C=this.Data.Data[l];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var D=!1,m=!1;if(s&&l<s.length&&(m=s[l]>0),o&&l<o.length&&(D=o[l]>0),m||D){var c=i,S=i+e;if(S>r)break;var f=c+(S-c)/2,I=this.ChartFrame.GetYFromData(C.Low),d=this.ChartFrame.GetYFromData(C.High);this.ChartFrame.GetYFromData(C.Open),this.ChartFrame.GetYFromData(C.Close);D&&(this.Canvas.fillStyle=this.UpColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(I-1,f),this.Canvas.lineTo(I-h-1,f-h/2),this.Canvas.lineTo(I-h-1,f+h/2)):(this.Canvas.moveTo(f,I+1),this.Canvas.lineTo(f-h/2,I+h+1),this.Canvas.lineTo(f+h/2,I+h+1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()),m&&(this.Canvas.fillStyle=this.DownColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(d+1,f),this.Canvas.lineTo(d+h+1,f-h/2),this.Canvas.lineTo(d+h+1,f+h/2)):(this.Canvas.moveTo(f,d-1),this.Canvas.lineTo(f-h/2,d-h-1),this.Canvas.lineTo(f+h/2,d-h-1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke())}}}}},this.Draw=function(){this.PtMax={X:null,Y:null,Value:null,Align:"left"},this.PtMin={X:null,Y:null,Value:null,Align:"left"},this.ChartFrame.ChartKLine={Max:null,Min:null},this.DrawKRange={Start:null,End:null},0!=this.IsShow&&(1!=this.DrawType?(2==this.DrawType?this.DrawAKLine():4==this.DrawType?this.DrawCloseArea():(this.DrawType,this.DrawKBar()),this.DrawTrade(),this.IsShowMaxMinPrice&&(!0===this.ChartFrame.IsHScreen?this.HScreenDrawMaxMinPrice(this.PtMax,this.PtMin):this.DrawMaxMinPrice(this.PtMax,this.PtMin))):this.DrawCloseLine())},this.DrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var a=r.g_JSChartResource.KLine.MaxMin.LeftArrow,i=r.g_JSChartResource.KLine.MaxMin.RightArrow,o=r.g_JSChartResource.KLine.MaxMin.HighYOffset,h=r.g_JSChartResource.KLine.MaxMin.LowYOffset,l=s.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=t.Align,this.Canvas.textBaseline="bottom";var u=t.X;n.IFrameSplitOperator.IsNumber(o)&&(t.Y+=o);var C=t.Value.toFixed(l);"left"==t.Align?C=a+C:C+=i,this.Canvas.fillText(C,u,t.Y),this.ChartFrame.ChartKLine.Max={X:u,Y:t.Y,Text:{BaseLine:"bottom"}},this.Canvas.textAlign=e.Align,this.Canvas.textBaseline="top";u=e.X;n.IFrameSplitOperator.IsNumber(h)&&(e.Y+=h),C=e.Value.toFixed(l),"left"==e.Align?C=a+C:C+=i,this.Canvas.fillText(C,u,e.Y),this.ChartFrame.ChartKLine.Min={X:u,Y:e.Y,Text:{BaseLine:"top"}}}},this.HScreenDrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var a=r.g_JSChartResource.KLine.MaxMin.LeftArrow,i=r.g_JSChartResource.KLine.MaxMin.RightArrow,o=r.g_JSChartResource.KLine.MaxMin.HighYOffset,h=r.g_JSChartResource.KLine.MaxMin.LowYOffset,l=s.JSCommonCoordinateData.GetfloatPrecision(this.Symbol),u=t.Y,C=t.X;n.IFrameSplitOperator.IsNumber(o)&&(u+=o),this.Canvas.save(),this.Canvas.translate(u,C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=t.Align,this.Canvas.textBaseline="bottom";var D=t.Value.toFixed(l);"left"==t.Align?D=a+D:D+=i,this.Canvas.fillText(D,0,0),this.Canvas.restore();u=e.Y,C=e.X;n.IFrameSplitOperator.IsNumber(h)&&(u+=h),this.Canvas.save(),this.Canvas.translate(u,C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=e.Align,this.Canvas.textBaseline="top";D=e.Value.toFixed(l);"left"==e.Align?D=a+D:D+=i,this.Canvas.fillText(D,0,0),this.Canvas.restore()}},this.DrawInfoDiv=function(t){if(this.InfoData&&!(this.InfoData.size<=0)){var e=this.ChartFrame.DataWidth,a=(this.ChartFrame.DistanceWidth,this.InfoData.get(t.DayData.Date.toString()));if(a&&!(a.Data.length<=0)){var i=!0===this.ChartFrame.IsHScreen;if(1===this.InfoDrawType)if(this.Canvas.font=this.GetDynamicFont(e),this.Canvas.fillStyle=this.InfoPointColor2,this.Canvas.textAlign="center",this.Canvas.textBaseline="top",i){var r=t.YMin,n=t.X;this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText("▲",0,0),this.Canvas.restore()}else{var s=S(t.X);this.Canvas.fillText("▲",s,t.YMin)}else{e=this.ChartFrame.DataWidth;var o=e/2;o>3&&(o=3);var h=t.X,l=this.ChartFrame.ChartBorder.GetBottom()-2-o;i&&(l=this.ChartFrame.ChartBorder.GetLeft()+2+o),this.Canvas.fillStyle=this.InfoPointColor,this.Canvas.beginPath(),i?this.Canvas.arc(l,h,o,0,2*Math.PI,!0):this.Canvas.arc(S(h),l,o,0,2*Math.PI,!0),this.Canvas.closePath(),this.Canvas.fill()}}}},this.GetTooltipData=function(t,e,a){return!1},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(0==this.IsShow)return e;if(1==this.DrawType||4==this.DrawType)for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];n.IFrameSplitOperator.IsNumber(r.Close)&&(null==e.Max&&(e.Max=r.Close),null==e.Min&&(e.Min=r.Close),e.Max<r.Close&&(e.Max=r.Close),e.Min>r.Close&&(e.Min=r.Close))}else for(a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){r=this.Data.Data[a];null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close&&(null==e.Max&&(e.Max=r.High),null==e.Min&&(e.Min=r.Low),e.Max<r.High&&(e.Max=r.High),e.Min>r.Low&&(e.Min=r.Low))}return e},this.DrawLastPointEvent=function(t){if(this.GetEventCallback){var e=this.GetEventCallback(i.JSCHART_EVENT_ID.ON_DRAW_KLINE_LAST_POINT);if(e){var a={Data:this.ChartFrame.DataWidth,Distance:this.ChartFrame.DistanceWidth};if(t)var r={LastPoint:{X:t.X,Y:t.Y,XLeft:t.XLeft,XRight:t.XRight},KItem:t.KItem,DrawType:this.DrawType,KWidth:a,ChartRight:t.ChartRight};else r={LastPoint:null,KItem:null,KWidth:a};e.Callback(e,r,this)}}}},e.ChartLine=m,e.ChartLineMultiData=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());for(var a=this.ChartFrame.XPointCount,i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s);if(h>e)break;for(var l in o){var u=o[l].Value,C=this.ChartFrame.GetYFromData(u);i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(C,h):this.Canvas.moveTo(h,C),i=!1):t?this.Canvas.lineTo(C,h):this.Canvas.lineTo(h,C),++r}}}r>0&&this.Canvas.stroke()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r)for(var n in r){var s=r[n].Value;null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=s),e.Max<s&&(e.Max=s),e.Min>s&&(e.Min=s)}}return e}},e.ChartLineStick=function(){this.newMethod=c,this.newMethod(),delete this.newMethod,this.ClassName="ChartLineStick",this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.NotSupportMessage?this.DrawNotSupportmessage():(this.DrawStick(),this.DrawLine()))}},e.ChartLock=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.WidthDiv=.2,this.LockCount=10,this.BGColor=r.g_JSChartResource.LockBGColor,this.TextColor=r.g_JSChartResource.LockTextColor,this.Font=r.g_JSChartResource.DefaultTextFont,this.Title="🔒开通权限",this.LockRect=null,this.LockID,this.Callback,this.IndexName,this.Draw=function(){if(this.LockRect=null,!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(!0!==this.ChartFrame.IsHScreen){var t=this.ChartBorder.GetRight(),e=0;if(null!=this.ChartFrame.Data){var a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth;t=this.ChartBorder.GetLeft()+i/2+2;for(var r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount,s=this.ChartFrame.Data.DataOffset,o=0;s<this.ChartFrame.Data.Data.length&&o<n;++s,++o,t+=a+i){var h=this.ChartFrame.Data.Data[s];if(null!=h.Open&&null!=h.High&&null!=h.Low&&null!=h.Close){var l=t+a;if(l>r)break}}e=(a+i)*this.LockCount}0==e&&(e=(t-this.ChartBorder.GetLeft())*this.WidthDiv);var u=t-e;u<this.ChartBorder.GetLeft()&&(u=this.ChartBorder.GetLeft());var C=this.ChartBorder.GetBottom()-this.ChartBorder.GetTop(),D=this.ChartBorder.GetRight()-u;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(u,this.ChartBorder.GetTop(),D,C);var m=u+D/2,c=this.ChartBorder.GetTop()+C/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,m,c),this.LockRect={Left:u,Top:this.ChartBorder.GetTop(),Width:D,Heigh:C}}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartBorder.GetBottom(),e=0;if(null!=this.ChartFrame.Data){var a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth;t=this.ChartBorder.GetTop()+i/2+2;for(var r=this.ChartBorder.GetBottom(),n=this.ChartFrame.XPointCount,s=this.ChartFrame.Data.DataOffset,o=0;s<this.ChartFrame.Data.Data.length&&o<n;++s,++o,t+=a+i){var h=this.ChartFrame.Data.Data[s];if(null!=h.Open&&null!=h.High&&null!=h.Low&&null!=h.Close){var l=t+a;if(l>r)break}}e=(a+i)*this.LockCount}0==e&&(e=(t-this.ChartBorder.GetTop())*this.WidthDiv);var u=t-e;u<this.ChartBorder.GetTop()&&(u=this.ChartBorder.GetTop());var C=this.ChartBorder.GetRight()-this.ChartBorder.GetLeft(),D=this.ChartBorder.GetBottom()-u;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(this.ChartBorder.GetLeft(),u,C,D);var m=this.ChartBorder.GetLeft()+C/2,c=u+D/2;this.Canvas.save(),this.Canvas.translate(m,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,0,0),this.Canvas.restore(),this.LockRect={Left:this.ChartBorder.GetLeft(),Top:u,Width:C,Heigh:D}},this.GetTooltipData=function(t,e,a){return null!=this.LockRect&&(!!this.IsPointInRect(t,e,this.LockRect.Left,this.LockRect.Top,this.LockRect.Width,this.LockRect.Heigh)&&(a.Data={ID:this.LockID,Callback:this.Callback,IndexName:this.IndexName},a.ChartPaint=this,!0))},this.IsPointInRect=function(t,e,a,i,r,n){return t>a&&t<a+r&&e>i&&e<i+n}},e.ChartMACD=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartMACD",this.UpColor=r.g_JSChartResource.UpBarColor,this.DownColor=r.g_JSChartResource.DownBarColor,this.LineWidth=1,this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(!0!==this.ChartFrame.IsHScreen){var t=this.IsMinuteFrame(),e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+r.g_JSChartResource.FrameLeftMargin,n=this.ChartBorder.GetRight(),s=this.ChartFrame.XPointCount,o=this.LineWidth;(50==this.LineWidth||o>e)&&(o=e),this.Canvas.save(),this.Canvas.lineWidth=o;for(var h=this.ChartFrame.GetYFromData(0),l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,i+=e+a){var C=this.Data.Data[l];if(null!=C){if(t)var D=this.ChartFrame.GetXFromIndex(u);else{var m=i,c=i+e;if(c>n)break;D=m+(c-m)/2}var S=this.ChartFrame.GetYFromData(C);if(D>n)break;var f=parseInt(D.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(f,h),this.Canvas.lineTo(f,S),this.Canvas.strokeStyle=C>=0?this.UpColor:this.DownColor,this.Canvas.stroke(),this.Canvas.closePath()}}this.Canvas.restore()}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.IsMinuteFrame(),e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetTop()+a/2+r.g_JSChartResource.FrameLeftMargin,n=this.ChartBorder.GetBottom(),s=this.ChartFrame.XPointCount,o=this.ChartFrame.GetYFromData(0),h=this.LineWidth;(50==this.LineWidth||h>e)&&(h=e),this.Canvas.save(),this.Canvas.lineWidth=h;for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,i+=e+a){var C=this.Data.Data[l];if(null!=C){if(t)var D=this.ChartFrame.GetXFromIndex(u);else{var m=i,c=i+e;if(c>n)break;D=m+(c-m)/2}var f=this.ChartFrame.GetYFromData(C);if(D>n)break;this.Canvas.beginPath(),this.Canvas.moveTo(o,S(D)),this.Canvas.lineTo(f,S(D)),this.Canvas.strokeStyle=C>=0?this.UpColor:this.DownColor,this.Canvas.stroke(),this.Canvas.closePath()}}this.Canvas.restore()}},e.ChartMinuteInfo=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinuteInfo",this.Data=new Map,this.SourceData,this.ChartMinutePrice,this.YClose,this.TextColor=r.g_JSChartResource.MinuteInfo.TextColor,this.Font=r.g_JSChartResource.MinuteInfo.Font,this.PointColor=r.g_JSChartResource.MinuteInfo.PointColor,this.LineColor=r.g_JSChartResource.MinuteInfo.LineColor,this.TextBGColor=r.g_JSChartResource.MinuteInfo.TextBGColor,this.TextHeight=18,this.TextRectCache=[],this.InfoDrawCache=[],this.FrameBottom,this.FrameTop,this.FrameLeft,this.FrameRight,this.YOffset=5,this.IsHScreen=!1,this.SetOption=function(t){t.TextColor&&(this.TextColor=t.TextColor),t.TextBGColor&&(this.TextBGColor=t.TextBGColor),t.Font&&(this.Font=t.Font),t.PointColor&&(this.PointColor=t.PointColor),t.LineColor&&(this.LineColor=t.LineColor),t.TextHeight>0&&(this.TextHeight=t.TextHeight)},this.Draw=function(){if(this.ChartMinutePrice&&this.Data&&!(this.Data.size<=0)){this.TextRectCache=[],this.InfoDrawCache=[],this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount;this.ChartFrame.MinuteCount;this.FrameBottom=this.ChartBorder.GetBottom(),this.FrameTop=this.ChartBorder.GetTop(),this.FrameLeft=this.ChartBorder.GetLeft(),this.FrameRight=this.ChartBorder.GetRight(),this.IsHScreen&&(this.FrameRight=this.ChartBorder.GetBottom(),this.FrameLeft=this.ChartBorder.GetTop(),this.FrameBottom=this.ChartBorder.GetLeft(),this.FrameTop=this.ChartBorder.GetRight()),this.YClose=this.ChartMinutePrice.YClose;var e=this.ChartMinutePrice.Data,a=!1;this.ChartMinutePrice.SourceData&&(e=this.ChartMinutePrice.SourceData,a=!0),this.Canvas.font=this.Font;for(var i=e.DataOffset,r=0;i<e.Data.length&&r<t;++i,++r){var n=this.SourceData.Data[i];if((!a||!n.Before)&&n){var s=n.DateTime;this.Data.has(s)&&(this.IsHScreen?this.CalcuateInfoHScreenPosition(this.Data.get(s),r,n):this.CalcuateInfoPosition(this.Data.get(s),r,n))}}for(var i in this.InfoDrawCache){n=this.InfoDrawCache[i];this.DrawInfoLines(n)}for(var i in this.InfoDrawCache){n=this.InfoDrawCache[i];this.DrawInfoText(n)}this.TextRectCache=[],this.InfoDrawCache=[]}},this.CalcuateInfoPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var i=t.Data[0],r=this.Canvas.measureText(i.Title).width+4,n=this.TextHeight,s=this.ChartFrame.GetXFromIndex(e),o=this.ChartFrame.GetYFromData(a.Close);s=S(s);var h=s<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,3,2,3,3,2],u=n+l[e%l.length],C={Y:[{Value:o+(n+this.YOffset),Offset:u},{Value:o-(2*n+this.YOffset),Offset:-u}]};a.Close<this.YClose&&(C.Y=C.Y.reverse());var D={X:s,Y:null,Width:r,Height:n};h||(D.X-=D.Width),this.FixTextRect(D,C);var m={Border:D,Start:{X:s,Y:o},IsLeft:h,Title:i.Title};i.Content&&(m.Content=i.Content),i.Link&&(m.Link=i.Link),i.Color&&(m.Color=i.Color),i.BGColor&&(m.BGColor=i.BGColor),this.InfoDrawCache.push(m),this.TextRectCache.push(D)}},this.CalcuateInfoHScreenPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var i=t.Data[0],r=this.Canvas.measureText(i.Title).width+4,n=this.TextHeight,s=this.ChartFrame.GetXFromIndex(e),o=this.ChartFrame.GetYFromData(a.Close);s=S(s);var h=s<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,3,2,3,3,2],u=n+l[e%l.length],C={X:[{Value:o+(n+this.YOffset),Offset:u},{Value:o-(2*n+this.YOffset),Offset:-u}]};a.Close>this.YClose&&(C.X=C.X.reverse());var D={X:null,Y:s,Width:n,Height:r};h||(D.Y-=D.Height),this.FixHScreenTextRect(D,C);var m={Border:D,Start:{X:o,Y:s},IsLeft:h,Title:i.Title};i.Content&&(m.Content=i.Content),i.Link&&(m.Link=i.Link),i.Color&&(m.Color=i.Color),i.BGColor&&(m.BGColor=i.BGColor),this.InfoDrawCache.push(m),this.TextRectCache.push(D)}},this.DrawInfoLines=function(t){var e=t.Border,a=t.IsLeft;this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.Start.X,t.Start.Y),a?this.Canvas.lineTo(e.X,e.Y):this.IsHScreen?this.Canvas.lineTo(e.X,e.Y+e.Height):this.Canvas.lineTo(e.X+e.Width,e.Y),this.Canvas.stroke(),this.Canvas.fillStyle=this.PointColor,this.Canvas.beginPath(),this.Canvas.arc(t.Start.X,t.Start.Y,5,0,2*Math.PI),this.Canvas.closePath(),this.Canvas.fill()},this.DrawInfoText=function(t){var e=t.Border,a=e.X,i=e.Y;t.BGColor?this.Canvas.fillStyle=t.BGColor:this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(a,i,e.Width,e.Height),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.rect(a,i,e.Width,e.Height),this.Canvas.stroke(),this.IsHScreen&&(this.Canvas.save(),this.Canvas.translate(e.X,e.Y),this.Canvas.rotate(90*Math.PI/180),a=0,i=0),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",t.Color?this.Canvas.fillStyle=t.Color:this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.IsHScreen?this.Canvas.fillText(t.Title,a+2,i-e.Width/2):this.Canvas.fillText(t.Title,a+2,i+e.Height/2),this.IsHScreen&&this.Canvas.restore()},this.FixTextRect=function(t,e){for(var a in e.Y){var i,r=e.Y[a];t.Y=r.Value;for(var n=0;n<10;++n){var s=!1;for(var o in this.TextRectCache){var h=this.TextRectCache[o];if(this.IsOverlap(h,t)){s=!0;break}}if(0==s)return;if(i=t.Y,i+=r.Offset,i+t.Height>this.FrameBottom||i<this.FrameTop)break;t.Y=i}}},this.FixHScreenTextRect=function(t,e){for(var a in e.X){var i,r=e.X[a];t.X=r.Value;for(var n=0;n<10;++n){var s=!1;for(var o in this.TextRectCache){var h=this.TextRectCache[o];if(this.IsOverlap(h,t)){s=!0;break}}if(0==s)return;if(i=t.X,i+=r.Offset,i+t.Width<this.FrameBottom||i>this.FrameTop)break;t.X=i}}},this.IsOverlap=function(t,e){return t.X+t.Width>e.X&&e.X+e.Width>t.X&&t.Y+t.Height>e.Y&&e.Y+e.Height>t.Y},this.GetMaxMin=function(){return{Min:null,Max:null}}},e.ChartMinutePriceLine=function(){this.newMethod=m,this.newMethod(),delete this.newMethod,this.YClose,this.IsDrawArea=!0,this.AreaColor="rgba(0,191,255,0.1)",this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.IsShow&&this.Data){var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();for(var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=this.ChartBorder.GetBottomEx(),r=this.ChartBorder.GetLeftEx(),n=!0,s={},o=0,h=0,l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<e;++l,++u){var C=this.Data.Data[l];if(++h,null!=C){var D=this.ChartFrame.GetXFromIndex(u),m=this.ChartFrame.GetYFromData(C);n?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(m,D):this.Canvas.moveTo(D,m),n=!1,s={X:D,Y:m}):t?this.Canvas.lineTo(m,D):this.Canvas.lineTo(D,m),++o,h>=a&&(n=!0,this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,D),this.Canvas.lineTo(r,s.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(D,i),this.Canvas.lineTo(s.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill()),o=0,h=0)}}o>0&&(this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,D),this.Canvas.lineTo(r,s.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(D,i),this.Canvas.lineTo(s.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill()))}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return e;e.Min=this.YClose,e.Max=this.YClose;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];r&&(null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r))}if(e.Max==this.YClose&&e.Min==this.YClose)return e.Max=this.YClose+.1*this.YClose,e.Min=this.YClose-.1*this.YClose,e;var n=Math.max(Math.abs(this.YClose-e.Max),Math.abs(this.YClose-e.Min));return e.Max=this.YClose+n,e.Min=this.YClose-n,e}},e.ChartMinuteVolumBar=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.UpColor=r.g_JSChartResource.UpBarColor,this.DownColor=r.g_JSChartResource.DownBarColor,this.CustomColor=r.g_JSChartResource.Minute.VolBarColor,this.YClose,this.Draw=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount,i=this.ChartFrame.GetYFromData(0),r=this.YClose;this.CustomColor&&(this.Canvas.strokeStyle=this.CustomColor);for(var n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(o&&o.Vol){var h=this.ChartFrame.GetYFromData(o.Vol),l=this.ChartFrame.GetXFromIndex(n);if(l>e)break;this.CustomColor||(this.Canvas.strokeStyle=o.Close>=r?this.UpColor:this.DownColor),this.Canvas.beginPath(),t?(this.Canvas.moveTo(h,S(l)),this.Canvas.lineTo(i,S(l))):(this.Canvas.moveTo(S(l),h),this.Canvas.lineTo(S(l),i)),this.Canvas.stroke(),r=o.Close}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:0,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];r&&r.Vol&&(null==e.Max&&(e.Max=r.Vol),e.Max<r.Vol&&(e.Max=r.Vol))}return e}},e.ChartMultiBar=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Bars=[],this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartFrame.DataWidth,i=[];for(var r in this.Bars){var s=this.Bars[r],o={Point:[],Color:s.Color,Width:a,Type:0};for(var h in s.Type>0&&(o.Type=s.Type),s.Width>0?(o.Width=s.Width,o.Width>a&&(o.Width=a)):o.Width<4&&(o.Width=1),s.Point){var l=s.Point[h];if(n.IFrameSplitOperator.IsNumber(l.Index)){var u=l.Index-e;if(u>=0&&u<t){var C=this.ChartFrame.GetXFromIndex(u),D=this.ChartFrame.GetYFromData(l.Value),m=this.ChartFrame.GetYFromData(l.Value2);o.Point.push({X:C,Y:D,Y2:m})}}}o.Point.length>0&&i.push(o)}for(var r in i){s=i[r];s.Width>=4?1==s.Type?this.DrawHollowBar(s):this.DrawFillBar(s):this.DrawLineBar(s)}}},this.DrawLineBar=function(t){this.Canvas.strokeStyle=t.Color;var e=this.Canvas.lineWidth;for(var a in this.Canvas.lineWidth=t.Width,t.Point){var i=t.Point[a];this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(S(i.Y),S(i.X)),this.Canvas.lineTo(S(i.Y2),S(i.X))):(this.Canvas.moveTo(S(i.X),S(i.Y)),this.Canvas.lineTo(S(i.X),S(i.Y2))),this.Canvas.stroke()}this.Canvas.lineWidth=e},this.DrawFillBar=function(t){for(var e in this.Canvas.fillStyle=t.Color,t.Point){var a=t.Point[e],i=a.X-t.Width/2,r=Math.min(a.Y,a.Y2),n=t.Width,s=Math.abs(a.Y-a.Y2);this.IsHScreen?this.Canvas.fillRect(f(r),f(i),f(s),f(n)):this.Canvas.fillRect(f(i),f(r),f(n),f(s))}},this.DrawHollowBar=function(t){this.Canvas.strokeStyle=t.Color;for(var e in t.Point){var a=t.Point[e],i=a.X-t.Width/2,r=Math.min(a.Y,a.Y2),n=t.Width,s=Math.abs(a.Y-a.Y2);this.Canvas.beginPath(),this.IsHScreen?this.Canvas.rect(S(r),S(i),f(s),f(n)):this.Canvas.rect(S(i),S(r),f(n),f(s)),this.Canvas.stroke()}this.Canvas.lineWidth=1},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Bars){var n=this.Bars[r];for(var s in n.Point){var o=n.Point[s];if(o.Index>=a&&o.Index<i){var h=Math.min(o.Value,o.Value2),l=Math.max(o.Value,o.Value2);(null==t.Max||t.Max<l)&&(t.Max=l),(null==t.Min||t.Min>h)&&(t.Min=h)}}}return t}},e.ChartMultiHtmlDom=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiHtmlDom",this.Texts=[],this.IsHScreen=!1,this.DrawCallback,this.DrawItem=[],this.IsDestroy=!1,this.Draw=function(){this.DrawItem=[],this.DrawCallback&&this.DrawCallback(1,{Self:this}),this.DrawDom(),this.DrawCallback&&this.DrawCallback(2,{Self:this,Draw:this.DrawItem})},this.OnDestroy=function(){this.IsDestroy=!0,this.DrawCallback&&this.DrawCallback(4,{Self:this})},this.DrawDom=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;for(var a in this.Texts){var i=this.Texts[a];if(i.Text&&n.IFrameSplitOperator.IsNumber(i.Index)){var r=i.Index-e,s=this.Data.Data[i.Index],o={KData:s,Item:i,IsShow:!1,Self:this};if(r>=0&&r<t){var h=this.ChartFrame.GetXFromIndex(r),l=this.ChartFrame.GetYFromData(i.Value);o.X=h,o.Y=l,o.IsShow=!0}this.DrawItem.push(o),this.DrawCallback&&this.DrawCallback(3,o)}}}},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Texts){var s=this.Texts[r];n.IFrameSplitOperator.IsNumber(s.Index)&&(s.Index>=a&&s.Index<i&&((null==t.Max||t.Max<s.Value)&&(t.Max=s.Value),(null==t.Min||t.Min>s.Value)&&(t.Min=s.Value)))}return t}},e.ChartMultiLine=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiLine",this.Lines=[],this.IsHScreen=!1,this.LineWidth=1,this.LineDash,this.ArrawAngle=35,this.ArrawLength=10,this.ArrawLineWidth=5,this.Arrow={Start:!1,End:!1},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;for(var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=[],i=[],r=0;r<this.Lines.length;++r){var s=this.Lines[r],o={Point:[],Color:s.Color},h={Start:[],End:[]};s.BGColor&&(o.BGColor=s.BGColor);for(var l=0;l<s.Point.length;++l){var u=s.Point[l];if(n.IFrameSplitOperator.IsNumber(u.Index)){var C=u.Index-e;if(C>=0&&C<t){var D=this.ChartFrame.GetXFromIndex(C),m=this.ChartFrame.GetYFromData(u.Value),c={X:D,Y:m,End:!1};o.Point.push({X:D,Y:m}),0!=l&&1!=l||h.Start.push(c),l!=s.Point.length-1&&l!=s.Point.length-2||h.End.push(c)}else o.Point.length>0&&(o.Point[o.Point.length-1].End=!0)}}o.Point.length>=2&&(a.push(o),i.push(h))}this.Canvas.save();for(r=0;r<a.length;++r){this.LineDash&&this.Canvas.setLineDash(this.LineDash),n.IFrameSplitOperator.IsPlusNumber(this.LineWidth)?this.Canvas.lineWidth=this.LineWidth:this.Canvas.lineWidth=1;var S=a[r];this.DrawLine(S,i[r])}this.Canvas.restore()}},this.DrawLine=function(t,e){if(t.BGColor){this.Canvas.fillStyle=t.BGColor;for(var a=0;a<t.Point.length;++a){var i=t.Point[a];0==a?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(i.Y,i.X):this.Canvas.moveTo(i.X,i.Y)):this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y)}this.Canvas.closePath(),this.Canvas.fill()}this.Canvas.strokeStyle=t.Color;var r=0;for(a=0;a<t.Point.length;++a){i=t.Point[a];0==r?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(i.Y,i.X):this.Canvas.moveTo(i.X,i.Y),++r):(this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y),++r),1==i.End&&(r>0&&this.Canvas.stroke(),r=0)}r>0&&this.Canvas.stroke(),2==e.End.length&&1==this.Arrow.End&&this.DrawArrow(e.End[0],e.End[1]),2==e.Start.length&&1==this.Arrow.Start&&this.DrawArrow(e.Start[1],e.Start[0])},this.DrawArrow=function(t,e){var a=this.ArrawAngle,i=this.ArrawLength,r=180*Math.atan2(t.Y-e.Y,t.X-e.X)/Math.PI,n=(r+a)*Math.PI/180,s=(r-a)*Math.PI/180,o=i*Math.cos(n),h=i*Math.sin(n),l=i*Math.cos(s),u=i*Math.sin(s);this.Canvas.beginPath();var C=e.X+o,D=e.Y+h;this.Canvas.moveTo(C,D),this.Canvas.lineTo(e.X,e.Y),C=e.X+l,D=e.Y+u,this.Canvas.lineTo(C,D),this.Canvas.setLineDash([]),this.Canvas.lineWidth=this.ArrawLineWidth,this.Canvas.stroke()},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Lines){var n=this.Lines[r];for(var s in n.Point){var o=n.Point[s];o.Index>=a&&o.Index<i&&((null==t.Max||t.Max<o.Value)&&(t.Max=o.Value),(null==t.Min||t.Min>o.Value)&&(t.Min=o.Value))}}return t}},e.ChartMultiPoint=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiPoint",this.PointGroup=[],this.IsHScreen=!1,this.LineWidth=1,this.PointRadius=5,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)&&n.IFrameSplitOperator.IsNonEmptyArray(this.PointGroup)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;this.Canvas.save();for(var a=0;a<this.PointGroup.length;++a){var i=this.PointGroup[a],r=i.Color,s=i.BGColor,o=this.LineWidth,h=this.PointRadius;n.IFrameSplitOperator.IsNumber(i.LineWidth)&&(o=i.LineWidth),n.IFrameSplitOperator.IsNumber(i.PointRadius)&&(h=i.PointRadius),this.Canvas.lineWidth=o,s&&(this.Canvas.fillStyle=s),r&&(this.Canvas.strokeStyle=r);for(var l=0;l<i.Point.length;++l){var u=i.Point[l];if(n.IFrameSplitOperator.IsNumber(u.Index)){var C=u.Index-e;if(C>=0&&C<t){var D=this.ChartFrame.GetXFromIndex(C),m=this.ChartFrame.GetYFromData(u.Value);this.Canvas.beginPath(),this.IsHScreen?this.Canvas.arc(m,D,h,0,360,!1):this.Canvas.arc(D,m,h,0,360,!1),s&&this.Canvas.fill(),r&&this.Canvas.stroke()}}}}this.Canvas.restore()}},this.GetMaxMin=function(){for(var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e,r=0;r<this.PointGroup.length;++r){var s=this.PointGroup[r];if(n.IFrameSplitOperator.IsNonEmptyArray(s.Point))for(var o=0;o<s.Point.length;++o){var h=s.Point[o];h.Index>=a&&h.Index<i&&((null==t.Max||t.Max<h.Value)&&(t.Max=h.Value),(null==t.Min||t.Min>h.Value)&&(t.Min=h.Value))}}return t}},e.ChartMultiText=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiText",this.Texts=[],this.Font=r.g_JSChartResource.DefaultTextFont,this.Color=r.g_JSChartResource.DefaultTextColor,this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)&&this.Texts){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight();for(var r in this.IsHScreen&&(a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom()),this.Texts){var s=this.Texts[r];if(s.Text&&n.IFrameSplitOperator.IsNumber(s.Index)){var o=s.Index-e;if(o>=0&&o<t){var h=this.ChartFrame.GetXFromIndex(o),l=this.ChartFrame.GetYFromData(s.Value);s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.Color,s.Font?this.Canvas.font=s.Font:this.Canvas.font=this.Font;var u=this.Canvas.measureText(s.Text).width;if(this.Canvas.textAlign="center",h+u/2>=i?(this.Canvas.textAlign="right",h=i):h-u/2<a&&(this.Canvas.textAlign="left",h=a),1==s.Baseline?this.Canvas.textBaseline="top":2==s.Baseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle",this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(l,h),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(s.Text,0,0),this.Canvas.restore()):this.Canvas.fillText(s.Text,h,l),s.Line){var C=this.Data.Data[s.Index],D="H"==s.Line.KData?C.High:C.Low,m=this.ChartFrame.GetYFromData(D),c=l;Array.isArray(s.Line.Offset)&&2==s.Line.Offset.length&&(c>m?(c-=s.Line.Offset[1],m+=s.Line.Offset[0]):c<m&&(c+=s.Line.Offset[1],m-=s.Line.Offset[0])),this.Canvas.save(),s.Line.Dash&&this.Canvas.setLineDash(s.Line.Dash),s.Line.Width>0&&(this.Canvas.lineWidth=s.Line.Width),this.Canvas.strokeStyle=s.Line.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(c,S(h)),this.Canvas.lineTo(m,S(h))):(this.Canvas.moveTo(S(h),c),this.Canvas.lineTo(S(h),m)),this.Canvas.stroke(),this.Canvas.restore()}}}}}},this.GetMaxMin=function(){var t={Min:null,Max:null};if(!this.Texts)return t;var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Texts){var n=this.Texts[r];n.Index>=a&&n.Index<i&&((null==t.Max||t.Max<n.Value)&&(t.Max=n.Value),(null==t.Min||t.Min>n.Value)&&(t.Min=n.Value))}return t}},e.ChartOrderbookDepth=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartOrderbookDepth",this.Data=null,this.AskColor={Line:r.g_JSChartResource.DepthChart.AskColor.Line,Area:r.g_JSChartResource.DepthChart.AskColor.Area},this.BidColor={Line:r.g_JSChartResource.DepthChart.BidColor.Line,Area:r.g_JSChartResource.DepthChart.BidColor.Area},this.LineWidth=r.g_JSChartResource.DepthChart.LineWidth,this.Draw=function(){this.Data&&(this.Canvas.save(),this.Canvas.lineWidth=this.LineWidth,this.DrawArea(this.Data.Bids,this.BidColor.Line,this.BidColor.Area,!0),this.DrawArea(this.Data.Asks,this.AskColor.Line,this.AskColor.Area,!1),this.Canvas.restore())},this.DrawArea=function(t,e,a,i){var r=this.ChartFrame.VerticalRange,n=[];for(var s in t){var o=t[s];if(i){if(o.Price<r.Min)break}else if(o.Price>r.Max)break;var h=this.ChartFrame.GetXFromIndex(o.Price),l=this.ChartFrame.GetYFromData(o.Vol);n.push({X:h,Y:l})}if(!(n.length<=1)){var u=this.ChartBorder.GetLeft(),C=this.ChartBorder.GetBottom(),D=this.ChartBorder.GetRight();for(var s in this.Canvas.beginPath(),this.Canvas.moveTo(n[0].X,C),n){o=n[s];this.Canvas.lineTo(o.X,o.Y)}for(var s in this.Canvas.lineTo(i?u:D,n[n.length-1].Y),this.Canvas.lineTo(i?u:D,C),this.Canvas.lineTo(n[0].X,C),this.Canvas.closePath(),this.Canvas.fillStyle=a,this.Canvas.fill(),this.Canvas.beginPath(),this.Canvas.moveTo(n[0].X,C),n){o=n[s];this.Canvas.lineTo(o.X,o.Y)}this.Canvas.lineTo(i?u:D,n[n.length-1].Y),this.Canvas.strokeStyle=e,this.Canvas.stroke()}},this.GetMaxMin=function(){var t={Min:null,Max:null,XMin:null,XMax:null},e=this.ChartFrame.VerticalRange;for(var a in this.Data.Asks){var i=this.Data.Asks[a];if(i.Price>e.Max)break;(null==t.XMin||t.XMin>i.Price)&&(t.XMin=i.Price),(null==t.XMax||t.XMax<i.Price)&&(t.XMax=i.Price),(null==t.Min||t.Min>i.Vol)&&(t.Min=i.Vol),(null==t.Max||t.Max<i.Vol)&&(t.Max=i.Vol)}for(var a in this.Data.Bids){i=this.Data.Bids[a];if(i.Price<e.Min)break;(null==t.XMin||t.XMin>i.Price)&&(t.XMin=i.Price),(null==t.XMax||t.XMax<i.Price)&&(t.XMax=i.Price),(null==t.Min||t.Min>i.Vol)&&(t.Min=i.Vol),(null==t.Max||t.Max<i.Vol)&&(t.Max=i.Vol)}return t}},e.ChartOverlayKLine=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Color="rgb(65,105,225)",this.MainData,this.SourceData,this.Name="ChartOverlayKLine",this.Title,this.DrawType=0,this.ClassName="ChartOverlayKLine",this.CustomDrawType=null,this.Status=i.OVERLAY_STATUS_ID.STATUS_NONE_ID,this.ShowRange={},this.DrawKRange={Start:null,End:null},this.YInfoType=4,this.SetOption=function(t){t&&(n.IFrameSplitOperator.IsNumber(t.DrawType)&&(this.CustomDrawType=t.DrawType),n.IFrameSplitOperator.IsNumber(t.YInfoType)&&(this.YInfoType=t.YInfoType))},this.DrawKBar=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var s=this.ChartFrame.XPointCount,o=!0,h=null;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s,this.ShowRange.FirstOpen=t,this.DrawKRange.Start=this.Data.DataOffset;for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,r+=a+i,++this.ShowRange.DataCount){var C=this.Data.Data[l];if(C&&null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){null==h&&(h=C.Open,this.ShowRange.FirstOverlayOpen=C.Open),o&&(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color,this.Canvas.beginPath(),o=!1);var D=r,m=r+a;if(m>n)break;var c=D+(m-D)/2,I=this.ChartFrame.GetYFromData(C.Low/h*t),d=this.ChartFrame.GetYFromData(C.High/h*t),T=this.ChartFrame.GetYFromData(C.Open/h*t),p=this.ChartFrame.GetYFromData(C.Close/h*t),v=d;this.DrawKRange.End=l,C.Open<C.Close?a>=4?(C.High>C.Close?(e?(this.Canvas.moveTo(S(v),S(c)),this.Canvas.lineTo(S(3==this.DrawType?Math.max(p,T):p),S(c))):(this.Canvas.moveTo(S(c),S(v)),this.Canvas.lineTo(S(c),S(3==this.DrawType?Math.min(p,T):p))),v=p):v=p,e?Math.abs(T-v)<1?this.Canvas.fillRect(f(v),f(D),1,f(a)):3==this.DrawType?this.Canvas.rect(S(v),S(D),f(T-v),f(a)):this.Canvas.fillRect(f(v),f(D),f(T-v),f(a)):Math.abs(T-v)<1?this.Canvas.fillRect(f(D),f(v),f(a),1):3==this.DrawType?this.Canvas.rect(S(D),S(v),f(a),f(T-v)):this.Canvas.fillRect(f(D),f(v),f(a),f(T-v)),C.Open>C.Low&&(e?(this.Canvas.moveTo(S(3==this.DrawType?Math.min(p,T):v),S(c)),this.Canvas.lineTo(S(I),S(c))):(this.Canvas.moveTo(S(c),S(3==this.DrawType?Math.max(p,T):v)),this.Canvas.lineTo(S(c),S(I))))):e?(this.Canvas.moveTo(d,S(c)),this.Canvas.lineTo(I,S(c))):(this.Canvas.moveTo(S(c),d),this.Canvas.lineTo(S(c),I)):C.Open>C.Close?a>=4?(C.High>C.Close?(e?(this.Canvas.moveTo(S(v),S(c)),this.Canvas.lineTo(S(T),S(c))):(this.Canvas.moveTo(S(c),S(v)),this.Canvas.lineTo(S(c),S(T))),v=T):v=T,e?Math.abs(p-v)<1?this.Canvas.fillRect(f(v),f(D),1,f(a)):this.Canvas.fillRect(f(v),f(D),f(p-v),f(a)):Math.abs(p-v)<1?this.Canvas.fillRect(f(D),f(v),f(a),1):this.Canvas.fillRect(f(D),f(v),f(a),f(p-v)),C.Open>C.Low&&(e?(this.Canvas.moveTo(S(v),S(c)),this.Canvas.lineTo(S(I),S(c))):(this.Canvas.moveTo(S(c),S(v)),this.Canvas.lineTo(S(c),S(I))))):e?(this.Canvas.moveTo(d,S(c)),this.Canvas.lineTo(I,S(c))):(this.Canvas.moveTo(S(c),d),this.Canvas.lineTo(S(c),I)):a>=4?(C.High>C.Close?(e?(this.Canvas.moveTo(v,S(c)),this.Canvas.lineTo(T,S(c))):(this.Canvas.moveTo(S(c),v),this.Canvas.lineTo(S(c),T)),v=T):v=T,e?(this.Canvas.moveTo(S(v),S(D)),this.Canvas.lineTo(S(v),S(m))):(this.Canvas.moveTo(S(D),S(v)),this.Canvas.lineTo(S(m),S(v))),C.Open>C.Low&&(e?(this.Canvas.moveTo(S(v),S(c)),this.Canvas.lineTo(S(I),S(c))):(this.Canvas.moveTo(S(c),S(v)),this.Canvas.lineTo(S(c),S(I))))):e?(this.Canvas.moveTo(d,S(c)),this.Canvas.lineTo(I,S(c))):(this.Canvas.moveTo(S(c),d),this.Canvas.lineTo(S(c),I))}}0==o&&this.Canvas.stroke()},this.DrawAKLine=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var s=this.ChartFrame.XPointCount,o=null;this.Canvas.strokeStyle=this.Color,this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s,this.ShowRange.FirstOpen=t,this.DrawKRange.Start=this.Data.DataOffset;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<s;++h,++l,r+=a+i,++this.ShowRange.DataCount){var u=this.Data.Data[h];if(null!=u.Open&&null!=u.High&&null!=u.Low&&null!=u.Close){null==o&&(o=u.Open,this.ShowRange.FirstOverlayOpen=u.Open);var C=r,D=r+a;if(D>n)break;var m=C+(D-C)/2,c=this.ChartFrame.GetYFromData(u.Low/o*t),f=this.ChartFrame.GetYFromData(u.High/o*t),I=this.ChartFrame.GetYFromData(u.Open/o*t),d=this.ChartFrame.GetYFromData(u.Close/o*t);this.DrawKRange.End=h,this.Canvas.beginPath(),e?(this.Canvas.moveTo(f,S(m)),this.Canvas.lineTo(c,S(m))):(this.Canvas.moveTo(S(m),f),this.Canvas.lineTo(S(m),c)),this.Canvas.stroke(),a>=4&&(this.Canvas.beginPath(),e?(this.Canvas.moveTo(S(I),C),this.Canvas.lineTo(S(I),m)):(this.Canvas.moveTo(C,S(I)),this.Canvas.lineTo(m,S(I))),this.Canvas.stroke(),this.Canvas.beginPath(),e?(this.Canvas.moveTo(S(d),D),this.Canvas.lineTo(S(d),m)):(this.Canvas.moveTo(D,S(d)),this.Canvas.lineTo(m,S(d))),this.Canvas.stroke())}}},this.DrawCloseLine=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var s=this.ChartFrame.XPointCount,o=null,h=!0;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s,this.ShowRange.FirstOpen=t,this.DrawKRange.Start=this.Data.DataOffset,this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath();for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,r+=a+i,++this.ShowRange.DataCount){var C=this.Data.Data[l];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){null==o&&(o=C.Open,this.ShowRange.FirstOverlayOpen=C.Open);var D=r,m=r+a;if(m>n)break;var c=D+(m-D)/2,S=this.ChartFrame.GetYFromData(C.Close/o*t);this.DrawKRange.End=l,h?(e?this.Canvas.moveTo(S,c):this.Canvas.moveTo(c,S),h=!1):e?this.Canvas.lineTo(S,c):this.Canvas.lineTo(c,S)}}0==h&&this.Canvas.stroke()},this.Draw=function(){if(this.TooltipRect=[],this.DrawKRange={Start:null,End:null},this.MainData&&this.Data){for(var t=this.ChartFrame.XPointCount,e=null,a=this.Data.DataOffset,i=0;a<this.MainData.Data.length&&i<t;++a,++i){var r=this.MainData.Data[a];if(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close){e=r.Open;break}}if(null!=e){var n=this.DrawType;null!=this.CustomDrawType&&(this.DrawType=this.CustomDrawType),1==this.DrawType?this.DrawCloseLine(e):2==this.DrawType?this.DrawAKLine(e):this.DrawKBar(e),this.DrawType=n}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(!this.MainData||!this.Data)return e;for(var a=null,i=this.Data.DataOffset,r=0;i<this.MainData.Data.length&&r<t;++i,++r){var n=this.MainData.Data[i];if(null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close){a=n.Close;break}}if(null==a)return e;var s,o,h=null;for(i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<t;++i,++r){n=this.Data.Data[i];n&&null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close&&(null==h&&(h=n.Open),s=n.High/h*a,o=n.Low/h*a,null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=o),e.Max<s&&(e.Max=s),e.Min>o&&(e.Min=o))}return e}},e.ChartOverlayMinutePriceLine=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Color="rgb(65,105,225)",this.MainData,this.MainYClose,this.Name="ChartOverlayMinutePriceLine",this.Title,this.Symbol,this.YClose,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();for(var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<e;++n,++s){var o=this.Data.Data[n].Close;if(null!=o){var h=o/this.YClose*this.MainYClose,l=this.ChartFrame.GetXFromIndex(s),u=this.ChartFrame.GetYFromData(h);i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(u,l):this.Canvas.moveTo(l,u),i=!1):t?this.Canvas.lineTo(u,l):this.Canvas.lineTo(l,u),++r,r>=a&&(i=!0,this.Canvas.stroke(),r=0)}}r>0&&this.Canvas.stroke()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return e;e.Min=this.MainYClose,e.Max=this.MainYClose;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a].Close;if(null!=r){r=r/this.YClose*this.MainYClose;null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r)}}if(e.Max==this.MainYClose&&e.Min==this.MainYClose)return e.Max=this.MainYClose+.1*this.MainYClose,e.Min=this.MainYClose-.1*this.MainYClose,e;var n=Math.max(Math.abs(this.MainYClose-e.Max),Math.abs(this.MainYClose-e.Min));return e.Max=this.MainYClose+n,e.Min=this.MainYClose-n,e}},e.ChartPie=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Draw=function(){if(!this.Data||!this.Data.Data||!(this.Data.Data.length>0))return this.DrawEmptyData();var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetTop(),i=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()),r=this.ChartBorder.GetHeight(),n=i/4*.8;this.Canvas.save(),this.Canvas.translate(t+n,a+r/2);var s=0;for(var o in this.Data.Data)s+=this.Data.Data[o].Value;var h=1.5*Math.PI,l=h,u=h;for(var C in this.Data.Data){var D=this.Data.Data[C],m=D.Value/s;this.Canvas.beginPath(),this.Canvas.moveTo(0,0),u+=2*m*Math.PI,this.Canvas.strokeStyle="white",this.Canvas.fillStyle=D.Color,this.Canvas.arc(0,0,n,l,u),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),l+=2*m*Math.PI}this.Canvas.restore();var c=t+i/2+5,S=a;this.Canvas.textBaseline="bottom",this.Canvas.font="12px 微软雅黑";for(var f=0,I=0;f<this.Data.Data.length;++f){var d=this.Data.Data[f];if(d.Text&&(this.Canvas.fillStyle=d.Color,this.Canvas.fillRect(c,S-15,13,13),this.Canvas.fillStyle="rgb(102,102,102)",this.Canvas.fillText(d.Text,c+16,S),S+=17,S>a+r/2+n)){if(++I,I>=2)break;S=a,c=e-i/4+5}}},this.DrawEmptyData=function(){console.log("[ChartPie::DrawEmptyData]");var t=this.ChartBorder.GetLeft(),e=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()),a=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()),i=this.ChartBorder.GetHeight(),r=a/4*.8;this.Canvas.save(),this.Canvas.translate(t+r,e+i/2),this.Canvas.beginPath(),this.Canvas.fillStyle="rgb(211,211,211)",this.Canvas.strokeStyle="white",this.Canvas.arc(0,0,.8*r,0,2*Math.PI),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.restore()}},e.ChartPointDot=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.Radius=1,this.ClassName="ChartPointDot",this.EnableUpDownColor=!1,this.HistoryData,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var a,i=this.ChartFrame.XPointCount;this.Canvas.save(),this.Canvas.fillStyle=this.Color;for(var r=this.Data.DataOffset,n=0;r<this.Data.Data.length&&n<i;++r,++n){var s=this.Data.Data[r];if(null!=s){var o=this.ChartFrame.GetXFromIndex(n),h=this.ChartFrame.GetYFromData(s);if(o>e)break;if(this.EnableUpDownColor){var l=this.HistoryData.Data[r];a=l.Close>s?"rgb(255,61,61)":"rgb(0,199,65)",this.Canvas.fillStyle=a}this.Canvas.beginPath(),t?this.Canvas.arc(h,o,this.Radius,0,2*Math.PI,!0):this.Canvas.arc(o,h,this.Radius,0,2*Math.PI,!0),this.Canvas.closePath(),this.Canvas.fill()}}this.Canvas.restore()}}},e.ChartRadar=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.BorderPoint=[],this.DataPoint=[],this.CenterPoint={},this.StartAngle=0,this.Color="rgb(198,198,198)",this.AreaColor="rgba(242,154,118,0.4)",this.AreaLineColor="rgb(242,154,118)",this.TitleFont="24px 微软雅黑",this.TitleColor="rgb(102,102,102)",this.BGColor=["rgb(255,255,255)","rgb(224,224,224)"],this.DrawBorder=function(){if(!(this.BorderPoint.length<=0)){this.Canvas.font=this.TitleFont,this.Canvas.strokeStyle=this.Color;var t=[1,.8,.6,.4,.2];for(var e in t){var a=t[e],i=!0;for(var r in this.BorderPoint){var n=this.BorderPoint[r];n.X=this.CenterPoint.X+n.Radius*Math.cos(n.Angle*Math.PI/180)*a,n.Y=this.CenterPoint.Y+n.Radius*Math.sin(n.Angle*Math.PI/180)*a,i?(this.Canvas.beginPath(),this.Canvas.moveTo(n.X,n.Y),i=!1):this.Canvas.lineTo(n.X,n.Y),0==e&&this.DrawText(n)}this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.fillStyle=this.BGColor[e%2==0?0:1],this.Canvas.fill()}for(var s in this.Canvas.beginPath(),this.BorderPoint){n=this.BorderPoint[s];n.X=this.CenterPoint.X+n.Radius*Math.cos(n.Angle*Math.PI/180),n.Y=this.CenterPoint.Y+n.Radius*Math.sin(n.Angle*Math.PI/180),this.Canvas.moveTo(this.CenterPoint.X,this.CenterPoint.Y),this.Canvas.lineTo(n.X,n.Y)}this.Canvas.stroke()}},this.DrawArea=function(){if(this.DataPoint&&!(this.DataPoint.length<=0)){this.Canvas.fillStyle=this.AreaColor,this.Canvas.strokeStyle=this.AreaLineColor,this.Canvas.beginPath();var t=!0;for(var e in this.DataPoint){var a=this.DataPoint[e];t?(this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),t=!1):this.Canvas.lineTo(a.X,a.Y)}this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()}},this.DrawText=function(t){if(t.Text){this.Canvas.fillStyle=this.TitleColor;var e=t.X,a=t.Y;t.Angle>0&&t.Angle<45?(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e+=2):t.Angle>=0&&t.Angle<90?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",e+=2):t.Angle>=90&&t.Angle<135||t.Angle>=135&&t.Angle<180?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",e-=2):t.Angle>=180&&t.Angle<225?(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",e-=2):t.Angle>=225&&t.Angle<=270?(this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom"):t.Angle>270&&t.Angle<315?(this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",e+=2):(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e+=2),this.Canvas.fillText(t.Text,e,a)}},this.Draw=function(){this.BorderPoint=[],this.DataPoint=[],this.InternalBorderPoint=[],this.CenterPoint={},this.Data&&this.Data.Data&&this.Data.Data.length>0?this.CalculatePoints(this.Data.Data):this.CalculatePoints(null),this.DrawBorder(),this.DrawArea()},this.CalculatePoints=function(t){for(var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()),i=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()),r=this.ChartBorder.GetHeight(),n={X:e+i/2,Y:a+r/2},s=Math.min(i/2,r/2)-2,o=Math.max(5,t?t.length:0),h=360/o,l=0;l<o;++l){var u={Index:l,Radius:s,Angle:l*h+this.StartAngle},C=u.Angle;if(t&&l<t.length){var D=t[l],m={Index:l,Text:D.Text};if(u.Text=D.Name,D.Value){var c=D.Value;c>=1&&(c=1);var S=s*c;m.X=n.X+S*Math.cos(C*Math.PI/180),m.Y=n.Y+S*Math.sin(C*Math.PI/180)}else m.X=n.X,m.Y=n.Y;this.DataPoint.push(m)}this.BorderPoint.push(u)}this.CenterPoint=n}},e.ChartRectangle=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartRectangle",this.Color=[],this.Rect,this.BorderColor=r.g_JSChartResource.FrameBorderPen,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Color&&this.Rect&&!(this.Color.length<=0)){this.Canvas.strokeStyle=this.BorderColor;var t=!1;if(2==this.Color.length)this.Canvas.fillStyle=this.Color[0],t=!0;else{if(1!=this.Color.length)return;this.Color[0]&&(this.Canvas.fillStyle=this.Color[0],t=!0)}var e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetHeightEx(),i=this.Rect.Left/1e3*e,r=this.Rect.Top/1e3*a,n=this.Rect.Right/1e3*e,s=this.Rect.Bottom/1e3*a;i=this.ChartBorder.GetLeft()+i,r=this.ChartBorder.GetTopEx()+r,n=this.ChartBorder.GetLeft()+n,s=this.ChartBorder.GetTopEx()+s;var o=Math.abs(i-n),h=Math.abs(r-s);t&&this.Canvas.fillRect(i,r,o,h),this.Canvas.rect(S(i),S(r),f(o),f(h)),this.Canvas.stroke()}}},e.ChartSingleText=C,e.ChartSplashPaint=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Font=r.g_JSChartResource.DefaultTextFont,this.TextColor=r.g_JSChartResource.DefaultTextColor,this.IsEnableSplash=!1,this.SplashTitle="数据加载中.....",this.HQChart,this.EnableSplash=function(t){if(this.IsEnableSplash=t,this.HQChart){var e=this.HQChart.GetEnableSplashEvent();if(e){var a={Enable:t};e.Callback(e,a,this)}}},this.SetTitle=function(t){this.SplashTitle=t},this.Draw=function(){if(this.IsEnableSplash)if(!0!==this.Frame.IsHScreen){var t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,t,e)}else this.HScreenDraw()},this.HScreenDraw=function(){var t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.save(),this.Canvas.translate(t,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,0,0),this.Canvas.restore()}},e.ChartStackedBar=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartStackedBar",this.Data,this.BarName=[],this.BarColor=["rgb(255,165,0)","rgb(95,158,160)"],this.LineWidth=1,this.BarType=0,this.IsHScreen,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&n.IFrameSplitOperator.IsNonEmptyArray(this.Data.Data)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount;if(this.IsHScreen)var i=this.ChartBorder.GetHScreenBorder(),s=i.TopEx+e/2+r.g_JSChartResource.FrameLeftMargin,o=i.BottomEx,h=i.RightEx,l=i.LeftEx;else i=this.ChartFrame.GetBorder(),s=i.LeftEx+e/2+r.g_JSChartResource.FrameLeftMargin,o=i.RightEx,h=i.TopEx,l=i.BottomEx;var u=this.IsMinuteFrame();if(this.Canvas.save(),1==this.BarType);else{this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth);var C=this.Canvas.lineWidth}for(var D=this.ChartFrame.GetYFromData(0),m=this.Data.DataOffset,c=0;m<this.Data.Data.length&&c<a;++m,++c,s+=t+e){var S=this.Data.Data[m];if(n.IFrameSplitOperator.IsNonEmptyArray(S)){if(u)var f=this.ChartFrame.GetXFromIndex(c);else{var I=s,d=s+t;if(d>o)break;f=I+(d-I)/2}if(f>o)break;1==this.BarType&&t>=4?this.DrawKBarItem(S,f,I,d,h,l,D,t):this.DrawBarItem(S,f,h,l,D,C)}}this.Canvas.restore()}},this.DrawKBarItem=function(t,e,a,i,r,s,o,h){for(var l=0,u=o,C=0,D=o,m=0;m<t.length;++m){var c=t[m];if(n.IFrameSplitOperator.IsNumber(c)&&0!=c){if(this.Canvas.fillStyle=this.BarColor[m],c>0){l+=c;var S=this.ChartFrame.GetYFromData(l),f={Left:a,Top:S,Width:h,Height:u-S};u=S}else{C+=c;S=this.ChartFrame.GetYFromData(C),f={Left:a,Top:S,Width:h,Height:D-S};D=S}this.IsHScreen?this.Canvas.fillRect(f.Top,f.Left,f.Height,f.Width):this.Canvas.fillRect(f.Left,f.Top,f.Width,f.Height)}}},this.DrawBarItem=function(t,e,a,i,r,s){e=S(e);for(var o=0,h=r,l=0,u=r,C=0;C<t.length;++C){var D=t[C];if(n.IFrameSplitOperator.IsNumber(D)&&0!=D){var m={};if(D>0){o+=D;var c=this.ChartFrame.GetYFromData(o);m={X:e,Y:h,X2:e,Y2:c};h=c}else{l+=D;c=this.ChartFrame.GetYFromData(l),m={X:e,Y:u,X2:e,Y2:c};u=c}this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(m.Y,m.X),this.Canvas.lineTo(m.Y2,m.X2)):(this.Canvas.moveTo(m.X,m.Y),this.Canvas.lineTo(m.X2,m.Y2)),this.Canvas.strokeStyle=this.BarColor[C],this.Canvas.stroke()}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&n.IFrameSplitOperator.IsNonEmptyArray(r)){for(var s=0,o=0,h=0;h<r.length;++h){var l=r[h];n.IFrameSplitOperator.IsNumber(l)&&(0!=l&&(l>0?s+=l:l<0&&(o+=l)))}null==e.Max&&(e.Max=s,e.Min=o),e.Max<s&&(e.Max=s),e.Min>o&&(e.Min=o)}}return e}},e.ChartStepLine=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartStepLine",this.LineWidth=1,this.DotLine,this.IsHScreen,this.IsDotLine=!1,this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.Canvas.save(),this.DrawLine(),this.Canvas.restore()))},this.DrawLine=function(){var t=this.IsMinuteFrame(),e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount,s=this.GetLockRect();if(this.IsHScreen){var o=this.ChartBorder.GetHScreenBorder(),h=o.BottomEx,l=o.TopEx+a/2+r.g_JSChartResource.FrameLeftMargin;s&&(h=s.Top)}else{o=this.ChartBorder.GetBorder(),l=o.LeftEx+a/2+r.g_JSChartResource.FrameLeftMargin,h=o.RightEx;s&&(h=s.Left)}this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth),this.IsDotLine&&this.Canvas.setLineDash(r.g_JSChartResource.DOTLINE.LineDash),this.DotLine&&this.Canvas.setLineDash(this.DotLine),this.Canvas.strokeStyle=this.Color;for(var u=!0,C=0,D={X:null,Y:null},m=this.Data.DataOffset;m>=0;--m){var c=this.Data.Data[m];if(n.IFrameSplitOperator.IsNumber(c)){var S=this.GetYFromData(c,!1),f=null;f=t?this.ChartFrame.GetXFromIndex(0):l,this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(S,f):this.Canvas.moveTo(f,S),u=!1,D.Y=S,D.X=f}}m=this.Data.DataOffset;for(var I=0;m<this.Data.Data.length&&I<i;++m,++I,l+=e+a){if(t)f=this.ChartFrame.GetXFromIndex(I);else{var d=l,T=l+e;if(T>h)break;f=d+(T-d)/2}if(f>h)break;c=this.Data.Data[m];if(n.IFrameSplitOperator.IsNumber(c)){S=this.GetYFromData(c,!1);u?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(S,f):this.Canvas.moveTo(f,S),u=!1,D.X=f,D.Y=S):(this.IsHScreen?(this.Canvas.lineTo(D.Y,f),this.Canvas.lineTo(S,f)):(this.Canvas.lineTo(f,D.Y),this.Canvas.lineTo(f,S)),D.X=f,D.Y=S),++C}}C>0&&this.Canvas.stroke()}},e.ChartStick=c,e.ChartStickLine=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartStickLine",this.Color="rgb(255,193,37)",this.LineWidth=2,this.BarType=0,this.MinBarWidth=r.g_JSChartResource.MinKLineBarWidth,this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight();t&&(i=this.ChartBorder.GetBottom());var r=this.ChartFrame.XPointCount,n=this.ChartBorder.GetLeft()+a/2+2;t&&(n=this.ChartBorder.GetTop()+a/2+2);var s=this.IsMinuteFrame();this.Canvas.save();var o=!1,h=!1;if(s)this.LineWidth>1?this.Canvas.lineWidth=2:this.Canvas.lineWidth=1,this.Canvas.strokeStyle=this.Color;else if(50==this.LineWidth)e>=this.MinBarWidth?(h=!0,this.Canvas.fillStyle=this.Color,this.Canvas.strokeStyle=this.Color):(this.Canvas.lineWidth=1,this.Canvas.strokeStyle=this.Color);else if(this.LineWidth<100){var l=this.LineWidth;e<=4?l=1:e<l&&(l=parseInt(e)),l<1&&(l=1),this.Canvas.lineWidth=l,this.Canvas.strokeStyle=this.Color}else{o=!0,this.Canvas.fillStyle=this.Color;var u=2}for(var C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<r;++C,++D,n+=e+a){var m=this.Data.Data[C];if(null!=m){var c=m.Value,I=m.Value2;null==I&&(I=0);var d=this.ChartFrame.GetXFromIndex(D),T=this.ChartFrame.GetYFromData(c),p=this.ChartFrame.GetYFromData(I);if(d>i)break;if(o){var v=n-u;if(t)this.Canvas.fillRect(Math.min(T,p),v,Math.abs(T-p),e+a+2*u);else{var F=e+a+2*u;v+F>i&&(F=i-v),this.Canvas.fillRect(v,f(Math.min(T,p)),F,f(Math.abs(T-p)))}}else if(h)1==this.BarType?t?(this.Canvas.beginPath(),this.Canvas.fillRect(f(Math.min(T,p)),f(n),f(Math.abs(T-p)),f(e)),this.Canvas.stroke()):(this.Canvas.beginPath(),this.Canvas.rect(f(n),f(Math.min(T,p)),f(e),f(Math.abs(T-p))),this.Canvas.stroke()):t?this.Canvas.fillRect(f(Math.min(T,p)),f(n),f(Math.abs(T-p)),f(e)):this.Canvas.fillRect(f(n),f(Math.min(T,p)),f(e),f(Math.abs(T-p)));else if(t)this.Canvas.beginPath(),this.Canvas.moveTo(T,S(d)),this.Canvas.lineTo(p,S(d)),this.Canvas.stroke();else{var g=parseInt(d.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(g,T),this.Canvas.lineTo(g,p),this.Canvas.stroke()}}}this.Canvas.restore()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r){var n=r.Value2;if(null==n&&(n=0),null!=r&&!isNaN(r.Value)&&!isNaN(n)){var s=Math.max(r.Value,n),o=Math.min(r.Value,n);null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=o),e.Max<s&&(e.Max=s),e.Min>o&&(e.Min=o)}}}return e}},e.ChartStraightArea=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.Font="11px 微软雅黑",this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)if(!0!==this.ChartFrame.IsHScreen){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight(),this.ChartBorder.GetBottom();var t=this.ChartBorder.GetLeft(),e=this.ChartFrame.XPointCount,a=this.ChartFrame.GetXFromIndex(e-1);for(var i in this.Data.Data){var r=this.Data.Data[i];if(null!=r&&!isNaN(r.Value)&&!isNaN(r.Value2)&&null!=r.Color){var n=Math.max(r.Value,r.Value2),s=Math.min(r.Value,r.Value2),o=this.ChartFrame.GetYFromData(n),h=this.ChartFrame.GetYFromData(s);this.Canvas.fillStyle=r.Color,this.Canvas.fillRect(f(t),f(o),f(a-t),f(h-o))}}for(var l in this.Data.Data){var u=this.Data.Data[l];if(null!=u&&!isNaN(u.Value)&&!isNaN(u.Value2)&&null!=u.Color){var C=Math.max(u.Value,u.Value2),D=Math.min(u.Value,u.Value2),m=this.ChartFrame.GetYFromData(C),c=this.ChartFrame.GetYFromData(D);if(u.Title&&u.TitleColor){var S=a;"left"==u.Align?(this.Canvas.textAlign="left",S=t):(this.Canvas.textAlign="right",S=a),this.Canvas.textBaseline="middle",this.Canvas.fillStyle=u.TitleColor,this.Canvas.font=this.Font;var I=m+(c-m)/2;this.Canvas.fillText(u.Title,S,I)}}}}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartBorder.GetBottom(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetHeight();for(var i in this.Data.Data){var r=this.Data.Data[i];if(null!=r&&!isNaN(r.Value)&&!isNaN(r.Value2)&&null!=r.Color){var n=Math.max(r.Value,r.Value2),s=Math.min(r.Value,r.Value2),o=this.ChartFrame.GetYFromData(n),h=this.ChartFrame.GetYFromData(s);if(this.Canvas.fillStyle=r.Color,this.Canvas.fillRect(f(h),f(e),f(o-h),f(a)),r.Title&&r.TitleColor){var l=o+(h-o)/2,u=t;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=r.TitleColor,this.Canvas.font=this.Font,this.Canvas.fillText(r.Title,0,-2),this.Canvas.restore()}}}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var t={Min:null,Max:null};if(!this.Data||!this.Data.Data)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];if(null!=a&&!isNaN(a.Value)&&!isNaN(a.Value2)){var i=Math.max(a.Value,a.Value2),r=Math.min(a.Value,a.Value2);null==t.Max&&(t.Max=i),null==t.Min&&(t.Min=r),t.Max<i&&(t.Max=i),t.Min>r&&(t.Min=r)}}return t}},e.ChartStraightLine=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.Draw=function(){if(this.Data&&this.Data.Data&&1==this.Data.Data.length){var t=this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();t&&this.ChartBorder.GetTop();var e=this.ChartFrame.XPointCount,a=this.Data.Data[0],i=this.ChartFrame.GetYFromData(a),r=this.ChartFrame.GetXFromIndex(0),n=this.ChartFrame.GetXFromIndex(e-1),s=parseInt(i.toString())+.5;this.Canvas.beginPath(),t?(this.Canvas.moveTo(s,r),this.Canvas.lineTo(s,n)):(this.Canvas.moveTo(r,s),this.Canvas.lineTo(n,s)),this.Canvas.strokeStyle=this.Color,this.Canvas.stroke()}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var t={Min:null,Max:null};return this.Data&&this.Data.Data?(1!=this.Data.Data.length||(t.Min=this.Data.Data[0],t.Max=this.Data.Data[0]),t):t}},e.ChartSubLine=function(){this.newMethod=m,this.newMethod(),delete this.newMethod,this.ClassName="ChartSubLine",this.Color="rgb(255,193,37)",this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.SubFrame={Max:null,Min:null},this.Draw=function(){if(this.IsShow&&this.Data&&this.Data.Data)switch(this.CalculateDataMaxMin(),this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.GetYFromData=function(t){var e=!0===this.ChartFrame.IsHScreen;if(e){if(t<=this.SubFrame.Min)return this.ChartBorder.GetLeftEx();if(t>=this.SubFrame.Max)return this.ChartBorder.GetRightEx();var a=this.ChartBorder.GetWidthEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return this.ChartBorder.GetLeftEx()+a}if(t<=this.SubFrame.Min)return this.ChartBorder.GetBottomEx();if(t>=this.SubFrame.Max)return this.ChartBorder.GetTopEx();var i=this.ChartBorder.GetHeightEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return this.ChartBorder.GetBottomEx()-i},this.CalculateDataMaxMin=function(){this.SubFrame={Max:null,Min:null};var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());for(var a=this.ChartFrame.XPointCount,i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<a;++i,++r){var n=this.Data.Data[i];if(null!=n){var s=this.ChartFrame.GetXFromIndex(r);if(s>e)break;(null==this.SubFrame.Min||this.SubFrame.Min>n)&&(this.SubFrame.Min=n),(null==this.SubFrame.Max||this.SubFrame.Max<n)&&(this.SubFrame.Max=n)}}},this.GetMaxMin=function(){return{Min:null,Max:null}}},e.ChartText=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.TextFont="14px 微软雅黑",this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth;var t=this.ChartBorder.GetRight();this.ChartFrame.XPointCount;for(var e in this.Data.Data){var a=this.Data.Data[e];if(null!=a){var i=a.Value,r=a.Position;if("Left"==r){var n=this.ChartFrame.GetXFromIndex(0),s=this.ChartFrame.GetYFromData(i);if(n>t)continue;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=a.Color,this.Canvas.font=this.TextFont,this.Canvas.fillText(a.Message,n,s)}}}}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var t={Min:null,Max:null};if(!this.Data||!this.Data.Data)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];if(null!=a&&!isNaN(a.Value)){var i=a.Value;null==t.Max&&(t.Max=i),null==t.Min&&(t.Min=i),t.Max<i&&(t.Max=i),t.Min>i&&(t.Min=i)}}return t}},e.ChartVolStick=function(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.UpColor=r.g_JSChartResource.UpBarColor,this.DownColor=r.g_JSChartResource.DownBarColor,this.HistoryData,this.KLineDrawType=0,this.ClassName="ChartVolStick",this.MinBarWidth=r.g_JSChartResource.MinKLineBarWidth,this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(!0!==this.ChartFrame.IsHScreen){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetLeft()+e/2+2,i=this.ChartBorder.GetRight(),r=this.ChartFrame.XPointCount,n=this.ChartFrame.GetYFromData(0),s=this.IsMinuteFrame();if(t>=this.MinBarWidth){n=f(n);for(var o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h,a+=t+e){var l=this.Data.Data[o],u=this.HistoryData.Data[o];if(null!=l&&null!=u){var C=a,D=a+t;if(D>i)break;var m=this.ChartFrame.GetYFromData(l),c=!1;u.Close>=u.Open?(this.Canvas.fillStyle=this.UpColor,c=!0):this.Canvas.fillStyle=this.DownColor;var I=f(Math.abs(n-m)>=1?n-m:1);m=n-I,6==this.KLineDrawType?(this.Canvas.strokeStyle=c?this.UpColor:this.DownColor,this.Canvas.beginPath(),this.Canvas.rect(S(C),S(m),f(t),I),this.Canvas.stroke()):!c||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType?this.Canvas.fillRect(f(C),m,f(t),I):(this.Canvas.strokeStyle=this.UpColor,this.Canvas.beginPath(),this.Canvas.rect(S(C),S(m),f(t),I),this.Canvas.stroke())}}}else for(o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h,a+=t+e){l=this.Data.Data[o],u=this.HistoryData.Data[o];if(null!=l&&null!=u){m=this.ChartFrame.GetYFromData(l);if(s)var d=this.ChartFrame.GetXFromIndex(h);else C=a,D=a+t,d=C+(D-C)/2;if(d>i)break;u.Close>u.Open?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;d=this.ChartFrame.GetXFromIndex(h);this.Canvas.beginPath(),this.Canvas.moveTo(S(d),m),this.Canvas.lineTo(S(d),n),this.Canvas.stroke()}}}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetTop()+e/2+2,i=this.ChartBorder.GetBottom(),r=this.ChartFrame.XPointCount,n=this.ChartFrame.GetYFromData(0);if(t>=this.MinBarWidth){n=f(n);for(var s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<r;++s,++o,a+=t+e){var h=this.Data.Data[s],l=this.HistoryData.Data[s];if(null!=h&&null!=l){var u=a,C=a+t;if(C>i)break;var D=this.ChartFrame.GetYFromData(h),m=!1;l.Close>=l.Open?(m=!0,this.Canvas.fillStyle=this.UpColor):this.Canvas.fillStyle=this.DownColor;var c=f(D-n);!m||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType?this.Canvas.fillRect(n,f(u),c,f(t)):(this.Canvas.strokeStyle=this.UpColor,this.Canvas.beginPath(),this.Canvas.rect(S(n),S(u),c,f(t)),this.Canvas.stroke())}}}else for(s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<r;++s,++o,a+=t+e){h=this.Data.Data[s],l=this.HistoryData.Data[s];if(null!=h&&null!=l){D=this.ChartFrame.GetYFromData(h);var I=this.ChartFrame.GetXFromIndex(o);if(I>i)break;l.Close>l.Open?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;I=this.ChartFrame.GetXFromIndex(o);this.Canvas.beginPath(),this.Canvas.moveTo(D,S(I)),this.Canvas.lineTo(n,S(I)),this.Canvas.stroke()}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];(!n.IFrameSplitOperator.IsNumber(e.Max)||e.Max<r)&&(e.Max=r),(!n.IFrameSplitOperator.IsNumber(e.Min)||e.Min>r)&&(e.Min=r)}return e.Max>0&&e.Min>0?e.Min=0:e.Max<0&&e.Min<0&&(e.Max=0),e}},e.ColorToRGBA=l,e.DepthChartCorssCursor=function(){this.Frame,this.Canvas,this.Data,this.Symbol,this.HQChart,this.HPenType=0,this.VPenType=0,this.LineDash=r.g_JSChartResource.DepthCorss.LineDash,this.AskColor=r.g_JSChartResource.DepthCorss.AskColor.Line,this.BidColor=r.g_JSChartResource.DepthCorss.BidColor.Line,this.LineWidth=r.g_JSChartResource.DepthCorss.LineWidth,this.IsShowTooltip=!0,this.Tooltip={LineHeight:r.g_JSChartResource.DepthCorss.Tooltip.LineHeight,Border:{Top:r.g_JSChartResource.DepthCorss.Tooltip.Border.Top,Left:r.g_JSChartResource.DepthCorss.Tooltip.Border.Left,Right:r.g_JSChartResource.DepthCorss.Tooltip.Border.Right,Bottom:r.g_JSChartResource.DepthCorss.Tooltip.Border.Bottom,ItemSpace:r.g_JSChartResource.DepthCorss.Tooltip.Border.ItemSpace},Font:r.g_JSChartResource.DepthCorss.Tooltip.Font,TextColor:r.g_JSChartResource.DepthCorss.Tooltip.TextColor,BGColor:r.g_JSChartResource.DepthCorss.Tooltip.BGColor},this.Font=r.g_JSChartResource.CorssCursorTextFont,this.TextColor=r.g_JSChartResource.CorssCursorTextColor,this.TextBGColor=r.g_JSChartResource.CorssCursorBGColor,this.TextHeight=20,this.LastPoint,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.IsShowCorss=!0,this.IsShow=!0,this.GetVol=function(t,e){if(!this.Data)return null;var a=e?this.Data.Asks:this.Data.Bids;if(!a||!Array.isArray(a)||a.length<=0)return null;for(var i in a){var r=a[i];if(r.Price==t)return r.Vol}return null},this.Draw=function(){if(this.Status=0,this.LastPoint&&this.Data&&this.IsShow){var t,e=this.LastPoint.X,a=this.LastPoint.Y,r=new i.Rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight());if(t=r.IsPointIn(e,a),this.PointY=null,this.PointY,t&&!0!==this.Frame.IsHScreen){var n=this.Frame.ChartBorder.GetLeft(),s=this.Frame.ChartBorder.GetRight(),o=this.Frame.ChartBorder.GetTopTitle(),h=this.Frame.ChartBorder.GetBottom(),l=(this.Frame.ChartBorder.Right,this.Frame.ChartBorder.GetChartWidth(),this.Frame.GetXData(e)),u=this.Frame.GetXFromPrice(l);if(u){var C=this.GetVol(u.Price,u.IsAsk);if(a=this.Frame.GetYFromData(C),u.Vol=C,u.Y=a,this.PointY=[[n,a],[s,a]],this.PointX=[[e,o],[e,h]],this.IsShowCorss){u.IsAsk?this.Canvas.strokeStyle=this.AskColor:this.Canvas.strokeStyle=this.BidColor,this.Canvas.save(),this.Canvas.lineWidth=this.LineWidth;this.Canvas.lineWidth;if(1==this.HPenType||0==this.HPenType){0==this.HPenType&&this.Canvas.setLineDash(this.LineDash);var D=S(a);this.Canvas.beginPath(),this.Canvas.moveTo(n,D),this.Canvas.lineTo(s,D),this.Canvas.stroke(),0==this.HPenType&&this.Canvas.setLineDash([])}0==this.VPenType&&this.Canvas.setLineDash(this.LineDash);var m=S(u.X);this.Canvas.beginPath(),this.Canvas.moveTo(m,o),this.Canvas.lineTo(m,h),this.Canvas.stroke(),0==this.VPenType&&this.Canvas.setLineDash([]),this.Canvas.restore()}if(this.HQChart){var c=this.HQChart.GetEvent(i.JSCHART_EVENT_ID.ON_DRAW_DEPTH_TOOLTIP);c&&c.Callback(c,u,this)}if(this.IsShowTooltip){var f=this.GetFormatTooltip(u);this.DrawTooltip(f,u)}}}}},this.GetFormatTooltip=function(t){var e=[],a=2;this.Symbol&&(a=s.JSCommonCoordinateData.GetfloatPrecision(this.Symbol));var i={Title:r.g_JSChartLocalization.GetText("Depth-Price",this.HQChart.LanguageID),TitleColor:this.Tooltip.TextColor,Text:t.Price.toFixed(a),Color:this.Tooltip.TextColor};e.push(i);i={Title:r.g_JSChartLocalization.GetText("Depth-Sum",this.HQChart.LanguageID),TitleColor:this.Tooltip.TextColor,Text:t.Vol.toFixed(4),Color:this.Tooltip.TextColor};return e.push(i),e},this.DrawTooltip=function(t,e){if(n.IFrameSplitOperator.IsNonEmptyArray(t)){this.Canvas.font=this.Tooltip.Font;for(var a=0,i=0,r=0,s=0;s<t.length;++s){var o=t[s];if(o){var h=!1;if(o.Title){var l=this.Canvas.measureText(o.Title).width;a<l&&(a=l),++i,h=!0}if(o.Text){l=this.Canvas.measureText(o.Text).width;a<l&&(a=l),++i,h=!0}h&&++r}}if(!(a<=0||i<=0)){var u=this.Tooltip.Border,C=this.Frame.ChartBorder.GetRight(),D=this.Frame.ChartBorder.GetTop();this.Tooltip.LineHeight=this.Canvas.measureText("擎").width+2,this.Tooltip.Width=a+(u.Left+u.Right),this.Tooltip.Height=this.Tooltip.LineHeight*i+(u.Top+u.Bottom)+u.ItemSpace*(r-1);var m=e.X,c=e.Y-this.Tooltip.Height;m+this.Tooltip.Width>=C&&(m=e.X-this.Tooltip.Width),c<D&&(c=e.Y),this.Canvas.fillStyle=this.Tooltip.BGColor,this.Canvas.fillRect(m,c,this.Tooltip.Width,this.Tooltip.Height),this.Canvas.textBaseline="top",this.Canvas.textAlign="left";var S=u.Left+m,f=u.Top+c;for(s=0;s<t.length;++s){o=t[s],h=!1;o.Title&&(o.TitleColor?this.Canvas.fillStyle=o.TitleColor:this.Canvas.fillStyle=this.Tooltip.TextColor,this.Canvas.fillText(o.Title,S,f),f+=this.Tooltip.LineHeight,h=!0),o.Text&&(o.Color?this.Canvas.fillStyle=o.Color:this.Canvas.fillStyle=this.Tooltip.TextColor,this.Canvas.fillText(o.Text,S,f),f+=this.Tooltip.LineHeight,h=!0),h&&(f+=u.ItemSpace)}}}}},e.GetFontHeight=h,e.IChartPainting=u,a("ac1f"),a("00b4"),a("5319"),a("d401"),a("d3b7"),a("25f0"),a("a9e3"),a("e25e"),a("fb6a"),a("99af"),a("cb29"),a("14d9"),a("4ec9"),a("3ca3"),a("ddb0"),a("26e9"),a("6062");var i=a("8709"),r=a("ee32"),n=a("deed"),s=a("966c");a("c534");var o=new function(){this.Index={NotSupport:{Font:"14px 微软雅黑",TextColor:"rgb(52,52,52)"}}};function h(t,e,a){if(!t)return null;e&&(t.font=e);var i="擎";n.IFrameSplitOperator.IsString(a)&&(i=a);var r=t.measureText(i),s=r.width+2;return s}function l(t,e){if(/^(rgb|RGB)/.test(t)){for(var a="#",i=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),r=0;r<i.length;r++){var n=Number(i[r]).toString(16);"0"===n&&(n+=n),a+=n}t=a}return"rgba("+parseInt("0x"+t.slice(1,3))+","+parseInt("0x"+t.slice(3,5))+","+parseInt("0x"+t.slice(5,7))+","+e+")"}function u(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="IChartPainting",this.Data=new i.ChartData,this.NotSupportMessage=null,this.MessageFont=o.Index.NotSupport.Font,this.MessageColor=o.Index.NotSupport.TextColor,this.IsDrawFirst=!1,this.IsShow=!0,this.GetEventCallback,this.Draw=function(){},this.GetYFromData=function(t,e){return this.ChartFrame.GetYFromData(t,e)},this.IsMinuteFrame=function(){var t="MinuteFrame"==this.ChartFrame.ClassName||"MinuteHScreenFrame"==this.ChartFrame.ClassName;return t},this.DrawNotSupportmessage=function(){this.Canvas.font=this.MessageFont,this.Canvas.fillStyle=this.MessageColor;var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeightEx(),r=t+e/2,n=a+i/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.NotSupportMessage,r,n)},this.GetTooltipData=function(t,e,a){return!1},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];null==r||isNaN(r)||(null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r))}return e},this.GetDynamicFont=function(t){var e;return e=t<5?"4px Arial":t<7?"6px Arial":t<9?"8px Arial":t<11?"10px Arial":t<13?"12px Arial":t<15?"14px Arial":"16px Arial",e},this.GetDynamicFontEx=function(t,e,a,i,r,s){if(a==i){var o="".concat(a.toFixed(0),"px ").concat(s);return o}var h=t+e;r&&(0==r.Type?r.Value>0&&(h=t*r.Value):1==r.Type?r.Value>0&&(h=(t+e)*r.Value):2==r.Type&&n.IFrameSplitOperator.IsNumber(r.Value)&&(h=t+e+2*r.Value)),h<i?h=i:h>a&&(h=a);o="".concat(h.toFixed(0),"px ").concat(s);return o},this.SetFillStyle=function(t,e,a,i,r){if(Array.isArray(t)){var n=this.Canvas.createLinearGradient(e,a,i,r),s=1/t.length;for(var o in t)n.addColorStop(o*s,t[o]);this.Canvas.fillStyle=n}else this.Canvas.fillStyle=t},this.GetFontHeight=function(t){return h(this.Canvas,t,"擎")},this.GetLockRect=function(){return this.ChartFrame.GetLockRect()}}function C(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.TextFont="14px 微软雅黑",this.Text,this.TextAlign="left",this.Direction=0,this.FixedFontSize=-1,this.YOffset=0,this.Position,this.TextBG,this.ShowOffset={X:0,Y:0},this.TextSize={Max:r.g_JSChartResource.DRAWICON.Text.MaxSize,Min:r.g_JSChartResource.DRAWICON.Text.MinSize,Zoom:{Type:r.g_JSChartResource.DRAWICON.Text.Zoom.Type,Value:r.g_JSChartResource.DRAWICON.Text.Zoom.Value},FontName:r.g_JSChartResource.DRAWICON.Text.FontName},this.ReloadResource=function(t){"DRAWTEXT"==this.Name?this.TextSize={Max:r.g_JSChartResource.DRAWTEXT.MaxSize,Min:r.g_JSChartResource.DRAWTEXT.MinSize,Zoom:{Type:r.g_JSChartResource.DRAWTEXT.Zoom.Type,Value:r.g_JSChartResource.DRAWTEXT.Zoom.Value},FontName:r.g_JSChartResource.DRAWTEXT.FontName}:"DRAWNUMBER"==this.Name&&(this.TextSize={Max:r.g_JSChartResource.DRAWNUMBER.MaxSize,Min:r.g_JSChartResource.DRAWNUMBER.MinSize,Zoom:{Type:r.g_JSChartResource.DRAWNUMBER.Zoom.Type,Value:r.g_JSChartResource.DRAWNUMBER.Zoom.Value},FontName:r.g_JSChartResource.DRAWNUMBER.FontName})},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if("DRAWTEXTREL"!=this.Name&&"DRAWTEXTABS"!=this.Name){if(this.Position)this.DrawPosition();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight(),n=this.ChartBorder.GetTopEx(),s=this.ChartBorder.GetBottomEx();t&&(i=this.ChartBorder.GetBottom(),n=this.ChartBorder.GetRightEx(),s=this.ChartBorder.GetLeftEx());var o,h=this.ChartFrame.XPointCount,l=Array.isArray(this.Text),u={Text:{},Font:{}};1==this.Direction?(this.Canvas.textBaseline="bottom",u.Text={Baseline:"bottom"}):2==this.Direction?(this.Canvas.textBaseline="top",u.Text={Baseline:"top"}):(this.Canvas.textBaseline="middle",u.Text={Baseline:"middle"}),this.FixedFontSize>0?this.TextFont="".concat(this.FixedFontSize,"px ").concat(this.TextSize.FontName):this.TextFont=this.GetDynamicFontEx(e,a,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName),u.Font={Height:this.GetFontHeight(this.TextFont)};for(var C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<h;++C,++D){var m=this.Data.Data[C];if(null!=m){var c=this.ChartFrame.GetXFromIndex(D),f=this.ChartFrame.GetYFromData(m);if(c>i)break;if(f+=this.ShowOffset.Y,c+=this.ShowOffset.X,this.Canvas.textAlign=this.TextAlign,this.Canvas.fillStyle=this.Color,this.Canvas.font=this.TextFont,u.Text.Color=this.Color,u.Text.Align=this.TextAlign,u.X=c,u.Y=f,this.YOffset>0&&this.Direction>0){var I=f;this.Canvas.save(),this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?(1==this.Direction?(f=n-this.YOffset,I+=5):(f=s+this.YOffset,I-=5),this.Canvas.moveTo(S(I),S(c)),this.Canvas.lineTo(S(f),S(c))):(1==this.Direction?(f=n+this.YOffset,I+=5):(f=s-this.YOffset,I-=5),this.Canvas.moveTo(S(c),S(I)),this.Canvas.lineTo(S(c),S(f))),this.Canvas.stroke(),this.Canvas.restore()}if(l){if(o=this.Text[C],!o)continue;t?"DRAWNUMBER"==this.Name&&(1==this.Direction?f+=r.g_JSChartResource.DRAWABOVE.YOffset:2==this.Direction&&(f-=4)):"DRAWNUMBER"==this.Name&&(1==this.Direction?f-=r.g_JSChartResource.DRAWABOVE.YOffset:2==this.Direction&&(f+=4)),"DRAWTEXT"==this.Name?this.DrawTextV2(o,u,t):this.DrawText(o,c,f,t)}else"DRAWTEXT"==this.Name?this.DrawTextV2(this.Text,u,t):this.DrawText(this.Text,c,f,t)}}}}else this.DrawRectText()},this.DrawPosition=function(){if(this.Text){var t=!0===this.ChartFrame.IsHScreen;if(t)var e=this.ChartBorder.GetRightEx()-this.ChartBorder.GetWidthEx()*this.Position.Y,a=this.ChartBorder.GetTop()+this.ChartBorder.GetHeight()*this.Position.X;else a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*this.Position.X,e=this.ChartBorder.GetTopEx()+this.ChartBorder.GetHeight()*this.Position.Y;this.Canvas.fillStyle=this.Color,0==this.Position.Type?this.Canvas.textAlign="left":1==this.Position.Type?this.Canvas.textAlign="right":this.Canvas.textAlign="center",1==this.Direction?this.Canvas.textBaseline="bottom":2==this.Direction?this.Canvas.textBaseline="top":this.Canvas.textBaseline="middle",this.DrawText(this.Text,a,e,t)}},this.DrawText=function(t,e,a,i){i?(this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()):this.Canvas.fillText(t,e,a)},this.DrawTextV2=function(t,e,a){var i=this.Canvas.measureText(t).width;if(a){var r=e.Y,n=e.X;if("right"==e.Text.Align?n-=i:"center"==e.Text.Align&&(n-=i/2),"top"==e.Text.Baseline?r-=e.Font.Height:"middle"==e.Text.Baseline&&(r-=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){var s=this.TextBG.Margin,o=r-s[0],h=n-s[2],l=i+s[2]+s[3],u=e.Font.Height+s[0]+s[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(o,h,u,l)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(S(o),S(h),f(u),f(l)))}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()}else{r=e.X,n=e.Y;if("right"==e.Text.Align?r-=i:"center"==e.Text.Align&&(r-=i/2),"top"==e.Text.Baseline?n+=e.Font.Height:"middle"==e.Text.Baseline&&(n+=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){s=this.TextBG.Margin,o=r-s[2],h=n-e.Font.Height-s[1],l=i+s[2]+s[3],u=e.Font.Height+s[0]+s[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(o,h,l,u)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(S(o),S(h),f(l),f(u)))}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.fillText(t,r,n)}},this.DrawRectText=function(){if(this.DrawData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.GetBorder();if("DRAWTEXTREL"==this.Name)if(t)var a=e.RightTitle-e.LeftEx,i=e.BottomEx-e.TopEx,r=this.DrawData.Point.X/1e3*i+e.TopEx,n=e.RightTitle-this.DrawData.Point.Y/1e3*i;else i=e.RightEx-e.LeftEx,a=e.BottomEx-e.TopTitle,r=this.DrawData.Point.X/1e3*i+e.LeftEx,n=this.DrawData.Point.Y/1e3*a+e.TopTitle;else{if("DRAWTEXTABS"!=this.Name)return;if(t)r=this.DrawData.Point.X+e.TopEx,n=e.RightTitle-this.DrawData.Point.Y;else r=this.DrawData.Point.X+e.LeftEx,n=this.DrawData.Point.Y+e.TopTitle}1==this.Direction?this.Canvas.textBaseline="bottom":2==this.Direction?this.Canvas.textBaseline="top":this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.Color,this.DrawText(this.DrawData.Text,r,n,t)}},this.SuperGetMaxMin=this.GetMaxMin,this.GetMaxMin=function(){return"DRAWTEXTREL"==this.Name||"DRAWTEXTABS"==this.Name?{Min:null,Max:null}:this.SuperGetMaxMin()}}function D(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawText",this.Color="rgb(255,193,37)",this.TextFont="14px 微软雅黑",this.Text,this.TextAlign="left",this.TextBaseline="middle",this.FixedFontSize=-1,this.YOffset=0,this.FixedPosition=-1,this.TextBG,this.VerticalLine,this.ShowOffset={X:0,Y:0},this.TextSize={Max:r.g_JSChartResource.DRAWICON.Text.MaxSize,Min:r.g_JSChartResource.DRAWICON.Text.MinSize,Zoom:{Type:r.g_JSChartResource.DRAWICON.Text.Zoom.Type,Value:r.g_JSChartResource.DRAWICON.Text.Zoom.Value},FontName:r.g_JSChartResource.DRAWICON.Text.FontName},this.ReloadResource=function(t){this.TextSize={Max:r.g_JSChartResource.DRAWTEXT.MaxSize,Min:r.g_JSChartResource.DRAWTEXT.MinSize,Zoom:{Type:r.g_JSChartResource.DRAWTEXT.Zoom.Type,Value:r.g_JSChartResource.DRAWTEXT.Zoom.Value},FontName:r.g_JSChartResource.DRAWTEXT.FontName}},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight(),r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx();t&&(i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetRightEx(),n=this.ChartBorder.GetLeftEx());var s,o=this.ChartFrame.XPointCount,h=Array.isArray(this.Text),l={Text:{Color:this.Color,Align:this.TextAlign,Baseline:this.TextBaseline},Font:{}};this.FixedFontSize>0?this.TextFont="".concat(this.FixedFontSize,"px ").concat(this.TextSize.FontName):this.TextFont=this.GetDynamicFontEx(e,a,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName),l.Font={Height:this.GetFontHeight(this.TextFont)};for(var u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<o;++u,++C){var D=this.Data.Data[u];if(null!=D){var m,c=this.ChartFrame.GetXFromIndex(C);if(m=1===this.FixedPosition?r:2===this.FixedPosition?n:this.ChartFrame.GetYFromData(D),c>i)break;if(m+=this.ShowOffset.Y,c+=this.ShowOffset.X,l.X=c,l.Y=m,h){if(s=this.Text[u],!s)continue;this.DrawText(s,l,t)}else this.DrawText(this.Text,l,t);this.DrawVerticalLine(u,l,t)}}}},this.DrawText=function(t,e,a){var i=this.Canvas.measureText(t).width;if(a){var r=e.Y,n=e.X;if("right"==e.Text.Align?n-=i:"center"==e.Text.Align&&(n-=i/2),"top"==e.Text.Baseline?r-=e.Font.Height:"middle"==e.Text.Baseline&&(r-=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){var s=this.TextBG.Margin,o=r-s[0],h=n-s[2],l=i+s[2]+s[3],u=e.Font.Height+s[0]+s[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(o,h,u,l)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(S(o),S(h),f(u),f(l))),e.Rect={Bottom:o,Top:o+u}}else{o=r,u=e.Font.Height;e.Rect={Bottom:o,Top:o+u}}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()}else{r=e.X,n=e.Y;if("right"==e.Text.Align?r-=i:"center"==e.Text.Align&&(r-=i/2),"top"==e.Text.Baseline?n+=e.Font.Height:"middle"==e.Text.Baseline&&(n+=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){s=this.TextBG.Margin,o=r-s[2],h=n-e.Font.Height-s[1],l=i+s[2]+s[3],u=e.Font.Height+s[0]+s[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(o,h,l,u)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(S(o),S(h),f(l),f(u))),e.Rect={Top:h,Bottom:h+u}}else{h=n-e.Font.Height,u=e.Font.Height;e.Rect={Top:h,Bottom:h+u}}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.fillText(t,r,n)}},this.DrawVerticalLine=function(t,e,a){if(this.VerticalLine){var i=this.VerticalLine.Data[t];if(i&&n.IFrameSplitOperator.IsNumber(i.High)&&n.IFrameSplitOperator.IsNumber(i.Low)){var r,s,o=this.ChartFrame.GetYFromData(i.High),h=this.ChartFrame.GetYFromData(i.Low);if(a)if(e.Rect.Bottom>o)r=e.Rect.Bottom-1,s=o+1;else{if(!(e.Rect.Top<h))return;r=e.Rect.Top-1,s=h-1}else if(e.Rect.Bottom<o)r=e.Rect.Bottom+1,s=o-1;else{if(!(e.Rect.Top>h))return;r=e.Rect.Top-1,s=h+1}this.Canvas.save();var l=e.X;1==this.VerticalLine.LineType&&(this.VerticalLine.LineDotted?this.Canvas.setLineDash(this.VerticalLine.LineDotted):this.Canvas.setLineDash([3,3])),n.IFrameSplitOperator.IsPlusNumber(this.VerticalLine.LineWidth)&&(this.Canvas.lineWidth=1*this.VerticalLine.LineWidth),this.Canvas.strokeStyle=this.VerticalLine.Color,this.Canvas.beginPath(),a?(this.Canvas.moveTo(S(r),S(l)),this.Canvas.lineTo(S(s),S(l))):(this.Canvas.moveTo(S(l),S(r)),this.Canvas.lineTo(S(l),S(s))),this.Canvas.stroke(),this.Canvas.restore()}}}}function m(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.ClassName="ChartLine",this.Color="rgb(255,193,37)",this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)switch(this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.DrawLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth);for(var i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s),l=this.GetYFromData(o);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()},this.DrawStraightLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,n=this.ChartBorder.GetLeft()+i/2+r.g_JSChartResource.FrameLeftMargin,s=this.ChartBorder.GetRight();t&&(s=this.ChartBorder.GetBottom()),t&&(n=this.ChartBorder.GetTop()+i/2+r.g_JSChartResource.FrameLeftMargin);var o=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash([3,5]);for(var h=!0,l=0,u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<o;++u,++C,n+=a+i){var D=this.Data.Data[u];if(null!=D){if(e)var m=this.ChartFrame.GetXFromIndex(C);else{var c=n,S=n+a;if(S>s)break;m=c+(S-c)/2}var f=this.GetYFromData(D);if(m>s)break;h?(this.Canvas.beginPath(),t?this.Canvas.moveTo(f,m):this.Canvas.moveTo(m,f),h=!1):t?this.Canvas.lineTo(f,m):this.Canvas.lineTo(m,f),++l}else l>0&&this.Canvas.stroke(),h=!0,l=0}l>0&&this.Canvas.stroke(),this.Canvas.restore()},this.GetYFromData=function(t){return this.ChartFrame.GetYFromData(t)}}function c(){this.newMethod=u,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.LineWidth,this.ClassName="ChartStick",this.DrawLine=function(){if(!this.ChartFrame.IsMinSize&&this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth);for(var i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s),l=this.ChartFrame.GetYFromData(o);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.DrawStick=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetLeft();this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineWidth&&(this.Canvas.lineWidth=this.LineWidth);for(var n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s),l=this.ChartFrame.GetYFromData(o);if(h>e)break;if(this.Canvas.beginPath(),t)this.Canvas.moveTo(r,h),this.Canvas.lineTo(l,h),this.Canvas.stroke();else{var u=parseInt(h.toString())+.5;this.Canvas.moveTo(u,l),this.Canvas.lineTo(u,i)}this.Canvas.stroke()}}this.Canvas.restore()}},this.Draw=function(){this.IsShow&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.DrawStick())}}function S(t){return parseInt(t)+.5}function f(t){return.5+t<<0}},d86b:function(t,e,a){var i=a("d039");t.exports=i((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},deed:function(t,e,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.CoordinateInfo=u,e.FrameSplitKLinePriceY=function t(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.CoordinateType=0,this.Symbol,this.Data,this.FrameSplitData2,this.FloatPrecision=null,this.Custom=[],this.SplitType=0,this.DefaultSplitType=0,this.Operator=function(){var e={};e.Max=this.Frame.HorizontalMax,e.Min=this.Frame.HorizontalMin,e.Count=this.SplitCount,e.Max==e.Min&&(e.Max+=.01*e.Max,e.Min-=.01*e.Min),e.Interval=(e.Max-e.Min)/(e.Count-1);var a=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);o.JSCommonCoordinateData.MARKET_SUFFIX_NAME.IsSHSZIndex(this.Symbol)&&(a=0),null!=this.FloatPrecision&&(a=this.FloatPrecision);var i=!0;if(t.SplitCustom)t.SplitCustom(this,e,a),i=!1;else switch(this.CoordinateType){case 1:this.SplitPercentage(e,a);break;default:1==this.SplitType?this.SplitFixed(e,a):this.SplitDefault(e,a),this.CustomCoordinate(a);break}if(i&&(this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,!1)),this.Frame.HorizontalMax=e.Max,this.Frame.HorizontalMin=e.Min,this.GetEventCallback){var r=this.GetEventCallback(s.JSCHART_EVENT_ID.ON_SPLIT_YCOORDINATE);if(r&&r.Callback){var n={ID:this.Frame.Identify,Frame:this.Frame};r.Callback(r,n,this)}}},this.SplitDefault=function(t,e){this.IntegerCoordinateSplit(t),this.Frame.HorizontalInfo=[];for(var a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new u,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e))},this.SplitPercentage=function(t,e){var a=this.GetFirstOpenPrice();t.Max=(t.Max-a)/a,t.Min=(t.Min-a)/a,t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit2(t);var i=(1+t.Max)*a,r=(1+t.Min)*a;this.Frame.HorizontalInfo=[];for(var n=0,s=t.Min;n<t.Count;++n,s+=t.Interval){var o=(s+1)*a;o<r||o>i||(this.Frame.HorizontalInfo[n]=new u,this.Frame.HorizontalInfo[n].Value=o,this.IsShowLeftText&&(this.Frame.HorizontalInfo[n].Message[0]=o.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[n].Message[1]=(100*s).toFixed(2)+"%"))}t.Min=(1+t.Min)*a,t.Max=(1+t.Max)*a},this.SplitFixed=function(t,e){this.Frame.HorizontalInfo=[];for(var a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new u,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e))},this.CustomCoordinate=function(t){this.Frame.CustomHorizontalInfo=[];for(var e=0;e<this.Custom.length;++e){var a=this.Custom[e];if(0==a.Type||3==a.Type||2==a.Type){var i=t;C.IsNumber(a.FloatPrecision)&&a.FloatPrecision>=0&&(i=a.FloatPrecision);var r=this.GetLatestPrice(i,a);r&&this.Frame.CustomHorizontalInfo.push(r)}else 1==a.Type&&this.CustomFixedCoordinate(a)}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return null;if(this.Data.Data.length<=0)return null;var a=this.Data.Data[this.Data.Data.length-1],i=new u;return i.Type=0,e&&C.IsNumber(e.Type)&&(i.Type=e.Type),i.Value=a.Close,i.TextColor=n.g_JSChartResource.FrameLatestPrice.TextColor,i.LineType=2,"left"==e.Position?i.Message[0]=a.Close.toFixed(t):i.Message[1]=a.Close.toFixed(t),a.Close>a.Open?i.LineColor=n.g_JSChartResource.FrameLatestPrice.UpBarColor:a.Close<a.Open?i.LineColor=n.g_JSChartResource.FrameLatestPrice.DownBarColor:i.LineColor=n.g_JSChartResource.FrameLatestPrice.UnchagneBarColor,C.IsNumber(e.LineType)&&(i.LineType=e.LineType),0==e.IsShowLine&&(i.LineType=-1),!0===e.CountDown&&(i.CountDown=!0),1===e.PositionEx&&(i.ExtendData={Custom:{Position:1}}),i},this.GetFirstOpenPrice=function(){if(!this.Data)return null;for(var t=this.Frame.XPointCount,e=this.Data.DataOffset,a=0;e<this.Data.Data.length&&a<t;++e,++a){var i=this.Data.Data[e];if(null!=i.Open&&null!=i.High&&null!=i.Low&&null!=i.Close)return i.Open}return null},this.CustomFixedCoordinate=function(t){for(var e=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol),a=0;a<t.Data.length;++a){var i,r=t.Data[a],n=new u;n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,C.IsNumber(t.LineType)&&(n.LineType=t.LineType),0==t.IsShowLine&&(n.LineType=-1),n.Value=r.Value,i=r.Text?r.Text:n.Value.toFixed(e),"left"==t.Position?n.Message[0]=i:n.Message[1]=i,1===t.PositionEx&&(n.ExtendData={Custom:{Position:1}}),this.Frame.CustomHorizontalInfo.push(n)}},this.IntegerCoordinateSplit2=function(t){var e=this.FrameSplitData2.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var a=t.Max,i=t.Min,r=t.Max/e.FixInterval,n=t.Min/e.FixInterval;C.IsFloat(r)&&(a=parseInt((r+.5).toFixed(0))*e.FixInterval),C.IsFloat(n)&&(i=parseInt((n-.5).toFixed(0))*e.FixInterval),0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var s=0,o=i;o-a<1e-8;o+=e.FixInterval)++s;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=s,!0}},e.FrameSplitKLineX=function t(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.MinDistance=12,this.Period,this.Symbol,this.MinTextDistance=50,this.SplitDateTime=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=e;r<a&&n<this.Frame.Data.Data.length;++r,++n){i+=t;var s=null;if(0==r){var o=C.FormatDateString(this.Frame.Data.Data[n].Date,"MM-DD");s={Value:n-e,Text:o}}else if(i>this.MinTextDistance){var h=C.FormatTimeString(this.Frame.Data.Data[n].Time);s={Value:n-e,Text:h}}if(s){var l=new u;l.Value=s.Value,this.ShowText&&(l.Message[0]=s.Text),0==l.Value&&(l.LineType=-1),this.Frame.VerticalInfo.push(l),i=0,0==r&&(i=-this.MinTextDistance/2)}}},this.SplitSecond=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=e;r<a&&n<this.Frame.Data.Data.length;++r,++n){i+=t;var s=null;if(0==r){var o=C.FormatDateString(this.Frame.Data.Data[n].Date,"MM-DD");s={Value:n-e,Text:o}}else if(i>this.MinTextDistance){var h=C.FormatTimeString(this.Frame.Data.Data[n].Time,"HH:MM:SS");s={Value:n-e,Text:h}}if(s){var l=new u;l.Value=s.Value,this.ShowText&&(l.Message[0]=s.Text),this.Frame.VerticalInfo.push(l),i=0,0==r&&(i=-this.MinTextDistance/2)}}},this.SplitDate=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=null,i=null,r=0,n=0,s=t,o=this.MinDistance;n<e&&s<this.Frame.Data.Data.length;++n,++s){var h=parseInt(this.Frame.Data.Data[s].Date/1e4),l=parseInt(this.Frame.Data.Data[s].Date/100)%100;if(i!=l&&++r,o<this.MinDistance&&a==h||null!=a&&a==h&&null!=i&&i==l)i=l,++o;else{var C,D=new u;D.Value=s-t,null==a||a!=h?C=h.toString():null!=i&&i==l||(C=l.toString()+"月"),a=h,i=l,this.ShowText&&(D.Message[0]=C),0==D.Value&&(D.LineType=-1),this.Frame.VerticalInfo.push(D),o=0}}0==this.Period&&r<=2&&this.SplitShortDate()},this.SplitShortDate=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=!0,i=0,r=t,n=12;i<e&&r<this.Frame.Data.Data.length;++i,++r){var s=parseInt(this.Frame.Data.Data[r].Date/1e4);if(n<12)++n;else{var o=new u;o.Value=r-t,a?(D=s.toString(),a=!1):D=C.FormatDateString(this.Frame.Data.Data[r].Date,"MM-DD"),this.ShowText&&(o.Message[0]=D),0==o.Value&&(o.LineType=-1),this.Frame.VerticalInfo.push(o),n=0}}if(1==this.Frame.VerticalInfo.length){var h=this.Frame.VerticalInfo[0],l=(r=h.Value+t,this.Frame.Data.Data[r]),D=C.FormatDateString(l.Date,"YYYY-MM");this.ShowText&&(h.Message[0]=D)}},this.Operator=function(){null!=this.Frame.Data&&(t.SplitCustom?t.SplitCustom(this):s.ChartData.IsMinutePeriod(this.Period,!0)?this.SplitDateTime():s.ChartData.IsSecondPeriod(this.Period)?this.SplitSecond():this.SplitDate())},this.CreateCoordinateInfo=function(){return new u}},e.FrameSplitMinutePriceY=function(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.High=null,this.Low=null,this.YClose,this.Data,this.AverageData,this.OverlayChartPaint,this.SplitCount=7,this.Symbol,this.SplitType=0,this.DefaultSplitType=0,this.LimitPrice,this.Custom,this.Operator=function(){if(this.Frame.HorizontalInfo=[],this.Frame.CustomHorizontalInfo=[],this.Data){var t=this.GetMaxMin();if(this.Symbol&&h.IsUSA(this.Symbol.toUpperCase())||2==this.SplitType?this.USASplit(t):this.DefaultSplit(t),this.CustomCoordinate(),this.GetEventCallback){var e=this.GetEventCallback(s.JSCHART_EVENT_ID.ON_SPLIT_YCOORDINATE);if(e&&e.Callback){var a={ID:this.Frame.Identify,Frame:this.Frame};e.Callback(e,a,this)}}}},this.GetMaxMin=function(){var t=this.YClose,e=this.YClose;for(var a in this.Data.Data)this.Data.Data[a]&&(t<this.Data.Data[a]&&(t=this.Data.Data[a]),e>this.Data.Data[a]&&(e=this.Data.Data[a]));if(this.AverageData)for(var a in this.AverageData.Data)this.AverageData.Data[a]&&(t<this.AverageData.Data[a]&&(t=this.AverageData.Data[a]),e>this.AverageData.Data[a]&&(e=this.AverageData.Data[a]));if(this.OverlayChartPaint&&this.OverlayChartPaint.length>0&&this.OverlayChartPaint[0]&&this.OverlayChartPaint[0].Symbol){var i=this.OverlayChartPaint[0].GetMaxMin();i.Max&&i.Max>t&&(t=i.Max),i.Min&&i.Min<e&&(e=i.Min)}return 1==this.SplitType&&this.LimitPrice&&(t<this.LimitPrice.Max&&(t=this.LimitPrice.Max),e>this.LimitPrice.Min&&(e=this.LimitPrice.Min)),C.IsNumber(this.High)&&C.IsNumber(this.Low)&&(t<this.High&&(t=this.High),e>this.Low&&(e=this.Low)),{Max:t,Min:e}},this.USASplit=function(t){var e=t.Max,a=t.Min;if(e==a)e+=.1*e,a-=.1*a;else{var i=this.Frame.ChartBorder.GetHeight(),r=5*(e-a)/i;e+=r,a-=r,a<0&&(a=t.Min)}var s=this.SplitCount,h=(e-a)/(s-1),l=[1,.1,.01,.001,1e-4],D=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);h<l[D]&&(h=l[D],e=a+h*s);for(var m=0;m<s;++m){var c=a+h*m;if(!this.YClose||c!=this.YClose){var S=new u;S.Value=c;var f=c.toFixed(D);if(this.IsShowLeftText&&(S.Message[0]=f),this.YClose){var I=100*(c/this.YClose-1);I>0?S.TextColor=n.g_JSChartResource.UpTextColor:I<0&&(S.TextColor=n.g_JSChartResource.DownTextColor),this.IsShowRightText&&(1==this.RightTextFormat?S.Message[1]=f:S.Message[1]=C.FormatValueString(I,2)+"%")}this.Frame.HorizontalInfo.push(S)}}if(this.YClose>a&&this.YClose<e){S=new u;S.Value=this.YClose,S.LineType=2,n.g_JSChartResource.FrameDotSplitPen&&(S.LineColor=n.g_JSChartResource.FrameDotSplitPen);f=this.YClose.toFixed(D);this.IsShowLeftText&&(S.Message[0]=f),this.IsShowRightText&&(1==this.RightTextFormat?S.Message[1]=f:S.Message[1]="0.00%"),this.Frame.HorizontalInfo.push(S)}this.Frame.HorizontalInfo.sort((function(t,e){return t.Value-e.Value})),this.Frame.HorizontalMax=e,this.Frame.HorizontalMin=a},this.DefaultSplit=function(t){var e=t.Max,a=t.Min;if(this.YClose==e&&this.YClose==a)e=this.YClose+.1*this.YClose,a=this.YClose-.1*this.YClose;else{var i=Math.max(Math.abs(this.YClose-e),Math.abs(this.YClose-a));e=this.YClose+i,a=this.YClose-i,a<0&&(a=t.Min)}var r=this.SplitCount,s=(e-a)/(r-1),h=[1,.1,.01,.001,1e-4],l=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);o.JSCommonCoordinateData.MARKET_SUFFIX_NAME.IsSHSZIndex(this.Symbol)&&(l=0),s<h[l]&&(s=h[l],e=this.YClose+s*(r-1)/2,a=this.YClose-s*(r-1)/2);for(var D=0;D<r;++D){var m=a+s*D;if(this.Frame.HorizontalInfo[D]=new u,this.Frame.HorizontalInfo[D].Value=m,this.Frame.HorizontalInfo[D].Message[0]=m.toFixed(l),this.YClose){var c=100*(m/this.YClose-1);c>0?this.Frame.HorizontalInfo[D].TextColor=n.g_JSChartResource.UpTextColor:c<0&&(this.Frame.HorizontalInfo[D].TextColor=n.g_JSChartResource.DownTextColor),this.Frame.HorizontalInfo[D].Message[1]=C.FormatValueString(c,2)+"%"}}this.Frame.HorizontalMax=e,this.Frame.HorizontalMin=a},this.CustomCoordinate=function(){if(this.Custom)for(var t in this.Custom){var e=this.Custom[t];if(1==e.Type)this.CustomFixedCoordinate(e);else if(0==e.Type){var a=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol),i=this.GetLatestPrice(a,e);i&&this.Frame.CustomHorizontalInfo.push(i)}}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return null;if(this.Data.Data.length<=0)return null;var a=this.Data.Data[this.Data.Data.length-1];if(!C.IsNumber(a)||!C.IsNumber(this.YClose))return null;var i=new u;return i.Type=0,i.Value=a,i.TextColor=n.g_JSChartResource.FrameLatestPrice.TextColor,i.LineType=2,"left"==e.Position?i.Message[0]=a.toFixed(t):i.Message[1]=a.toFixed(t),a>this.YClose?i.LineColor=n.g_JSChartResource.FrameLatestPrice.UpBarColor:a<this.YClose?i.LineColor=n.g_JSChartResource.FrameLatestPrice.DownBarColor:i.LineColor=n.g_JSChartResource.FrameLatestPrice.UnchagneBarColor,C.IsNumber(e.LineType)&&(i.LineType=e.LineType),0==e.IsShowLine&&(i.LineType=-1),i},this.CustomFixedCoordinate=function(t){var e=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);for(var a in t.Data){var i,r=t.Data[a],n=new u;if(n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,C.IsNumber(t.LineType)&&(n.LineType=t.LineType),0==t.IsShowLine&&(n.LineType=-1),C.IsNumber(r.Increase)){if(!C.IsNumber(this.YClose))continue;n.Value=this.YClose*(1+r.Increase)}else n.Value=r.Value;i=r.Text?r.Text:n.Value.toFixed(e),"left"==t.Position?n.Message[0]=i:n.Message[1]=i,this.Frame.CustomHorizontalInfo.push(n)}}},e.FrameSplitMinuteX=function(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Symbol=null,this.DayCount=1,this.DayData,this.Operator=function(){this.Frame.VerticalInfo=[];this.Frame.XPointCount;var t=this.Frame.ChartBorder.GetWidth(),e=!0===this.Frame.IsHScreen;e&&(t=this.Frame.ChartBorder.GetHeight());var a=o.JSCommonCoordinateData.MinuteCoordinateData,i=a.GetCoordinateData(this.Symbol,t),r=i.Count,n=i.MiddleCount>0?i.MiddleCount:parseInt(r/2),s=i.Data;if(this.Frame.XPointCount=243,this.Frame.XPointCount=r*this.DayCount,this.Frame.MinuteCount=r,this.Frame.VerticalInfo=[],this.DayCount<=1)for(var h in s){var l=new u;l.Value=s[h][0],this.ShowText&&(l.Message[0]=s[h][3]),this.Frame.VerticalInfo[h]=l}else{h=this.DayData.length-1;for(var D=0;h>=0;--h,++D){l=new u;l.Value=D*r+n,l.LineType=-1,this.ShowText&&(l.Message[0]=C.FormatDateString(this.DayData[h].Date,"MM-DD")),this.Frame.VerticalInfo.push(l);l=new u;l.Value=(D+1)*r,this.Frame.VerticalInfo.push(l)}}}},e.FrameSplitXData=function(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Operator=function(){if(null!=this.Frame.Data&&null!=this.Frame.XData){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=0,i=t;a<e&&i<this.Frame.Data.Data.length;++a,++i){var r=new u;r.Value=i-t,this.ShowText&&(r.Message[0]=this.Frame.XData[a]),this.Frame.VerticalInfo.push(r)}}}},e.FrameSplitXDepth=function(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.SplitCount=3,this.Symbol,this.LineType=3,this.Operator=function(){var t=this.Frame.VerticalRange;if(t){this.Frame.VerticalInfo=[];var e=2;this.Symbol&&(e=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol));var a=t.Max,i=t.Min;if(t.Bid)for(var r=(t.Bid.Max-i)/this.SplitCount,n=0;n<this.SplitCount;++n){var h=new u;h.Value=i+r*n,h.Value<=0||(C.IsNumber(this.LineType)&&(h.LineType=this.LineType),this.ShowText&&(h.Message[0]=h.Value.toFixed(e)),this.Frame.VerticalInfo.push(h))}h=new u;if(h.Value=t.Center,this.Frame.VerticalInfo.push(h),t.Ask)for(r=(a-t.Ask.Min)/this.SplitCount,n=1;n<=this.SplitCount;++n){h=new u;h.Value=t.Ask.Min+r*n,C.IsNumber(this.LineType)&&(h.LineType=this.LineType),this.ShowText&&(h.Message[0]=h.Value.toFixed(e)),this.Frame.VerticalInfo.push(h)}if(this.GetEventCallback){var l=this.GetEventCallback(s.JSCHART_EVENT_ID.ON_SPLIT_XCOORDINATE);if(l&&l.Callback){var D={ID:this.Frame.Identify,Frame:this.Frame};l.Callback(l,D,this)}}}}},e.FrameSplitY=function(){this.newMethod=C,this.newMethod(),delete this.newMethod,this.SplitType=0,this.DefaultSplitType=0,this.FloatPrecision=2,this.FLOATPRECISION_RANGE=[1,.1,.01,.001,1e-4],this.IgnoreYValue=null,this.LineType=null,this.IsShowYZero=!0,this.IntegerSplitData=null,this.Operator=function(){var t={};if(t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,t.Max==t.Min&&(0==t.Max?(t.Max=1,t.Min=-1):(t.Max+=.01*t.Max,t.Min-=.01*t.Min)),this.Frame.YSpecificMaxMin?(t.Count=this.Frame.YSpecificMaxMin.Count,t.Interval=(t.Max-t.Min)/(t.Count-1)):1==this.SplitType?(t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1)):2==this.SplitType?(t.Max=100,t.Min=0,t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1)):(t.Count=2*this.SplitCount,0==this.FloatPrecision?(t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit2(t)):(t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit(t))),this.Frame.HorizontalInfo=[],this.Frame.YSplitScale)for(var e in this.Frame.YSplitScale){var a=this.Frame.YSplitScale[e],i=new u;i.Value=a,C.IsNumber(this.LineType)&&(i.LineType=this.LineType);var r=Math.abs(a),n=this.FloatPrecision;r<1e-10?i.Message[1]=0:r<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1]?i.Message[1]=a.toExponential(2).toString():(n<this.FLOATPRECISION_RANGE.length&&r<this.FLOATPRECISION_RANGE[n]&&++n,n<this.FLOATPRECISION_RANGE.length&&r<this.FLOATPRECISION_RANGE[n]&&++n,n<this.FLOATPRECISION_RANGE.length&&r<this.FLOATPRECISION_RANGE[n]&&++n,i.Message[1]=C.FormatValueString(a,n,this.LanguageID)),i.Message[0]=i.Message[1],-2==this.StringFormat?i.Message[1]=null:-3==this.StringFormat?i.Message[0]=null:-1==this.StringFormat&&(i.Message[0]=i.Message[1]=null),this.Frame.HorizontalInfo.push(i)}else for(e=0,a=t.Min;e<t.Count;++e,a+=t.Interval){i=new u;if(this.Frame.HorizontalInfo[e]=i,i.Value=a,C.IsNumber(this.LineType)&&(i.LineType=this.LineType),1==this.StringFormat){n=this.FloatPrecision;!isNaN(a)&&Math.abs(a)>1e3&&(n=0),this.Frame.HorizontalInfo[e].Message[1]=C.FormatValueString(a,n,this.LanguageID)}else if(-1==this.StringFormat);else{r=Math.abs(a),n=this.FloatPrecision;r<1e-10?this.Frame.HorizontalInfo[e].Message[1]=0:r<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1]?this.Frame.HorizontalInfo[e].Message[1]=a.toExponential(2).toString():(n<this.FLOATPRECISION_RANGE.length&&r<this.FLOATPRECISION_RANGE[n]&&++n,n<this.FLOATPRECISION_RANGE.length&&r<this.FLOATPRECISION_RANGE[n]&&++n,n<this.FLOATPRECISION_RANGE.length&&r<this.FLOATPRECISION_RANGE[n]&&++n,this.Frame.HorizontalInfo[e].Message[1]=C.FormatValueString(a,n,this.LanguageID))}this.Frame.HorizontalInfo[e].Message[0]=this.Frame.HorizontalInfo[e].Message[1],-2==this.StringFormat?this.Frame.HorizontalInfo[e].Message[1]=null:-3==this.StringFormat&&(this.Frame.HorizontalInfo[e].Message[0]=null)}if(this.FilterIgnoreYValue(),this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,t.Max>0&&t.Min<0&&this.IsShowYZero),this.RemoveZero(this.Frame.HorizontalInfo),this.DynamicMessageText(),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,this.GetEventCallback){var o=this.GetEventCallback(s.JSCHART_EVENT_ID.ON_SPLIT_YCOORDINATE);if(o&&o.Callback){var h={ID:this.Frame.Identify,Frame:this.Frame};o.Callback(o,h,this)}}},this.FilterIgnoreYValue=function(){if(this.IgnoreYValue&&!(this.IgnoreYValue.length<=0)){var t=new Set(this.IgnoreYValue);this.Frame.HorizontalInfo=this.Frame.HorizontalInfo.filter((function(e){return!t.has(e.Value)})),this.IsShowYZero=!t.has(0)}},this.DynamicMessageText=function(){if(2==this.SplitType)for(var t=0;t<this.Frame.HorizontalInfo.length;++t){var e=this.Frame.HorizontalInfo[t];e.Message[0]&&(e.Message[0]+="%"),e.Message[1]&&(e.Message[1]+="%")}},this.IntegerCoordinateSplit2=function(t){null==this.IntegerSplitData&&(this.IntegerSplitData=new m);var e=this.IntegerSplitData.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var a=t.Max,i=t.Min,r=t.Max/e.FixInterval,n=t.Min/e.FixInterval;C.IsFloat(r)&&(a=parseInt((r+.5).toFixed(0))*e.FixInterval),C.IsFloat(n)&&(i=parseInt((n-.5).toFixed(0))*e.FixInterval),0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var s=0,o=i;o-a<1e-8;o+=e.FixInterval)++s;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=s,!0}},e.HQDateStringFormat=f,e.HQMinuteTimeStringFormat=function(){this.newMethod=c,this.newMethod(),delete this.newMethod,this.Frame,this.Symbol,this.Operator=function(){if(null==this.Value||isNaN(this.Value))return!1;var t=Math.abs(this.Value);t=parseInt(t.toFixed(0));var e=t;this.Frame&&this.Frame.MinuteCount&&(e=t%this.Frame.MinuteCount);var a=o.JSCommonCoordinateData.MinuteTimeStringData,i=a.GetTimeData(this.Symbol);if(!i)return!1;e<0?e=0:e>i.length&&(e=i.length-1),this.Frame&&t>=this.Frame.XPointCount&&(e=i.length-1);var r=i[e];if(this.Text=C.FormatTimeString(r),this.GetEventCallback){var n=this.GetEventCallback(s.JSCHART_EVENT_ID.ON_FORMAT_CORSSCURSOR_X_TEXT);if(n){var h={Time:r,Index:e};n.Callback(n,h,this)}}return!0}},e.HQPriceStringFormat=S,e.IChangeStringFormat=c,e.IFrameSplitOperator=C,e.PriceSplitData=function(){this.newMethod=D,this.newMethod(),delete this.newMethod,this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,.1,.01],[.2,.4,.2,.02],[.4,.5,.2,.01],[.5,.8,.2,.05],[.8,1,.5,.05],[1,2,.5,.05],[2,4,.5,.05],[4,5,.5,.05],[5,10,.5,.05],[10,12,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,2e8,2e7],[4e8,5e8,4e8,1e7],[5e8,1e9,5e8,5e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]]},e.SplitData=D,e.g_DivTooltipDataForamt=void 0;var r=i(a("53ca"));a("e25e"),a("14d9"),a("d401"),a("d3b7"),a("25f0"),a("ac1f"),a("5319"),a("841c"),a("fb6a"),a("99af"),a("a3a2"),a("6062"),a("3ca3"),a("ddb0"),a("4de4"),a("4e82"),a("4ec9");var n=a("ee32"),s=a("8709"),o=a("966c"),h=o.JSCommonCoordinateData.MARKET_SUFFIX_NAME,l=["日","一","二","三","四","五","六"];function u(){this.Value,this.Message=new Array,this.TextColor=n.g_JSChartResource.FrameSplitTextColor,this.Font=n.g_JSChartResource.FrameSplitTextFont,this.LineColor=n.g_JSChartResource.FrameSplitPen,this.LineDash=null,this.LineType=1}function C(){this.ChartBorder,this.Frame,this.FrameSplitData,this.SplitCount=5,this.StringFormat=0,this.IsShowLeftText=!0,this.IsShowRightText=!0,this.LanguageID=n.JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.GetEventCallback,this.IntegerCoordinateSplit=function(t){var e=this.FrameSplitData.Find(t.Interval);if(!e)return!1;if(t.Interval==e.Interval)return!0;var a=t.Max,i=t.Min,r=t.Max/e.FixInterval,n=t.Min/e.FixInterval;C.IsFloat(r)&&(a=parseInt((r+.5).toFixed(0))*e.FixInterval),C.IsFloat(n)&&(i=parseInt((n-.5).toFixed(0))*e.FixInterval),0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var s=0,o=i;o-a<1e-8;o+=e.FixInterval)++s;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=s,!0},this.Filter=function(t,e){if(this.SplitCount<=0||t.length<=0||t.length<=this.SplitCount)return t;var a=parseInt(t.length/this.SplitCount);a<=1&&(a=2);for(var i=[],r=0;r<t.length;r+=a)r+a>=t.length&&r!=t.length-1?i.push(t[t.length-1]):i.push(t[r]);if(2==this.SplitCount&&i.length>2)for(r=1;r<i.length-1;++r){var n=i[r];n.Message[0]=null,n.Message[1]=null}if(e){var s=!1;for(r=0;r<i.length;++r){n=i[r];if(Math.abs(n.Value)<1e-8){s=!0;break}}if(0==s){var o=new u;o.Value=0,o.Message[0]=null,o.Message[1]=null,i.push(o)}}return i},this.RemoveZero=function(t){var e=[!0,!0];for(var a in t){var i=t[a],r=i.Message[0];this.IsDecimalZeroEnd(r)||(e[0]=!1);r=i.Message[1];this.IsDecimalZeroEnd(r)||(e[1]=!1)}if(0!=e[0]||0!=e[1])for(var a in t){i=t[a];if(e[0]){r=i.Message[0];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[0]=r.replace(/[.][0]+/g,""))}if(e[1]){r=i.Message[1];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[1]=r.replace(/[.][0]+/g,""))}}},this.IsDecimalZeroEnd=function(t){if(null==t)return!0;if("0"==t)return!0;"number"==typeof t&&(t=t.toString());var e=t.search(/[.]/);if(e<0)return!1;for(var a=e+1;a<t.length;++a){var i=t.charAt(a);if(i>="1"&&i<="9")return!1}return!0}}function D(){this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,.1,.01],[.2,.4,.2,.02],[.4,.5,.4,.01],[.5,1,.5,.05],[1,2,1,.05],[2,4,2,.05],[4,5,4,.05],[5,10,5,.05],[10,20,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,1e8,1e7],[4e8,5e8,1e8,1e7],[5e8,1e9,1e8,1e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]],this.Find=function(t){for(var e in this.Data){var a=this.Data[e];if(t>a[0]&&t<=a[1]){var i={};return i.FixInterval=a[2],i.Increase=a[3],i}}return null}}function m(){this.newMethod=D,this.newMethod(),delete this.newMethod,this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,1,1],[.2,.4,1,1],[.4,.5,1,1],[.5,.8,1,1],[.8,1,1,1],[1,2,1,1],[2,4,2,1],[4,5,4,1],[5,10,5,1],[10,12,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,2e8,2e7],[4e8,5e8,4e8,1e7],[5e8,1e9,5e8,5e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]]}function c(){this.Data,this.Value,this.Text,this.Operator=function(){return!1}}function S(){this.newMethod=c,this.newMethod(),delete this.newMethod,this.Symbol,this.FrameID,this.LanguageID=n.JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.PercentageText,this.RValue,this.RText,this.RComplexText,this.PriceFormatType=0,this.DataFormatType=0,this.Operator=function(){if(this.RText=null,this.RComplexText=null,C.IsString(this.RValue)&&(this.RText=this.RValue),!this.Value)return!1;var t=2;if(0==this.FrameID){t=o.JSCommonCoordinateData.GetfloatPrecision(this.Symbol);1==this.PriceFormatType?this.Text=C.FormatValueThousandsString(this.Value,t):this.Text=this.Value.toFixed(t)}else 1==this.DataFormatType?this.Text=C.FormatValueThousandsString(this.Value,t):this.Text=C.FormatValueString(this.Value,t,this.LanguageID);if(this.GetEventCallback){var e=this.GetEventCallback(s.JSCHART_EVENT_ID.ON_FORMAT_CORSSCURSOR_Y_TEXT);if(e){var a={Value:this.Value,FrameID:this.FrameID};e.Callback(e,a,this)}}return!0}}function f(){this.newMethod=c,this.newMethod(),delete this.newMethod,this.DateFormatType=0,this.LanguageID=0,this.Operator=function(){if(!C.IsNumber(this.Value)||this.Value<0)return!1;if(!this.Data)return!1;var t=this.Value;if(t=parseInt(t.toFixed(0)),this.Data.DataOffset+t>=this.Data.Data.length)return!1;var e=this.Data.Data[this.Data.DataOffset+t],a=e.Date,i="YYYY-MM-DD";if(1==this.DateFormatType?i="YYYY/MM/DD":2==this.DateFormatType?i="YYYY/MM/DD/W":3==this.DateFormatType&&(i="DD/MM/YYYY"),this.Text=C.FormatDateString(a,i,this.LanguageID),s.ChartData.IsMinutePeriod(this.Data.Period,!0)){var r=C.FormatTimeString(e.Time);this.Text=this.Text+" "+r}else if(s.ChartData.IsSecondPeriod(this.Data.Period)){r=C.FormatTimeString(e.Time,"HH:MM:SS");this.Text=this.Text+" "+r}if(this.GetEventCallback){var n=this.GetEventCallback(s.JSCHART_EVENT_ID.ON_FORMAT_CORSSCURSOR_X_TEXT);if(n){var o={Item:e,Period:this.Data.Period,Date:e.Date,Time:e.Time,Index:this.Data.DataOffset+t};n.Callback(n,o,this)}}return!0}}C.FormatValueThousandsString=function(t,e){if(null==t||isNaN(t)){if(e>0){for(var a="-.",i=0;i<e;++i)a+="-";return a}return"--"}var r="",n=t.toFixed(e);if(e>0){var s=n.split(".")[1],o=n.split(".")[0];while(o.length>3)r=","+o.slice(-3)+r,o=o.slice(0,o.length-3);o&&(r=o+r+"."+s)}else{while(n.length>3)r=","+n.slice(-3)+r,n=n.slice(0,n.length-3);n&&(r=n+r)}return r},C.FormatValueString=function(t,e,a){if(null==t||isNaN(t)){if(e>0){for(var i="-.",r=0;r<e;++r)i+="-";return i}return"--"}if(t<1e-11&&t>-1e-11)return"0";var s=Math.abs(t);return a===n.JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID?s<1e4?t.toFixed(e):s<1e6?(t/1e3).toFixed(e)+"K":s<1e9?(t/1e6).toFixed(e)+"M":s<1e12?(t/1e9).toFixed(e)+"B":(t/1e12).toFixed(e)+"T":a===n.JSCHART_LANGUAGE_ID.LANGUAGE_TRADITIONAL_CHINESE_ID?s<1e4?t.toFixed(e):s<1e8?(t/1e4).toFixed(e)+"萬":s<1e12?(t/1e8).toFixed(e)+"億":(t/1e12).toFixed(e)+"萬億":s<1e4?t.toFixed(e):s<1e8?(t/1e4).toFixed(e)+"万":s<1e12?(t/1e8).toFixed(e)+"亿":(t/1e12).toFixed(e)+"万亿"},C.FromatIntegerString=function(t,e,a){return t<1e4&&C.IsInteger(t)&&(e=0),C.FormatValueString(t,e,a)},C.NumberToString=function(t){return t<10?"0"+t.toString():t.toString()},C.FormatDateString=function(t,e,a){var i=parseInt(t/1e4),r=parseInt(t/100)%100,s=t%100;switch(e){case"MM-DD":return C.NumberToString(r)+"-"+C.NumberToString(s);case"YYYY-MM":return"".concat(i,"-").concat(C.NumberToString(r));case"YYYY/MM/DD":return i.toString()+"/"+C.NumberToString(r)+"/"+C.NumberToString(s);case"YYYY/MM/DD/W":var o=new Date(i,r-1,s),h=n.g_JSChartLocalization.GetText(l[o.getDay()],a);return i.toString()+"/"+C.NumberToString(r)+"/"+C.NumberToString(s)+"/"+h.toString();case"DD/MM/YYYY":return C.NumberToString(s)+"/"+C.NumberToString(r)+"/"+i.toString();default:return i.toString()+"-"+C.NumberToString(r)+"-"+C.NumberToString(s)}},C.FormatTimeString=function(t,e){if("HH:MM:SS"==e){var a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return C.NumberToString(a)+":"+C.NumberToString(i)+":"+C.NumberToString(r)}if("HH:MM"==e){a=parseInt(t/100),i=t%100;return C.NumberToString(a)+":"+C.NumberToString(i)}if(t<1e4){a=parseInt(t/100),i=t%100;return C.NumberToString(a)+":"+C.NumberToString(i)}a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return C.NumberToString(a)+":"+C.NumberToString(i)+":"+C.NumberToString(r)},C.FormatReportDateString=function(t){var e,a=parseInt(t/1e4),i=parseInt(t/100)%100;switch(i){case 3:e="一季度报";break;case 6:e="半年报";break;case 9:e="三季度报";break;case 12:e="年报";break}return a.toString()+e},C.FormatDateTimeString=function(t,e){var a=t.split(" ");if(a.length<2)return"";var i=parseInt(a[1]),r=i%100,n=parseInt(i/100),s=(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString());if(1==e){var o=parseInt(a[0]),h=parseInt(o/1e4),l=parseInt(o%1e4/100),u=o%100;s=h.toString()+"-"+(l<10?"0"+l.toString():l.toString())+"-"+(u<10?"0"+u.toString():u.toString())+" "+s}return s},C.FormatValueColor=function(t,e){return null!=t&&null==e?0==t?"PriceNull":t>0?"PriceUp":"PriceDown":null==t||null==e||t==e?"PriceNull":t>e?"PriceUp":"PriceDown"},C.IsNumber=function(t){return null!=t&&!isNaN(t)},C.IsPlusNumber=function(t){return null!=t&&(!isNaN(t)&&t>0)},C.IsInteger=function(t){return"number"===typeof t&&t%1===0},C.IsObjectExist=function(t){return void 0!==t&&null!=t},C.IsBool=function(t){return!0===t||!1===t},C.IsString=function(t){var e=(0,r.default)(t);return"string"==e},C.IsFloat=function(t){return void 0!==t&&(null!=t&&(!isNaN(t)&&t!=parseInt(t)))},C.IsNonEmptyArray=function(t){if(t&&Array.isArray(t))return t.length>0};var I=new function(){this.DataMap=new Map([["CorssCursor_XStringFormat",{Create:function(){return new f}}],["CorssCursor_YStringFormat",{Create:function(){return new S}}]]),this.Create=function(t){if(!this.DataMap.has(t))return null;var e=this.DataMap.get(t);return e.Create()}};e.g_DivTooltipDataForamt=I},ee32:function(t,e,a){"use strict";function i(){this.TooltipBGColor="rgb(255, 255, 255)",this.TooltipAlpha=.92,this.SelectRectBGColor="rgba(1,130,212,0.06)",this.BGColor="rgb(255,255,255)",this.UpBarColor="rgb(238,21,21)",this.DownBarColor="rgb(25,158,0)",this.UnchagneBarColor="rgb(0,0,0)",this.MinKLineBarWidth=4,this.Minute={},this.Minute.VolBarColor=null,this.Minute.PriceColor="rgb(50,171,205)",this.Minute.AreaPriceColor="rgba(50,171,205,0.1)",this.Minute.AvPriceColor="rgb(238,127,9)",this.DefaultTextColor="rgb(43,54,69)",this.DefaultTextFont="14px 微软雅黑",this.IndexTitleBGColor="rgb(217,219,220)",this.IndexTitleBorderColor="rgb(180,180,180)",this.IndexTitleColor="rgb(43,54,69)",this.DynamicTitleFont="12px 微软雅黑",this.OverlayIndexTitleBGColor="rgba(255,255,255,0.7)",this.UpTextColor="rgb(238,21,21)",this.DownTextColor="rgb(25,158,0)",this.UnchagneTextColor="rgb(0,0,0)",this.CloseLineColor="rgb(0,191,255)",this.CloseLineAreaColor=["rgba(0,191,255,0.8)","rgba(0,191,255,0.2)"],this.Title={TradeIndexColor:"rgb(105,105,105)",ColorIndexColor:"rgb(112,128,144)",VolColor:"rgb(43,54,69)",AmountColor:"rgb(43,54,69)",DateTimeColor:"rgb(43,54,69)",SettingColor:"rgb(43,54,69)",NameColor:"rgb(43,54,69)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(43,54,69)"},this.FrameBorderPen="rgb(225,236,242)",this.FrameSplitPen="rgb(225,236,242)",this.FrameSplitTextColor="rgb(51,51,51)",this.FrameSplitTextFont="12px 微软雅黑",this.FrameYLineDash=[2,2],this.FrameXLineDash=null,this.FrameTitleBGColor="rgb(246,251,253)",this.Frame={XBottomOffset:0,YTopOffset:2,YTextPadding:[2,2]},this.FrameLogo={TextColor:"rgb(178,34,34)",Font:"bold 16px 微软雅黑"},this.FrameLatestPrice={TextColor:"rgb(255,255,255)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(0,0,0)",BGAlpha:.6,OverlayTextColor:"rgb(255,255,255)"},this.FrameMargin=4,this.FrameLeftMargin=2,this.FrameRightMargin=2,this.OverlayFrame={BolderPen:"rgb(190,190,190)",TitleColor:"rgb(105,105,105)",TitleFont:"11px arial"},this.CorssCursorBGColor="rgb(43,54,69)",this.CorssCursorTextColor="rgb(255,255,255)",this.CorssCursorTextFont="12px 微软雅黑",this.CorssCursorHPenColor="rgb(130,130,130)",this.CorssCursorVPenColor="rgb(130,130,130)",this.Domain="https://opensource.zealink.com",this.CacheDomain="https://opensourcecache.zealink.com",this.KLine={MaxMin:{Font:"12px 微软雅黑",Color:"rgb(111,111,111)",RightArrow:"→",LeftArrow:"←",HighYOffset:0,LowYOffset:0},Info:{Color:"rgb(205,149,12)",Color2:"rgb(255,133,3)",TextColor:"#197de9",TextBGColor:"rgba(220,220,220,0.5)",Investor:{ApiUrl:"/API/NewsInteract"},Announcement:{ApiUrl:"/API/ReportList"},Pforecast:{ApiUrl:"/API/StockHistoryDay"},Research:{ApiUrl:"/API/InvestorRelationsList"},BlockTrading:{ApiUrl:"/API/StockHistoryDay"},TradeDetail:{ApiUrl:"/API/StockHistoryDay"},Policy:{ApiUrl:"/API/StockHistoryDay"}}},this.Index={},this.Index.LineColor=["rgb(255,189,09)","rgb(22,198,255)","rgb(174,35,161)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],this.ColorArray=["rgb(142, 145, 163)","rgb(82,188,134)","rgb(255, 207, 36)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],this.Index.StockHistoryDayApiUrl="https://opensource.zealink.com/API/StockHistoryDay",this.Index.MarketLongShortApiUrl="https://opensource.zealink.com/API/FactorTiming",this.Index.MarketAttentionApiUrl="https://opensource.zealink.com/API/MarketAttention",this.Index.MarketHeatApiUrl="https://opensource.zealink.com/API/MarketHeat",this.Index.CustomIndexHeatApiUrl="https://opensource.zealink.com/API/QuadrantCalculate",this.Index.NotSupport={Font:"14px 微软雅黑",TextColor:"rgb(52,52,52)"},this.DrawPicture={},this.DrawPicture.LineColor=["rgb(30,144,255)"],this.DrawPicture.PointColor=["rgb(105,105,105)"],this.KLineTrain={Font:"bold 14px 宋体",LastDataIcon:{Color:"rgb(0,0,205)",Text:"⬇"},BuyIcon:{Color:"rgb(255,185, 15)",Text:"买"},SellIcon:{Color:"rgb(70,130,180)",Text:"卖"}},this.TooltipPaint={BGColor:"rgba(250,250,250,0.8)",BorderColor:"rgb(120,120,120)",TitleColor:"rgb(120,120,120)",TitleFont:"13px 微软雅黑"},this.Barrage={Font:"16px 微软雅黑",Height:20,Color:"RGB(109,109,109)"},this.MinuteInfo={TextColor:"rgb(84,143,255)",Font:"14px 微软雅黑",PointColor:"rgb(38,113,254)",LineColor:"rgb(120,167,255)",TextBGColor:"rgba(255,255,255,0.8)"},this.DRAWICON={Text:{MaxSize:50,MinSize:20,Zoom:{Type:2,Value:1},FontName:"Arial"}},this.DRAWTEXT={MaxSize:18,MinSize:18,Zoom:{Type:1,Value:1},FontName:"微软雅黑"},this.DRAWNUMBER={MaxSize:18,MinSize:18,Zoom:{Type:1,Value:1},FontName:"微软雅黑"},this.DRAWABOVE={YOffset:0},this.CIRCLEDOT={Radius:1.3},this.POINTDOT={Radius:2},this.DepthChart={BidColor:{Line:"rgb(82,176,123)",Area:"rgba(82,176,123,0.8)"},AskColor:{Line:"rgb(207,76,89)",Area:"rgba(207,76,89, 0.8)"},LineWidth:4},this.DepthCorss={BidColor:{Line:"rgb(82,176,123)"},AskColor:{Line:"rgb(207,76,89)"},LineWidth:2,LineDash:[3,3],Tooltip:{BGColor:"rgba(236,240,245, 0.8)",TextColor:"rgb(130,140,151)",Border:{Top:5,Left:20,Right:20,Bottom:5,ItemSpace:5},Font:"14px 微软雅黑"}},this.Report={BorderColor:"rgb(192,192,192)",SelectedColor:"rgb(180,240,240)",Header:{Color:"rgb(60,60,60)",SortColor:"rgb(255,0,0)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:15,Name:"微软雅黑"}},Item:{Mergin:{Top:2,Bottom:0,Left:5,Right:5},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2},NameFont:{Size:14,Name:"微软雅黑"},SymbolFont:{Size:12,Name:"微软雅黑"}},FixedItem:{Font:{Size:15,Name:"微软雅黑"}},LimitBorder:{Color:"rgb(180,180,180)",Mergin:{Top:1,Bottom:1,Left:0,Right:0}},FieldColor:{Index:"rgb(60,60,60)",Symbol:"rgb(60,60,60)",Name:"rgb(60,60,60)",Vol:"rgb(90,90,90)",Amount:"rgb(90,90,90)",Text:"rgb(60,60,60)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(90,90,90)",CloseLineColor:"rgb(30,144,255)",PageInfo:{Font:{Size:15,Name:"微软雅黑"},TextColor:"rgb(0,0,0)",BGColor:"rgba(180,180,180,0.5)",Mergin:{Left:5,Right:5,Top:4,Bottom:2}}},this.SetStyle=function(t){if(t.TooltipBGColor&&(this.TooltipBGColor=t.TooltipBGColor),t.TooltipAlpha&&(this.TooltipAlpha=t.TooltipAlpha),t.BGColor&&(this.BGColor=t.BGColor),t.SelectRectBGColor&&(this.SelectRectBGColor=t.SelectRectBGColor),t.UpBarColor&&(this.UpBarColor=t.UpBarColor),t.DownBarColor&&(this.DownBarColor=t.DownBarColor),t.UnchagneBarColor&&(this.UnchagneBarColor=t.UnchagneBarColor),t.Minute&&(t.Minute.VolBarColor&&(this.Minute.VolBarColor=t.Minute.VolBarColor),t.Minute.PriceColor&&(this.Minute.PriceColor=t.Minute.PriceColor),t.Minute.AvPriceColor&&(this.Minute.AvPriceColor=t.Minute.AvPriceColor),t.Minute.AreaPriceColor&&(this.Minute.AreaPriceColor=t.Minute.AreaPriceColor)),t.DefaultTextColor&&(this.DefaultTextColor=t.DefaultTextColor),t.DefaultTextFont&&(this.DefaultTextFont=t.DefaultTextFont),t.DynamicTitleFont&&(this.DynamicTitleFont=t.DynamicTitleFont),t.IndexTitleBGColor&&(this.IndexTitleBGColor=t.IndexTitleBGColor),t.OverlayIndexTitleBGColor&&(this.OverlayIndexTitleBGColor=t.OverlayIndexTitleBGColor),t.IndexTitleBorderColor&&(this.IndexTitleBorderColor=t.IndexTitleBorderColor),t.IndexTitleColor&&(this.IndexTitleColor=t.IndexTitleColor),t.UpTextColor&&(this.UpTextColor=t.UpTextColor),t.DownTextColor&&(this.DownTextColor=t.DownTextColor),t.UnchagneTextColor&&(this.UnchagneTextColor=t.UnchagneTextColor),t.CloseLineColor&&(this.CloseLineColor=t.CloseLineColor),t.CloseLineAreaColor&&(this.CloseLineAreaColor=t.CloseLineAreaColor),t.FrameBorderPen&&(this.FrameBorderPen=t.FrameBorderPen),t.FrameSplitPen&&(this.FrameSplitPen=t.FrameSplitPen),t.FrameSplitTextColor&&(this.FrameSplitTextColor=t.FrameSplitTextColor),t.FrameSplitTextFont&&(this.FrameSplitTextFont=t.FrameSplitTextFont),t.FrameTitleBGColor&&(this.FrameTitleBGColor=t.FrameTitleBGColor),t.Frame&&(t.Frame.XBottomOffset&&(this.Frame.XBottomOffset=t.Frame.XBottomOffset),t.Frame.YTopOffset&&(this.Frame.YTopOffset=t.Frame.YTopOffset)),t.FrameLatestPrice&&(t.FrameLatestPrice.TextColor&&(this.FrameLatestPrice.TextColor=t.FrameLatestPrice.TextColor),t.FrameLatestPrice.UpBarColor&&(this.FrameLatestPrice.UpBarColor=t.FrameLatestPrice.UpBarColor),t.FrameLatestPrice.DownBarColor&&(this.FrameLatestPrice.DownBarColor=t.FrameLatestPrice.DownBarColor),t.FrameLatestPrice.UnchagneBarColor&&(this.FrameLatestPrice.UnchagneBarColor=t.FrameLatestPrice.UnchagneBarColor),t.FrameLatestPrice.BGAlpha&&(this.FrameLatestPrice.BGAlpha=t.FrameLatestPrice.BGAlpha),t.FrameLatestPrice.OverlayTextColor&&(this.FrameLatestPrice.OverlayTextColor=t.FrameLatestPrice.OverlayTextColor)),t.CorssCursorBGColor&&(this.CorssCursorBGColor=t.CorssCursorBGColor),t.CorssCursorTextColor&&(this.CorssCursorTextColor=t.CorssCursorTextColor),t.CorssCursorTextFont&&(this.CorssCursorTextFont=t.CorssCursorTextFont),t.CorssCursorHPenColor&&(this.CorssCursorHPenColor=t.CorssCursorHPenColor),t.CorssCursorVPenColor&&(this.CorssCursorVPenColor=t.CorssCursorVPenColor),t.KLine&&(this.KLine=t.KLine),t.Index&&(t.Index.LineColor&&(this.Index.LineColor=t.Index.LineColor),t.Index.NotSupport&&(this.Index.NotSupport=t.Index.NotSupport)),t.ColorArray&&(this.ColorArray=t.ColorArray),t.DrawPicture&&(this.DrawPicture.LineColor=t.DrawPicture.LineColor,this.DrawPicture.PointColor=t.DrawPicture.PointColor),t.TooltipPaint&&(t.TooltipPaint.BGColor&&(this.TooltipPaint.BGColor=t.TooltipPaint.BGColor),t.TooltipPaint.BorderColor&&(this.TooltipPaint.BorderColor=t.TooltipPaint.BorderColor),t.TooltipPaint.TitleColor&&(this.TooltipPaint.TitleColor=t.TooltipPaint.TitleColor),t.TooltipPaint.TitleFont&&(this.TooltipPaint.TitleFont=t.TooltipPaint.TitleFont)),t.Title&&(t.Title.TradeIndexColor&&(this.Title.TradeIndexColor=t.Title.TradeIndexColor),t.Title.ColorIndexColor&&(this.Title.ColorIndexColor=t.Title.ColorIndexColor),t.Title.VolColor&&(this.Title.VolColor=t.Title.VolColor),t.Title.AmountColor&&(this.Title.AmountColor=t.Title.AmountColor),t.Title.DateTimeColor&&(this.Title.DateTimeColor=t.Title.DateTimeColor),t.Title.NameColor&&(this.Title.NameColor=t.Title.NameColor),t.Title.SettingColor&&(this.Title.SettingColor=t.Title.SettingColor),t.Title.TurnoverRateColor&&(this.Title.TurnoverRateColor=t.Title.TurnoverRateColor),t.Title.PositionColor&&(this.Title.PositionColor=t.Title.PositionColor)),t.DRAWICON&&t.DRAWICON.Text){var e=t.DRAWICON.Text;this.IsPlusNumber(e.MaxSize)&&(this.DRAWICON.Text.MaxSize=e.MaxSize),this.IsPlusNumber(e.MinSize)&&(this.DRAWICON.Text.MinSize=e.MinSize),e.Zoom&&(this.DRAWICON.Text.Zoom=e.Zoom),e.FontName&&(this.DRAWICON.Text.FontName=e.FontName)}if(t.DRAWTEXT){e=t.DRAWTEXT;this.IsPlusNumber(e.MaxSize)&&(this.DRAWICON.MaxSize=e.MaxSize),this.IsPlusNumber(e.MinSize)&&(this.DRAWICON.MinSize=e.MinSize),e.Zoom&&(this.DRAWICON.Zoom=e.Zoom),e.FontName&&(this.DRAWICON.FontName=e.FontName)}if(t.DRAWNUMBER){e=t.DRAWNUMBER;this.IsPlusNumber(e.MaxSize)&&(this.DRAWNUMBER.MaxSize=e.MaxSize),this.IsPlusNumber(e.MinSize)&&(this.DRAWNUMBER.MinSize=e.MinSize),e.Zoom&&(this.DRAWNUMBER.Zoom=e.Zoom),e.FontName&&(this.DRAWNUMBER.FontName=e.FontName)}if(t.DRAWABOVE){e=t.DRAWABOVE;this.IsNumber(e.YOffset)&&(this.DRAWABOVE.YOffset=e.YOffset)}if(t.DepthChart){e=t.DepthChart;e.BidColor&&(e.BidColor.Line&&(this.DepthChart.BidColor.Line=e.BidColor.Line),e.BidColor.Area&&(this.DepthChart.BidColor.Area=e.BidColor.Area)),e.AskColor&&(e.AskColor.Line&&(this.DepthChart.AskColor.Line=e.AskColor.Line),e.AskColor.Area&&(this.DepthChart.AskColor.Area=e.AskColor.Area)),e.LineWidth&&(this.DepthChart.LineWidth=e.LineWidth)}if(t.DepthCorss){e=t.DepthCorss;if(e.BidColor&&e.BidColor.Line&&(this.DepthCorss.BidColor.Line=e.BidColor.Line),e.AskColor&&e.AskColor.Line&&(this.DepthCorss.AskColor.Line=e.AskColor.Line),e.LineWidth&&(this.DepthCorss.LineWidth=e.LineWidth),e.LineDash&&(this.DepthCorss.LineDash=e.LineDash),e.Tooltip){var a=e.Tooltip;a.BGColor&&(this.DepthCorss.Tooltip.BGColor=a.BGColor),a.TextColor&&(this.DepthCorss.Tooltip.TextColor=a.TextColor),a.Font&&(this.DepthCorss.Tooltip.Font=a.Font),a.LineHeight&&(this.DepthCorss.Tooltip.LineHeight=a.LineHeight);var i=a.Border;this.IsNumber(i.Top)&&(this.DepthCorss.Tooltip.Border.Top=i.Top),this.IsNumber(i.Left)&&(this.DepthCorss.Tooltip.Border.Left=i.Left),this.IsNumber(i.Right)&&(this.DepthCorss.Tooltip.Border.Right=i.Right),this.IsNumber(i.Bottom)&&(this.DepthCorss.Tooltip.Border.Bottom=i.Bottom),this.IsNumber(i.ItemSpace)&&(this.DepthCorss.Tooltip.Border.ItemSpace=i.ItemSpace)}}if(t.CIRCLEDOT){e=t.CIRCLEDOT;this.IsNumber(e.Radius)&&(this.CIRCLEDOT.Radius=e.Radius)}if(t.POINTDOT){e=t.POINTDOT;this.IsNumber(e.Radius)&&(this.POINTDOT.Radius=e.Radius)}if(t.Report){e=t.Report;if(e.BorderColor&&(this.Report.BorderColor=e.BorderColor),e.UpTextColor&&(this.Report.UpTextColor=e.UpTextColor),e.DownTextColor&&(this.Report.DownTextColor=e.DownTextColor),e.UnchagneTextColor&&(this.Report.UnchagneTextColor=e.UnchagneTextColor),e.BorderColor&&(this.Report.SelectedColor=e.SelectedColor),e.CloseLineColor&&(this.Report.CloseLineColor=e.CloseLineColor),e.Header){var r=e.Header;if(r.Color&&(this.Report.Header.Color=r.Color),r.SortColor&&(this.Report.Header.SortColor=r.SortColor),r.Mergin){var n=r.Mergin;this.IsNumber(n.Left)&&(this.Report.Header.Mergin.Left=n.Left),this.IsNumber(n.Right)&&(this.Report.Header.Mergin.Left=n.Right),this.IsNumber(n.Top)&&(this.Report.Header.Mergin.Top=n.Top),this.IsNumber(n.Bottom)&&(this.Report.Header.Mergin.Bottom=n.Bottom)}if(r.Font){var s=r.Font;s.Name&&(this.Report.Header.Font.Name=s.Name),this.IsNumber(s.Size)&&(this.Report.Header.Font.Size=s.Size)}}if(e.Item){var o=e.Item;if(o.Mergin){n=o.Mergin;this.IsNumber(n.Left)&&(this.Report.Item.Mergin.Left=n.Left),this.IsNumber(n.Right)&&(this.Report.Item.Mergin.Right=n.Right),this.IsNumber(n.Top)&&(this.Report.Item.Mergin.Top=n.Top),this.IsNumber(n.Bottom)&&(this.Report.Item.Mergin.Bottom=n.Bottom)}if(o.Font){s=o.Font;s.Name&&(this.Report.Item.Font.Name=s.Name),this.IsNumber(s.Size)&&(this.Report.Item.Font.Size=s.Size)}if(o.BarMergin){n=o.BarMergin;this.IsNumber(n.Left)&&(this.Report.Item.BarMergin.Left=n.Left),this.IsNumber(n.Top)&&(this.Report.Item.BarMergin.Top=n.Top),this.IsNumber(n.Right)&&(this.Report.Item.BarMergin.Right=n.Right),this.IsNumber(n.Bottom)&&(this.Report.Item.BarMergin.Bottom=n.Bottom)}if(o.NameFont){s=o.NameFont;s.Name&&(this.Report.Item.NameFont.Name=s.Name),this.IsNumber(s.Size)&&(this.Report.Item.NameFont.Size=s.Size)}if(o.SymbolFont){s=o.SymbolFont;s.Name&&(this.Report.Item.SymbolFont.Name=s.Name),this.IsNumber(s.Size)&&(this.Report.Item.SymbolFont.Size=s.Size)}}if(e.FixedItem){o=e.FixedItem;if(o.Font){s=o.Font;s.Name&&(this.Report.FixedItem.Font.Name=s.Name),this.IsNumber(s.Size)&&(this.Report.FixedItem.Font.Size=s.Size)}}if(e.LimitBorder){var h=e.LimitBorder;if(h.Color&&(this.Report.LimitBorder.Color=h.Color),h.Mergin){n=h.Mergin;this.IsNumber(n.Left)&&(this.Report.LimitBorder.Mergin.Left=n.Left),this.IsNumber(n.Top)&&(this.Report.LimitBorder.Mergin.Top=n.Top),this.IsNumber(n.Right)&&(this.Report.LimitBorder.Mergin.Right=n.Right),this.IsNumber(n.Bottom)&&(this.Report.LimitBorder.Mergin.Bottom=n.Bottom)}}if(e.FieldColor){var l=e.FieldColor;if(l.Name&&(this.Report.FieldColor.Name=l.Name),l.Symbol&&(this.Report.FieldColor.Symbol=l.Symbol),l.Vol&&(this.Report.FieldColor.Vol=l.Vol),l.Amount&&(this.Report.FieldColor.Amount=l.Amount),l.Index&&(this.Report.FieldColor.Index=l.Index),l.BarTitle&&(this.Report.FieldColor.BarTitle=l.BarTitle),l.Text&&(this.Report.FieldColor.Text=l.Text),this.IsNonEmptyArray(l.Bar))for(var u=0;u<l.Bar.length;++u)this.Report.FieldColor.Bar[u]=l.Bar[u]}if(e.PageInfo){var C=e.PageInfo;if(C.Font){s=C.Font;s.Name&&(this.Report.PageInfo.Font.Name=s.Name),this.IsNumber(s.Size)&&(this.Report.PageInfo.Font.Size=s.Size)}if(C.TextColor&&(this.Report.PageInfo.TextColor=C.TextColor),C.BGColor&&(this.Report.PageInfo.BGColor=C.BGColor),C.Mergin){n=C.Mergin;this.IsNumber(n.Left)&&(this.Report.PageInfo.Mergin.Left=n.Left),this.IsNumber(n.Top)&&(this.Report.PageInfo.Mergin.Top=n.Top),this.IsNumber(n.Right)&&(this.Report.PageInfo.Mergin.Right=n.Right),this.IsNumber(n.Bottom)&&(this.Report.PageInfo.Mergin.Bottom=n.Bottom)}}}},this.IsNumber=function(t){return null!=t&&!isNaN(t)},this.IsPlusNumber=function(t){return null!=t&&(!isNaN(t)&&t>0)},this.IsNonEmptyArray=function(t){if(t&&Array.isArray(t))return t.length>0}}a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.JSCHART_LANGUAGE_ID=void 0,e.JSChartResource=i,e.g_JSChartResource=e.g_JSChartLocalization=void 0,a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0");var r=new i;e.g_JSChartResource=r;var n={LANGUAGE_CHINESE_ID:0,LANGUAGE_ENGLISH_ID:1,LANGUAGE_TRADITIONAL_CHINESE_ID:2};e.JSCHART_LANGUAGE_ID=n;var s=new function(){this.TextResource=new Map([["Tooltip-Open",{CN:"开:",EN:"O:",TC:"開"}],["Tooltip-High",{CN:"高:",EN:"H:",TC:"高"}],["Tooltip-Low",{CN:"低:",EN:"L:",TC:"低"}],["Tooltip-Close",{CN:"收:",EN:"C:",TC:"收"}],["Tooltip-Increase",{CN:"幅:",EN:"I:",TC:"幅"}],["Tooltip-Vol",{CN:"量:",EN:"V:",TC:"量"}],["Tooltip-Amount",{CN:"额:",EN:"A:",TC:"額"}],["Tooltip-AvPrice",{CN:"均:",EN:"AP:",TC:"均"}],["Tooltip-Price",{CN:"价:",EN:"P:",TC:"價"}],["Tooltip-Exchange",{CN:"换:",EN:"E:",TC:"換"}],["Tooltip-Position",{CN:"持:",EN:"P:",TC:"持"}],["KTitle-Open",{CN:"开:",EN:"O:",TC:"開"}],["KTitle-High",{CN:"高:",EN:"H:",TC:"高"}],["KTitle-Low",{CN:"低:",EN:"L:",TC:"低"}],["KTitle-Close",{CN:"收:",EN:"C:",TC:"收"}],["KTitle-Increase",{CN:"幅:",EN:"I:",TC:"幅"}],["KTitle-Vol",{CN:"量:",EN:"V:",TC:"量"}],["KTitle-Amount",{CN:"额:",EN:"A:",TC:"額"}],["KTitle-Exchange",{CN:"换:",EN:"E:",TC:"換"}],["KTitle-Position",{CN:"持:",EN:"P:",TC:"持"}],["KTitle-Price",{CN:"价:",EN:"Price:",TC:"價"}],["MTitle-Close",{CN:"价:",EN:"C:",TC:"價"}],["MTitle-AvPrice",{CN:"均:",EN:"AC:",TC:"均"}],["MTitle-Increase",{CN:"幅:",EN:"I:",TC:"幅"}],["MTitle-Vol",{CN:"量:",EN:"V:",TC:"量"}],["MTitle-Amount",{CN:"额:",EN:"A:",TC:"額"}],["MTitle-Position",{CN:"持:",EN:"P:",TC:"持"}],["日线",{CN:"日线",EN:"1D",TC:"日綫"}],["周线",{CN:"周线",EN:"1W",TC:"周綫"}],["双周",{CN:"双周",EN:"2W",TC:"雙周"}],["月线",{CN:"月线",EN:"1M",TC:"月綫"}],["半年",{CN:"半年",EN:"HY",TC:"半年"}],["年线",{CN:"年线",EN:"1Y",TC:"年綫"}],["1分",{CN:"1分",EN:"1Min",TC:"1分"}],["5分",{CN:"5分",EN:"5Min",TC:"5分"}],["15分",{CN:"15分",EN:"15Min",TC:"15分"}],["30分",{CN:"30分",EN:"30Min",TC:"30分"}],["60分",{CN:"60分",EN:"60Min",TC:"60分"}],["季线",{CN:"季线",EN:"1Q",TC:"季綫"}],["分笔",{CN:"分笔",EN:"Tick",TC:"分筆"}],["2小时",{CN:"2小时",EN:"2H",TC:"2小時"}],["4小时",{CN:"4小时",EN:"4H",TC:"4小時"}],["不复权",{CN:"不复权",EN:"No Right",TC:"不復權"}],["前复权",{CN:"前复权",EN:"Pro Right",TC:"前復權"}],["后复权",{CN:"后复权",EN:"Post Right",TC:"后復權"}],["日",{CN:"日",EN:"Sun.",TC:"日"}],["一",{CN:"一",EN:"Mon.",TC:"壹"}],["二",{CN:"二",EN:"Tues.",TC:"貳"}],["三",{CN:"三",EN:"Wed.",TC:"叁"}],["四",{CN:"四",EN:"Thur.",TC:"肆"}],["五",{CN:"五",EN:"Fri.",TC:"伍"}],["六",{CN:"六",EN:"Sat.",TC:"陸"}],["1月",{CN:"1月",EN:"Jan",TC:"1月"}],["2月",{CN:"2月",EN:"Feb",TC:"2月"}],["3月",{CN:"3月",EN:"Mar",TC:"3月"}],["4月",{CN:"4月",EN:"Apr",TC:"4月"}],["5月",{CN:"5月",EN:"May",TC:"5月"}],["6月",{CN:"6月",EN:"Jun",TC:"6月"}],["7月",{CN:"7月",EN:"Jul",TC:"7月"}],["8月",{CN:"8月",EN:"Aug",TC:"8月"}],["9月",{CN:"9月",EN:"Sept",TC:"9月"}],["10月",{CN:"10月",EN:"Oct",TC:"10月"}],["11月",{CN:"11月",EN:"Nov",TC:"11月"}],["12月",{CN:"12月",EN:"Dec",TC:"12月"}],["自定义分钟",{CN:"分",EN:"Min",TC:"分"}],["自定义日线",{CN:"日",EN:"D",TC:"日"}],["自定义秒",{CN:"秒",EN:"S",TC:"秒"}],["Depth-Price",{CN:"委托价",EN:"Price",TC:"委托價"}],["Depth-Sum",{CN:"累计",EN:"Sum",TC:"累計"}]]),this.GetText=function(t,e){var a=this.TextResource.get(t);if(!a)return"";switch(e){case n.LANGUAGE_CHINESE_ID:return a.CN;case n.LANGUAGE_ENGLISH_ID:return a.EN;case n.LANGUAGE_TRADITIONAL_CHINESE_ID:return a.TC;default:return a.CN}},this.SetTextResource=function(t,e){this.TextResource.set(t,e)},this.GetLanguageID=function(t){var e=null;switch(t){case"EN":e=n.LANGUAGE_ENGLISH_ID;break;case"CN":e=n.LANGUAGE_CHINESE_ID;break;case"TC":e=n.LANGUAGE_TRADITIONAL_CHINESE_ID;break;default:break}return e}};e.g_JSChartLocalization=s},f183:function(t,e,a){var i=a("23e7"),r=a("e330"),n=a("d012"),s=a("861d"),o=a("1a2d"),h=a("9bf2").f,l=a("241c"),u=a("057f"),C=a("4fad"),D=a("90e3"),m=a("bb2f"),c=!1,S=D("meta"),f=0,I=function(t){h(t,S,{value:{objectID:"O"+f++,weakData:{}}})},d=t.exports={enable:function(){d.enable=function(){},c=!0;var t=l.f,e=r([].splice),a={};a[S]=1,t(a).length&&(l.f=function(a){for(var i=t(a),r=0,n=i.length;r<n;r++)if(i[r]===S){e(i,r,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,S)){if(!C(t))return"F";if(!e)return"E";I(t)}return t[S].objectID},getWeakData:function(t,e){if(!o(t,S)){if(!C(t))return!0;if(!e)return!1;I(t)}return t[S].weakData},onFreeze:function(t){return m&&c&&C(t)&&!o(t,S)&&I(t),t}};n[S]=!0}}]);